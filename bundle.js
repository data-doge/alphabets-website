var _Mathatan2=Math.atan,_MathLN=Math.LN2,_Mathtan=Math.tan,_Mathasin=Math.asin,_Mathacos=Math.acos,_Mathsign=Math.sign,_NumberEPSILON=Number.EPSILON,_Mathlog=Math.log,_Mathceil=Math.ceil,_StringfromCharCode=String.fromCharCode,_Mathabs=Math.abs,_Mathround=Math.round,_Mathsin2=Math.sin,_Mathcos2=Math.cos,_Mathsqrt=Math.sqrt,_MathPI2=Math.PI,_Mathatan=Math.atan2,_Mathfloor=Math.floor,_Mathpow=Math.pow,_Mathmax=Math.max,_Mathmin=Math.min;(function S(M,E,L){function C(R,D){if(!E[R]){if(!M[R]){var I="function"==typeof require&&require;if(!D&&I)return I(R,!0);if(A)return A(R,!0);var U=new Error("Cannot find module '"+R+"'");throw U.code="MODULE_NOT_FOUND",U}var F=E[R]={exports:{}};M[R][0].call(F.exports,function(V){var G=M[R][1][V];return C(G?G:V)},F,F.exports,S,M,E,L)}return E[R].exports}for(var A="function"==typeof require&&require,P=0;P<L.length;P++)C(L[P]);return C})({1:[function(S,M){(function(L){"use strict";function C(le,pe){if(le===pe)return 0;for(var ue=le.length,ge=pe.length,fe=0,he=_Mathmin(ue,ge);fe<he;++fe)if(le[fe]!==pe[fe]){ue=le[fe],ge=pe[fe];break}return ue<ge?-1:ge<ue?1:0}function A(le){return L.Buffer&&"function"==typeof L.Buffer.isBuffer?L.Buffer.isBuffer(le):!!(null!=le&&le._isBuffer)}function P(le){return Object.prototype.toString.call(le)}function R(le){return!A(le)&&!("function"!=typeof L.ArrayBuffer)&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(le):!!le&&(!!(le instanceof DataView)||le.buffer&&le.buffer instanceof ArrayBuffer))}function D(le){if(Q.isFunction(le)){if(oe)return le.name;var pe=le.toString(),ue=pe.match(ie);return ue&&ue[1]}}function I(le,pe){return"string"==typeof le?le.length<pe?le:le.slice(0,pe):le}function U(le){if(oe||!Q.isFunction(le))return Q.inspect(le);var pe=D(le),ue=pe?": "+pe:"";return"[Function"+ue+"]"}function F(le){return I(U(le.actual),128)+" "+le.operator+" "+I(U(le.expected),128)}function V(le,pe,ue,ge,fe){throw new ne.AssertionError({message:ue,actual:le,expected:pe,operator:ge,stackStartFunction:fe})}function G(le,pe){le||V(le,!0,pe,"==",ne.ok)}function O(le,pe,ue,ge){if(le===pe)return!0;if(A(le)&&A(pe))return 0===C(le,pe);if(Q.isDate(le)&&Q.isDate(pe))return le.getTime()===pe.getTime();if(Q.isRegExp(le)&&Q.isRegExp(pe))return le.source===pe.source&&le.global===pe.global&&le.multiline===pe.multiline&&le.lastIndex===pe.lastIndex&&le.ignoreCase===pe.ignoreCase;if((null===le||"object"!=typeof le)&&(null===pe||"object"!=typeof pe))return ue?le==pe:le==pe;if(R(le)&&R(pe)&&P(le)===P(pe)&&!(le instanceof Float32Array||le instanceof Float64Array))return 0===C(new Uint8Array(le.buffer),new Uint8Array(pe.buffer));if(A(le)!==A(pe))return!1;ge=ge||{actual:[],expected:[]};var fe=ge.actual.indexOf(le);return-1!==fe&&fe===ge.expected.indexOf(pe)||(ge.actual.push(le),ge.expected.push(pe),W(le,pe,ue,ge))}function H(le){return"[object Arguments]"==Object.prototype.toString.call(le)}function W(le,pe,ue,ge){if(null===le||le===void 0||null===pe||pe===void 0)return!1;if(Q.isPrimitive(le)||Q.isPrimitive(pe))return le===pe;if(ue&&Object.getPrototypeOf(le)!==Object.getPrototypeOf(pe))return!1;var fe=H(le),he=H(pe);if(fe&&!he||!fe&&he)return!1;if(fe)return le=ee.call(le),pe=ee.call(pe),O(le,pe,ue);var ye=se(le),xe=se(pe),ve,_e;if(ye.length!==xe.length)return!1;for(ye.sort(),xe.sort(),_e=ye.length-1;0<=_e;_e--)if(ye[_e]!==xe[_e])return!1;for(_e=ye.length-1;0<=_e;_e--)if(ve=ye[_e],!O(le[ve],pe[ve],ue,ge))return!1;return!0}function X(le,pe,ue){O(le,pe,!0)&&V(le,pe,ue,"notDeepStrictEqual",X)}function Y(le,pe){if(!le||!pe)return!1;if("[object RegExp]"==Object.prototype.toString.call(pe))return pe.test(le);try{if(le instanceof pe)return!0}catch(ue){}return!Error.isPrototypeOf(pe)&&!0===pe.call({},le)}function Z(le){var pe;try{le()}catch(ue){pe=ue}return pe}function K(le,pe,ue,ge){var fe;if("function"!=typeof pe)throw new TypeError("\"block\" argument must be a function");"string"==typeof ue&&(ge=ue,ue=null),fe=Z(pe),ge=(ue&&ue.name?" ("+ue.name+").":".")+(ge?" "+ge:"."),le&&!fe&&V(fe,ue,"Missing expected exception"+ge);var he="string"==typeof ge,ye=!le&&Q.isError(fe),xe=!le&&fe&&!ue;if((ye&&he&&Y(fe,ue)||xe)&&V(fe,ue,"Got unwanted exception"+ge),le&&fe&&ue&&!Y(fe,ue)||!le&&fe)throw fe}var Q=S("util/"),J=Object.prototype.hasOwnProperty,ee=Array.prototype.slice,oe=function(){return"foo"===function(){}.name}(),ne=M.exports=G,ie=/\s*function\s+([^\(\s]*)\s*/;ne.AssertionError=function(pe){this.name="AssertionError",this.actual=pe.actual,this.expected=pe.expected,this.operator=pe.operator,pe.message?(this.message=pe.message,this.generatedMessage=!1):(this.message=F(this),this.generatedMessage=!0);var ue=pe.stackStartFunction||V;if(Error.captureStackTrace)Error.captureStackTrace(this,ue);else{var ge=new Error;if(ge.stack){var fe=ge.stack,he=D(ue),ye=fe.indexOf("\n"+he);if(0<=ye){var xe=fe.indexOf("\n",ye+1);fe=fe.substring(xe+1)}this.stack=fe}}},Q.inherits(ne.AssertionError,Error),ne.fail=V,ne.ok=G,ne.equal=function(pe,ue,ge){pe!=ue&&V(pe,ue,ge,"==",ne.equal)},ne.notEqual=function(pe,ue,ge){pe==ue&&V(pe,ue,ge,"!=",ne.notEqual)},ne.deepEqual=function(pe,ue,ge){O(pe,ue,!1)||V(pe,ue,ge,"deepEqual",ne.deepEqual)},ne.deepStrictEqual=function(pe,ue,ge){O(pe,ue,!0)||V(pe,ue,ge,"deepStrictEqual",ne.deepStrictEqual)},ne.notDeepEqual=function(pe,ue,ge){O(pe,ue,!1)&&V(pe,ue,ge,"notDeepEqual",ne.notDeepEqual)},ne.notDeepStrictEqual=X,ne.strictEqual=function(pe,ue,ge){pe!==ue&&V(pe,ue,ge,"===",ne.strictEqual)},ne.notStrictEqual=function(pe,ue,ge){pe===ue&&V(pe,ue,ge,"!==",ne.notStrictEqual)},ne.throws=function(le,pe,ue){K(!0,le,pe,ue)},ne.doesNotThrow=function(le,pe,ue){K(!1,le,pe,ue)},ne.ifError=function(le){if(le)throw le};var se=Object.keys||function(le){var pe=[];for(var ue in le)J.call(le,ue)&&pe.push(ue);return pe}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"util/":30}],2:[function(S,M){function L(C,A){return C+A}M.exports=function(A){"use strict";return A.reduce(L,0)/A.length}},{}],3:[function(S,M){function L(F,V){return _Mathpow(F[0]-V[0],2)+_Mathpow(F[1]-V[1],2)+_Mathpow(F[2]-V[2],2)}var C=S("color-name"),A={};for(var P in C)C.hasOwnProperty(P)&&(A[C[P]]=P);var R=M.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var D in R)if(R.hasOwnProperty(D)){if(!("channels"in R[D]))throw new Error("missing channels property: "+D);if(!("labels"in R[D]))throw new Error("missing channel labels property: "+D);if(R[D].labels.length!==R[D].channels)throw new Error("channel and label counts mismatch: "+D);var I=R[D].channels,U=R[D].labels;delete R[D].channels,delete R[D].labels,Object.defineProperty(R[D],"channels",{value:I}),Object.defineProperty(R[D],"labels",{value:U})}R.rgb.hsl=function(F){var V=F[0]/255,G=F[1]/255,O=F[2]/255,H=_Mathmin(V,G,O),W=_Mathmax(V,G,O),X=W-H,Y,Z,K;return W===H?Y=0:V===W?Y=(G-O)/X:G===W?Y=2+(O-V)/X:O===W&&(Y=4+(V-G)/X),Y=_Mathmin(60*Y,360),0>Y&&(Y+=360),K=(H+W)/2,Z=W===H?0:0.5>=K?X/(W+H):X/(2-W-H),[Y,100*Z,100*K]},R.rgb.hsv=function(F){var V=F[0],G=F[1],O=F[2],H=_Mathmin(V,G,O),W=_Mathmax(V,G,O),X=W-H,Y,Z,K;return Z=0===W?0:1e3*(X/W)/10,W===H?Y=0:V===W?Y=(G-O)/X:G===W?Y=2+(O-V)/X:O===W&&(Y=4+(V-G)/X),Y=_Mathmin(60*Y,360),0>Y&&(Y+=360),K=1e3*(W/255)/10,[Y,Z,K]},R.rgb.hwb=function(F){var V=F[0],G=F[1],O=F[2],H=R.rgb.hsl(F)[0],W=1/255*_Mathmin(V,_Mathmin(G,O));return O=1-1/255*_Mathmax(V,_Mathmax(G,O)),[H,100*W,100*O]},R.rgb.cmyk=function(F){var V=F[0]/255,G=F[1]/255,O=F[2]/255,H,W,X,Y;return Y=_Mathmin(1-V,1-G,1-O),H=(1-V-Y)/(1-Y)||0,W=(1-G-Y)/(1-Y)||0,X=(1-O-Y)/(1-Y)||0,[100*H,100*W,100*X,100*Y]},R.rgb.keyword=function(F){var V=A[F];if(V)return V;var G=Infinity,O;for(var H in C)if(C.hasOwnProperty(H)){var W=C[H],X=L(F,W);X<G&&(G=X,O=H)}return O},R.keyword.rgb=function(F){return C[F]},R.rgb.xyz=function(F){var V=F[0]/255,G=F[1]/255,O=F[2]/255;V=0.04045<V?_Mathpow((V+0.055)/1.055,2.4):V/12.92,G=0.04045<G?_Mathpow((G+0.055)/1.055,2.4):G/12.92,O=0.04045<O?_Mathpow((O+0.055)/1.055,2.4):O/12.92;var H=0.4124*V+0.3576*G+0.1805*O,W=0.2126*V+0.7152*G+0.0722*O,X=0.0193*V+0.1192*G+0.9505*O;return[100*H,100*W,100*X]},R.rgb.lab=function(F){var V=R.rgb.xyz(F),G=V[0],O=V[1],H=V[2],W,X,Y;return G/=95.047,O/=100,H/=108.883,G=0.008856<G?_Mathpow(G,1/3):7.787*G+16/116,O=0.008856<O?_Mathpow(O,1/3):7.787*O+16/116,H=0.008856<H?_Mathpow(H,1/3):7.787*H+16/116,W=116*O-16,X=500*(G-O),Y=200*(O-H),[W,X,Y]},R.hsl.rgb=function(F){var V=F[0]/360,G=F[1]/100,O=F[2]/100,H,W,X,Y,Z;if(0==G)return Z=255*O,[Z,Z,Z];W=0.5>O?O*(1+G):O+G-O*G,H=2*O-W,Y=[0,0,0];for(var K=0;3>K;K++)X=V+1/3*-(K-1),0>X&&X++,1<X&&X--,Z=1>6*X?H+6*(W-H)*X:1>2*X?W:2>3*X?H+6*((W-H)*(2/3-X)):H,Y[K]=255*Z;return Y},R.hsl.hsv=function(F){var V=F[0],G=F[1]/100,O=F[2]/100,H=G,W=_Mathmax(O,0.01),X,Y;return O*=2,G*=1>=O?O:2-O,H*=1>=W?W:2-W,Y=(O+G)/2,X=0==O?2*H/(W+H):2*G/(O+G),[V,100*X,100*Y]},R.hsv.rgb=function(F){var V=F[0]/60,G=F[1]/100,O=F[2]/100,H=_Mathfloor(V)%6,W=V-_Mathfloor(V),X=255*O*(1-G),Y=255*O*(1-G*W),Z=255*O*(1-G*(1-W));return O*=255,0==H?[O,Z,X]:1==H?[Y,O,X]:2==H?[X,O,Z]:3==H?[X,Y,O]:4==H?[Z,X,O]:5==H?[O,X,Y]:void 0},R.hsv.hsl=function(F){var V=F[0],G=F[1]/100,O=F[2]/100,H=_Mathmax(O,0.01),W,X,Y;return Y=(2-G)*O,W=(2-G)*H,X=G*H,X/=1>=W?W:2-W,X=X||0,Y/=2,[V,100*X,100*Y]},R.hwb.rgb=function(F){var V=F[0]/360,G=F[1]/100,O=F[2]/100,H=G+O,W,X,Y,Z;1<H&&(G/=H,O/=H),W=_Mathfloor(6*V),X=1-O,Y=6*V-W,0!=(1&W)&&(Y=1-Y),Z=G+Y*(X-G);var K,Q,J;switch(W){default:case 6:case 0:K=X,Q=Z,J=G;break;case 1:K=Z,Q=X,J=G;break;case 2:K=G,Q=X,J=Z;break;case 3:K=G,Q=Z,J=X;break;case 4:K=Z,Q=G,J=X;break;case 5:K=X,Q=G,J=Z;}return[255*K,255*Q,255*J]},R.cmyk.rgb=function(F){var V=F[0]/100,G=F[1]/100,O=F[2]/100,H=F[3]/100,W,X,Y;return W=1-_Mathmin(1,V*(1-H)+H),X=1-_Mathmin(1,G*(1-H)+H),Y=1-_Mathmin(1,O*(1-H)+H),[255*W,255*X,255*Y]},R.xyz.rgb=function(F){var V=F[0]/100,G=F[1]/100,O=F[2]/100,H,W,X;return H=3.2406*V+-1.5372*G+-0.4986*O,W=-0.9689*V+1.8758*G+0.0415*O,X=0.0557*V+-0.204*G+1.057*O,H=0.0031308<H?1.055*_Mathpow(H,1/2.4)-0.055:12.92*H,W=0.0031308<W?1.055*_Mathpow(W,1/2.4)-0.055:12.92*W,X=0.0031308<X?1.055*_Mathpow(X,1/2.4)-0.055:12.92*X,H=_Mathmin(_Mathmax(0,H),1),W=_Mathmin(_Mathmax(0,W),1),X=_Mathmin(_Mathmax(0,X),1),[255*H,255*W,255*X]},R.xyz.lab=function(F){var V=F[0],G=F[1],O=F[2],H,W,X;return V/=95.047,G/=100,O/=108.883,V=0.008856<V?_Mathpow(V,1/3):7.787*V+16/116,G=0.008856<G?_Mathpow(G,1/3):7.787*G+16/116,O=0.008856<O?_Mathpow(O,1/3):7.787*O+16/116,H=116*G-16,W=500*(V-G),X=200*(G-O),[H,W,X]},R.lab.xyz=function(F){var V=F[0],G=F[1],O=F[2],H,W,X;W=(V+16)/116,H=G/500+W,X=W-O/200;var Y=_Mathpow(W,3),Z=_Mathpow(H,3),K=_Mathpow(X,3);return W=0.008856<Y?Y:(W-16/116)/7.787,H=0.008856<Z?Z:(H-16/116)/7.787,X=0.008856<K?K:(X-16/116)/7.787,H*=95.047,W*=100,X*=108.883,[H,W,X]},R.lab.lch=function(F){var V=F[0],G=F[1],O=F[2],H,W,X;return H=_Mathatan(O,G),W=360*H/2/_MathPI2,0>W&&(W+=360),X=_Mathsqrt(G*G+O*O),[V,X,W]},R.lch.lab=function(F){var V=F[0],G=F[1],O=F[2],H,W,X;return X=2*(O/360)*_MathPI2,H=G*_Mathcos2(X),W=G*_Mathsin2(X),[V,H,W]},R.rgb.ansi16=function(F){var V=F[0],G=F[1],O=F[2],H=1 in arguments?arguments[1]:R.rgb.hsv(F)[2];if(H=_Mathround(H/50),0===H)return 30;var W=30+(_Mathround(O/255)<<2|_Mathround(G/255)<<1|_Mathround(V/255));return 2===H&&(W+=60),W},R.hsv.ansi16=function(F){return R.rgb.ansi16(R.hsv.rgb(F),F[2])},R.rgb.ansi256=function(F){var V=F[0],G=F[1],O=F[2];if(V===G&&G===O)return 8>V?16:248<V?231:_Mathround(24*((V-8)/247))+232;var H=16+36*_Mathround(5*(V/255))+6*_Mathround(5*(G/255))+_Mathround(5*(O/255));return H},R.ansi16.rgb=function(F){var V=F%10;if(0==V||7==V)return 50<F&&(V+=3.5),V=255*(V/10.5),[V,V,V];var G=0.5*(~~(50<F)+1),O=255*((1&V)*G),H=255*((1&V>>1)*G),W=255*((1&V>>2)*G);return[O,H,W]},R.ansi256.rgb=function(F){if(232<=F){var V=10*(F-232)+8;return[V,V,V]}F-=16;var G,O=255*(_Mathfloor(F/36)/5),H=255*(_Mathfloor((G=F%36)/6)/5),W=255*(G%6/5);return[O,H,W]},R.rgb.hex=function(F){var V=((255&_Mathround(F[0]))<<16)+((255&_Mathround(F[1]))<<8)+(255&_Mathround(F[2])),G=V.toString(16).toUpperCase();return"000000".substring(G.length)+G},R.hex.rgb=function(F){var V=F.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!V)return[0,0,0];var G=V[0];3===V[0].length&&(G=G.split("").map(function(Y){return Y+Y}).join(""));var O=parseInt(G,16);return[255&O>>16,255&O>>8,255&O]},R.rgb.hcg=function(F){var V=F[0]/255,G=F[1]/255,O=F[2]/255,H=_Mathmax(_Mathmax(V,G),O),W=_Mathmin(_Mathmin(V,G),O),X=H-W,Y,Z;return Y=1>X?W/(1-X):0,Z=0>=X?0:H===V?(G-O)/X%6:H===G?2+(O-V)/X:4+(V-G)/X+4,Z/=6,Z%=1,[360*Z,100*X,100*Y]},R.hsl.hcg=function(F){var V=F[1]/100,G=F[2]/100,O=1,H=0;return O=0.5>G?2*V*G:2*V*(1-G),1>O&&(H=(G-0.5*O)/(1-O)),[F[0],100*O,100*H]},R.hsv.hcg=function(F){var V=F[1]/100,G=F[2]/100,O=V*G,H=0;return 1>O&&(H=(G-O)/(1-O)),[F[0],100*O,100*H]},R.hcg.rgb=function(F){var V=F[0]/360,G=F[1]/100,O=F[2]/100;if(0==G)return[255*O,255*O,255*O];var H=[0,0,0],W=6*(V%1),X=W%1,Y=1-X,Z=0;switch(_Mathfloor(W)){case 0:H[0]=1,H[1]=X,H[2]=0;break;case 1:H[0]=Y,H[1]=1,H[2]=0;break;case 2:H[0]=0,H[1]=1,H[2]=X;break;case 3:H[0]=0,H[1]=Y,H[2]=1;break;case 4:H[0]=X,H[1]=0,H[2]=1;break;default:H[0]=1,H[1]=0,H[2]=Y;}return Z=(1-G)*O,[255*(G*H[0]+Z),255*(G*H[1]+Z),255*(G*H[2]+Z)]},R.hcg.hsv=function(F){var V=F[1]/100,G=F[2]/100,O=V+G*(1-V),H=0;return 0<O&&(H=V/O),[F[0],100*H,100*O]},R.hcg.hsl=function(F){var V=F[1]/100,G=F[2]/100,O=G*(1-V)+0.5*V,H=0;return 0<O&&0.5>O?H=V/(2*O):0.5<=O&&1>O&&(H=V/(2*(1-O))),[F[0],100*H,100*O]},R.hcg.hwb=function(F){var V=F[1]/100,G=F[2]/100,O=V+G*(1-V);return[F[0],100*(O-V),100*(1-O)]},R.hwb.hcg=function(F){var V=F[1]/100,G=F[2]/100,O=1-G,H=O-V,W=0;return 1>H&&(W=(O-H)/(1-H)),[F[0],100*H,100*W]},R.apple.rgb=function(F){return[255*(F[0]/65535),255*(F[1]/65535),255*(F[2]/65535)]},R.rgb.apple=function(F){return[65535*(F[0]/255),65535*(F[1]/255),65535*(F[2]/255)]},R.gray.rgb=function(F){return[255*(F[0]/100),255*(F[0]/100),255*(F[0]/100)]},R.gray.hsl=R.gray.hsv=function(F){return[0,0,F[0]]},R.gray.hwb=function(F){return[0,100,F[0]]},R.gray.cmyk=function(F){return[0,0,0,F[0]]},R.gray.lab=function(F){return[F[0],0,0]},R.gray.hex=function(F){var V=255&_Mathround(255*(F[0]/100)),O=((V<<16)+(V<<8)+V).toString(16).toUpperCase();return"000000".substring(O.length)+O},R.rgb.gray=function(F){var V=(F[0]+F[1]+F[2])/3;return[100*(V/255)]}},{"color-name":6}],4:[function(S,M){function L(I){var U=function(F){return void 0===F||null===F?F:(1<arguments.length&&(F=Array.prototype.slice.call(arguments)),I(F))};return"conversion"in I&&(U.conversion=I.conversion),U}function C(I){var U=function(F){if(void 0===F||null===F)return F;1<arguments.length&&(F=Array.prototype.slice.call(arguments));var V=I(F);if("object"==typeof V)for(var G=V.length,O=0;O<G;O++)V[O]=_Mathround(V[O]);return V};return"conversion"in I&&(U.conversion=I.conversion),U}var A=S("./conversions"),P=S("./route"),R={},D=Object.keys(A);D.forEach(function(I){R[I]={},Object.defineProperty(R[I],"channels",{value:A[I].channels}),Object.defineProperty(R[I],"labels",{value:A[I].labels});var U=P(I),F=Object.keys(U);F.forEach(function(V){var G=U[V];R[I][V]=C(G),R[I][V].raw=L(G)})}),M.exports=R},{"./conversions":3,"./route":5}],5:[function(S,M){function L(){for(var I={},U=D.length,F=0;F<U;F++)I[D[F]]={distance:-1,parent:null};return I}function C(I){var U=L(),F=[I];for(U[I].distance=0;F.length;)for(var V=F.pop(),G=Object.keys(R[V]),O=G.length,H=0;H<O;H++){var W=G[H],X=U[W];-1===X.distance&&(X.distance=U[V].distance+1,X.parent=V,F.unshift(W))}return U}function A(I,U){return function(F){return U(I(F))}}function P(I,U){for(var F=[U[I].parent,I],V=R[U[I].parent][I],G=U[I].parent;U[G].parent;)F.unshift(U[G].parent),V=A(R[U[G].parent][G],V),G=U[G].parent;return V.conversion=F,V}var R=S("./conversions"),D=Object.keys(R);M.exports=function(I){for(var U=C(I),F={},V=Object.keys(U),G=V.length,O=0;O<G;O++){var H=V[O],W=U[H];null!==W.parent&&(F[H]=P(H,U))}return F}},{"./conversions":3}],6:[function(S,M){M.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(S,M,E){(function(L){function D(){try{return E.storage.debug}catch(U){}if("undefined"!=typeof L&&"env"in L)return L.env.DEBUG}E=M.exports=S("./debug"),E.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},E.formatArgs=function(U){var F=this.useColors;if(U[0]=(F?"%c":"")+this.namespace+(F?" %c":" ")+U[0]+(F?"%c ":" ")+"+"+E.humanize(this.diff),!!F){var V="color: "+this.color;U.splice(1,0,V,"color: inherit");var G=0,O=0;U[0].replace(/%[a-zA-Z%]/g,function(H){"%%"===H||(G++,"%c"===H&&(O=G))}),U.splice(O,0,V)}},E.save=function(U){try{null==U?E.storage.removeItem("debug"):E.storage.debug=U}catch(F){}},E.load=D,E.useColors=function(){return"undefined"!=typeof window&&window&&"undefined"!=typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof document&&document&&"WebkitAppearance"in document.documentElement.style||"undefined"!=typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},E.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(U){}}(),E.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],E.formatters.j=function(U){try{return JSON.stringify(U)}catch(F){return"[UnexpectedJSONParseError]: "+F.message}},E.enable(D())}).call(this,S("_process"))},{"./debug":8,_process:20}],8:[function(S,M,E){function L(U){var F=0,V;for(V in U)F=(F<<5)-F+U.charCodeAt(V),F|=0;return E.colors[_Mathabs(F)%E.colors.length]}function C(U){function F(){if(F.enabled){var V=F,G=+new Date,O=G-(I||G);V.diff=O,V.prev=I,V.curr=G,I=G;for(var H=Array(arguments.length),W=0;W<H.length;W++)H[W]=arguments[W];H[0]=E.coerce(H[0]),"string"!=typeof H[0]&&H.unshift("%O");var X=0;H[0]=H[0].replace(/%([a-zA-Z%])/g,function(Z,K){if("%%"===Z)return Z;X++;var Q=E.formatters[K];if("function"==typeof Q){var J=H[X];Z=Q.call(V,J),H.splice(X,1),X--}return Z}),E.formatArgs.call(V,H);var Y=F.log||E.log||console.log.bind(console);Y.apply(V,H)}}return F.namespace=U,F.enabled=E.enabled(U),F.useColors=E.useColors(),F.color=L(U),"function"==typeof E.init&&E.init(F),F}E=M.exports=C.debug=C.default=C,E.coerce=function(U){return U instanceof Error?U.stack||U.message:U},E.disable=function(){E.enable("")},E.enable=function(U){E.save(U);for(var F=(U||"").split(/[\s,]+/),V=F.length,G=0;G<V;G++)F[G]&&(U=F[G].replace(/\*/g,".*?"),"-"===U[0]?E.skips.push(new RegExp("^"+U.substr(1)+"$")):E.names.push(new RegExp("^"+U+"$")))},E.enabled=function(U){var F,V;for(F=0,V=E.skips.length;F<V;F++)if(E.skips[F].test(U))return!1;for(F=0,V=E.names.length;F<V;F++)if(E.names[F].test(U))return!0;return!1},E.humanize=S("ms"),E.names=[],E.skips=[],E.formatters={};var I},{ms:18}],9:[function(S,M){function L(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function C(D){return"function"==typeof D}function A(D){return"number"==typeof D}function P(D){return"object"==typeof D&&null!==D}function R(D){return void 0===D}M.exports=L,L.EventEmitter=L,L.prototype._events=void 0,L.prototype._maxListeners=void 0,L.defaultMaxListeners=10,L.prototype.setMaxListeners=function(D){if(!A(D)||0>D||isNaN(D))throw TypeError("n must be a positive number");return this._maxListeners=D,this},L.prototype.emit=function(D){var I,U,F,V,G,O;if(this._events||(this._events={}),"error"===D&&(!this._events.error||P(this._events.error)&&!this._events.error.length))if(I=arguments[1],I instanceof Error)throw I;else{var H=new Error("Uncaught, unspecified \"error\" event. ("+I+")");throw H.context=I,H}if(U=this._events[D],R(U))return!1;if(C(U))switch(arguments.length){case 1:U.call(this);break;case 2:U.call(this,arguments[1]);break;case 3:U.call(this,arguments[1],arguments[2]);break;default:V=Array.prototype.slice.call(arguments,1),U.apply(this,V);}else if(P(U))for(V=Array.prototype.slice.call(arguments,1),O=U.slice(),F=O.length,G=0;G<F;G++)O[G].apply(this,V);return!0},L.prototype.addListener=function(D,I){var U;if(!C(I))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",D,C(I.listener)?I.listener:I),this._events[D]?P(this._events[D])?this._events[D].push(I):this._events[D]=[this._events[D],I]:this._events[D]=I,P(this._events[D])&&!this._events[D].warned&&(U=R(this._maxListeners)?L.defaultMaxListeners:this._maxListeners,U&&0<U&&this._events[D].length>U&&(this._events[D].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[D].length),"function"==typeof console.trace&&console.trace())),this},L.prototype.on=L.prototype.addListener,L.prototype.once=function(D,I){function U(){this.removeListener(D,U),F||(F=!0,I.apply(this,arguments))}if(!C(I))throw TypeError("listener must be a function");var F=!1;return U.listener=I,this.on(D,U),this},L.prototype.removeListener=function(D,I){var U,F,V,G;if(!C(I))throw TypeError("listener must be a function");if(!this._events||!this._events[D])return this;if(U=this._events[D],V=U.length,F=-1,U===I||C(U.listener)&&U.listener===I)delete this._events[D],this._events.removeListener&&this.emit("removeListener",D,I);else if(P(U)){for(G=V;0<G--;)if(U[G]===I||U[G].listener&&U[G].listener===I){F=G;break}if(0>F)return this;1===U.length?(U.length=0,delete this._events[D]):U.splice(F,1),this._events.removeListener&&this.emit("removeListener",D,I)}return this},L.prototype.removeAllListeners=function(D){var I,U;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[D]&&delete this._events[D],this;if(0===arguments.length){for(I in this._events)"removeListener"!==I&&this.removeAllListeners(I);return this.removeAllListeners("removeListener"),this._events={},this}if(U=this._events[D],C(U))this.removeListener(D,U);else if(U)for(;U.length;)this.removeListener(D,U[U.length-1]);return delete this._events[D],this},L.prototype.listeners=function(D){var I;return I=this._events&&this._events[D]?C(this._events[D])?[this._events[D]]:this._events[D].slice():[],I},L.prototype.listenerCount=function(D){if(this._events){var I=this._events[D];if(C(I))return 1;if(I)return I.length}return 0},L.listenerCount=function(D,I){return D.listenerCount(I)}},{}],10:[function(S,M){"use strict";function L(A,P,R){var D,I;return C(Array.isArray(P),"Get closest expects an array as second argument"),P.forEach(function(U,F){var V=R(U,A);0<=V&&("undefined"==typeof I||V<I)&&(I=V,D=F)}),D}var C=S("assert");M.exports={number:function(P,R){return L(P,R,function(D,I){return _Mathabs(D-I)})},greaterNumber:function(P,R){return L(P,R,function(D,I){return D-I})},lowerNumber:function(P,R){return L(P,R,function(D,I){return I-D})},custom:function(P,R,D){return L(P,R,D)}}},{assert:1}],11:[function(S,M){M.exports="function"==typeof Object.create?function(C,A){C.super_=A,C.prototype=Object.create(A.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}})}:function(C,A){C.super_=A;var P=function(){};P.prototype=A.prototype,C.prototype=new P,C.prototype.constructor=C}},{}],12:[function(S,M){(function(L,C){"object"==typeof M&&"object"==typeof M.exports?M.exports=L.document?C(L,!0):function(A){if(!A.document)throw new Error("jQuery requires a window with a document");return C(A)}:C(L)})("undefined"==typeof window?this:window,function(L,C){function A(Br){var Nr=!!Br&&"length"in Br&&Br.length,Ur=qe.type(Br);return"function"===Ur||qe.isWindow(Br)?!1:"array"===Ur||0===Nr||"number"==typeof Nr&&0<Nr&&Nr-1 in Br}function P(Br,Nr,Ur){if(qe.isFunction(Nr))return qe.grep(Br,function(Fr,Vr){return!!Nr.call(Fr,Vr,Fr)!==Ur});if(Nr.nodeType)return qe.grep(Br,function(Fr){return Fr===Nr!==Ur});if("string"==typeof Nr){if(rt.test(Nr))return qe.filter(Nr,Br,Ur);Nr=qe.filter(Nr,Br)}return qe.grep(Br,function(Fr){return-1<ke.call(Nr,Fr)!==Ur})}function R(Br,Nr){for(;(Br=Br[Nr])&&1!==Br.nodeType;);return Br}function D(Br){var Nr={};return qe.each(Br.match(lt)||[],function(Ur,Fr){Nr[Fr]=!0}),Nr}function I(){Ue.removeEventListener("DOMContentLoaded",I),L.removeEventListener("load",I),qe.ready()}function U(){this.expando=qe.expando+U.uid++}function F(Br,Nr,Ur){var Fr;if(void 0===Ur&&1===Br.nodeType)if(Fr="data-"+Nr.replace(xt,"-$&").toLowerCase(),Ur=Br.getAttribute(Fr),"string"==typeof Ur){try{Ur="true"===Ur||"false"!==Ur&&("null"===Ur?null:+Ur+""===Ur?+Ur:yt.test(Ur)?qe.parseJSON(Ur):Ur)}catch(Vr){}ht.set(Br,Nr,Ur)}else Ur=void 0;return Ur}function V(Br,Nr,Ur,Fr){var Gr=1,kr=20,zr=Fr?function(){return Fr.cur()}:function(){return qe.css(Br,Nr,"")},Or=zr(),Hr=Ur&&Ur[3]||(qe.cssNumber[Nr]?"":"px"),jr=(qe.cssNumber[Nr]||"px"!==Hr&&+Or)&&bt.exec(qe.css(Br,Nr)),Vr;if(jr&&jr[3]!==Hr){Hr=Hr||jr[3],Ur=Ur||[],jr=+Or||1;do Gr=Gr||".5",jr/=Gr,qe.style(Br,Nr,jr+Hr);while(Gr!=(Gr=zr()/Or)&&1!=Gr&&--kr)}return Ur&&(jr=+jr||+Or||0,Vr=Ur[1]?jr+(Ur[1]+1)*Ur[2]:+Ur[2],Fr&&(Fr.unit=Hr,Fr.start=jr,Fr.end=Vr)),Vr}function G(Br,Nr){var Ur="undefined"==typeof Br.getElementsByTagName?"undefined"==typeof Br.querySelectorAll?[]:Br.querySelectorAll(Nr||"*"):Br.getElementsByTagName(Nr||"*");return void 0===Nr||Nr&&qe.nodeName(Br,Nr)?qe.merge([Br],Ur):Ur}function O(Br,Nr){for(var Ur=0,Fr=Br.length;Ur<Fr;Ur++)ft.set(Br[Ur],"globalEval",!Nr||ft.get(Nr[Ur],"globalEval"))}function H(Br,Nr,Ur,Fr,Vr){for(var Wr=Nr.createDocumentFragment(),qr=[],Xr=0,Yr=Br.length,Gr,kr,zr,Or,Hr,jr;Xr<Yr;Xr++)if(Gr=Br[Xr],Gr||0===Gr)if("object"===qe.type(Gr))qe.merge(qr,Gr.nodeType?[Gr]:Gr);else if(!wt.test(Gr))qr.push(Nr.createTextNode(Gr));else{for(kr=kr||Wr.appendChild(Nr.createElement("div")),zr=(Tt.exec(Gr)||["",""])[1].toLowerCase(),Or=Lt[zr]||Lt._default,kr.innerHTML=Or[1]+qe.htmlPrefilter(Gr)+Or[2],jr=Or[0];jr--;)kr=kr.lastChild;qe.merge(qr,kr.childNodes),kr=Wr.firstChild,kr.textContent=""}for(Wr.textContent="",Xr=0;Gr=qr[Xr++];){if(Fr&&-1<qe.inArray(Gr,Fr)){Vr&&Vr.push(Gr);continue}if(Hr=qe.contains(Gr.ownerDocument,Gr),kr=G(Wr.appendChild(Gr),"script"),Hr&&O(kr),Ur)for(jr=0;Gr=kr[jr++];)Et.test(Gr.type||"")&&Ur.push(Gr)}return Wr}function W(){return!0}function X(){return!1}function Y(){try{return Ue.activeElement}catch(Br){}}function Z(Br,Nr,Ur,Fr,Vr,Gr){var kr,zr;if("object"==typeof Nr){for(zr in"string"!=typeof Ur&&(Fr=Fr||Ur,Ur=void 0),Nr)Z(Br,zr,Ur,Fr,Nr[zr],Gr);return Br}if(null==Fr&&null==Vr?(Vr=Ur,Fr=Ur=void 0):null==Vr&&("string"==typeof Ur?(Vr=Fr,Fr=void 0):(Vr=Fr,Fr=Ur,Ur=void 0)),!1===Vr)Vr=X;else if(!Vr)return Br;return 1===Gr&&(kr=Vr,Vr=function(Or){return qe().off(Or),kr.apply(this,arguments)},Vr.guid=kr.guid||(kr.guid=qe.guid++)),Br.each(function(){qe.event.add(this,Nr,Vr,Fr,Ur)})}function K(Br,Nr){return qe.nodeName(Br,"table")&&qe.nodeName(11===Nr.nodeType?Nr.firstChild:Nr,"tr")?Br.getElementsByTagName("tbody")[0]||Br.appendChild(Br.ownerDocument.createElement("tbody")):Br}function Q(Br){return Br.type=(null!==Br.getAttribute("type"))+"/"+Br.type,Br}function J(Br){var Nr=Bt.exec(Br.type);return Nr?Br.type=Nr[1]:Br.removeAttribute("type"),Br}function ee(Br,Nr){var Ur,Fr,Vr,Gr,kr,zr,Or,Hr;if(1===Nr.nodeType){if(ft.hasData(Br)&&(Gr=ft.access(Br),kr=ft.set(Nr,Gr),Hr=Gr.events,Hr))for(Vr in delete kr.handle,kr.events={},Hr)for(Ur=0,Fr=Hr[Vr].length;Ur<Fr;Ur++)qe.event.add(Nr,Vr,Hr[Vr][Ur]);ht.hasData(Br)&&(zr=ht.access(Br),Or=qe.extend({},zr),ht.set(Nr,Or))}}function oe(Br,Nr){var Ur=Nr.nodeName.toLowerCase();"input"===Ur&&Mt.test(Br.type)?Nr.checked=Br.checked:("input"===Ur||"textarea"===Ur)&&(Nr.defaultValue=Br.defaultValue)}function ne(Br,Nr,Ur,Fr){Nr=Ve.apply([],Nr);var jr=0,Wr=Br.length,Xr=Nr[0],Yr=qe.isFunction(Xr),Vr,Gr,kr,zr,Or,Hr;if(Yr||1<Wr&&"string"==typeof Xr&&!je.checkClone&&It.test(Xr))return Br.each(function(Zr){var Kr=Br.eq(Zr);Yr&&(Nr[0]=Xr.call(this,Zr,Kr.html())),ne(Kr,Nr,Ur,Fr)});if(Wr&&(Vr=H(Nr,Br[0].ownerDocument,!1,Br,Fr),Gr=Vr.firstChild,1===Vr.childNodes.length&&(Vr=Gr),Gr||Fr)){for(kr=qe.map(G(Vr,"script"),Q),zr=kr.length;jr<Wr;jr++)Or=Vr,jr!=Wr-1&&(Or=qe.clone(Or,!0,!0),zr&&qe.merge(kr,G(Or,"script"))),Ur.call(Br[jr],Or,jr);if(zr)for(Hr=kr[kr.length-1].ownerDocument,qe.map(kr,J),jr=0;jr<zr;jr++)Or=kr[jr],Et.test(Or.type||"")&&!ft.access(Or,"globalEval")&&qe.contains(Hr,Or)&&(Or.src?qe._evalUrl&&qe._evalUrl(Or.src):qe.globalEval(Or.textContent.replace(Nt,"")))}return Br}function ie(Br,Nr,Ur){for(var Vr=Nr?qe.filter(Nr,Br):Br,Gr=0,Fr;null!=(Fr=Vr[Gr]);Gr++)Ur||1!==Fr.nodeType||qe.cleanData(G(Fr)),Fr.parentNode&&(Ur&&qe.contains(Fr.ownerDocument,Fr)&&O(G(Fr,"script")),Fr.parentNode.removeChild(Fr));return Br}function se(Br,Nr){var Ur=qe(Nr.createElement(Br)).appendTo(Nr.body),Fr=qe.css(Ur[0],"display");return Ur.detach(),Fr}function le(Br){var Nr=Ue,Ur=Ft[Br];return Ur||(Ur=se(Br,Nr),("none"===Ur||!Ur)&&(Ut=(Ut||qe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(Nr.documentElement),Nr=Ut[0].contentDocument,Nr.write(),Nr.close(),Ur=se(Br,Nr),Ut.detach()),Ft[Br]=Ur),Ur}function pe(Br,Nr,Ur){var zr=Br.style,Fr,Vr,Gr,kr;return Ur=Ur||kt(Br),kr=Ur?Ur.getPropertyValue(Nr)||Ur[Nr]:void 0,""!==kr&&void 0!==kr||qe.contains(Br.ownerDocument,Br)||(kr=qe.style(Br,Nr)),Ur&&!je.pixelMarginRight()&&Gt.test(kr)&&Vt.test(Nr)&&(Fr=zr.width,Vr=zr.minWidth,Gr=zr.maxWidth,zr.minWidth=zr.maxWidth=zr.width=kr,kr=Ur.width,zr.width=Fr,zr.minWidth=Vr,zr.maxWidth=Gr),void 0===kr?kr:kr+""}function ue(Br,Nr){return{get:function(){return Br()?void delete this.get:(this.get=Nr).apply(this,arguments)}}}function ge(Br){if(Br in Xt)return Br;for(var Nr=Br[0].toUpperCase()+Br.slice(1),Ur=qt.length;Ur--;)if(Br=qt[Ur]+Nr,Br in Xt)return Br}function fe(Br,Nr,Ur){var Fr=bt.exec(Nr);return Fr?_Mathmax(0,Fr[2]-(Ur||0))+(Fr[3]||"px"):Nr}function he(Br,Nr,Ur,Fr,Vr){for(var Gr=Ur===(Fr?"border":"content")?4:"width"===Nr?1:0,kr=0;4>Gr;Gr+=2)"margin"===Ur&&(kr+=qe.css(Br,Ur+_t[Gr],!0,Vr)),Fr?("content"===Ur&&(kr-=qe.css(Br,"padding"+_t[Gr],!0,Vr)),"margin"!==Ur&&(kr-=qe.css(Br,"border"+_t[Gr]+"Width",!0,Vr))):(kr+=qe.css(Br,"padding"+_t[Gr],!0,Vr),"padding"!==Ur&&(kr+=qe.css(Br,"border"+_t[Gr]+"Width",!0,Vr)));return kr}function ye(Br,Nr,Ur){var Fr=!0,Vr="width"===Nr?Br.offsetWidth:Br.offsetHeight,Gr=kt(Br),kr="border-box"===qe.css(Br,"boxSizing",!1,Gr);if(0>=Vr||null==Vr){if(Vr=pe(Br,Nr,Gr),(0>Vr||null==Vr)&&(Vr=Br.style[Nr]),Gt.test(Vr))return Vr;Fr=kr&&(je.boxSizingReliable()||Vr===Br.style[Nr]),Vr=parseFloat(Vr)||0}return Vr+he(Br,Nr,Ur||(kr?"border":"content"),Fr,Gr)+"px"}function xe(Br,Nr){for(var Gr=[],kr=0,zr=Br.length,Ur,Fr,Vr;kr<zr;kr++)(Fr=Br[kr],!!Fr.style)&&(Gr[kr]=ft.get(Fr,"olddisplay"),Ur=Fr.style.display,Nr?(!Gr[kr]&&"none"===Ur&&(Fr.style.display=""),""===Fr.style.display&&St(Fr)&&(Gr[kr]=ft.access(Fr,"olddisplay",le(Fr.nodeName)))):(Vr=St(Fr),("none"!==Ur||!Vr)&&ft.set(Fr,"olddisplay",Vr?Ur:qe.css(Fr,"display"))));for(kr=0;kr<zr;kr++)(Fr=Br[kr],!!Fr.style)&&(Nr&&"none"!==Fr.style.display&&""!==Fr.style.display||(Fr.style.display=Nr?Gr[kr]||"":"none"));return Br}function ve(Br,Nr,Ur,Fr,Vr){return new ve.prototype.init(Br,Nr,Ur,Fr,Vr)}function _e(){return L.setTimeout(function(){Yt=void 0}),Yt=qe.now()}function Se(Br,Nr){var Fr=0,Vr={height:Br},Ur;for(Nr=Nr?1:0;4>Fr;Fr+=2-Nr)Ur=_t[Fr],Vr["margin"+Ur]=Vr["padding"+Ur]=Br;return Nr&&(Vr.opacity=Vr.width=Br),Vr}function Me(Br,Nr,Ur){for(var Vr=(Le.tweeners[Nr]||[]).concat(Le.tweeners["*"]),Gr=0,kr=Vr.length,Fr;Gr<kr;Gr++)if(Fr=Vr[Gr].call(Ur,Nr,Br))return Fr}function Ee(Br,Nr){var Ur,Fr,Vr,Gr,kr;for(Ur in Br)if(Fr=qe.camelCase(Ur),Vr=Nr[Fr],Gr=Br[Ur],qe.isArray(Gr)&&(Vr=Gr[1],Gr=Br[Ur]=Gr[0]),Ur!==Fr&&(Br[Fr]=Gr,delete Br[Ur]),kr=qe.cssHooks[Fr],kr&&"expand"in kr)for(Ur in Gr=kr.expand(Gr),delete Br[Fr],Gr)Ur in Br||(Br[Ur]=Gr[Ur],Nr[Ur]=Vr);else Nr[Fr]=Vr}function Le(Br,Nr,Ur){var Gr=0,kr=Le.prefilters.length,zr=qe.Deferred().always(function(){delete Or.elem}),Or=function(){if(Vr)return!1;for(var Wr=Yt||_e(),qr=_Mathmax(0,Hr.startTime+Hr.duration-Wr),Xr=qr/Hr.duration||0,Yr=1-Xr,Zr=0,Kr=Hr.tweens.length;Zr<Kr;Zr++)Hr.tweens[Zr].run(Yr);return zr.notifyWith(Br,[Hr,Yr,qr]),1>Yr&&Kr?qr:(zr.resolveWith(Br,[Hr]),!1)},Hr=zr.promise({elem:Br,props:qe.extend({},Nr),opts:qe.extend(!0,{specialEasing:{},easing:qe.easing._default},Ur),originalProperties:Nr,originalOptions:Ur,startTime:Yt||_e(),duration:Ur.duration,tweens:[],createTween:function(Wr,qr){var Xr=qe.Tween(Br,Hr.opts,Wr,qr,Hr.opts.specialEasing[Wr]||Hr.opts.easing);return Hr.tweens.push(Xr),Xr},stop:function(Wr){var qr=0,Xr=Wr?Hr.tweens.length:0;if(Vr)return this;for(Vr=!0;qr<Xr;qr++)Hr.tweens[qr].run(1);return Wr?(zr.notifyWith(Br,[Hr,1,0]),zr.resolveWith(Br,[Hr,Wr])):zr.rejectWith(Br,[Hr,Wr]),this}}),jr=Hr.props,Fr,Vr;for(Ee(jr,Hr.opts.specialEasing);Gr<kr;Gr++)if(Fr=Le.prefilters[Gr].call(Hr,Br,jr,Hr.opts),Fr)return qe.isFunction(Fr.stop)&&(qe._queueHooks(Hr.elem,Hr.opts.queue).stop=qe.proxy(Fr.stop,Fr)),Fr;return qe.map(jr,Me,Hr),qe.isFunction(Hr.opts.start)&&Hr.opts.start.call(Br,Hr),qe.fx.timer(qe.extend(Or,{elem:Br,anim:Hr,queue:Hr.opts.queue})),Hr.progress(Hr.opts.progress).done(Hr.opts.done,Hr.opts.complete).fail(Hr.opts.fail).always(Hr.opts.always)}function we(Br){return Br.getAttribute&&Br.getAttribute("class")||""}function Ce(Br){return function(Nr,Ur){"string"!=typeof Nr&&(Ur=Nr,Nr="*");var Vr=0,Gr=Nr.toLowerCase().match(lt)||[],Fr;if(qe.isFunction(Ur))for(;Fr=Gr[Vr++];)"+"===Fr[0]?(Fr=Fr.slice(1)||"*",(Br[Fr]=Br[Fr]||[]).unshift(Ur)):(Br[Fr]=Br[Fr]||[]).push(Ur)}}function Ae(Br,Nr,Ur,Fr){function Vr(zr){var Or;return Gr[zr]=!0,qe.each(Br[zr]||[],function(Hr,jr){var Wr=jr(Nr,Ur,Fr);return"string"!=typeof Wr||kr||Gr[Wr]?kr?!(Or=Wr):void 0:(Nr.dataTypes.unshift(Wr),Vr(Wr),!1)}),Or}var Gr={},kr=Br===vr;return Vr(Nr.dataTypes[0])||!Gr["*"]&&Vr("*")}function Pe(Br,Nr){var Vr=qe.ajaxSettings.flatOptions||{},Ur,Fr;for(Ur in Nr)void 0!==Nr[Ur]&&((Vr[Ur]?Br:Fr||(Fr={}))[Ur]=Nr[Ur]);return Fr&&qe.extend(!0,Br,Fr),Br}function Re(Br,Nr,Ur){for(var zr=Br.contents,Or=Br.dataTypes,Fr,Vr,Gr,kr;"*"===Or[0];)Or.shift(),void 0==Fr&&(Fr=Br.mimeType||Nr.getResponseHeader("Content-Type"));if(Fr)for(Vr in zr)if(zr[Vr]&&zr[Vr].test(Fr)){Or.unshift(Vr);break}if(Or[0]in Ur)Gr=Or[0];else{for(Vr in Ur){if(!Or[0]||Br.converters[Vr+" "+Or[0]]){Gr=Vr;break}kr||(kr=Vr)}Gr=Gr||kr}return Gr?(Gr!==Or[0]&&Or.unshift(Gr),Ur[Gr]):void 0}function De(Br,Nr,Ur,Fr){var Hr={},jr=Br.dataTypes.slice(),Vr,Gr,kr,zr,Or;if(jr[1])for(kr in Br.converters)Hr[kr.toLowerCase()]=Br.converters[kr];for(Gr=jr.shift();Gr;)if(Br.responseFields[Gr]&&(Ur[Br.responseFields[Gr]]=Nr),!Or&&Fr&&Br.dataFilter&&(Nr=Br.dataFilter(Nr,Br.dataType)),Or=Gr,Gr=jr.shift(),Gr)if("*"===Gr)Gr=Or;else if("*"!==Or&&Or!==Gr){if(kr=Hr[Or+" "+Gr]||Hr["* "+Gr],!kr)for(Vr in Hr)if(zr=Vr.split(" "),zr[1]===Gr&&(kr=Hr[Or+" "+zr[0]]||Hr["* "+zr[0]],kr)){!0===kr?kr=Hr[Vr]:!0!==Hr[Vr]&&(Gr=zr[0],jr.unshift(zr[1]));break}if(!0!==kr)if(kr&&Br.throws)Nr=kr(Nr);else try{Nr=kr(Nr)}catch(Wr){return{state:"parsererror",error:kr?Wr:"No conversion from "+Or+" to "+Gr}}}return{state:"success",data:Nr}}function Ie(Br,Nr,Ur,Fr){if(qe.isArray(Nr))qe.each(Nr,function(Gr,kr){Ur||Mr.test(Br)?Fr(Br,kr):Ie(Br+"["+("object"==typeof kr&&null!=kr?Gr:"")+"]",kr,Ur,Fr)});else if(!Ur&&"object"===qe.type(Nr))for(var Vr in Nr)Ie(Br+"["+Vr+"]",Nr[Vr],Ur,Fr);else Fr(Br,Nr)}function Be(Br){return qe.isWindow(Br)?Br:9===Br.nodeType&&Br.defaultView}var Ne=[],Ue=L.document,Fe=Ne.slice,Ve=Ne.concat,Ge=Ne.push,ke=Ne.indexOf,ze={},Oe=ze.toString,He=ze.hasOwnProperty,je={},We="2.2.4",qe=function(Br,Nr){return new qe.fn.init(Br,Nr)},Xe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Ye=/^-ms-/,Ze=/-([\da-z])/gi,Ke=function(Br,Nr){return Nr.toUpperCase()};qe.fn=qe.prototype={jquery:We,constructor:qe,selector:"",length:0,toArray:function(){return Fe.call(this)},get:function(Br){return null==Br?Fe.call(this):0>Br?this[Br+this.length]:this[Br]},pushStack:function(Br){var Nr=qe.merge(this.constructor(),Br);return Nr.prevObject=this,Nr.context=this.context,Nr},each:function(Br){return qe.each(this,Br)},map:function(Br){return this.pushStack(qe.map(this,function(Nr,Ur){return Br.call(Nr,Ur,Nr)}))},slice:function(){return this.pushStack(Fe.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(Br){var Nr=this.length,Ur=+Br+(0>Br?Nr:0);return this.pushStack(0<=Ur&&Ur<Nr?[this[Ur]]:[])},end:function(){return this.prevObject||this.constructor()},push:Ge,sort:Ne.sort,splice:Ne.splice},qe.extend=qe.fn.extend=function(){var kr=arguments[0]||{},zr=1,Or=arguments.length,Hr=!1,Br,Nr,Ur,Fr,Vr,Gr;for("boolean"==typeof kr&&(Hr=kr,kr=arguments[zr]||{},zr++),"object"==typeof kr||qe.isFunction(kr)||(kr={}),zr===Or&&(kr=this,zr--);zr<Or;zr++)if(null!=(Br=arguments[zr]))for(Nr in Br)(Ur=kr[Nr],Fr=Br[Nr],kr!==Fr)&&(Hr&&Fr&&(qe.isPlainObject(Fr)||(Vr=qe.isArray(Fr)))?(Vr?(Vr=!1,Gr=Ur&&qe.isArray(Ur)?Ur:[]):Gr=Ur&&qe.isPlainObject(Ur)?Ur:{},kr[Nr]=qe.extend(Hr,Gr,Fr)):void 0!==Fr&&(kr[Nr]=Fr));return kr},qe.extend({expando:"jQuery"+(We+Math.random()).replace(/\D/g,""),isReady:!0,error:function(Br){throw new Error(Br)},noop:function(){},isFunction:function(Br){return"function"===qe.type(Br)},isArray:Array.isArray,isWindow:function(Br){return null!=Br&&Br===Br.window},isNumeric:function(Br){var Nr=Br&&Br.toString();return!qe.isArray(Br)&&0<=Nr-parseFloat(Nr)+1},isPlainObject:function(Br){if("object"!==qe.type(Br)||Br.nodeType||qe.isWindow(Br))return!1;if(Br.constructor&&!He.call(Br,"constructor")&&!He.call(Br.constructor.prototype||{},"isPrototypeOf"))return!1;for(var Nr in Br);return void 0==Nr||He.call(Br,Nr)},isEmptyObject:function(Br){for(var Nr in Br)return!1;return!0},type:function(Br){return null==Br?Br+"":"object"==typeof Br||"function"==typeof Br?ze[Oe.call(Br)]||"object":typeof Br},globalEval:function(Br){var Ur=eval,Nr;Br=qe.trim(Br),Br&&(1===Br.indexOf("use strict")?(Nr=Ue.createElement("script"),Nr.text=Br,Ue.head.appendChild(Nr).parentNode.removeChild(Nr)):Ur(Br))},camelCase:function(Br){return Br.replace(Ye,"ms-").replace(Ze,Ke)},nodeName:function(Br,Nr){return Br.nodeName&&Br.nodeName.toLowerCase()===Nr.toLowerCase()},each:function(Br,Nr){var Fr=0,Ur;if(A(Br))for(Ur=Br.length;Fr<Ur&&!1!==Nr.call(Br[Fr],Fr,Br[Fr]);Fr++);else for(Fr in Br)if(!1===Nr.call(Br[Fr],Fr,Br[Fr]))break;return Br},trim:function(Br){return null==Br?"":(Br+"").replace(Xe,"")},makeArray:function(Br,Nr){var Ur=Nr||[];return null!=Br&&(A(Object(Br))?qe.merge(Ur,"string"==typeof Br?[Br]:Br):Ge.call(Ur,Br)),Ur},inArray:function(Br,Nr,Ur){return null==Nr?-1:ke.call(Nr,Br,Ur)},merge:function(Br,Nr){for(var Ur=+Nr.length,Fr=0,Vr=Br.length;Fr<Ur;Fr++)Br[Vr++]=Nr[Fr];return Br.length=Vr,Br},grep:function(Br,Nr,Ur){for(var Vr=[],Gr=0,kr=Br.length,Fr;Gr<kr;Gr++)Fr=!Nr(Br[Gr],Gr),Fr!==!Ur&&Vr.push(Br[Gr]);return Vr},map:function(Br,Nr,Ur){var Gr=0,kr=[],Fr,Vr;if(A(Br))for(Fr=Br.length;Gr<Fr;Gr++)Vr=Nr(Br[Gr],Gr,Ur),null!=Vr&&kr.push(Vr);else for(Gr in Br)Vr=Nr(Br[Gr],Gr,Ur),null!=Vr&&kr.push(Vr);return Ve.apply([],kr)},guid:1,proxy:function(Br,Nr){var Ur,Fr,Vr;if("string"==typeof Nr&&(Ur=Br[Nr],Nr=Br,Br=Ur),!!qe.isFunction(Br))return Fr=Fe.call(arguments,2),Vr=function(){return Br.apply(Nr||this,Fr.concat(Fe.call(arguments)))},Vr.guid=Br.guid=Br.guid||qe.guid++,Vr},now:Date.now,support:je}),"function"==typeof Symbol&&(qe.fn[Symbol.iterator]=Ne[Symbol.iterator]),qe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(Br,Nr){ze["[object "+Nr+"]"]=Nr.toLowerCase()});var Qe=function(Br){function Nr(so,lo,po,co){var _o=lo&&lo.ownerDocument,So=lo?lo.nodeType:9,uo,mo,go,fo,yo,xo,vo,bo;if(po=po||[],"string"!=typeof so||!so||1!==So&&9!==So&&11!==So)return po;if(!co&&((lo?lo.ownerDocument||lo:_a)!==ma&&ua(lo),lo=lo||ma,fa)){if(11!==So&&(xo=eo.exec(so)))if(!(uo=xo[1])){if(xo[2])return Ia.apply(po,lo.getElementsByTagName(so)),po;if((uo=xo[3])&&ta.getElementsByClassName&&lo.getElementsByClassName)return Ia.apply(po,lo.getElementsByClassName(uo)),po}else if(9===So){if(!(go=lo.getElementById(uo)))return po;if(go.id===uo)return po.push(go),po}else if(_o&&(go=_o.getElementById(uo))&&va(lo,go)&&go.id===uo)return po.push(go),po;if(ta.qsa&&!La[so+" "]&&(!ha||!ha.test(so))){if(1!==So)_o=lo,bo=so;else if("object"!==lo.nodeName.toLowerCase()){for((fo=lo.getAttribute("id"))?fo=fo.replace(ao,"\\$&"):lo.setAttribute("id",fo=ba),vo=na(so),mo=vo.length,yo=Za.test(fo)?"#"+fo:"[id='"+fo+"']";mo--;)vo[mo]=yo+" "+qr(vo[mo]);bo=vo.join(","),_o=ro.test(so)&&jr(lo.parentNode)||lo}if(bo)try{return Ia.apply(po,_o.querySelectorAll(bo)),po}catch(Mo){}finally{fo===ba&&lo.removeAttribute("id")}}}return sa(so.replace(Ha,"$1"),lo,po,co)}function Ur(){function so(po,co){return lo.push(po+" ")>ra.cacheLength&&delete so[lo.shift()],so[po+" "]=co}var lo=[];return so}function Fr(so){return so[ba]=!0,so}function Vr(so){var lo=ma.createElement("div");try{return!!so(lo)}catch(po){return!1}finally{lo.parentNode&&lo.parentNode.removeChild(lo),lo=null}}function Gr(so,lo){for(var po=so.split("|"),co=po.length;co--;)ra.attrHandle[po[co]]=lo}function kr(so,lo){var po=lo&&so,co=po&&1===so.nodeType&&1===lo.nodeType&&(~lo.sourceIndex||Ca)-(~so.sourceIndex||Ca);if(co)return co;if(po)for(;po=po.nextSibling;)if(po===lo)return-1;return so?1:-1}function zr(so){return function(lo){var po=lo.nodeName.toLowerCase();return"input"===po&&lo.type===so}}function Or(so){return function(lo){var po=lo.nodeName.toLowerCase();return("input"===po||"button"===po)&&lo.type===so}}function Hr(so){return Fr(function(lo){return lo=+lo,Fr(function(po,co){for(var mo=so([],po.length,lo),go=mo.length,uo;go--;)po[uo=mo[go]]&&(po[uo]=!(co[uo]=po[uo]))})})}function jr(so){return so&&"undefined"!=typeof so.getElementsByTagName&&so}function Wr(){}function qr(so){for(var lo=0,po=so.length,co="";lo<po;lo++)co+=so[lo].value;return co}function Xr(so,lo,po){var co=lo.dir,uo=po&&"parentNode"===co,mo=Ma++;return lo.first?function(go,fo,yo){for(;go=go[co];)if(1===go.nodeType||uo)return so(go,fo,yo)}:function(go,fo,yo){var _o=[Sa,mo],xo,vo,bo;if(yo){for(;go=go[co];)if((1===go.nodeType||uo)&&so(go,fo,yo))return!0;}else for(;go=go[co];)if(1===go.nodeType||uo){if(bo=go[ba]||(go[ba]={}),vo=bo[go.uniqueID]||(bo[go.uniqueID]={}),(xo=vo[co])&&xo[0]===Sa&&xo[1]===mo)return _o[2]=xo[2];if(vo[co]=_o,_o[2]=so(go,fo,yo))return!0}}}function Yr(so){return 1<so.length?function(lo,po,co){for(var uo=so.length;uo--;)if(!so[uo](lo,po,co))return!1;return!0}:so[0]}function Zr(so,lo,po){for(var co=0,uo=lo.length;co<uo;co++)Nr(so,lo[co],po);return po}function Kr(so,lo,po,co,uo){for(var go=[],fo=0,yo=so.length,mo;fo<yo;fo++)(mo=so[fo])&&(!po||po(mo,co,uo))&&(go.push(mo),null!=lo&&lo.push(fo));return go}function Qr(so,lo,po,co,uo,mo){return co&&!co[ba]&&(co=Qr(co)),uo&&!uo[ba]&&(uo=Qr(uo,mo)),Fr(function(go,fo,yo,xo){var So=[],Mo=[],To=fo.length,Eo=go||Zr(lo||"*",yo.nodeType?[yo]:yo,[]),Lo=so&&(go||!lo)?Kr(Eo,So,so,yo,xo):Eo,wo=po?uo||(go?so:To||co)?[]:fo:Lo,vo,bo,_o;if(po&&po(Lo,wo,yo,xo),co)for(vo=Kr(wo,Mo),co(vo,[],yo,xo),bo=vo.length;bo--;)(_o=vo[bo])&&(wo[Mo[bo]]=!(Lo[Mo[bo]]=_o));if(!go)wo=Kr(wo===fo?wo.splice(To,wo.length):wo),uo?uo(null,fo,wo,xo):Ia.apply(fo,wo);else if(uo||so){if(uo){for(vo=[],bo=wo.length;bo--;)(_o=wo[bo])&&vo.push(Lo[bo]=_o);uo(null,wo=[],vo,xo)}for(bo=wo.length;bo--;)(_o=wo[bo])&&-1<(vo=uo?Na(go,_o):So[bo])&&(go[vo]=!(fo[vo]=_o))}})}function Jr(so){for(var uo=so.length,mo=ra.relative[so[0].type],go=mo||ra.relative[" "],fo=mo?1:0,yo=Xr(function(bo){return bo===lo},go,!0),xo=Xr(function(bo){return-1<Na(lo,bo)},go,!0),vo=[function(bo,_o,So){var Mo=!mo&&(So||_o!==la)||((lo=_o).nodeType?yo(bo,_o,So):xo(bo,_o,So));return lo=null,Mo}],lo,po,co;fo<uo;fo++)if(po=ra.relative[so[fo].type])vo=[Xr(Yr(vo),po)];else{if(po=ra.filter[so[fo].type].apply(null,so[fo].matches),po[ba]){for(co=++fo;co<uo&&!ra.relative[so[co].type];co++);return Qr(1<fo&&Yr(vo),1<fo&&qr(so.slice(0,fo-1).concat({value:" "===so[fo-2].type?"*":""})).replace(Ha,"$1"),po,fo<co&&Jr(so.slice(fo,co)),co<uo&&Jr(so=so.slice(co)),co<uo&&qr(so))}vo.push(po)}return Yr(vo)}function $r(so,lo){var po=0<lo.length,co=0<so.length,uo=function(mo,go,fo,yo,xo){var So=0,Mo="0",To=mo&&[],Eo=[],Lo=la,wo=mo||co&&ra.find.TAG("*",xo),Co=Sa+=null==Lo?1:Math.random()||0.1,Ao=wo.length,vo,bo,_o;for(xo&&(la=go===ma||go||xo);Mo!==Ao&&null!=(vo=wo[Mo]);Mo++){if(co&&vo){for(bo=0,go||vo.ownerDocument===ma||(ua(vo),fo=!fa);_o=so[bo++];)if(_o(vo,go||ma,fo)){yo.push(vo);break}xo&&(Sa=Co)}po&&((vo=!_o&&vo)&&So--,mo&&To.push(vo))}if(So+=Mo,po&&Mo!==So){for(bo=0;_o=lo[bo++];)_o(To,Eo,go,fo);if(mo){if(0<So)for(;Mo--;)To[Mo]||Eo[Mo]||(Eo[Mo]=Ra.call(yo));Eo=Kr(Eo)}Ia.apply(yo,Eo),xo&&!mo&&0<Eo.length&&1<So+lo.length&&Nr.uniqueSort(yo)}return xo&&(Sa=Co,la=Lo),To};return po?Fr(uo):uo}var ba="sizzle"+1*new Date,_a=Br.document,Sa=0,Ma=0,Ta=Ur(),Ea=Ur(),La=Ur(),wa=function(so,lo){return so===lo&&(ca=!0),0},Ca=-2147483648,Aa={}.hasOwnProperty,Pa=[],Ra=Pa.pop,Da=Pa.push,Ia=Pa.push,Ba=Pa.slice,Na=function(so,lo){for(var po=0,co=so.length;po<co;po++)if(so[po]===lo)return po;return-1},Ua="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Fa="[\\x20\\t\\r\\n\\f]",Va="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Oa=/[\x20\t\r\n\f]+/g,Ha=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,ja=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Wa=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Xa=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Ya=/:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,Za=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,Ka={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Qa=/^(?:input|select|textarea|button)$/i,Ja=/^h\d$/i,$a=/^[^{]+\{\s*\[native \w/,eo=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ro=/[+~]/,ao=/'|\\/g,oo=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,no=function(so,lo,po){var co="0x"+lo-65536;return co!=co||po?lo:0>co?_StringfromCharCode(co+65536):_StringfromCharCode(55296|co>>10,56320|1023&co)},io=function(){ua()},ea,ta,ra,aa,oa,na,ia,sa,la,da,ca,ua,ma,ga,fa,ha,ya,xa,va;try{Ia.apply(Pa=Ba.call(_a.childNodes),_a.childNodes),Pa[_a.childNodes.length].nodeType}catch(so){Ia={apply:Pa.length?function(lo,po){Da.apply(lo,Ba.call(po))}:function(lo,po){for(var co=lo.length,uo=0;lo[co++]=po[uo++];);lo.length=co-1}}}for(ea in ta=Nr.support={},oa=Nr.isXML=function(so){var lo=so&&(so.ownerDocument||so).documentElement;return!!lo&&"HTML"!==lo.nodeName},ua=Nr.setDocument=function(so){var co=so?so.ownerDocument||so:_a,lo,po;return co!==ma&&9===co.nodeType&&co.documentElement?(ma=co,ga=ma.documentElement,fa=!oa(ma),(po=ma.defaultView)&&po.top!==po&&(po.addEventListener?po.addEventListener("unload",io,!1):po.attachEvent&&po.attachEvent("onunload",io)),ta.attributes=Vr(function(uo){return uo.className="i",!uo.getAttribute("className")}),ta.getElementsByTagName=Vr(function(uo){return uo.appendChild(ma.createComment("")),!uo.getElementsByTagName("*").length}),ta.getElementsByClassName=$a.test(ma.getElementsByClassName),ta.getById=Vr(function(uo){return ga.appendChild(uo).id=ba,!ma.getElementsByName||!ma.getElementsByName(ba).length}),ta.getById?(ra.find.ID=function(uo,mo){if("undefined"!=typeof mo.getElementById&&fa){var go=mo.getElementById(uo);return go?[go]:[]}},ra.filter.ID=function(uo){var mo=uo.replace(oo,no);return function(go){return go.getAttribute("id")===mo}}):(delete ra.find.ID,ra.filter.ID=function(uo){var mo=uo.replace(oo,no);return function(go){var fo="undefined"!=typeof go.getAttributeNode&&go.getAttributeNode("id");return fo&&fo.value===mo}}),ra.find.TAG=ta.getElementsByTagName?function(uo,mo){return"undefined"==typeof mo.getElementsByTagName?ta.qsa?mo.querySelectorAll(uo):void 0:mo.getElementsByTagName(uo)}:function(uo,mo){var fo=[],yo=0,xo=mo.getElementsByTagName(uo),go;if("*"===uo){for(;go=xo[yo++];)1===go.nodeType&&fo.push(go);return fo}return xo},ra.find.CLASS=ta.getElementsByClassName&&function(uo,mo){if("undefined"!=typeof mo.getElementsByClassName&&fa)return mo.getElementsByClassName(uo)},ya=[],ha=[],(ta.qsa=$a.test(ma.querySelectorAll))&&(Vr(function(uo){ga.appendChild(uo).innerHTML="<a id='"+ba+"'></a><select id='"+ba+"-\r\\' msallowcapture=''><option selected=''></option></select>",uo.querySelectorAll("[msallowcapture^='']").length&&ha.push("[*^$]="+Fa+"*(?:''|\"\")"),uo.querySelectorAll("[selected]").length||ha.push("\\["+Fa+"*(?:value|"+Ua+")"),uo.querySelectorAll("[id~="+ba+"-]").length||ha.push("~="),uo.querySelectorAll(":checked").length||ha.push(":checked"),uo.querySelectorAll("a#"+ba+"+*").length||ha.push(".#.+[+~]")}),Vr(function(uo){var mo=ma.createElement("input");mo.setAttribute("type","hidden"),uo.appendChild(mo).setAttribute("name","D"),uo.querySelectorAll("[name=d]").length&&ha.push("name"+Fa+"*[*^$|!~]?="),uo.querySelectorAll(":enabled").length||ha.push(":enabled",":disabled"),uo.querySelectorAll("*,:x"),ha.push(",.*:")})),(ta.matchesSelector=$a.test(xa=ga.matches||ga.webkitMatchesSelector||ga.mozMatchesSelector||ga.oMatchesSelector||ga.msMatchesSelector))&&Vr(function(uo){ta.disconnectedMatch=xa.call(uo,"div"),xa.call(uo,"[s!='']:x"),ya.push("!=",":("+Va+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+("\\["+Fa+"*("+Va+")(?:"+Fa+"*([*^$|!~]?=)"+Fa+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Va+"))|)"+Fa+"*\\]")+")*)|.*)\\)|)")}),ha=ha.length&&new RegExp(ha.join("|")),ya=ya.length&&new RegExp(ya.join("|")),lo=$a.test(ga.compareDocumentPosition),va=lo||$a.test(ga.contains)?function(uo,mo){var go=9===uo.nodeType?uo.documentElement:uo,fo=mo&&mo.parentNode;return uo===fo||!!(fo&&1===fo.nodeType&&(go.contains?go.contains(fo):uo.compareDocumentPosition&&16&uo.compareDocumentPosition(fo)))}:function(uo,mo){if(mo)for(;mo=mo.parentNode;)if(mo===uo)return!0;return!1},wa=lo?function(uo,mo){if(uo===mo)return ca=!0,0;var go=!uo.compareDocumentPosition-!mo.compareDocumentPosition;return go?go:(go=(uo.ownerDocument||uo)===(mo.ownerDocument||mo)?uo.compareDocumentPosition(mo):1,1&go||!ta.sortDetached&&mo.compareDocumentPosition(uo)===go?uo===ma||uo.ownerDocument===_a&&va(_a,uo)?-1:mo===ma||mo.ownerDocument===_a&&va(_a,mo)?1:da?Na(da,uo)-Na(da,mo):0:4&go?-1:1)}:function(uo,mo){if(uo===mo)return ca=!0,0;var fo=0,yo=uo.parentNode,xo=mo.parentNode,vo=[uo],bo=[mo],go;if(!yo||!xo)return uo===ma?-1:mo===ma?1:yo?-1:xo?1:da?Na(da,uo)-Na(da,mo):0;if(yo===xo)return kr(uo,mo);for(go=uo;go=go.parentNode;)vo.unshift(go);for(go=mo;go=go.parentNode;)bo.unshift(go);for(;vo[fo]===bo[fo];)fo++;return fo?kr(vo[fo],bo[fo]):vo[fo]===_a?-1:bo[fo]===_a?1:0},ma):ma},Nr.matches=function(so,lo){return Nr(so,null,null,lo)},Nr.matchesSelector=function(so,lo){if((so.ownerDocument||so)!==ma&&ua(so),lo=lo.replace(Xa,"='$1']"),ta.matchesSelector&&fa&&!La[lo+" "]&&(!ya||!ya.test(lo))&&(!ha||!ha.test(lo)))try{var po=xa.call(so,lo);if(po||ta.disconnectedMatch||so.document&&11!==so.document.nodeType)return po}catch(co){}return 0<Nr(lo,ma,null,[so]).length},Nr.contains=function(so,lo){return(so.ownerDocument||so)!==ma&&ua(so),va(so,lo)},Nr.attr=function(so,lo){(so.ownerDocument||so)!==ma&&ua(so);var po=ra.attrHandle[lo.toLowerCase()],co=po&&Aa.call(ra.attrHandle,lo.toLowerCase())?po(so,lo,!fa):void 0;return void 0===co?ta.attributes||!fa?so.getAttribute(lo):(co=so.getAttributeNode(lo))&&co.specified?co.value:null:co},Nr.error=function(so){throw new Error("Syntax error, unrecognized expression: "+so)},Nr.uniqueSort=function(so){var po=[],co=0,uo=0,lo;if(ca=!ta.detectDuplicates,da=!ta.sortStable&&so.slice(0),so.sort(wa),ca){for(;lo=so[uo++];)lo===so[uo]&&(co=po.push(uo));for(;co--;)so.splice(po[co],1)}return da=null,so},aa=Nr.getText=function(so){var po="",co=0,uo=so.nodeType,lo;if(!uo)for(;lo=so[co++];)po+=aa(lo);else if(1===uo||9===uo||11===uo){if("string"==typeof so.textContent)return so.textContent;for(so=so.firstChild;so;so=so.nextSibling)po+=aa(so)}else if(3===uo||4===uo)return so.nodeValue;return po},ra=Nr.selectors={cacheLength:50,createPseudo:Fr,match:Ka,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(so){return so[1]=so[1].replace(oo,no),so[3]=(so[3]||so[4]||so[5]||"").replace(oo,no),"~="===so[2]&&(so[3]=" "+so[3]+" "),so.slice(0,4)},CHILD:function(so){return so[1]=so[1].toLowerCase(),"nth"===so[1].slice(0,3)?(!so[3]&&Nr.error(so[0]),so[4]=+(so[4]?so[5]+(so[6]||1):2*("even"===so[3]||"odd"===so[3])),so[5]=+(so[7]+so[8]||"odd"===so[3])):so[3]&&Nr.error(so[0]),so},PSEUDO:function(so){var po=!so[6]&&so[2],lo;return Ka.CHILD.test(so[0])?null:(so[3]?so[2]=so[4]||so[5]||"":po&&Ya.test(po)&&(lo=na(po,!0))&&(lo=po.indexOf(")",po.length-lo)-po.length)&&(so[0]=so[0].slice(0,lo),so[2]=po.slice(0,lo)),so.slice(0,3))}},filter:{TAG:function(so){var lo=so.replace(oo,no).toLowerCase();return"*"===so?function(){return!0}:function(po){return po.nodeName&&po.nodeName.toLowerCase()===lo}},CLASS:function(so){var lo=Ta[so+" "];return lo||(lo=new RegExp("(^|"+Fa+")"+so+"("+Fa+"|$)"))&&Ta(so,function(po){return lo.test("string"==typeof po.className&&po.className||"undefined"!=typeof po.getAttribute&&po.getAttribute("class")||"")})},ATTR:function(so,lo,po){return function(co){var uo=Nr.attr(co,so);return null==uo?"!="===lo:!lo||(uo+="","="===lo?uo===po:"!="===lo?uo!==po:"^="===lo?po&&0===uo.indexOf(po):"*="===lo?po&&-1<uo.indexOf(po):"$="===lo?po&&uo.slice(-po.length)===po:"~="===lo?-1<(" "+uo.replace(Oa," ")+" ").indexOf(po):"|="===lo&&(uo===po||uo.slice(0,po.length+1)===po+"-"))}},CHILD:function(so,lo,po,co,uo){var mo="nth"!==so.slice(0,3),go="last"!==so.slice(-4),fo="of-type"===lo;return 1===co&&0===uo?function(yo){return!!yo.parentNode}:function(yo,xo,vo){var Lo=mo==go?"previousSibling":"nextSibling",wo=yo.parentNode,Co=fo&&yo.nodeName.toLowerCase(),Ao=!vo&&!fo,Po=!1,bo,_o,So,Mo,To,Eo;if(wo){if(mo){for(;Lo;){for(Mo=yo;Mo=Mo[Lo];)if(fo?Mo.nodeName.toLowerCase()===Co:1===Mo.nodeType)return!1;Eo=Lo="only"===so&&!Eo&&"nextSibling"}return!0}if(Eo=[go?wo.firstChild:wo.lastChild],go&&Ao){for(Mo=wo,So=Mo[ba]||(Mo[ba]={}),_o=So[Mo.uniqueID]||(So[Mo.uniqueID]={}),bo=_o[so]||[],To=bo[0]===Sa&&bo[1],Po=To&&bo[2],Mo=To&&wo.childNodes[To];Mo=++To&&Mo&&Mo[Lo]||(Po=To=0)||Eo.pop();)if(1===Mo.nodeType&&++Po&&Mo===yo){_o[so]=[Sa,To,Po];break}}else if(Ao&&(Mo=yo,So=Mo[ba]||(Mo[ba]={}),_o=So[Mo.uniqueID]||(So[Mo.uniqueID]={}),bo=_o[so]||[],To=bo[0]===Sa&&bo[1],Po=To),!1===Po)for(;(Mo=++To&&Mo&&Mo[Lo]||(Po=To=0)||Eo.pop())&&!((fo?Mo.nodeName.toLowerCase()===Co:1===Mo.nodeType)&&++Po&&(Ao&&(So=Mo[ba]||(Mo[ba]={}),_o=So[Mo.uniqueID]||(So[Mo.uniqueID]={}),_o[so]=[Sa,Po]),Mo===yo)););return Po-=uo,Po===co||0==Po%co&&0<=Po/co}}},PSEUDO:function(so,lo){var co=ra.pseudos[so]||ra.setFilters[so.toLowerCase()]||Nr.error("unsupported pseudo: "+so),po;return co[ba]?co(lo):1<co.length?(po=[so,so,"",lo],ra.setFilters.hasOwnProperty(so.toLowerCase())?Fr(function(uo,mo){for(var fo=co(uo,lo),yo=fo.length,go;yo--;)go=Na(uo,fo[yo]),uo[go]=!(mo[go]=fo[yo])}):function(uo){return co(uo,0,po)}):co}},pseudos:{not:Fr(function(so){var lo=[],po=[],co=ia(so.replace(Ha,"$1"));return co[ba]?Fr(function(uo,mo,go,fo){for(var xo=co(uo,null,fo,[]),vo=uo.length,yo;vo--;)(yo=xo[vo])&&(uo[vo]=!(mo[vo]=yo))}):function(uo,mo,go){return lo[0]=uo,co(lo,null,go,po),lo[0]=null,!po.pop()}}),has:Fr(function(so){return function(lo){return 0<Nr(so,lo).length}}),contains:Fr(function(so){return so=so.replace(oo,no),function(lo){return-1<(lo.textContent||lo.innerText||aa(lo)).indexOf(so)}}),lang:Fr(function(so){return Za.test(so||"")||Nr.error("unsupported lang: "+so),so=so.replace(oo,no).toLowerCase(),function(lo){var po;do if(po=fa?lo.lang:lo.getAttribute("xml:lang")||lo.getAttribute("lang"))return po=po.toLowerCase(),po===so||0===po.indexOf(so+"-");while((lo=lo.parentNode)&&1===lo.nodeType);return!1}}),target:function(so){var lo=Br.location&&Br.location.hash;return lo&&lo.slice(1)===so.id},root:function(so){return so===ga},focus:function(so){return so===ma.activeElement&&(!ma.hasFocus||ma.hasFocus())&&!!(so.type||so.href||~so.tabIndex)},enabled:function(so){return!1===so.disabled},disabled:function(so){return!0===so.disabled},checked:function(so){var lo=so.nodeName.toLowerCase();return"input"===lo&&!!so.checked||"option"===lo&&!!so.selected},selected:function(so){return so.parentNode&&so.parentNode.selectedIndex,!0===so.selected},empty:function(so){for(so=so.firstChild;so;so=so.nextSibling)if(6>so.nodeType)return!1;return!0},parent:function(so){return!ra.pseudos.empty(so)},header:function(so){return Ja.test(so.nodeName)},input:function(so){return Qa.test(so.nodeName)},button:function(so){var lo=so.nodeName.toLowerCase();return"input"===lo&&"button"===so.type||"button"===lo},text:function(so){var lo;return"input"===so.nodeName.toLowerCase()&&"text"===so.type&&(null==(lo=so.getAttribute("type"))||"text"===lo.toLowerCase())},first:Hr(function(){return[0]}),last:Hr(function(so,lo){return[lo-1]}),eq:Hr(function(so,lo,po){return[0>po?po+lo:po]}),even:Hr(function(so,lo){for(var po=0;po<lo;po+=2)so.push(po);return so}),odd:Hr(function(so,lo){for(var po=1;po<lo;po+=2)so.push(po);return so}),lt:Hr(function(so,lo,po){for(var co=0>po?po+lo:po;0<=--co;)so.push(co);return so}),gt:Hr(function(so,lo,po){for(var co=0>po?po+lo:po;++co<lo;)so.push(co);return so})}},ra.pseudos.nth=ra.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})ra.pseudos[ea]=zr(ea);for(ea in{submit:!0,reset:!0})ra.pseudos[ea]=Or(ea);return Wr.prototype=ra.filters=ra.pseudos,ra.setFilters=new Wr,na=Nr.tokenize=function(so,lo){var xo=Ea[so+" "],po,co,uo,mo,go,fo,yo;if(xo)return lo?0:xo.slice(0);for(go=so,fo=[],yo=ra.preFilter;go;){for(mo in(!po||(co=ja.exec(go)))&&(co&&(go=go.slice(co[0].length)||go),fo.push(uo=[])),po=!1,(co=Wa.exec(go))&&(po=co.shift(),uo.push({value:po,type:co[0].replace(Ha," ")}),go=go.slice(po.length)),ra.filter)(co=Ka[mo].exec(go))&&(!yo[mo]||(co=yo[mo](co)))&&(po=co.shift(),uo.push({value:po,type:mo,matches:co}),go=go.slice(po.length));if(!po)break}return lo?go.length:go?Nr.error(so):Ea(so,fo).slice(0)},ia=Nr.compile=function(so,lo){var co=[],uo=[],mo=La[so+" "],po;if(!mo){for(lo||(lo=na(so)),po=lo.length;po--;)mo=Jr(lo[po]),mo[ba]?co.push(mo):uo.push(mo);mo=La(so,$r(uo,co)),mo.selector=so}return mo},sa=Nr.select=function(so,lo,po,co){var xo="function"==typeof so&&so,vo=!co&&na(so=xo.selector||so),uo,mo,go,fo,yo;if(po=po||[],1===vo.length){if(mo=vo[0]=vo[0].slice(0),2<mo.length&&"ID"===(go=mo[0]).type&&ta.getById&&9===lo.nodeType&&fa&&ra.relative[mo[1].type]){if(lo=(ra.find.ID(go.matches[0].replace(oo,no),lo)||[])[0],!lo)return po;xo&&(lo=lo.parentNode),so=so.slice(mo.shift().value.length)}for(uo=Ka.needsContext.test(so)?0:mo.length;uo--&&(go=mo[uo],!ra.relative[fo=go.type]);)if((yo=ra.find[fo])&&(co=yo(go.matches[0].replace(oo,no),ro.test(mo[0].type)&&jr(lo.parentNode)||lo))){if(mo.splice(uo,1),so=co.length&&qr(mo),!so)return Ia.apply(po,co),po;break}}return(xo||ia(so,vo))(co,lo,!fa,po,!lo||ro.test(so)&&jr(lo.parentNode)||lo),po},ta.sortStable=ba.split("").sort(wa).join("")===ba,ta.detectDuplicates=!!ca,ua(),ta.sortDetached=Vr(function(so){return 1&so.compareDocumentPosition(ma.createElement("div"))}),Vr(function(so){return so.innerHTML="<a href='#'></a>","#"===so.firstChild.getAttribute("href")})||Gr("type|href|height|width",function(so,lo,po){if(!po)return so.getAttribute(lo,"type"===lo.toLowerCase()?1:2)}),ta.attributes&&Vr(function(so){return so.innerHTML="<input/>",so.firstChild.setAttribute("value",""),""===so.firstChild.getAttribute("value")})||Gr("value",function(so,lo,po){if(!po&&"input"===so.nodeName.toLowerCase())return so.defaultValue}),Vr(function(so){return null==so.getAttribute("disabled")})||Gr(Ua,function(so,lo,po){var co;if(!po)return!0===so[lo]?lo.toLowerCase():(co=so.getAttributeNode(lo))&&co.specified?co.value:null}),Nr}(L);qe.find=Qe,qe.expr=Qe.selectors,qe.expr[":"]=qe.expr.pseudos,qe.uniqueSort=qe.unique=Qe.uniqueSort,qe.text=Qe.getText,qe.isXMLDoc=Qe.isXML,qe.contains=Qe.contains;var Je=function(Br,Nr,Ur){for(var Fr=[];(Br=Br[Nr])&&9!==Br.nodeType;)if(1===Br.nodeType){if(void 0!==Ur&&qe(Br).is(Ur))break;Fr.push(Br)}return Fr},$e=function(Br,Nr){for(var Ur=[];Br;Br=Br.nextSibling)1===Br.nodeType&&Br!==Nr&&Ur.push(Br);return Ur},et=qe.expr.match.needsContext,tt=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,rt=/^.[^:#\[\.,]*$/;qe.filter=function(Br,Nr,Ur){var Fr=Nr[0];return Ur&&(Br=":not("+Br+")"),1===Nr.length&&1===Fr.nodeType?qe.find.matchesSelector(Fr,Br)?[Fr]:[]:qe.find.matches(Br,qe.grep(Nr,function(Vr){return 1===Vr.nodeType}))},qe.fn.extend({find:function(Br){var Ur=this.length,Fr=[],Vr=this,Nr;if("string"!=typeof Br)return this.pushStack(qe(Br).filter(function(){for(Nr=0;Nr<Ur;Nr++)if(qe.contains(Vr[Nr],this))return!0}));for(Nr=0;Nr<Ur;Nr++)qe.find(Br,Vr[Nr],Fr);return Fr=this.pushStack(1<Ur?qe.unique(Fr):Fr),Fr.selector=this.selector?this.selector+" "+Br:Br,Fr},filter:function(Br){return this.pushStack(P(this,Br||[],!1))},not:function(Br){return this.pushStack(P(this,Br||[],!0))},is:function(Br){return!!P(this,"string"==typeof Br&&et.test(Br)?qe(Br):Br||[],!1).length}});var ot=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,nt=qe.fn.init=function(Br,Nr,Ur){var Fr,Vr;if(!Br)return this;if(Ur=Ur||at,"string"==typeof Br){if(Fr="<"===Br[0]&&">"===Br[Br.length-1]&&3<=Br.length?[null,Br,null]:ot.exec(Br),Fr&&(Fr[1]||!Nr)){if(Fr[1]){if(Nr=Nr instanceof qe?Nr[0]:Nr,qe.merge(this,qe.parseHTML(Fr[1],Nr&&Nr.nodeType?Nr.ownerDocument||Nr:Ue,!0)),tt.test(Fr[1])&&qe.isPlainObject(Nr))for(Fr in Nr)qe.isFunction(this[Fr])?this[Fr](Nr[Fr]):this.attr(Fr,Nr[Fr]);return this}return Vr=Ue.getElementById(Fr[2]),Vr&&Vr.parentNode&&(this.length=1,this[0]=Vr),this.context=Ue,this.selector=Br,this}return!Nr||Nr.jquery?(Nr||Ur).find(Br):this.constructor(Nr).find(Br)}return Br.nodeType?(this.context=this[0]=Br,this.length=1,this):qe.isFunction(Br)?void 0===Ur.ready?Br(qe):Ur.ready(Br):(void 0!==Br.selector&&(this.selector=Br.selector,this.context=Br.context),qe.makeArray(Br,this))},at;nt.prototype=qe.fn,at=qe(Ue);var it=/^(?:parents|prev(?:Until|All))/,st={children:!0,contents:!0,next:!0,prev:!0};qe.fn.extend({has:function(Br){var Nr=qe(Br,this),Ur=Nr.length;return this.filter(function(){for(var Fr=0;Fr<Ur;Fr++)if(qe.contains(this,Nr[Fr]))return!0})},closest:function(Br,Nr){for(var Fr=0,Vr=this.length,Gr=[],kr=et.test(Br)||"string"!=typeof Br?qe(Br,Nr||this.context):0,Ur;Fr<Vr;Fr++)for(Ur=this[Fr];Ur&&Ur!==Nr;Ur=Ur.parentNode)if(11>Ur.nodeType&&(kr?-1<kr.index(Ur):1===Ur.nodeType&&qe.find.matchesSelector(Ur,Br))){Gr.push(Ur);break}return this.pushStack(1<Gr.length?qe.uniqueSort(Gr):Gr)},index:function(Br){return Br?"string"==typeof Br?ke.call(qe(Br),this[0]):ke.call(this,Br.jquery?Br[0]:Br):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(Br,Nr){return this.pushStack(qe.uniqueSort(qe.merge(this.get(),qe(Br,Nr))))},addBack:function(Br){return this.add(null==Br?this.prevObject:this.prevObject.filter(Br))}}),qe.each({parent:function(Br){var Nr=Br.parentNode;return Nr&&11!==Nr.nodeType?Nr:null},parents:function(Br){return Je(Br,"parentNode")},parentsUntil:function(Br,Nr,Ur){return Je(Br,"parentNode",Ur)},next:function(Br){return R(Br,"nextSibling")},prev:function(Br){return R(Br,"previousSibling")},nextAll:function(Br){return Je(Br,"nextSibling")},prevAll:function(Br){return Je(Br,"previousSibling")},nextUntil:function(Br,Nr,Ur){return Je(Br,"nextSibling",Ur)},prevUntil:function(Br,Nr,Ur){return Je(Br,"previousSibling",Ur)},siblings:function(Br){return $e((Br.parentNode||{}).firstChild,Br)},children:function(Br){return $e(Br.firstChild)},contents:function(Br){return Br.contentDocument||qe.merge([],Br.childNodes)}},function(Br,Nr){qe.fn[Br]=function(Ur,Fr){var Vr=qe.map(this,Nr,Ur);return"Until"!==Br.slice(-5)&&(Fr=Ur),Fr&&"string"==typeof Fr&&(Vr=qe.filter(Fr,Vr)),1<this.length&&(!st[Br]&&qe.uniqueSort(Vr),it.test(Br)&&Vr.reverse()),this.pushStack(Vr)}});var lt=/\S+/g;qe.Callbacks=function(Br){Br="string"==typeof Br?D(Br):qe.extend({},Br);var Gr=[],kr=[],zr=-1,Or=function(){for(Vr=Br.once,Fr=Nr=!0;kr.length;zr=-1)for(Ur=kr.shift();++zr<Gr.length;)!1===Gr[zr].apply(Ur[0],Ur[1])&&Br.stopOnFalse&&(zr=Gr.length,Ur=!1);Br.memory||(Ur=!1),Nr=!1,Vr&&(Ur?Gr=[]:Gr="")},Hr={add:function(){return Gr&&(Ur&&!Nr&&(zr=Gr.length-1,kr.push(Ur)),function jr(Wr){qe.each(Wr,function(qr,Xr){qe.isFunction(Xr)?(!Br.unique||!Hr.has(Xr))&&Gr.push(Xr):Xr&&Xr.length&&"string"!==qe.type(Xr)&&jr(Xr)})}(arguments),Ur&&!Nr&&Or()),this},remove:function(){return qe.each(arguments,function(jr,Wr){for(var qr;-1<(qr=qe.inArray(Wr,Gr,qr));)Gr.splice(qr,1),qr<=zr&&zr--}),this},has:function(jr){return jr?-1<qe.inArray(jr,Gr):0<Gr.length},empty:function(){return Gr&&(Gr=[]),this},disable:function(){return Vr=kr=[],Gr=Ur="",this},disabled:function(){return!Gr},lock:function(){return Vr=kr=[],Ur||(Gr=Ur=""),this},locked:function(){return!!Vr},fireWith:function(jr,Wr){return Vr||(Wr=Wr||[],Wr=[jr,Wr.slice?Wr.slice():Wr],kr.push(Wr),!Nr&&Or()),this},fire:function(){return Hr.fireWith(this,arguments),this},fired:function(){return!!Fr}},Nr,Ur,Fr,Vr;return Hr},qe.extend({Deferred:function(Br){var Nr=[["resolve","done",qe.Callbacks("once memory"),"resolved"],["reject","fail",qe.Callbacks("once memory"),"rejected"],["notify","progress",qe.Callbacks("memory")]],Ur="pending",Fr={state:function(){return Ur},always:function(){return Vr.done(arguments).fail(arguments),this},then:function(){var Gr=arguments;return qe.Deferred(function(kr){qe.each(Nr,function(zr,Or){var Hr=qe.isFunction(Gr[zr])&&Gr[zr];Vr[Or[1]](function(){var jr=Hr&&Hr.apply(this,arguments);jr&&qe.isFunction(jr.promise)?jr.promise().progress(kr.notify).done(kr.resolve).fail(kr.reject):kr[Or[0]+"With"](this===Fr?kr.promise():this,Hr?[jr]:arguments)})}),Gr=null}).promise()},promise:function(Gr){return null==Gr?Fr:qe.extend(Gr,Fr)}},Vr={};return Fr.pipe=Fr.then,qe.each(Nr,function(Gr,kr){var zr=kr[2],Or=kr[3];Fr[kr[1]]=zr.add,Or&&zr.add(function(){Ur=Or},Nr[1^Gr][2].disable,Nr[2][2].lock),Vr[kr[0]]=function(){return Vr[kr[0]+"With"](this===Vr?Fr:this,arguments),this},Vr[kr[0]+"With"]=zr.fireWith}),Fr.promise(Vr),Br&&Br.call(Vr,Vr),Vr},when:function(Br){var Nr=0,Ur=Fe.call(arguments),Fr=Ur.length,Vr=1!==Fr||Br&&qe.isFunction(Br.promise)?Fr:0,Gr=1===Vr?Br:qe.Deferred(),kr=function(jr,Wr,qr){return function(Xr){Wr[jr]=this,qr[jr]=1<arguments.length?Fe.call(arguments):Xr,qr===zr?Gr.notifyWith(Wr,qr):! --Vr&&Gr.resolveWith(Wr,qr)}},zr,Or,Hr;if(1<Fr)for(zr=Array(Fr),Or=Array(Fr),Hr=Array(Fr);Nr<Fr;Nr++)Ur[Nr]&&qe.isFunction(Ur[Nr].promise)?Ur[Nr].promise().progress(kr(Nr,Or,zr)).done(kr(Nr,Hr,Ur)).fail(Gr.reject):--Vr;return Vr||Gr.resolveWith(Hr,Ur),Gr.promise()}});var ut;qe.fn.ready=function(Br){return qe.ready.promise().done(Br),this},qe.extend({isReady:!1,readyWait:1,holdReady:function(Br){Br?qe.readyWait++:qe.ready(!0)},ready:function(Br){(!0===Br?! --qe.readyWait:!qe.isReady)&&(qe.isReady=!0,!0!==Br&&0<--qe.readyWait||(ut.resolveWith(Ue,[qe]),qe.fn.triggerHandler&&(qe(Ue).triggerHandler("ready"),qe(Ue).off("ready"))))}}),qe.ready.promise=function(Br){return ut||(ut=qe.Deferred(),"complete"!==Ue.readyState&&("loading"===Ue.readyState||Ue.documentElement.doScroll)?(Ue.addEventListener("DOMContentLoaded",I),L.addEventListener("load",I)):L.setTimeout(qe.ready)),ut.promise(Br)},qe.ready.promise();var mt=function(Br,Nr,Ur,Fr,Vr,Gr,kr){var zr=0,Or=Br.length,Hr=null==Ur;if("object"===qe.type(Ur))for(zr in Vr=!0,Ur)mt(Br,Nr,zr,Ur[zr],!0,Gr,kr);else if(void 0!==Fr&&(Vr=!0,qe.isFunction(Fr)||(kr=!0),Hr&&(kr?(Nr.call(Br,Fr),Nr=null):(Hr=Nr,Nr=function(jr,Wr,qr){return Hr.call(qe(jr),qr)})),Nr))for(;zr<Or;zr++)Nr(Br[zr],Ur,kr?Fr:Fr.call(Br[zr],zr,Nr(Br[zr],Ur)));return Vr?Br:Hr?Nr.call(Br):Or?Nr(Br[0],Ur):Gr},gt=function(Br){return 1===Br.nodeType||9===Br.nodeType||!+Br.nodeType};U.uid=1,U.prototype={register:function(Br,Nr){var Ur=Nr||{};return Br.nodeType?Br[this.expando]=Ur:Object.defineProperty(Br,this.expando,{value:Ur,writable:!0,configurable:!0}),Br[this.expando]},cache:function(Br){if(!gt(Br))return{};var Nr=Br[this.expando];return Nr||(Nr={},gt(Br)&&(Br.nodeType?Br[this.expando]=Nr:Object.defineProperty(Br,this.expando,{value:Nr,configurable:!0}))),Nr},set:function(Br,Nr,Ur){var Vr=this.cache(Br),Fr;if("string"==typeof Nr)Vr[Nr]=Ur;else for(Fr in Nr)Vr[Fr]=Nr[Fr];return Vr},get:function(Br,Nr){return void 0===Nr?this.cache(Br):Br[this.expando]&&Br[this.expando][Nr]},access:function(Br,Nr,Ur){var Fr;return void 0===Nr||Nr&&"string"==typeof Nr&&void 0===Ur?(Fr=this.get(Br,Nr),void 0===Fr?this.get(Br,qe.camelCase(Nr)):Fr):(this.set(Br,Nr,Ur),void 0===Ur?Nr:Ur)},remove:function(Br,Nr){var Gr=Br[this.expando],Ur,Fr,Vr;if(void 0!==Gr){if(void 0===Nr)this.register(Br);else for(qe.isArray(Nr)?Fr=Nr.concat(Nr.map(qe.camelCase)):(Vr=qe.camelCase(Nr),(Nr in Gr)?Fr=[Nr,Vr]:(Fr=Vr,Fr=(Fr in Gr)?[Fr]:Fr.match(lt)||[])),Ur=Fr.length;Ur--;)delete Gr[Fr[Ur]];(void 0===Nr||qe.isEmptyObject(Gr))&&(Br.nodeType?Br[this.expando]=void 0:delete Br[this.expando])}},hasData:function(Br){var Nr=Br[this.expando];return void 0!==Nr&&!qe.isEmptyObject(Nr)}};var ft=new U,ht=new U,yt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xt=/[A-Z]/g;qe.extend({hasData:function(Br){return ht.hasData(Br)||ft.hasData(Br)},data:function(Br,Nr,Ur){return ht.access(Br,Nr,Ur)},removeData:function(Br,Nr){ht.remove(Br,Nr)},_data:function(Br,Nr,Ur){return ft.access(Br,Nr,Ur)},_removeData:function(Br,Nr){ft.remove(Br,Nr)}}),qe.fn.extend({data:function(Br,Nr){var Gr=this[0],kr=Gr&&Gr.attributes,Ur,Fr,Vr;if(void 0===Br){if(this.length&&(Vr=ht.get(Gr),1===Gr.nodeType&&!ft.get(Gr,"hasDataAttrs"))){for(Ur=kr.length;Ur--;)kr[Ur]&&(Fr=kr[Ur].name,0===Fr.indexOf("data-")&&(Fr=qe.camelCase(Fr.slice(5)),F(Gr,Fr,Vr[Fr])));ft.set(Gr,"hasDataAttrs",!0)}return Vr}return"object"==typeof Br?this.each(function(){ht.set(this,Br)}):mt(this,function(zr){var Or,Hr;return Gr&&void 0===zr?(Or=ht.get(Gr,Br)||ht.get(Gr,Br.replace(xt,"-$&").toLowerCase()),void 0!==Or)?Or:(Hr=qe.camelCase(Br),Or=ht.get(Gr,Hr),void 0!==Or)?Or:(Or=F(Gr,Hr,void 0),void 0===Or?void 0:Or):void(Hr=qe.camelCase(Br),this.each(function(){var jr=ht.get(this,Hr);ht.set(this,Hr,zr),-1<Br.indexOf("-")&&void 0!==jr&&ht.set(this,Br,zr)}))},null,Nr,1<arguments.length,null,!0)},removeData:function(Br){return this.each(function(){ht.remove(this,Br)})}}),qe.extend({queue:function(Br,Nr,Ur){var Fr;if(Br)return Nr=(Nr||"fx")+"queue",Fr=ft.get(Br,Nr),Ur&&(!Fr||qe.isArray(Ur)?Fr=ft.access(Br,Nr,qe.makeArray(Ur)):Fr.push(Ur)),Fr||[]},dequeue:function(Br,Nr){Nr=Nr||"fx";var Ur=qe.queue(Br,Nr),Fr=Ur.length,Vr=Ur.shift(),Gr=qe._queueHooks(Br,Nr);"inprogress"===Vr&&(Vr=Ur.shift(),Fr--),Vr&&("fx"===Nr&&Ur.unshift("inprogress"),delete Gr.stop,Vr.call(Br,function(){qe.dequeue(Br,Nr)},Gr)),!Fr&&Gr&&Gr.empty.fire()},_queueHooks:function(Br,Nr){var Ur=Nr+"queueHooks";return ft.get(Br,Ur)||ft.access(Br,Ur,{empty:qe.Callbacks("once memory").add(function(){ft.remove(Br,[Nr+"queue",Ur])})})}}),qe.fn.extend({queue:function(Br,Nr){var Ur=2;return"string"!=typeof Br&&(Nr=Br,Br="fx",Ur--),arguments.length<Ur?qe.queue(this[0],Br):void 0===Nr?this:this.each(function(){var Fr=qe.queue(this,Br,Nr);qe._queueHooks(this,Br),"fx"===Br&&"inprogress"!==Fr[0]&&qe.dequeue(this,Br)})},dequeue:function(Br){return this.each(function(){qe.dequeue(this,Br)})},clearQueue:function(Br){return this.queue(Br||"fx",[])},promise:function(Br,Nr){var Fr=1,Vr=qe.Deferred(),Gr=this,kr=this.length,zr=function(){--Fr||Vr.resolveWith(Gr,[Gr])},Ur;for("string"!=typeof Br&&(Nr=Br,Br=void 0),Br=Br||"fx";kr--;)Ur=ft.get(Gr[kr],Br+"queueHooks"),Ur&&Ur.empty&&(Fr++,Ur.empty.add(zr));return zr(),Vr.promise(Nr)}});var vt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,bt=new RegExp("^(?:([+-])=|)("+vt+")([a-z%]*)$","i"),_t=["Top","Right","Bottom","Left"],St=function(Br,Nr){return Br=Nr||Br,"none"===qe.css(Br,"display")||!qe.contains(Br.ownerDocument,Br)},Mt=/^(?:checkbox|radio)$/i,Tt=/<([\w:-]+)/,Et=/^$|\/(?:java|ecma)script/i,Lt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td;var wt=/<|&#?\w+;/;(function(){var Br=Ue.createDocumentFragment(),Nr=Br.appendChild(Ue.createElement("div")),Ur=Ue.createElement("input");Ur.setAttribute("type","radio"),Ur.setAttribute("checked","checked"),Ur.setAttribute("name","t"),Nr.appendChild(Ur),je.checkClone=Nr.cloneNode(!0).cloneNode(!0).lastChild.checked,Nr.innerHTML="<textarea>x</textarea>",je.noCloneChecked=!!Nr.cloneNode(!0).lastChild.defaultValue})();var Ct=/^key/,At=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Pt=/^([^.]*)(?:\.(.+)|)/;qe.event={global:{},add:function(Br,Nr,Ur,Fr,Vr){var Kr=ft.get(Br),Gr,kr,zr,Or,Hr,jr,Wr,qr,Xr,Yr,Zr;if(Kr)for(Ur.handler&&(Gr=Ur,Ur=Gr.handler,Vr=Gr.selector),Ur.guid||(Ur.guid=qe.guid++),(Or=Kr.events)||(Or=Kr.events={}),(kr=Kr.handle)||(kr=Kr.handle=function(Qr){return"undefined"!=typeof qe&&qe.event.triggered!==Qr.type?qe.event.dispatch.apply(Br,arguments):void 0}),Nr=(Nr||"").match(lt)||[""],Hr=Nr.length;Hr--;)(zr=Pt.exec(Nr[Hr])||[],Xr=Zr=zr[1],Yr=(zr[2]||"").split(".").sort(),!!Xr)&&(Wr=qe.event.special[Xr]||{},Xr=(Vr?Wr.delegateType:Wr.bindType)||Xr,Wr=qe.event.special[Xr]||{},jr=qe.extend({type:Xr,origType:Zr,data:Fr,handler:Ur,guid:Ur.guid,selector:Vr,needsContext:Vr&&qe.expr.match.needsContext.test(Vr),namespace:Yr.join(".")},Gr),(qr=Or[Xr])||(qr=Or[Xr]=[],qr.delegateCount=0,(!Wr.setup||!1===Wr.setup.call(Br,Fr,Yr,kr))&&Br.addEventListener&&Br.addEventListener(Xr,kr)),Wr.add&&(Wr.add.call(Br,jr),!jr.handler.guid&&(jr.handler.guid=Ur.guid)),Vr?qr.splice(qr.delegateCount++,0,jr):qr.push(jr),qe.event.global[Xr]=!0)},remove:function(Br,Nr,Ur,Fr,Vr){var Kr=ft.hasData(Br)&&ft.get(Br),Gr,kr,zr,Or,Hr,jr,Wr,qr,Xr,Yr,Zr;if(Kr&&(Or=Kr.events)){for(Nr=(Nr||"").match(lt)||[""],Hr=Nr.length;Hr--;){if(zr=Pt.exec(Nr[Hr])||[],Xr=Zr=zr[1],Yr=(zr[2]||"").split(".").sort(),!Xr){for(Xr in Or)qe.event.remove(Br,Xr+Nr[Hr],Ur,Fr,!0);continue}for(Wr=qe.event.special[Xr]||{},Xr=(Fr?Wr.delegateType:Wr.bindType)||Xr,qr=Or[Xr]||[],zr=zr[2]&&new RegExp("(^|\\.)"+Yr.join("\\.(?:.*\\.|)")+"(\\.|$)"),kr=Gr=qr.length;Gr--;)jr=qr[Gr],(Vr||Zr===jr.origType)&&(!Ur||Ur.guid===jr.guid)&&(!zr||zr.test(jr.namespace))&&(!Fr||Fr===jr.selector||"**"===Fr&&jr.selector)&&(qr.splice(Gr,1),jr.selector&&qr.delegateCount--,Wr.remove&&Wr.remove.call(Br,jr));kr&&!qr.length&&((!Wr.teardown||!1===Wr.teardown.call(Br,Yr,Kr.handle))&&qe.removeEvent(Br,Xr,Kr.handle),delete Or[Xr])}qe.isEmptyObject(Or)&&ft.remove(Br,"handle events")}},dispatch:function(Br){Br=qe.event.fix(Br);var kr=[],zr=Fe.call(arguments),Or=(ft.get(this,"events")||{})[Br.type]||[],Hr=qe.event.special[Br.type]||{},Nr,Ur,Fr,Vr,Gr;if(zr[0]=Br,Br.delegateTarget=this,!(Hr.preDispatch&&!1===Hr.preDispatch.call(this,Br))){for(kr=qe.event.handlers.call(this,Br,Or),Nr=0;(Vr=kr[Nr++])&&!Br.isPropagationStopped();)for(Br.currentTarget=Vr.elem,Ur=0;(Gr=Vr.handlers[Ur++])&&!Br.isImmediatePropagationStopped();)(!Br.rnamespace||Br.rnamespace.test(Gr.namespace))&&(Br.handleObj=Gr,Br.data=Gr.data,Fr=((qe.event.special[Gr.origType]||{}).handle||Gr.handler).apply(Vr.elem,zr),void 0!==Fr&&!1===(Br.result=Fr)&&(Br.preventDefault(),Br.stopPropagation()));return Hr.postDispatch&&Hr.postDispatch.call(this,Br),Br.result}},handlers:function(Br,Nr){var kr=[],zr=Nr.delegateCount,Or=Br.target,Ur,Fr,Vr,Gr;if(zr&&Or.nodeType&&("click"!==Br.type||isNaN(Br.button)||1>Br.button))for(;Or!==this;Or=Or.parentNode||this)if(1===Or.nodeType&&(!0!==Or.disabled||"click"!==Br.type)){for(Fr=[],Ur=0;Ur<zr;Ur++)Gr=Nr[Ur],Vr=Gr.selector+" ",void 0===Fr[Vr]&&(Fr[Vr]=Gr.needsContext?-1<qe(Vr,this).index(Or):qe.find(Vr,this,null,[Or]).length),Fr[Vr]&&Fr.push(Gr);Fr.length&&kr.push({elem:Or,handlers:Fr})}return zr<Nr.length&&kr.push({elem:this,handlers:Nr.slice(zr)}),kr},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(Br,Nr){return null==Br.which&&(Br.which=null==Nr.charCode?Nr.keyCode:Nr.charCode),Br}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(Br,Nr){var Gr=Nr.button,Ur,Fr,Vr;return null==Br.pageX&&null!=Nr.clientX&&(Ur=Br.target.ownerDocument||Ue,Fr=Ur.documentElement,Vr=Ur.body,Br.pageX=Nr.clientX+(Fr&&Fr.scrollLeft||Vr&&Vr.scrollLeft||0)-(Fr&&Fr.clientLeft||Vr&&Vr.clientLeft||0),Br.pageY=Nr.clientY+(Fr&&Fr.scrollTop||Vr&&Vr.scrollTop||0)-(Fr&&Fr.clientTop||Vr&&Vr.clientTop||0)),Br.which||void 0===Gr||(Br.which=1&Gr?1:2&Gr?3:4&Gr?2:0),Br}},fix:function(Br){if(Br[qe.expando])return Br;var Vr=Br.type,Gr=Br,kr=this.fixHooks[Vr],Nr,Ur,Fr;for(kr||(this.fixHooks[Vr]=kr=At.test(Vr)?this.mouseHooks:Ct.test(Vr)?this.keyHooks:{}),Fr=kr.props?this.props.concat(kr.props):this.props,Br=new qe.Event(Gr),Nr=Fr.length;Nr--;)Ur=Fr[Nr],Br[Ur]=Gr[Ur];return Br.target||(Br.target=Ue),3===Br.target.nodeType&&(Br.target=Br.target.parentNode),kr.filter?kr.filter(Br,Gr):Br},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Y()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Y()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&qe.nodeName(this,"input"))return this.click(),!1},_default:function(Br){return qe.nodeName(Br.target,"a")}},beforeunload:{postDispatch:function(Br){void 0!==Br.result&&Br.originalEvent&&(Br.originalEvent.returnValue=Br.result)}}}},qe.removeEvent=function(Br,Nr,Ur){Br.removeEventListener&&Br.removeEventListener(Nr,Ur)},qe.Event=function(Br,Nr){return this instanceof qe.Event?void(Br&&Br.type?(this.originalEvent=Br,this.type=Br.type,this.isDefaultPrevented=Br.defaultPrevented||void 0===Br.defaultPrevented&&!1===Br.returnValue?W:X):this.type=Br,Nr&&qe.extend(this,Nr),this.timeStamp=Br&&Br.timeStamp||qe.now(),this[qe.expando]=!0):new qe.Event(Br,Nr)},qe.Event.prototype={constructor:qe.Event,isDefaultPrevented:X,isPropagationStopped:X,isImmediatePropagationStopped:X,isSimulated:!1,preventDefault:function(){var Br=this.originalEvent;this.isDefaultPrevented=W,Br&&!this.isSimulated&&Br.preventDefault()},stopPropagation:function(){var Br=this.originalEvent;this.isPropagationStopped=W,Br&&!this.isSimulated&&Br.stopPropagation()},stopImmediatePropagation:function(){var Br=this.originalEvent;this.isImmediatePropagationStopped=W,Br&&!this.isSimulated&&Br.stopImmediatePropagation(),this.stopPropagation()}},qe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(Br,Nr){qe.event.special[Br]={delegateType:Nr,bindType:Nr,handle:function(Ur){var Vr=this,Gr=Ur.relatedTarget,kr=Ur.handleObj,Fr;return Gr&&(Gr===Vr||qe.contains(Vr,Gr))||(Ur.type=kr.origType,Fr=kr.handler.apply(this,arguments),Ur.type=Nr),Fr}}}),qe.fn.extend({on:function(Br,Nr,Ur,Fr){return Z(this,Br,Nr,Ur,Fr)},one:function(Br,Nr,Ur,Fr){return Z(this,Br,Nr,Ur,Fr,1)},off:function(Br,Nr,Ur){var Fr,Vr;if(Br&&Br.preventDefault&&Br.handleObj)return Fr=Br.handleObj,qe(Br.delegateTarget).off(Fr.namespace?Fr.origType+"."+Fr.namespace:Fr.origType,Fr.selector,Fr.handler),this;if("object"==typeof Br){for(Vr in Br)this.off(Vr,Nr,Br[Vr]);return this}return(!1===Nr||"function"==typeof Nr)&&(Ur=Nr,Nr=void 0),!1===Ur&&(Ur=X),this.each(function(){qe.event.remove(this,Br,Ur,Nr)})}});var Rt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Dt=/<script|<style|<link/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Bt=/^true\/(.*)/,Nt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;qe.extend({htmlPrefilter:function(Br){return Br.replace(Rt,"<$1></$2>")},clone:function(Br,Nr,Ur){var zr=Br.cloneNode(!0),Or=qe.contains(Br.ownerDocument,Br),Fr,Vr,Gr,kr;if(!je.noCloneChecked&&(1===Br.nodeType||11===Br.nodeType)&&!qe.isXMLDoc(Br))for(kr=G(zr),Gr=G(Br),(Fr=0,Vr=Gr.length);Fr<Vr;Fr++)oe(Gr[Fr],kr[Fr]);if(Nr)if(Ur)for(Gr=Gr||G(Br),kr=kr||G(zr),(Fr=0,Vr=Gr.length);Fr<Vr;Fr++)ee(Gr[Fr],kr[Fr]);else ee(Br,zr);return kr=G(zr,"script"),0<kr.length&&O(kr,!Or&&G(Br,"script")),zr},cleanData:function(Br){for(var Vr=qe.event.special,Gr=0,Nr,Ur,Fr;void 0!==(Ur=Br[Gr]);Gr++)if(gt(Ur)){if(Nr=Ur[ft.expando]){if(Nr.events)for(Fr in Nr.events)Vr[Fr]?qe.event.remove(Ur,Fr):qe.removeEvent(Ur,Fr,Nr.handle);Ur[ft.expando]=void 0}Ur[ht.expando]&&(Ur[ht.expando]=void 0)}}}),qe.fn.extend({domManip:ne,detach:function(Br){return ie(this,Br,!0)},remove:function(Br){return ie(this,Br)},text:function(Br){return mt(this,function(Nr){return void 0===Nr?qe.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=Nr)})},null,Br,arguments.length)},append:function(){return ne(this,arguments,function(Br){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var Nr=K(this,Br);Nr.appendChild(Br)}})},prepend:function(){return ne(this,arguments,function(Br){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var Nr=K(this,Br);Nr.insertBefore(Br,Nr.firstChild)}})},before:function(){return ne(this,arguments,function(Br){this.parentNode&&this.parentNode.insertBefore(Br,this)})},after:function(){return ne(this,arguments,function(Br){this.parentNode&&this.parentNode.insertBefore(Br,this.nextSibling)})},empty:function(){for(var Nr=0,Br;null!=(Br=this[Nr]);Nr++)1===Br.nodeType&&(qe.cleanData(G(Br,!1)),Br.textContent="");return this},clone:function(Br,Nr){return Br=null!=Br&&Br,Nr=null==Nr?Br:Nr,this.map(function(){return qe.clone(this,Br,Nr)})},html:function(Br){return mt(this,function(Nr){var Ur=this[0]||{},Fr=0,Vr=this.length;if(void 0===Nr&&1===Ur.nodeType)return Ur.innerHTML;if("string"==typeof Nr&&!Dt.test(Nr)&&!Lt[(Tt.exec(Nr)||["",""])[1].toLowerCase()]){Nr=qe.htmlPrefilter(Nr);try{for(;Fr<Vr;Fr++)Ur=this[Fr]||{},1===Ur.nodeType&&(qe.cleanData(G(Ur,!1)),Ur.innerHTML=Nr);Ur=0}catch(Gr){}}Ur&&this.empty().append(Nr)},null,Br,arguments.length)},replaceWith:function(){var Br=[];return ne(this,arguments,function(Nr){var Ur=this.parentNode;0>qe.inArray(this,Br)&&(qe.cleanData(G(this)),Ur&&Ur.replaceChild(Nr,this))},Br)}}),qe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(Br,Nr){qe.fn[Br]=function(Ur){for(var Vr=[],Gr=qe(Ur),kr=Gr.length-1,zr=0,Fr;zr<=kr;zr++)Fr=zr==kr?this:this.clone(!0),qe(Gr[zr])[Nr](Fr),Ge.apply(Vr,Fr.get());return this.pushStack(Vr)}});var Ft={HTML:"block",BODY:"block"},Vt=/^margin/,Gt=new RegExp("^("+vt+")(?!px)[a-z%]+$","i"),kt=function(Br){var Nr=Br.ownerDocument.defaultView;return Nr&&Nr.opener||(Nr=L),Nr.getComputedStyle(Br)},zt=function(Br,Nr,Ur,Fr){var kr={},Vr,Gr;for(Gr in Nr)kr[Gr]=Br.style[Gr],Br.style[Gr]=Nr[Gr];for(Gr in Vr=Ur.apply(Br,Fr||[]),Nr)Br.style[Gr]=kr[Gr];return Vr},Ot=Ue.documentElement,Ut;(function(){function Br(){kr.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",kr.innerHTML="",Ot.appendChild(Gr);var zr=L.getComputedStyle(kr);Nr="1%"!==zr.top,Vr="2px"===zr.marginLeft,Ur="4px"===zr.width,kr.style.marginRight="50%",Fr="4px"===zr.marginRight,Ot.removeChild(Gr)}var Gr=Ue.createElement("div"),kr=Ue.createElement("div"),Nr,Ur,Fr,Vr;kr.style&&(kr.style.backgroundClip="content-box",kr.cloneNode(!0).style.backgroundClip="",je.clearCloneStyle="content-box"===kr.style.backgroundClip,Gr.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Gr.appendChild(kr),qe.extend(je,{pixelPosition:function(){return Br(),Nr},boxSizingReliable:function(){return null==Ur&&Br(),Ur},pixelMarginRight:function(){return null==Ur&&Br(),Fr},reliableMarginLeft:function(){return null==Ur&&Br(),Vr},reliableMarginRight:function(){var Or=kr.appendChild(Ue.createElement("div")),zr;return Or.style.cssText=kr.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",Or.style.marginRight=Or.style.width="0",kr.style.width="1px",Ot.appendChild(Gr),zr=!parseFloat(L.getComputedStyle(Or).marginRight),Ot.removeChild(Gr),kr.removeChild(Or),zr}}))})();var Ht=/^(none|table(?!-c[ea]).+)/,jt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:"0",fontWeight:"400"},qt=["Webkit","O","Moz","ms"],Xt=Ue.createElement("div").style;qe.extend({cssHooks:{opacity:{get:function(Br,Nr){if(Nr){var Ur=pe(Br,"opacity");return""===Ur?"1":Ur}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(Br,Nr,Ur,Fr){if(Br&&3!==Br.nodeType&&8!==Br.nodeType&&Br.style){var zr=qe.camelCase(Nr),Or=Br.style,Vr,Gr,kr;if(Nr=qe.cssProps[zr]||(qe.cssProps[zr]=ge(zr)||zr),kr=qe.cssHooks[Nr]||qe.cssHooks[zr],void 0!==Ur){if(Gr=typeof Ur,"string"===Gr&&(Vr=bt.exec(Ur))&&Vr[1]&&(Ur=V(Br,Nr,Vr),Gr="number"),null==Ur||Ur!==Ur)return;"number"===Gr&&(Ur+=Vr&&Vr[3]||(qe.cssNumber[zr]?"":"px")),je.clearCloneStyle||""!==Ur||0!==Nr.indexOf("background")||(Or[Nr]="inherit"),kr&&"set"in kr&&void 0===(Ur=kr.set(Br,Ur,Fr))||(Or[Nr]=Ur)}else return kr&&"get"in kr&&void 0!==(Vr=kr.get(Br,!1,Fr))?Vr:Or[Nr]}},css:function(Br,Nr,Ur,Fr){var zr=qe.camelCase(Nr),Vr,Gr,kr;return Nr=qe.cssProps[zr]||(qe.cssProps[zr]=ge(zr)||zr),kr=qe.cssHooks[Nr]||qe.cssHooks[zr],kr&&"get"in kr&&(Vr=kr.get(Br,!0,Ur)),void 0===Vr&&(Vr=pe(Br,Nr,Fr)),"normal"===Vr&&Nr in Wt&&(Vr=Wt[Nr]),""===Ur||Ur?(Gr=parseFloat(Vr),!0===Ur||isFinite(Gr)?Gr||0:Vr):Vr}}),qe.each(["height","width"],function(Br,Nr){qe.cssHooks[Nr]={get:function(Ur,Fr,Vr){if(Fr)return Ht.test(qe.css(Ur,"display"))&&0===Ur.offsetWidth?zt(Ur,jt,function(){return ye(Ur,Nr,Vr)}):ye(Ur,Nr,Vr)},set:function(Ur,Fr,Vr){var kr=Vr&&kt(Ur),zr=Vr&&he(Ur,Nr,Vr,"border-box"===qe.css(Ur,"boxSizing",!1,kr),kr),Gr;return zr&&(Gr=bt.exec(Fr))&&"px"!==(Gr[3]||"px")&&(Ur.style[Nr]=Fr,Fr=qe.css(Ur,Nr)),fe(Ur,Fr,zr)}}}),qe.cssHooks.marginLeft=ue(je.reliableMarginLeft,function(Br,Nr){if(Nr)return(parseFloat(pe(Br,"marginLeft"))||Br.getBoundingClientRect().left-zt(Br,{marginLeft:0},function(){return Br.getBoundingClientRect().left}))+"px"}),qe.cssHooks.marginRight=ue(je.reliableMarginRight,function(Br,Nr){if(Nr)return zt(Br,{display:"inline-block"},pe,[Br,"marginRight"])}),qe.each({margin:"",padding:"",border:"Width"},function(Br,Nr){qe.cssHooks[Br+Nr]={expand:function(Ur){for(var Fr=0,Vr={},Gr="string"==typeof Ur?Ur.split(" "):[Ur];4>Fr;Fr++)Vr[Br+_t[Fr]+Nr]=Gr[Fr]||Gr[Fr-2]||Gr[0];return Vr}},Vt.test(Br)||(qe.cssHooks[Br+Nr].set=fe)}),qe.fn.extend({css:function(Br,Nr){return mt(this,function(Ur,Fr,Vr){var zr={},Or=0,Gr,kr;if(qe.isArray(Fr)){for(Gr=kt(Ur),kr=Fr.length;Or<kr;Or++)zr[Fr[Or]]=qe.css(Ur,Fr[Or],!1,Gr);return zr}return void 0===Vr?qe.css(Ur,Fr):qe.style(Ur,Fr,Vr)},Br,Nr,1<arguments.length)},show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(Br){return"boolean"==typeof Br?Br?this.show():this.hide():this.each(function(){St(this)?qe(this).show():qe(this).hide()})}}),qe.Tween=ve,ve.prototype={constructor:ve,init:function(Br,Nr,Ur,Fr,Vr,Gr){this.elem=Br,this.prop=Ur,this.easing=Vr||qe.easing._default,this.options=Nr,this.start=this.now=this.cur(),this.end=Fr,this.unit=Gr||(qe.cssNumber[Ur]?"":"px")},cur:function(){var Br=ve.propHooks[this.prop];return Br&&Br.get?Br.get(this):ve.propHooks._default.get(this)},run:function(Br){var Ur=ve.propHooks[this.prop],Nr;return this.pos=this.options.duration?Nr=qe.easing[this.easing](Br,this.options.duration*Br,0,1,this.options.duration):Nr=Br,this.now=(this.end-this.start)*Nr+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Ur&&Ur.set?Ur.set(this):ve.propHooks._default.set(this),this}},ve.prototype.init.prototype=ve.prototype,ve.propHooks={_default:{get:function(Br){var Nr;return 1!==Br.elem.nodeType||null!=Br.elem[Br.prop]&&null==Br.elem.style[Br.prop]?Br.elem[Br.prop]:(Nr=qe.css(Br.elem,Br.prop,""),Nr&&"auto"!==Nr?Nr:0)},set:function(Br){qe.fx.step[Br.prop]?qe.fx.step[Br.prop](Br):1===Br.elem.nodeType&&(null!=Br.elem.style[qe.cssProps[Br.prop]]||qe.cssHooks[Br.prop])?qe.style(Br.elem,Br.prop,Br.now+Br.unit):Br.elem[Br.prop]=Br.now}}},ve.propHooks.scrollTop=ve.propHooks.scrollLeft={set:function(Br){Br.elem.nodeType&&Br.elem.parentNode&&(Br.elem[Br.prop]=Br.now)}},qe.easing={linear:function(Br){return Br},swing:function(Br){return 0.5-_Mathcos2(Br*_MathPI2)/2},_default:"swing"},qe.fx=ve.prototype.init,qe.fx.step={};var Kt=/^(?:toggle|show|hide)$/,Qt=/queueHooks$/,Yt,Zt;qe.Animation=qe.extend(Le,{tweeners:{"*":[function(Br,Nr){var Ur=this.createTween(Br,Nr);return V(Ur.elem,Br,bt.exec(Nr),Ur),Ur}]},tweener:function(Br,Nr){qe.isFunction(Br)?(Nr=Br,Br=["*"]):Br=Br.match(lt);for(var Fr=0,Vr=Br.length,Ur;Fr<Vr;Fr++)Ur=Br[Fr],Le.tweeners[Ur]=Le.tweeners[Ur]||[],Le.tweeners[Ur].unshift(Nr)},prefilters:[function(Br,Nr,Ur){var Wr=this,qr={},Xr=Br.style,Yr=Br.nodeType&&St(Br),Zr=ft.get(Br,"fxshow"),Fr,Vr,Gr,kr,zr,Or,Hr,jr;for(Fr in Ur.queue||(zr=qe._queueHooks(Br,"fx"),null==zr.unqueued&&(zr.unqueued=0,Or=zr.empty.fire,zr.empty.fire=function(){zr.unqueued||Or()}),zr.unqueued++,Wr.always(function(){Wr.always(function(){zr.unqueued--,qe.queue(Br,"fx").length||zr.empty.fire()})})),1===Br.nodeType&&("height"in Nr||"width"in Nr)&&(Ur.overflow=[Xr.overflow,Xr.overflowX,Xr.overflowY],Hr=qe.css(Br,"display"),jr="none"===Hr?ft.get(Br,"olddisplay")||le(Br.nodeName):Hr,"inline"===jr&&"none"===qe.css(Br,"float")&&(Xr.display="inline-block")),Ur.overflow&&(Xr.overflow="hidden",Wr.always(function(){Xr.overflow=Ur.overflow[0],Xr.overflowX=Ur.overflow[1],Xr.overflowY=Ur.overflow[2]})),Nr)if(Vr=Nr[Fr],Kt.exec(Vr)){if(delete Nr[Fr],Gr=Gr||"toggle"===Vr,Vr===(Yr?"hide":"show"))if("show"===Vr&&Zr&&void 0!==Zr[Fr])Yr=!0;else continue;qr[Fr]=Zr&&Zr[Fr]||qe.style(Br,Fr)}else Hr=void 0;if(!qe.isEmptyObject(qr))for(Fr in Zr?"hidden"in Zr&&(Yr=Zr.hidden):Zr=ft.access(Br,"fxshow",{}),Gr&&(Zr.hidden=!Yr),Yr?qe(Br).show():Wr.done(function(){qe(Br).hide()}),Wr.done(function(){for(var Kr in ft.remove(Br,"fxshow"),qr)qe.style(Br,Kr,qr[Kr])}),qr)kr=Me(Yr?Zr[Fr]:0,Fr,Wr),Fr in Zr||(Zr[Fr]=kr.start,Yr&&(kr.end=kr.start,kr.start="width"===Fr||"height"===Fr?1:0));else"inline"===("none"===Hr?le(Br.nodeName):Hr)&&(Xr.display=Hr)}],prefilter:function(Br,Nr){Nr?Le.prefilters.unshift(Br):Le.prefilters.push(Br)}}),qe.speed=function(Br,Nr,Ur){var Fr=Br&&"object"==typeof Br?qe.extend({},Br):{complete:Ur||!Ur&&Nr||qe.isFunction(Br)&&Br,duration:Br,easing:Ur&&Nr||Nr&&!qe.isFunction(Nr)&&Nr};return Fr.duration=qe.fx.off?0:"number"==typeof Fr.duration?Fr.duration:Fr.duration in qe.fx.speeds?qe.fx.speeds[Fr.duration]:qe.fx.speeds._default,(null==Fr.queue||!0===Fr.queue)&&(Fr.queue="fx"),Fr.old=Fr.complete,Fr.complete=function(){qe.isFunction(Fr.old)&&Fr.old.call(this),Fr.queue&&qe.dequeue(this,Fr.queue)},Fr},qe.fn.extend({fadeTo:function(Br,Nr,Ur,Fr){return this.filter(St).css("opacity",0).show().end().animate({opacity:Nr},Br,Ur,Fr)},animate:function(Br,Nr,Ur,Fr){var Vr=qe.isEmptyObject(Br),Gr=qe.speed(Nr,Ur,Fr),kr=function(){var zr=Le(this,qe.extend({},Br),Gr);(Vr||ft.get(this,"finish"))&&zr.stop(!0)};return kr.finish=kr,Vr||!1===Gr.queue?this.each(kr):this.queue(Gr.queue,kr)},stop:function(Br,Nr,Ur){var Fr=function(Vr){var Gr=Vr.stop;delete Vr.stop,Gr(Ur)};return"string"!=typeof Br&&(Ur=Nr,Nr=Br,Br=void 0),Nr&&!1!==Br&&this.queue(Br||"fx",[]),this.each(function(){var Vr=!0,Gr=null!=Br&&Br+"queueHooks",kr=qe.timers,zr=ft.get(this);if(Gr)zr[Gr]&&zr[Gr].stop&&Fr(zr[Gr]);else for(Gr in zr)zr[Gr]&&zr[Gr].stop&&Qt.test(Gr)&&Fr(zr[Gr]);for(Gr=kr.length;Gr--;)kr[Gr].elem===this&&(null==Br||kr[Gr].queue===Br)&&(kr[Gr].anim.stop(Ur),Vr=!1,kr.splice(Gr,1));(Vr||!Ur)&&qe.dequeue(this,Br)})},finish:function(Br){return!1!==Br&&(Br=Br||"fx"),this.each(function(){var Ur=ft.get(this),Fr=Ur[Br+"queue"],Vr=Ur[Br+"queueHooks"],Gr=qe.timers,kr=Fr?Fr.length:0,Nr;for(Ur.finish=!0,qe.queue(this,Br,[]),Vr&&Vr.stop&&Vr.stop.call(this,!0),Nr=Gr.length;Nr--;)Gr[Nr].elem===this&&Gr[Nr].queue===Br&&(Gr[Nr].anim.stop(!0),Gr.splice(Nr,1));for(Nr=0;Nr<kr;Nr++)Fr[Nr]&&Fr[Nr].finish&&Fr[Nr].finish.call(this);delete Ur.finish})}}),qe.each(["toggle","show","hide"],function(Br,Nr){var Ur=qe.fn[Nr];qe.fn[Nr]=function(Fr,Vr,Gr){return null==Fr||"boolean"==typeof Fr?Ur.apply(this,arguments):this.animate(Se(Nr,!0),Fr,Vr,Gr)}}),qe.each({slideDown:Se("show"),slideUp:Se("hide"),slideToggle:Se("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(Br,Nr){qe.fn[Br]=function(Ur,Fr,Vr){return this.animate(Nr,Ur,Fr,Vr)}}),qe.timers=[],qe.fx.tick=function(){var Nr=0,Ur=qe.timers,Br;for(Yt=qe.now();Nr<Ur.length;Nr++)Br=Ur[Nr],Br()||Ur[Nr]!==Br||Ur.splice(Nr--,1);Ur.length||qe.fx.stop(),Yt=void 0},qe.fx.timer=function(Br){qe.timers.push(Br),Br()?qe.fx.start():qe.timers.pop()},qe.fx.interval=13,qe.fx.start=function(){Zt||(Zt=L.setInterval(qe.fx.tick,qe.fx.interval))},qe.fx.stop=function(){L.clearInterval(Zt),Zt=null},qe.fx.speeds={slow:600,fast:200,_default:400},qe.fn.delay=function(Br,Nr){return Br=qe.fx?qe.fx.speeds[Br]||Br:Br,Nr=Nr||"fx",this.queue(Nr,function(Ur,Fr){var Vr=L.setTimeout(Ur,Br);Fr.stop=function(){L.clearTimeout(Vr)}})},function(){var Br=Ue.createElement("input"),Nr=Ue.createElement("select"),Ur=Nr.appendChild(Ue.createElement("option"));Br.type="checkbox",je.checkOn=""!==Br.value,je.optSelected=Ur.selected,Nr.disabled=!0,je.optDisabled=!Ur.disabled,Br=Ue.createElement("input"),Br.value="t",Br.type="radio",je.radioValue="t"===Br.value}();var $t=qe.expr.attrHandle,Jt;qe.fn.extend({attr:function(Br,Nr){return mt(this,qe.attr,Br,Nr,1<arguments.length)},removeAttr:function(Br){return this.each(function(){qe.removeAttr(this,Br)})}}),qe.extend({attr:function(Br,Nr,Ur){var Gr=Br.nodeType,Fr,Vr;if(3!==Gr&&8!==Gr&&2!==Gr)return"undefined"==typeof Br.getAttribute?qe.prop(Br,Nr,Ur):(1===Gr&&qe.isXMLDoc(Br)||(Nr=Nr.toLowerCase(),Vr=qe.attrHooks[Nr]||(qe.expr.match.bool.test(Nr)?Jt:void 0)),void 0!==Ur)?null===Ur?void qe.removeAttr(Br,Nr):Vr&&"set"in Vr&&void 0!==(Fr=Vr.set(Br,Ur,Nr))?Fr:(Br.setAttribute(Nr,Ur+""),Ur):Vr&&"get"in Vr&&null!==(Fr=Vr.get(Br,Nr))?Fr:(Fr=qe.find.attr(Br,Nr),null==Fr?void 0:Fr)},attrHooks:{type:{set:function(Br,Nr){if(!je.radioValue&&"radio"===Nr&&qe.nodeName(Br,"input")){var Ur=Br.value;return Br.setAttribute("type",Nr),Ur&&(Br.value=Ur),Nr}}}},removeAttr:function(Br,Nr){var Vr=0,Gr=Nr&&Nr.match(lt),Ur,Fr;if(Gr&&1===Br.nodeType)for(;Ur=Gr[Vr++];)Fr=qe.propFix[Ur]||Ur,qe.expr.match.bool.test(Ur)&&(Br[Fr]=!1),Br.removeAttribute(Ur)}}),Jt={set:function(Br,Nr,Ur){return!1===Nr?qe.removeAttr(Br,Ur):Br.setAttribute(Ur,Ur),Ur}},qe.each(qe.expr.match.bool.source.match(/\w+/g),function(Br,Nr){var Ur=$t[Nr]||qe.find.attr;$t[Nr]=function(Fr,Vr,Gr){var kr,zr;return Gr||(zr=$t[Vr],$t[Vr]=kr,kr=null==Ur(Fr,Vr,Gr)?null:Vr.toLowerCase(),$t[Vr]=zr),kr}});var tr=/^(?:input|select|textarea|button)$/i,rr=/^(?:a|area)$/i;qe.fn.extend({prop:function(Br,Nr){return mt(this,qe.prop,Br,Nr,1<arguments.length)},removeProp:function(Br){return this.each(function(){delete this[qe.propFix[Br]||Br]})}}),qe.extend({prop:function(Br,Nr,Ur){var Gr=Br.nodeType,Fr,Vr;if(3!==Gr&&8!==Gr&&2!==Gr)return 1===Gr&&qe.isXMLDoc(Br)||(Nr=qe.propFix[Nr]||Nr,Vr=qe.propHooks[Nr]),void 0===Ur?Vr&&"get"in Vr&&null!==(Fr=Vr.get(Br,Nr))?Fr:Br[Nr]:Vr&&"set"in Vr&&void 0!==(Fr=Vr.set(Br,Ur,Nr))?Fr:Br[Nr]=Ur},propHooks:{tabIndex:{get:function(Br){var Nr=qe.find.attr(Br,"tabindex");return Nr?parseInt(Nr,10):tr.test(Br.nodeName)||rr.test(Br.nodeName)&&Br.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),je.optSelected||(qe.propHooks.selected={get:function(Br){var Nr=Br.parentNode;return Nr&&Nr.parentNode&&Nr.parentNode.selectedIndex,null},set:function(Br){var Nr=Br.parentNode;Nr&&(Nr.selectedIndex,Nr.parentNode&&Nr.parentNode.selectedIndex)}}),qe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){qe.propFix[this.toLowerCase()]=this});var or=/[\t\r\n\f]/g;qe.fn.extend({addClass:function(Br){var Or=0,Nr,Ur,Fr,Vr,Gr,kr,zr;if(qe.isFunction(Br))return this.each(function(Hr){qe(this).addClass(Br.call(this,Hr,we(this)))});if("string"==typeof Br&&Br)for(Nr=Br.match(lt)||[];Ur=this[Or++];)if(Vr=we(Ur),Fr=1===Ur.nodeType&&(" "+Vr+" ").replace(or," "),Fr){for(kr=0;Gr=Nr[kr++];)0>Fr.indexOf(" "+Gr+" ")&&(Fr+=Gr+" ");zr=qe.trim(Fr),Vr!==zr&&Ur.setAttribute("class",zr)}return this},removeClass:function(Br){var Or=0,Nr,Ur,Fr,Vr,Gr,kr,zr;if(qe.isFunction(Br))return this.each(function(Hr){qe(this).removeClass(Br.call(this,Hr,we(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof Br&&Br)for(Nr=Br.match(lt)||[];Ur=this[Or++];)if(Vr=we(Ur),Fr=1===Ur.nodeType&&(" "+Vr+" ").replace(or," "),Fr){for(kr=0;Gr=Nr[kr++];)for(;-1<Fr.indexOf(" "+Gr+" ");)Fr=Fr.replace(" "+Gr+" "," ");zr=qe.trim(Fr),Vr!==zr&&Ur.setAttribute("class",zr)}return this},toggleClass:function(Br,Nr){var Ur=typeof Br;return"boolean"==typeof Nr&&"string"==Ur?Nr?this.addClass(Br):this.removeClass(Br):qe.isFunction(Br)?this.each(function(Fr){qe(this).toggleClass(Br.call(this,Fr,we(this),Nr),Nr)}):this.each(function(){var Fr,Vr,Gr,kr;if("string"==Ur)for(Vr=0,Gr=qe(this),kr=Br.match(lt)||[];Fr=kr[Vr++];)Gr.hasClass(Fr)?Gr.removeClass(Fr):Gr.addClass(Fr);else(void 0===Br||"boolean"==Ur)&&(Fr=we(this),Fr&&ft.set(this,"__className__",Fr),this.setAttribute&&this.setAttribute("class",Fr||!1===Br?"":ft.get(this,"__className__")||""))})},hasClass:function(Br){var Fr=0,Nr,Ur;for(Nr=" "+Br+" ";Ur=this[Fr++];)if(1===Ur.nodeType&&-1<(" "+we(Ur)+" ").replace(or," ").indexOf(Nr))return!0;return!1}});var nr=/\r/g,ir=/[\x20\t\r\n\f]+/g;qe.fn.extend({val:function(Br){var Vr=this[0],Nr,Ur,Fr;return arguments.length?(Fr=qe.isFunction(Br),this.each(function(Gr){var kr;1!==this.nodeType||(kr=Fr?Br.call(this,Gr,qe(this).val()):Br,null==kr?kr="":"number"==typeof kr?kr+="":qe.isArray(kr)&&(kr=qe.map(kr,function(zr){return null==zr?"":zr+""})),Nr=qe.valHooks[this.type]||qe.valHooks[this.nodeName.toLowerCase()],(!Nr||!("set"in Nr)||void 0===Nr.set(this,kr,"value"))&&(this.value=kr))})):Vr?(Nr=qe.valHooks[Vr.type]||qe.valHooks[Vr.nodeName.toLowerCase()],Nr&&"get"in Nr&&void 0!==(Ur=Nr.get(Vr,"value")))?Ur:(Ur=Vr.value,"string"==typeof Ur?Ur.replace(nr,""):null==Ur?"":Ur):void 0}}),qe.extend({valHooks:{option:{get:function(Br){var Nr=qe.find.attr(Br,"value");return null==Nr?qe.trim(qe.text(Br)).replace(ir," "):Nr}},select:{get:function(Br){for(var Fr=Br.options,Vr=Br.selectedIndex,Gr="select-one"===Br.type||0>Vr,kr=Gr?null:[],zr=Gr?Vr+1:Fr.length,Or=0>Vr?zr:Gr?Vr:0,Nr,Ur;Or<zr;Or++)if(Ur=Fr[Or],(Ur.selected||Or===Vr)&&(je.optDisabled?!Ur.disabled:null===Ur.getAttribute("disabled"))&&(!Ur.parentNode.disabled||!qe.nodeName(Ur.parentNode,"optgroup"))){if(Nr=qe(Ur).val(),Gr)return Nr;kr.push(Nr)}return kr},set:function(Br,Nr){for(var Vr=Br.options,Gr=qe.makeArray(Nr),kr=Vr.length,Ur,Fr;kr--;)Fr=Vr[kr],(Fr.selected=-1<qe.inArray(qe.valHooks.option.get(Fr),Gr))&&(Ur=!0);return Ur||(Br.selectedIndex=-1),Gr}}}}),qe.each(["radio","checkbox"],function(){qe.valHooks[this]={set:function(Br,Nr){if(qe.isArray(Nr))return Br.checked=-1<qe.inArray(qe(Br).val(),Nr)}},je.checkOn||(qe.valHooks[this].get=function(Br){return null===Br.getAttribute("value")?"on":Br.value})});var sr=/^(?:focusinfocus|focusoutblur)$/;qe.extend(qe.event,{trigger:function(Br,Nr,Ur,Fr){var Wr=[Ur||Ue],qr=He.call(Br,"type")?Br.type:Br,Xr=He.call(Br,"namespace")?Br.namespace.split("."):[],Vr,Gr,kr,zr,Or,Hr,jr;if((Gr=kr=Ur=Ur||Ue,3!==Ur.nodeType&&8!==Ur.nodeType)&&!sr.test(qr+qe.event.triggered)&&(-1<qr.indexOf(".")&&(Xr=qr.split("."),qr=Xr.shift(),Xr.sort()),Or=0>qr.indexOf(":")&&"on"+qr,Br=Br[qe.expando]?Br:new qe.Event(qr,"object"==typeof Br&&Br),Br.isTrigger=Fr?2:3,Br.namespace=Xr.join("."),Br.rnamespace=Br.namespace?new RegExp("(^|\\.)"+Xr.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,Br.result=void 0,Br.target||(Br.target=Ur),Nr=null==Nr?[Br]:qe.makeArray(Nr,[Br]),jr=qe.event.special[qr]||{},Fr||!jr.trigger||!1!==jr.trigger.apply(Ur,Nr))){if(!Fr&&!jr.noBubble&&!qe.isWindow(Ur)){for(zr=jr.delegateType||qr,sr.test(zr+qr)||(Gr=Gr.parentNode);Gr;Gr=Gr.parentNode)Wr.push(Gr),kr=Gr;kr===(Ur.ownerDocument||Ue)&&Wr.push(kr.defaultView||kr.parentWindow||L)}for(Vr=0;(Gr=Wr[Vr++])&&!Br.isPropagationStopped();)Br.type=1<Vr?zr:jr.bindType||qr,Hr=(ft.get(Gr,"events")||{})[Br.type]&&ft.get(Gr,"handle"),Hr&&Hr.apply(Gr,Nr),Hr=Or&&Gr[Or],Hr&&Hr.apply&&gt(Gr)&&(Br.result=Hr.apply(Gr,Nr),!1===Br.result&&Br.preventDefault());return Br.type=qr,Fr||Br.isDefaultPrevented()||jr._default&&!1!==jr._default.apply(Wr.pop(),Nr)||!gt(Ur)||!Or||!qe.isFunction(Ur[qr])||qe.isWindow(Ur)||(kr=Ur[Or],kr&&(Ur[Or]=null),qe.event.triggered=qr,Ur[qr](),qe.event.triggered=void 0,kr&&(Ur[Or]=kr)),Br.result}},simulate:function(Br,Nr,Ur){var Fr=qe.extend(new qe.Event,Ur,{type:Br,isSimulated:!0});qe.event.trigger(Fr,null,Nr)}}),qe.fn.extend({trigger:function(Br,Nr){return this.each(function(){qe.event.trigger(Br,Nr,this)})},triggerHandler:function(Br,Nr){var Ur=this[0];if(Ur)return qe.event.trigger(Br,Nr,Ur,!0)}}),qe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(Br,Nr){qe.fn[Nr]=function(Ur,Fr){return 0<arguments.length?this.on(Nr,null,Ur,Fr):this.trigger(Nr)}}),qe.fn.extend({hover:function(Br,Nr){return this.mouseenter(Br).mouseleave(Nr||Br)}}),je.focusin="onfocusin"in L,je.focusin||qe.each({focus:"focusin",blur:"focusout"},function(Br,Nr){var Ur=function(Fr){qe.event.simulate(Nr,Fr.target,qe.event.fix(Fr))};qe.event.special[Nr]={setup:function(){var Fr=this.ownerDocument||this,Vr=ft.access(Fr,Nr);Vr||Fr.addEventListener(Br,Ur,!0),ft.access(Fr,Nr,(Vr||0)+1)},teardown:function(){var Fr=this.ownerDocument||this,Vr=ft.access(Fr,Nr)-1;Vr?ft.access(Fr,Nr,Vr):(Fr.removeEventListener(Br,Ur,!0),ft.remove(Fr,Nr))}}});var lr=L.location,pr=qe.now(),dr=/\?/;qe.parseJSON=function(Br){return JSON.parse(Br+"")},qe.parseXML=function(Br){var Nr;if(!Br||"string"!=typeof Br)return null;try{Nr=new L.DOMParser().parseFromString(Br,"text/xml")}catch(Ur){Nr=void 0}return(!Nr||Nr.getElementsByTagName("parsererror").length)&&qe.error("Invalid XML: "+Br),Nr};var cr=/#.*$/,ur=/([?&])_=[^&]*/,mr=/^(.*?):[ \t]*([^\r\n]*)$/mg,gr=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,fr=/^(?:GET|HEAD)$/,yr=/^\/\//,xr={},vr={},br="*/".concat("*"),_r=Ue.createElement("a");_r.href=lr.href,qe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:lr.href,type:"GET",isLocal:gr.test(lr.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":br,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":qe.parseJSON,"text xml":qe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(Br,Nr){return Nr?Pe(Pe(Br,qe.ajaxSettings),Nr):Pe(qe.ajaxSettings,Br)},ajaxPrefilter:Ce(xr),ajaxTransport:Ce(vr),ajax:function(Br,Nr){function Ur(ra,aa,oa,na){var ua=aa,ia,sa,la,da,ca;2==$r||($r=2,zr&&L.clearTimeout(zr),Fr=void 0,Gr=na||"",ta.readyState=0<ra?4:0,ia=200<=ra&&300>ra||304===ra,oa&&(da=Re(Wr,ta,oa)),da=De(Wr,da,ta,ia),ia?(Wr.ifModified&&(ca=ta.getResponseHeader("Last-Modified"),ca&&(qe.lastModified[Vr]=ca),ca=ta.getResponseHeader("etag"),ca&&(qe.etag[Vr]=ca)),204===ra||"HEAD"===Wr.type?ua="nocontent":304===ra?ua="notmodified":(ua=da.state,sa=da.data,la=da.error,ia=!la)):(la=ua,(ra||!ua)&&(ua="error",0>ra&&(ra=0))),ta.status=ra,ta.statusText=(aa||ua)+"",ia?Yr.resolveWith(qr,[sa,ua,ta]):Yr.rejectWith(qr,[ta,ua,la]),ta.statusCode(Kr),Kr=void 0,Hr&&Xr.trigger(ia?"ajaxSuccess":"ajaxError",[ta,Wr,ia?sa:la]),Zr.fireWith(qr,[ta,ua]),Hr&&(Xr.trigger("ajaxComplete",[ta,Wr]),! --qe.active&&qe.event.trigger("ajaxStop")))}"object"==typeof Br&&(Nr=Br,Br=void 0),Nr=Nr||{};var Wr=qe.ajaxSetup({},Nr),qr=Wr.context||Wr,Xr=Wr.context&&(qr.nodeType||qr.jquery)?qe(qr):qe.event,Yr=qe.Deferred(),Zr=qe.Callbacks("once memory"),Kr=Wr.statusCode||{},Qr={},Jr={},$r=0,ea="canceled",ta={readyState:0,getResponseHeader:function(ra){var aa;if(2==$r){if(!kr)for(kr={};aa=mr.exec(Gr);)kr[aa[1].toLowerCase()]=aa[2];aa=kr[ra.toLowerCase()]}return null==aa?null:aa},getAllResponseHeaders:function(){return 2==$r?Gr:null},setRequestHeader:function(ra,aa){var oa=ra.toLowerCase();return $r||(ra=Jr[oa]=Jr[oa]||ra,Qr[ra]=aa),this},overrideMimeType:function(ra){return $r||(Wr.mimeType=ra),this},statusCode:function(ra){if(ra)if(2>$r)for(var aa in ra)Kr[aa]=[Kr[aa],ra[aa]];else ta.always(ra[ta.status]);return this},abort:function(ra){var aa=ra||ea;return Fr&&Fr.abort(aa),Ur(0,aa),this}},Fr,Vr,Gr,kr,zr,Or,Hr,jr;if(Yr.promise(ta).complete=Zr.add,ta.success=ta.done,ta.error=ta.fail,Wr.url=((Br||Wr.url||lr.href)+"").replace(cr,"").replace(yr,lr.protocol+"//"),Wr.type=Nr.method||Nr.type||Wr.method||Wr.type,Wr.dataTypes=qe.trim(Wr.dataType||"*").toLowerCase().match(lt)||[""],null==Wr.crossDomain){Or=Ue.createElement("a");try{Or.href=Wr.url,Or.href=Or.href,Wr.crossDomain=_r.protocol+"//"+_r.host!=Or.protocol+"//"+Or.host}catch(ra){Wr.crossDomain=!0}}if(Wr.data&&Wr.processData&&"string"!=typeof Wr.data&&(Wr.data=qe.param(Wr.data,Wr.traditional)),Ae(xr,Wr,Nr,ta),2==$r)return ta;for(jr in Hr=qe.event&&Wr.global,Hr&&0==qe.active++&&qe.event.trigger("ajaxStart"),Wr.type=Wr.type.toUpperCase(),Wr.hasContent=!fr.test(Wr.type),Vr=Wr.url,Wr.hasContent||(Wr.data&&(Vr=Wr.url+=(dr.test(Vr)?"&":"?")+Wr.data,delete Wr.data),!1===Wr.cache&&(Wr.url=ur.test(Vr)?Vr.replace(ur,"$1_="+pr++):Vr+(dr.test(Vr)?"&":"?")+"_="+pr++)),Wr.ifModified&&(qe.lastModified[Vr]&&ta.setRequestHeader("If-Modified-Since",qe.lastModified[Vr]),qe.etag[Vr]&&ta.setRequestHeader("If-None-Match",qe.etag[Vr])),(Wr.data&&Wr.hasContent&&!1!==Wr.contentType||Nr.contentType)&&ta.setRequestHeader("Content-Type",Wr.contentType),ta.setRequestHeader("Accept",Wr.dataTypes[0]&&Wr.accepts[Wr.dataTypes[0]]?Wr.accepts[Wr.dataTypes[0]]+("*"===Wr.dataTypes[0]?"":", "+br+"; q=0.01"):Wr.accepts["*"]),Wr.headers)ta.setRequestHeader(jr,Wr.headers[jr]);if(Wr.beforeSend&&(!1===Wr.beforeSend.call(qr,ta,Wr)||2==$r))return ta.abort();for(jr in ea="abort",{success:1,error:1,complete:1})ta[jr](Wr[jr]);if(Fr=Ae(vr,Wr,Nr,ta),!Fr)Ur(-1,"No Transport");else{if(ta.readyState=1,Hr&&Xr.trigger("ajaxSend",[ta,Wr]),2==$r)return ta;Wr.async&&0<Wr.timeout&&(zr=L.setTimeout(function(){ta.abort("timeout")},Wr.timeout));try{$r=1,Fr.send(Qr,Ur)}catch(ra){if(2>$r)Ur(-1,ra);else throw ra}}return ta},getJSON:function(Br,Nr,Ur){return qe.get(Br,Nr,Ur,"json")},getScript:function(Br,Nr){return qe.get(Br,void 0,Nr,"script")}}),qe.each(["get","post"],function(Br,Nr){qe[Nr]=function(Ur,Fr,Vr,Gr){return qe.isFunction(Fr)&&(Gr=Gr||Vr,Vr=Fr,Fr=void 0),qe.ajax(qe.extend({url:Ur,type:Nr,dataType:Gr,data:Fr,success:Vr},qe.isPlainObject(Ur)&&Ur))}}),qe._evalUrl=function(Br){return qe.ajax({url:Br,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},qe.fn.extend({wrapAll:function(Br){var Nr;return qe.isFunction(Br)?this.each(function(Ur){qe(this).wrapAll(Br.call(this,Ur))}):(this[0]&&(Nr=qe(Br,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&Nr.insertBefore(this[0]),Nr.map(function(){for(var Ur=this;Ur.firstElementChild;)Ur=Ur.firstElementChild;return Ur}).append(this)),this)},wrapInner:function(Br){return qe.isFunction(Br)?this.each(function(Nr){qe(this).wrapInner(Br.call(this,Nr))}):this.each(function(){var Nr=qe(this),Ur=Nr.contents();Ur.length?Ur.wrapAll(Br):Nr.append(Br)})},wrap:function(Br){var Nr=qe.isFunction(Br);return this.each(function(Ur){qe(this).wrapAll(Nr?Br.call(this,Ur):Br)})},unwrap:function(){return this.parent().each(function(){qe.nodeName(this,"body")||qe(this).replaceWith(this.childNodes)}).end()}}),qe.expr.filters.hidden=function(Br){return!qe.expr.filters.visible(Br)},qe.expr.filters.visible=function(Br){return 0<Br.offsetWidth||0<Br.offsetHeight||0<Br.getClientRects().length};var Sr=/%20/g,Mr=/\[\]$/,Tr=/\r?\n/g,Er=/^(?:submit|button|image|reset|file)$/i,Lr=/^(?:input|select|textarea|keygen)/i;qe.param=function(Br,Nr){var Fr=[],Vr=function(Gr,kr){kr=qe.isFunction(kr)?kr():null==kr?"":kr,Fr[Fr.length]=encodeURIComponent(Gr)+"="+encodeURIComponent(kr)},Ur;if(void 0===Nr&&(Nr=qe.ajaxSettings&&qe.ajaxSettings.traditional),qe.isArray(Br)||Br.jquery&&!qe.isPlainObject(Br))qe.each(Br,function(){Vr(this.name,this.value)});else for(Ur in Br)Ie(Ur,Br[Ur],Nr,Vr);return Fr.join("&").replace(Sr,"+")},qe.fn.extend({serialize:function(){return qe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var Br=qe.prop(this,"elements");return Br?qe.makeArray(Br):this}).filter(function(){var Br=this.type;return this.name&&!qe(this).is(":disabled")&&Lr.test(this.nodeName)&&!Er.test(Br)&&(this.checked||!Mt.test(Br))}).map(function(Br,Nr){var Ur=qe(this).val();return null==Ur?null:qe.isArray(Ur)?qe.map(Ur,function(Fr){return{name:Nr.name,value:Fr.replace(Tr,"\r\n")}}):{name:Nr.name,value:Ur.replace(Tr,"\r\n")}}).get()}}),qe.ajaxSettings.xhr=function(){try{return new L.XMLHttpRequest}catch(Br){}};var wr={0:200,1223:204},Cr=qe.ajaxSettings.xhr();je.cors=!!Cr&&"withCredentials"in Cr,je.ajax=Cr=!!Cr,qe.ajaxTransport(function(Br){var Nr,Ur;if(je.cors||Cr&&!Br.crossDomain)return{send:function(Fr,Vr){var kr=Br.xhr(),Gr;if(kr.open(Br.type,Br.url,Br.async,Br.username,Br.password),Br.xhrFields)for(Gr in Br.xhrFields)kr[Gr]=Br.xhrFields[Gr];for(Gr in Br.mimeType&&kr.overrideMimeType&&kr.overrideMimeType(Br.mimeType),Br.crossDomain||Fr["X-Requested-With"]||(Fr["X-Requested-With"]="XMLHttpRequest"),Fr)kr.setRequestHeader(Gr,Fr[Gr]);Nr=function(zr){return function(){Nr&&(Nr=Ur=kr.onload=kr.onerror=kr.onabort=kr.onreadystatechange=null,"abort"===zr?kr.abort():"error"===zr?"number"==typeof kr.status?Vr(kr.status,kr.statusText):Vr(0,"error"):Vr(wr[kr.status]||kr.status,kr.statusText,"text"!==(kr.responseType||"text")||"string"!=typeof kr.responseText?{binary:kr.response}:{text:kr.responseText},kr.getAllResponseHeaders()))}},kr.onload=Nr(),Ur=kr.onerror=Nr("error"),void 0===kr.onabort?kr.onreadystatechange=function(){4===kr.readyState&&L.setTimeout(function(){Nr&&Ur()})}:kr.onabort=Ur,Nr=Nr("abort");try{kr.send(Br.hasContent&&Br.data||null)}catch(zr){if(Nr)throw zr}},abort:function(){Nr&&Nr()}}}),qe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(Br){return qe.globalEval(Br),Br}}}),qe.ajaxPrefilter("script",function(Br){void 0===Br.cache&&(Br.cache=!1),Br.crossDomain&&(Br.type="GET")}),qe.ajaxTransport("script",function(Br){if(Br.crossDomain){var Nr,Ur;return{send:function(Fr,Vr){Nr=qe("<script>").prop({charset:Br.scriptCharset,src:Br.url}).on("load error",Ur=function(Gr){Nr.remove(),Ur=null,Gr&&Vr("error"===Gr.type?404:200,Gr.type)}),Ue.head.appendChild(Nr[0])},abort:function(){Ur&&Ur()}}}});var Ar=[],Pr=/(=)\?(?=&|$)|\?\?/;qe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var Br=Ar.pop()||qe.expando+"_"+pr++;return this[Br]=!0,Br}}),qe.ajaxPrefilter("json jsonp",function(Br,Nr,Ur){var kr=!1!==Br.jsonp&&(Pr.test(Br.url)?"url":"string"==typeof Br.data&&0===(Br.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pr.test(Br.data)&&"data"),Fr,Vr,Gr;if(kr||"jsonp"===Br.dataTypes[0])return Fr=Br.jsonpCallback=qe.isFunction(Br.jsonpCallback)?Br.jsonpCallback():Br.jsonpCallback,kr?Br[kr]=Br[kr].replace(Pr,"$1"+Fr):!1!==Br.jsonp&&(Br.url+=(dr.test(Br.url)?"&":"?")+Br.jsonp+"="+Fr),Br.converters["script json"]=function(){return Gr||qe.error(Fr+" was not called"),Gr[0]},Br.dataTypes[0]="json",Vr=L[Fr],L[Fr]=function(){Gr=arguments},Ur.always(function(){void 0===Vr?qe(L).removeProp(Fr):L[Fr]=Vr,Br[Fr]&&(Br.jsonpCallback=Nr.jsonpCallback,Ar.push(Fr)),Gr&&qe.isFunction(Vr)&&Vr(Gr[0]),Gr=Vr=void 0}),"script"}),qe.parseHTML=function(Br,Nr,Ur){if(!Br||"string"!=typeof Br)return null;"boolean"==typeof Nr&&(Ur=Nr,Nr=!1),Nr=Nr||Ue;var Fr=tt.exec(Br),Vr=!Ur&&[];return Fr?[Nr.createElement(Fr[1])]:(Fr=H([Br],Nr,Vr),Vr&&Vr.length&&qe(Vr).remove(),qe.merge([],Fr.childNodes))};var Rr=qe.fn.load;qe.fn.load=function(Br,Nr,Ur){if("string"!=typeof Br&&Rr)return Rr.apply(this,arguments);var kr=this,zr=Br.indexOf(" "),Fr,Vr,Gr;return-1<zr&&(Fr=qe.trim(Br.slice(zr)),Br=Br.slice(0,zr)),qe.isFunction(Nr)?(Ur=Nr,Nr=void 0):Nr&&"object"==typeof Nr&&(Vr="POST"),0<kr.length&&qe.ajax({url:Br,type:Vr||"GET",dataType:"html",data:Nr}).done(function(Or){Gr=arguments,kr.html(Fr?qe("<div>").append(qe.parseHTML(Or)).find(Fr):Or)}).always(Ur&&function(Or,Hr){kr.each(function(){Ur.apply(this,Gr||[Or.responseText,Hr,Or])})}),this},qe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(Br,Nr){qe.fn[Nr]=function(Ur){return this.on(Nr,Ur)}}),qe.expr.filters.animated=function(Br){return qe.grep(qe.timers,function(Nr){return Br===Nr.elem}).length},qe.offset={setOffset:function(Br,Nr,Ur){var jr=qe.css(Br,"position"),Wr=qe(Br),qr={},Fr,Vr,Gr,kr,zr,Or,Hr;"static"===jr&&(Br.style.position="relative"),zr=Wr.offset(),Gr=qe.css(Br,"top"),Or=qe.css(Br,"left"),Hr=("absolute"===jr||"fixed"===jr)&&-1<(Gr+Or).indexOf("auto"),Hr?(Fr=Wr.position(),kr=Fr.top,Vr=Fr.left):(kr=parseFloat(Gr)||0,Vr=parseFloat(Or)||0),qe.isFunction(Nr)&&(Nr=Nr.call(Br,Ur,qe.extend({},zr))),null!=Nr.top&&(qr.top=Nr.top-zr.top+kr),null!=Nr.left&&(qr.left=Nr.left-zr.left+Vr),"using"in Nr?Nr.using.call(Br,qr):Wr.css(qr)}},qe.fn.extend({offset:function(Br){if(arguments.length)return void 0===Br?this:this.each(function(kr){qe.offset.setOffset(this,Br,kr)});var Fr=this[0],Vr={top:0,left:0},Gr=Fr&&Fr.ownerDocument,Nr,Ur;if(Gr)return(Nr=Gr.documentElement,!qe.contains(Nr,Fr))?Vr:(Vr=Fr.getBoundingClientRect(),Ur=Be(Gr),{top:Vr.top+Ur.pageYOffset-Nr.clientTop,left:Vr.left+Ur.pageXOffset-Nr.clientLeft})},position:function(){if(this[0]){var Ur=this[0],Fr={top:0,left:0},Br,Nr;return"fixed"===qe.css(Ur,"position")?Nr=Ur.getBoundingClientRect():(Br=this.offsetParent(),Nr=this.offset(),!qe.nodeName(Br[0],"html")&&(Fr=Br.offset()),Fr.top+=qe.css(Br[0],"borderTopWidth",!0),Fr.left+=qe.css(Br[0],"borderLeftWidth",!0)),{top:Nr.top-Fr.top-qe.css(Ur,"marginTop",!0),left:Nr.left-Fr.left-qe.css(Ur,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var Br=this.offsetParent;Br&&"static"===qe.css(Br,"position");)Br=Br.offsetParent;return Br||Ot})}}),qe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(Br,Nr){var Ur="pageYOffset"===Nr;qe.fn[Br]=function(Fr){return mt(this,function(Vr,Gr,kr){var zr=Be(Vr);return void 0===kr?zr?zr[Nr]:Vr[Gr]:void(zr?zr.scrollTo(Ur?zr.pageXOffset:kr,Ur?kr:zr.pageYOffset):Vr[Gr]=kr)},Br,Fr,arguments.length)}}),qe.each(["top","left"],function(Br,Nr){qe.cssHooks[Nr]=ue(je.pixelPosition,function(Ur,Fr){if(Fr)return Fr=pe(Ur,Nr),Gt.test(Fr)?qe(Ur).position()[Nr]+"px":Fr})}),qe.each({Height:"height",Width:"width"},function(Br,Nr){qe.each({padding:"inner"+Br,content:Nr,"":"outer"+Br},function(Ur,Fr){qe.fn[Fr]=function(Vr,Gr){var kr=arguments.length&&(Ur||"boolean"!=typeof Vr),zr=Ur||(!0===Vr||!0===Gr?"margin":"border");return mt(this,function(Or,Hr,jr){var Wr;return qe.isWindow(Or)?Or.document.documentElement["client"+Br]:9===Or.nodeType?(Wr=Or.documentElement,_Mathmax(Or.body["scroll"+Br],Wr["scroll"+Br],Or.body["offset"+Br],Wr["offset"+Br],Wr["client"+Br])):void 0===jr?qe.css(Or,Hr,zr):qe.style(Or,Hr,jr,zr)},Nr,kr?Vr:void 0,kr,null)}})}),qe.fn.extend({bind:function(Br,Nr,Ur){return this.on(Br,null,Nr,Ur)},unbind:function(Br,Nr){return this.off(Br,null,Nr)},delegate:function(Br,Nr,Ur,Fr){return this.on(Nr,Br,Ur,Fr)},undelegate:function(Br,Nr,Ur){return 1===arguments.length?this.off(Br,"**"):this.off(Nr,Br||"**",Ur)},size:function(){return this.length}}),qe.fn.andSelf=qe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return qe});var Dr=L.jQuery,Ir=L.$;return qe.noConflict=function(Br){return L.$===qe&&(L.$=Ir),Br&&L.jQuery===qe&&(L.jQuery=Dr),qe},C||(L.jQuery=L.$=qe),qe})},{}],13:[function(S,M){function L(V,G,O){for(var H=-1,W=V.length;++H<W;){var X=V[H],Y=G(X);if(null!=Y&&(Z===void 0?Y===Y&&!P(Y):O(Y,Z)))var Z=Y,K=X}return K}function C(V,G){return V<G}function A(V){return!!V&&"object"==typeof V}function P(V){return"symbol"==typeof V||A(V)&&F.call(V)==I}function R(V){return V}var I="[object Symbol]",U=Object.prototype,F=U.toString;M.exports=function(V){return V&&V.length?L(V,R,C):void 0}},{}],14:[function(S,M){function L(ye,xe,ve,_e){for(var Se=-1,Me=fe(ge((xe-ye)/(ve||1)),0),Te=Array(Me);Me--;)Te[_e?Me:++Se]=ye,ye+=ve;return Te}function A(ye,xe){return xe=null==xe?X:xe,!!xe&&("number"==typeof ye||se.test(ye))&&-1<ye&&0==ye%1&&ye<xe}function P(ye,xe,ve){if(!F(ve))return!1;var _e=typeof xe;return!("number"==_e?!(D(ve)&&A(xe,ve.length)):!("string"==_e&&xe in ve))&&R(ve[xe],ye)}function R(ye,xe){return ye===xe||ye!==ye&&xe!==xe}function D(ye){return null!=ye&&U(ye.length)&&!I(ye)}function I(ye){var xe=F(ye)?ue.call(ye):"";return xe==K||xe==Q}function U(ye){return"number"==typeof ye&&-1<ye&&0==ye%1&&ye<=X}function F(ye){var xe=typeof ye;return!!ye&&("object"==xe||"function"==xe)}function V(ye){return!!ye&&"object"==typeof ye}function G(ye){return"symbol"==typeof ye||V(ye)&&ue.call(ye)==J}function O(ye){if(!ye)return 0===ye?ye:0;if(ye=H(ye),ye===W||ye===-W){var xe=0>ye?-1:1;return xe*Y}return ye===ye?ye:0}function H(ye){if("number"==typeof ye)return ye;if(G(ye))return Z;if(F(ye)){var xe="function"==typeof ye.valueOf?ye.valueOf():ye;ye=F(xe)?xe+"":xe}if("string"!=typeof ye)return 0===ye?ye:+ye;ye=ye.replace(ee,"");var ve=ne.test(ye);return ve||ie.test(ye)?le(ye.slice(2),ve?2:8):oe.test(ye)?Z:+ye}var W=1/0,X=9007199254740991,Y=1.7976931348623157e308,Z=0/0,K="[object Function]",Q="[object GeneratorFunction]",J="[object Symbol]",ee=/^\s+|\s+$/g,oe=/^[-+]0x[0-9a-f]+$/i,ne=/^0b[01]+$/i,ie=/^0o[0-7]+$/i,se=/^(?:0|[1-9]\d*)$/,le=parseInt,pe=Object.prototype,ue=pe.toString,ge=_Mathceil,fe=_Mathmax,he=function(ye){return function(xe,ve,_e){return _e&&"number"!=typeof _e&&P(xe,ve,_e)&&(ve=_e=void 0),xe=O(xe),void 0===ve?(ve=xe,xe=0):ve=O(ve),_e=void 0===_e?xe<ve?1:-1:O(_e),L(xe,ve,_e,ye)}}();M.exports=he},{}],15:[function(S,M){(function(L){function C(fe){if("string"==typeof fe)return fe;if(D(fe))return ue?ue.call(fe):"";var he=fe+"";return"0"==he&&1/fe==-G?"-0":he}function P(fe){var he=typeof fe;return!!fe&&("object"==he||"function"==he)}function R(fe){return!!fe&&"object"==typeof fe}function D(fe){return"symbol"==typeof fe||R(fe)&&ie.call(fe)==W}function I(fe){if(!fe)return 0===fe?fe:0;if(fe=F(fe),fe===G||fe===-G){var he=0>fe?-1:1;return he*O}return fe===fe?fe:0}function U(fe){var he=I(fe),ye=he%1;return he===he?ye?he-ye:he:0}function F(fe){if("number"==typeof fe)return fe;if(D(fe))return H;if(P(fe)){var he="function"==typeof fe.valueOf?fe.valueOf():fe;fe=P(he)?he+"":he}if("string"!=typeof fe)return 0===fe?fe:+fe;fe=fe.replace(X,"");var ye=Z.test(fe);return ye||K.test(fe)?Q(fe.slice(2),ye?2:8):Y.test(fe)?H:+fe}function V(fe){return null==fe?"":C(fe)}var G=1/0,O=1.7976931348623157e308,H=0/0,W="[object Symbol]",X=/^\s+|\s+$/g,Y=/^[-+]0x[0-9a-f]+$/i,Z=/^0b[01]+$/i,K=/^0o[0-7]+$/i,Q=parseInt,J="object"==typeof L&&L&&L.Object===Object&&L,ee="object"==typeof self&&self&&self.Object===Object&&self,oe=J||ee||Function("return this")(),ne=Object.prototype,ie=ne.toString,se=oe.Symbol,pe=se?se.prototype:void 0,ue=pe?pe.toString:void 0,ge=function(fe){var he=Math[fe];return function(ye,xe){if(ye=F(ye),xe=_Mathmin(U(xe),292),xe){var ve=(V(ye)+"e").split("e"),_e=he(ve[0]+"e"+(+ve[1]+xe));return ve=(V(_e)+"e").split("e"),+(ve[0]+"e"+(+ve[1]-xe))}return he(ye)}}("round");M.exports=ge}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],16:[function(S,M){function L(xe,ve){for(var _e=-1,Se=xe?xe.length:0,Me=Array(Se);++_e<Se;)Me[_e]=ve(xe[_e],_e,xe);return Me}function C(xe,ve){for(var _e=-1,Se=Array(xe);++_e<xe;)Se[_e]=ve(_e);return Se}function A(xe,ve){return L(ve,function(_e){return xe[_e]})}function R(xe,ve){var _e=ye(xe)||G(xe)?C(xe.length,String):[],Se=_e.length;for(var Te in xe)(ve||le.call(xe,Te))&&!(!!Se&&("length"==Te||U(Te,Se)))&&_e.push(Te);return _e}function D(xe){if(!F(xe))return fe(xe);var ve=[];for(var _e in Object(xe))le.call(xe,_e)&&"constructor"!=_e&&ve.push(_e);return ve}function I(xe,ve){return xe+ge(he()*(ve-xe+1))}function U(xe,ve){return ve=null==ve?J:ve,!!ve&&("number"==typeof xe||ie.test(xe))&&-1<xe&&0==xe%1&&xe<ve}function F(xe){var ve=xe&&xe.constructor,_e="function"==typeof ve&&ve.prototype||se;return xe===_e}function G(xe){return H(xe)&&le.call(xe,"callee")&&(!ue.call(xe,"callee")||pe.call(xe)==ee)}function O(xe){return null!=xe&&X(xe.length)&&!W(xe)}function H(xe){return Z(xe)&&O(xe)}function W(xe){var ve=Y(xe)?pe.call(xe):"";return ve==oe||ve==ne}function X(xe){return"number"==typeof xe&&-1<xe&&0==xe%1&&xe<=J}function Y(xe){var ve=typeof xe;return!!xe&&("object"==ve||"function"==ve)}function Z(xe){return!!xe&&"object"==typeof xe}function K(xe){return O(xe)?R(xe):D(xe)}function Q(xe){return xe?A(xe,K(xe)):[]}var J=9007199254740991,ee="[object Arguments]",oe="[object Function]",ne="[object GeneratorFunction]",ie=/^(?:0|[1-9]\d*)$/,se=Object.prototype,le=se.hasOwnProperty,pe=se.toString,ue=se.propertyIsEnumerable,ge=_Mathfloor,fe=function(xe,ve){return function(_e){return xe(ve(_e))}}(Object.keys,Object),he=Math.random,ye=Array.isArray;M.exports=function(xe){var ve=O(xe)?xe:Q(xe),_e=ve.length;return 0<_e?ve[I(0,_e-1)]:void 0}},{}],17:[function(S,M){function L(C,A){this.minValue=C,this.maxValue=A}L.prototype.getRange=function(){return this.maxValue-this.minValue},L.prototype.linearToLogarithmic=function(C){var A=_Mathround(_Mathpow(this.getRange()+1,C)+this.minValue-1);return A<this.minValue?A=this.minValue:A>this.maxValue&&(A=this.maxValue),A},L.prototype.logarithmicToLinear=function(C){var A=C-this.minValue+1;return 0>=A?0:C>=this.maxValue?1:_Mathlog(A)/_Mathlog(this.getRange()+1)},M.exports=L},{}],18:[function(S,M){function L(V){if(V+="",!(1e4<V.length)){var G=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(V);if(G){var O=parseFloat(G[1]),H=(G[2]||"ms").toLowerCase();return"years"===H||"year"===H||"yrs"===H||"yr"===H||"y"===H?O*F:"days"===H||"day"===H||"d"===H?O*U:"hours"===H||"hour"===H||"hrs"===H||"hr"===H||"h"===H?O*I:"minutes"===H||"minute"===H||"mins"===H||"min"===H||"m"===H?O*D:"seconds"===H||"second"===H||"secs"===H||"sec"===H||"s"===H?O*R:"milliseconds"===H||"millisecond"===H||"msecs"===H||"msec"===H||"ms"===H?O:void 0}}}function C(V){return V>=U?_Mathround(V/U)+"d":V>=I?_Mathround(V/I)+"h":V>=D?_Mathround(V/D)+"m":V>=R?_Mathround(V/R)+"s":V+"ms"}function A(V){return P(V,U,"day")||P(V,I,"hour")||P(V,D,"minute")||P(V,R,"second")||V+" ms"}function P(V,G,O){return V<G?void 0:V<1.5*G?_Mathfloor(V/G)+" "+O:_Mathceil(V/G)+" "+O+"s"}var R=1e3,D=60*R,I=60*D,U=24*I,F=365.25*U;M.exports=function(V,G){G=G||{};var O=typeof V;if("string"==O&&0<V.length)return L(V);if("number"==O&&!1===isNaN(V))return G.long?A(V):C(V);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(V))}},{}],19:[function(S,M){(function(L){(function(){var C,A,P;"undefined"!=typeof performance&&null!==performance&&performance.now?M.exports=function(){return performance.now()}:"undefined"!=typeof L&&null!==L&&L.hrtime?(M.exports=function(){return(C()-P)/1e6},A=L.hrtime,C=function(){var R;return R=A(),1e9*R[0]+R[1]},P=C()):Date.now?(M.exports=function(){return Date.now()-P},P=Date.now()):(M.exports=function(){return new Date().getTime()-P},P=new Date().getTime())}).call(this)}).call(this,S("_process"))},{_process:20}],20:[function(S,M){function L(){throw new Error("setTimeout has not been defined")}function C(){throw new Error("clearTimeout has not been defined")}function A(Y){if(V===setTimeout)return setTimeout(Y,0);if((V===L||!V)&&setTimeout)return V=setTimeout,setTimeout(Y,0);try{return V(Y,0)}catch(Z){try{return V.call(null,Y,0)}catch(K){return V.call(this,Y,0)}}}function P(Y){if(G===clearTimeout)return clearTimeout(Y);if((G===C||!G)&&clearTimeout)return G=clearTimeout,clearTimeout(Y);try{return G(Y)}catch(Z){try{return G.call(null,Y)}catch(K){return G.call(this,Y)}}}function R(){H&&W&&(H=!1,W.length?O=W.concat(O):X=-1,O.length&&D())}function D(){if(!H){var Y=A(R);H=!0;for(var Z=O.length;Z;){for(W=O,O=[];++X<Z;)W&&W[X].run();X=-1,Z=O.length}W=null,H=!1,P(Y)}}function I(Y,Z){this.fun=Y,this.array=Z}function U(){}var F=M.exports={},V,G;(function(){try{V="function"==typeof setTimeout?setTimeout:L}catch(Y){V=L}try{G="function"==typeof clearTimeout?clearTimeout:C}catch(Y){G=C}})();var O=[],H=!1,W,X=-1;F.nextTick=function(Y){var Z=Array(arguments.length-1);if(1<arguments.length)for(var K=1;K<arguments.length;K++)Z[K-1]=arguments[K];O.push(new I(Y,Z)),1!==O.length||H||A(D)},I.prototype.run=function(){this.fun.apply(null,this.array)},F.title="browser",F.browser=!0,F.env={},F.argv=[],F.version="",F.versions={},F.on=U,F.addListener=U,F.once=U,F.off=U,F.removeListener=U,F.removeAllListeners=U,F.emit=U,F.binding=function(){throw new Error("process.binding is not supported")},F.cwd=function(){return"/"},F.chdir=function(){throw new Error("process.chdir is not supported")},F.umask=function(){return 0}},{}],21:[function(S,M){function L(D){return this instanceof L?void(this.running=!1,this.last=P(),this._frame=0,this._tick=this.tick.bind(this),D&&this.on("tick",D)):new L(D)}var C=S("inherits"),A=S("events").EventEmitter,P=S("right-now"),R=S("raf");M.exports=L,C(L,A),L.prototype.start=function(){if(!this.running)return this.running=!0,this.last=P(),this._frame=R(this._tick),this},L.prototype.stop=function(){return this.running=!1,0!==this._frame&&R.cancel(this._frame),this._frame=0,this},L.prototype.tick=function(){this._frame=R(this._tick);var D=P(),I=D-this.last;this.emit("tick",I),this.last=D}},{events:9,inherits:11,raf:22,"right-now":23}],22:[function(S,M){(function(L){for(var C=S("performance-now"),A="undefined"==typeof window?L:window,P=["moz","webkit"],R="AnimationFrame",D=A["request"+R],I=A["cancel"+R]||A["cancelRequest"+R],U=0;!D&&U<P.length;U++)D=A[P[U]+"Request"+R],I=A[P[U]+"Cancel"+R]||A[P[U]+"CancelRequest"+R];if(!D||!I){var F=0,V=0,G=[];D=function(H){if(0===G.length){var W=C(),X=_Mathmax(0,1e3/60-(W-F));F=X+W,setTimeout(function(){var Y=G.slice(0);G.length=0;for(var Z=0;Z<Y.length;Z++)if(!Y[Z].cancelled)try{Y[Z].callback(F)}catch(K){setTimeout(function(){throw K},0)}},_Mathround(X))}return G.push({handle:++V,callback:H,cancelled:!1}),V},I=function(H){for(var W=0;W<G.length;W++)G[W].handle===H&&(G[W].cancelled=!0)}}M.exports=function(H){return D.call(A,H)},M.exports.cancel=function(){I.apply(A,arguments)},M.exports.polyfill=function(){A.requestAnimationFrame=D,A.cancelAnimationFrame=I}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"performance-now":19}],23:[function(S,M){(function(L){M.exports=L.performance&&L.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],24:[function(S,M){"use strict";function L(A,P){P=(P||0)%A.length,0>P&&(P+=A.length);var R=A.splice(0,P);return A.push.apply(A,R),A}M.exports=L,M.exports.all=function(A){var P=A.slice(),R=[],D;for(D=0;D<P.length;D++)R.push(P.slice()),L(P,1);return R}},{}],25:[function(S,M){(function(L){var C=S("debug")("scale-number-range");M.exports=function(P,R,D,I,U){if(L.env.SCALE_THROW_OOB_ERRORS){if(P<R)throw C("ERROR OOB - scale(%d, %d, %d, %d, %d)",P,R,D,I,U),new Error("number is less than oldMin");if(P>D)throw C("ERROR OOB - scale(%d, %d, %d, %d, %d)",P,R,D,I,U),new Error("number is greater than oldMax")}return(U-I)*(P-R)/(D-R)+I}}).call(this,S("_process"))},{_process:20,debug:7}],26:[function(S,M){M.exports=function(L,C,A){A=A||function(){return{width:window.innerWidth,height:window.innerHeight}};var P=function(){var R=A();L.setSize(R.width,R.height),C.aspect=R.width/R.height,C.updateProjectionMatrix()};return window.addEventListener("resize",P,!1),{trigger:function(){P()},destroy:function(){window.removeEventListener("resize",P)}}}},{}],27:[function(S,M,E){var L=L||{},C={REVISION:"76"};"function"==typeof define&&define.amd?define("three",C):"undefined"!=typeof E&&"undefined"!=typeof M&&(M.exports=C),_NumberEPSILON===void 0&&(_NumberEPSILON=2.220446049250313e-16),_Mathsign===void 0&&(_Mathsign=function(A){return 0>A?-1:0<A?1:+A}),Function.prototype.name===void 0&&Object.defineProperty!==void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(A){"use strict";if(A===void 0||null===A)throw new TypeError("Cannot convert first argument to object");for(var P=Object(A),R=1,D=arguments.length,I;R!==D;++R)if(I=arguments[R],void 0!==I&&null!==I){I=Object(I);for(var U=Object.keys(I),F=0,V=U.length;F!==V;++F){var G=U[F],O=Object.getOwnPropertyDescriptor(I,G);void 0!==O&&O.enumerable&&(P[G]=I[G])}}return P}}),C.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},C.CullFaceNone=0,C.CullFaceBack=1,C.CullFaceFront=2,C.CullFaceFrontBack=3,C.FrontFaceDirectionCW=0,C.FrontFaceDirectionCCW=1,C.BasicShadowMap=0,C.PCFShadowMap=1,C.PCFSoftShadowMap=2,C.FrontSide=0,C.BackSide=1,C.DoubleSide=2,C.FlatShading=1,C.SmoothShading=2,C.NoColors=0,C.FaceColors=1,C.VertexColors=2,C.NoBlending=0,C.NormalBlending=1,C.AdditiveBlending=2,C.SubtractiveBlending=3,C.MultiplyBlending=4,C.CustomBlending=5,C.AddEquation=100,C.SubtractEquation=101,C.ReverseSubtractEquation=102,C.MinEquation=103,C.MaxEquation=104,C.ZeroFactor=200,C.OneFactor=201,C.SrcColorFactor=202,C.OneMinusSrcColorFactor=203,C.SrcAlphaFactor=204,C.OneMinusSrcAlphaFactor=205,C.DstAlphaFactor=206,C.OneMinusDstAlphaFactor=207,C.DstColorFactor=208,C.OneMinusDstColorFactor=209,C.SrcAlphaSaturateFactor=210,C.NeverDepth=0,C.AlwaysDepth=1,C.LessDepth=2,C.LessEqualDepth=3,C.EqualDepth=4,C.GreaterEqualDepth=5,C.GreaterDepth=6,C.NotEqualDepth=7,C.MultiplyOperation=0,C.MixOperation=1,C.AddOperation=2,C.NoToneMapping=0,C.LinearToneMapping=1,C.ReinhardToneMapping=2,C.Uncharted2ToneMapping=3,C.CineonToneMapping=4,C.UVMapping=300,C.CubeReflectionMapping=301,C.CubeRefractionMapping=302,C.EquirectangularReflectionMapping=303,C.EquirectangularRefractionMapping=304,C.SphericalReflectionMapping=305,C.CubeUVReflectionMapping=306,C.CubeUVRefractionMapping=307,C.RepeatWrapping=1e3,C.ClampToEdgeWrapping=1001,C.MirroredRepeatWrapping=1002,C.NearestFilter=1003,C.NearestMipMapNearestFilter=1004,C.NearestMipMapLinearFilter=1005,C.LinearFilter=1006,C.LinearMipMapNearestFilter=1007,C.LinearMipMapLinearFilter=1008,C.UnsignedByteType=1009,C.ByteType=1010,C.ShortType=1011,C.UnsignedShortType=1012,C.IntType=1013,C.UnsignedIntType=1014,C.FloatType=1015,C.HalfFloatType=1025,C.UnsignedShort4444Type=1016,C.UnsignedShort5551Type=1017,C.UnsignedShort565Type=1018,C.AlphaFormat=1019,C.RGBFormat=1020,C.RGBAFormat=1021,C.LuminanceFormat=1022,C.LuminanceAlphaFormat=1023,C.RGBEFormat=C.RGBAFormat,C.DepthFormat=1026,C.RGB_S3TC_DXT1_Format=2001,C.RGBA_S3TC_DXT1_Format=2002,C.RGBA_S3TC_DXT3_Format=2003,C.RGBA_S3TC_DXT5_Format=2004,C.RGB_PVRTC_4BPPV1_Format=2100,C.RGB_PVRTC_2BPPV1_Format=2101,C.RGBA_PVRTC_4BPPV1_Format=2102,C.RGBA_PVRTC_2BPPV1_Format=2103,C.RGB_ETC1_Format=2151,C.LoopOnce=2200,C.LoopRepeat=2201,C.LoopPingPong=2202,C.InterpolateDiscrete=2300,C.InterpolateLinear=2301,C.InterpolateSmooth=2302,C.ZeroCurvatureEnding=2400,C.ZeroSlopeEnding=2401,C.WrapAroundEnding=2402,C.TrianglesDrawMode=0,C.TriangleStripDrawMode=1,C.TriangleFanDrawMode=2,C.LinearEncoding=3e3,C.sRGBEncoding=3001,C.GammaEncoding=3007,C.RGBEEncoding=3002,C.LogLuvEncoding=3003,C.RGBM7Encoding=3004,C.RGBM16Encoding=3005,C.RGBDEncoding=3006,C.BasicDepthPacking=3200,C.RGBADepthPacking=3201,C.Color=function(A){return 3===arguments.length?this.fromArray(arguments):this.set(A)},C.Color.prototype={constructor:C.Color,r:1,g:1,b:1,set:function(A){return A instanceof C.Color?this.copy(A):"number"==typeof A?this.setHex(A):"string"==typeof A&&this.setStyle(A),this},setScalar:function(A){this.r=A,this.g=A,this.b=A},setHex:function(A){return A=_Mathfloor(A),this.r=(255&A>>16)/255,this.g=(255&A>>8)/255,this.b=(255&A)/255,this},setRGB:function(A,P,R){return this.r=A,this.g=P,this.b=R,this},setHSL:function(){function A(P,R,D){return 0>D&&(D+=1),1<D&&(D-=1),D<1/6?P+6*(R-P)*D:D<1/2?R:D<2/3?P+6*(R-P)*(2/3-D):P}return function(P,R,D){if(P=C.Math.euclideanModulo(P,1),R=C.Math.clamp(R,0,1),D=C.Math.clamp(D,0,1),0===R)this.r=this.g=this.b=D;else{var I=0.5>=D?D*(1+R):D+R-D*R,U=2*D-I;this.r=A(U,I,P+1/3),this.g=A(U,I,P),this.b=A(U,I,P-1/3)}return this}}(),setStyle:function(A){function P(W){void 0===W||1>parseFloat(W)&&console.warn("THREE.Color: Alpha component of "+A+" will be ignored.")}var R;if(R=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(A)){var D,I=R[1],U=R[2];switch(I){case"rgb":case"rgba":if(D=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(U))return this.r=_Mathmin(255,parseInt(D[1],10))/255,this.g=_Mathmin(255,parseInt(D[2],10))/255,this.b=_Mathmin(255,parseInt(D[3],10))/255,P(D[5]),this;if(D=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(U))return this.r=_Mathmin(100,parseInt(D[1],10))/100,this.g=_Mathmin(100,parseInt(D[2],10))/100,this.b=_Mathmin(100,parseInt(D[3],10))/100,P(D[5]),this;break;case"hsl":case"hsla":if(D=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(U)){var F=parseFloat(D[1])/360,V=parseInt(D[2],10)/100,G=parseInt(D[3],10)/100;return P(D[5]),this.setHSL(F,V,G)}}}else if(R=/^\#([A-Fa-f0-9]+)$/.exec(A)){var O=R[1],H=O.length;if(3===H)return this.r=parseInt(O.charAt(0)+O.charAt(0),16)/255,this.g=parseInt(O.charAt(1)+O.charAt(1),16)/255,this.b=parseInt(O.charAt(2)+O.charAt(2),16)/255,this;if(6===H)return this.r=parseInt(O.charAt(0)+O.charAt(1),16)/255,this.g=parseInt(O.charAt(2)+O.charAt(3),16)/255,this.b=parseInt(O.charAt(4)+O.charAt(5),16)/255,this}if(A&&0<A.length){var O=C.ColorKeywords[A];void 0===O?console.warn("THREE.Color: Unknown color "+A):this.setHex(O)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(A){return this.r=A.r,this.g=A.g,this.b=A.b,this},copyGammaToLinear:function(A,P){return void 0===P&&(P=2),this.r=_Mathpow(A.r,P),this.g=_Mathpow(A.g,P),this.b=_Mathpow(A.b,P),this},copyLinearToGamma:function(A,P){void 0===P&&(P=2);var R=0<P?1/P:1;return this.r=_Mathpow(A.r,R),this.g=_Mathpow(A.g,R),this.b=_Mathpow(A.b,R),this},convertGammaToLinear:function(){var A=this.r,P=this.g,R=this.b;return this.r=A*A,this.g=P*P,this.b=R*R,this},convertLinearToGamma:function(){return this.r=_Mathsqrt(this.r),this.g=_Mathsqrt(this.g),this.b=_Mathsqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(A){var P=A||{h:0,s:0,l:0},R=this.r,D=this.g,I=this.b,U=_Mathmax(R,D,I),F=_Mathmin(R,D,I),O=(F+U)/2,V,G;if(F===U)V=0,G=0;else{var H=U-F;G=0.5>=O?H/(U+F):H/(2-U-F),U===R?V=(D-I)/H+(D<I?6:0):U===D?V=(I-R)/H+2:U===I?V=(R-D)/H+4:void 0,V/=6}return P.h=V,P.s=G,P.l=O,P},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(A,P,R){var D=this.getHSL();return D.h+=A,D.s+=P,D.l+=R,this.setHSL(D.h,D.s,D.l),this},add:function(A){return this.r+=A.r,this.g+=A.g,this.b+=A.b,this},addColors:function(A,P){return this.r=A.r+P.r,this.g=A.g+P.g,this.b=A.b+P.b,this},addScalar:function(A){return this.r+=A,this.g+=A,this.b+=A,this},multiply:function(A){return this.r*=A.r,this.g*=A.g,this.b*=A.b,this},multiplyScalar:function(A){return this.r*=A,this.g*=A,this.b*=A,this},lerp:function(A,P){return this.r+=(A.r-this.r)*P,this.g+=(A.g-this.g)*P,this.b+=(A.b-this.b)*P,this},equals:function(A){return A.r===this.r&&A.g===this.g&&A.b===this.b},fromArray:function(A,P){return void 0===P&&(P=0),this.r=A[P],this.g=A[P+1],this.b=A[P+2],this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this.r,A[P+1]=this.g,A[P+2]=this.b,A}},C.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},C.Quaternion=function(A,P,R,D){this._x=A||0,this._y=P||0,this._z=R||0,this._w=D===void 0?1:D},C.Quaternion.prototype={constructor:C.Quaternion,get x(){return this._x},set x(A){this._x=A,this.onChangeCallback()},get y(){return this._y},set y(A){this._y=A,this.onChangeCallback()},get z(){return this._z},set z(A){this._z=A,this.onChangeCallback()},get w(){return this._w},set w(A){this._w=A,this.onChangeCallback()},set:function(A,P,R,D){return this._x=A,this._y=P,this._z=R,this._w=D,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(A){return this._x=A.x,this._y=A.y,this._z=A.z,this._w=A.w,this.onChangeCallback(),this},setFromEuler:function(A,P){if(!1==A instanceof C.Euler)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var R=_Mathcos2(A._x/2),D=_Mathcos2(A._y/2),I=_Mathcos2(A._z/2),U=_Mathsin2(A._x/2),F=_Mathsin2(A._y/2),V=_Mathsin2(A._z/2),G=A.order;return"XYZ"===G?(this._x=U*D*I+R*F*V,this._y=R*F*I-U*D*V,this._z=R*D*V+U*F*I,this._w=R*D*I-U*F*V):"YXZ"===G?(this._x=U*D*I+R*F*V,this._y=R*F*I-U*D*V,this._z=R*D*V-U*F*I,this._w=R*D*I+U*F*V):"ZXY"===G?(this._x=U*D*I-R*F*V,this._y=R*F*I+U*D*V,this._z=R*D*V+U*F*I,this._w=R*D*I-U*F*V):"ZYX"===G?(this._x=U*D*I-R*F*V,this._y=R*F*I+U*D*V,this._z=R*D*V-U*F*I,this._w=R*D*I+U*F*V):"YZX"===G?(this._x=U*D*I+R*F*V,this._y=R*F*I+U*D*V,this._z=R*D*V-U*F*I,this._w=R*D*I-U*F*V):"XZY"===G&&(this._x=U*D*I-R*F*V,this._y=R*F*I-U*D*V,this._z=R*D*V+U*F*I,this._w=R*D*I+U*F*V),!1!==P&&this.onChangeCallback(),this},setFromAxisAngle:function(A,P){var R=P/2,D=_Mathsin2(R);return this._x=A.x*D,this._y=A.y*D,this._z=A.z*D,this._w=_Mathcos2(R),this.onChangeCallback(),this},setFromRotationMatrix:function(A){var P=A.elements,R=P[0],D=P[4],I=P[8],U=P[1],F=P[5],V=P[9],G=P[2],O=P[6],H=P[10],W=R+F+H,X;return 0<W?(X=0.5/_Mathsqrt(W+1),this._w=0.25/X,this._x=(O-V)*X,this._y=(I-G)*X,this._z=(U-D)*X):R>F&&R>H?(X=2*_Mathsqrt(1+R-F-H),this._w=(O-V)/X,this._x=0.25*X,this._y=(D+U)/X,this._z=(I+G)/X):F>H?(X=2*_Mathsqrt(1+F-R-H),this._w=(I-G)/X,this._x=(D+U)/X,this._y=0.25*X,this._z=(V+O)/X):(X=2*_Mathsqrt(1+H-R-F),this._w=(U-D)/X,this._x=(I+G)/X,this._y=(V+O)/X,this._z=0.25*X),this.onChangeCallback(),this},setFromUnitVectors:function(){var A,P;return function(D,I){return void 0==A&&(A=new C.Vector3),P=D.dot(I)+1,P<1e-6?(P=0,_Mathabs(D.x)>_Mathabs(D.z)?A.set(-D.y,D.x,0):A.set(0,-D.z,D.y)):A.crossVectors(D,I),this._x=A.x,this._y=A.y,this._z=A.z,this._w=P,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(A){return this._x*A._x+this._y*A._y+this._z*A._z+this._w*A._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return _Mathsqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var A=this.length();return 0===A?(this._x=0,this._y=0,this._z=0,this._w=1):(A=1/A,this._x*=A,this._y*=A,this._z*=A,this._w*=A),this.onChangeCallback(),this},multiply:function(A,P){return void 0===P?this.multiplyQuaternions(this,A):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(A,P))},multiplyQuaternions:function(A,P){var R=A._x,D=A._y,I=A._z,U=A._w,F=P._x,V=P._y,G=P._z,O=P._w;return this._x=R*O+U*F+D*G-I*V,this._y=D*O+U*V+I*F-R*G,this._z=I*O+U*G+R*V-D*F,this._w=U*O-R*F-D*V-I*G,this.onChangeCallback(),this},slerp:function(A,P){if(0===P)return this;if(1===P)return this.copy(A);var R=this._x,D=this._y,I=this._z,U=this._w,F=U*A._w+R*A._x+D*A._y+I*A._z;if(0>F?(this._w=-A._w,this._x=-A._x,this._y=-A._y,this._z=-A._z,F=-F):this.copy(A),1<=F)return this._w=U,this._x=R,this._y=D,this._z=I,this;var V=_Mathsqrt(1-F*F);if(1e-3>_Mathabs(V))return this._w=0.5*(U+this._w),this._x=0.5*(R+this._x),this._y=0.5*(D+this._y),this._z=0.5*(I+this._z),this;var G=_Mathatan(V,F),O=_Mathsin2((1-P)*G)/V,H=_Mathsin2(P*G)/V;return this._w=U*O+this._w*H,this._x=R*O+this._x*H,this._y=D*O+this._y*H,this._z=I*O+this._z*H,this.onChangeCallback(),this},equals:function(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._w===this._w},fromArray:function(A,P){return void 0===P&&(P=0),this._x=A[P],this._y=A[P+1],this._z=A[P+2],this._w=A[P+3],this.onChangeCallback(),this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this._x,A[P+1]=this._y,A[P+2]=this._z,A[P+3]=this._w,A},onChange:function(A){return this.onChangeCallback=A,this},onChangeCallback:function(){}},Object.assign(C.Quaternion,{slerp:function(A,P,R,D){return R.copy(A).slerp(P,D)},slerpFlat:function(A,P,R,D,I,U,F){var V=R[D+0],G=R[D+1],O=R[D+2],H=R[D+3],W=I[U+0],X=I[U+1],Y=I[U+2],Z=I[U+3];if(H!==Z||V!==W||G!==X||O!==Y){var K=1-F,Q=V*W+G*X+O*Y+H*Z,J=0<=Q?1:-1,ee=1-Q*Q;if(ee>_NumberEPSILON){var oe=_Mathsqrt(ee),ne=_Mathatan(oe,Q*J);K=_Mathsin2(K*ne)/oe,F=_Mathsin2(F*ne)/oe}var ie=F*J;if(V=V*K+W*ie,G=G*K+X*ie,O=O*K+Y*ie,H=H*K+Z*ie,K==1-F){var se=1/_Mathsqrt(V*V+G*G+O*O+H*H);V*=se,G*=se,O*=se,H*=se}}A[P]=V,A[P+1]=G,A[P+2]=O,A[P+3]=H}}),C.Vector2=function(A,P){this.x=A||0,this.y=P||0},C.Vector2.prototype={constructor:C.Vector2,get width(){return this.x},set width(A){this.x=A},get height(){return this.y},set height(A){this.y=A},set:function(A,P){return this.x=A,this.y=P,this},setScalar:function(A){return this.x=A,this.y=A,this},setX:function(A){return this.x=A,this},setY:function(A){return this.y=A,this},setComponent:function(A,P){switch(A){case 0:this.x=P;break;case 1:this.y=P;break;default:throw new Error("index is out of range: "+A);}},getComponent:function(A){switch(A){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+A);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(A){return this.x=A.x,this.y=A.y,this},add:function(A,P){return void 0===P?(this.x+=A.x,this.y+=A.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(A,P))},addScalar:function(A){return this.x+=A,this.y+=A,this},addVectors:function(A,P){return this.x=A.x+P.x,this.y=A.y+P.y,this},addScaledVector:function(A,P){return this.x+=A.x*P,this.y+=A.y*P,this},sub:function(A,P){return void 0===P?(this.x-=A.x,this.y-=A.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(A,P))},subScalar:function(A){return this.x-=A,this.y-=A,this},subVectors:function(A,P){return this.x=A.x-P.x,this.y=A.y-P.y,this},multiply:function(A){return this.x*=A.x,this.y*=A.y,this},multiplyScalar:function(A){return isFinite(A)?(this.x*=A,this.y*=A):(this.x=0,this.y=0),this},divide:function(A){return this.x/=A.x,this.y/=A.y,this},divideScalar:function(A){return this.multiplyScalar(1/A)},min:function(A){return this.x=_Mathmin(this.x,A.x),this.y=_Mathmin(this.y,A.y),this},max:function(A){return this.x=_Mathmax(this.x,A.x),this.y=_Mathmax(this.y,A.y),this},clamp:function(A,P){return this.x=_Mathmax(A.x,_Mathmin(P.x,this.x)),this.y=_Mathmax(A.y,_Mathmin(P.y,this.y)),this},clampScalar:function(){var A,P;return function(D,I){return void 0==A&&(A=new C.Vector2,P=new C.Vector2),A.set(D,D),P.set(I,I),this.clamp(A,P)}}(),clampLength:function(A,P){var R=this.length();return this.multiplyScalar(_Mathmax(A,_Mathmin(P,R))/R),this},floor:function(){return this.x=_Mathfloor(this.x),this.y=_Mathfloor(this.y),this},ceil:function(){return this.x=_Mathceil(this.x),this.y=_Mathceil(this.y),this},round:function(){return this.x=_Mathround(this.x),this.y=_Mathround(this.y),this},roundToZero:function(){return this.x=0>this.x?_Mathceil(this.x):_Mathfloor(this.x),this.y=0>this.y?_Mathceil(this.y):_Mathfloor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(A){return this.x*A.x+this.y*A.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return _Mathsqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return _Mathabs(this.x)+_Mathabs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var A=_Mathatan(this.y,this.x);return 0>A&&(A+=2*_MathPI2),A},distanceTo:function(A){return _Mathsqrt(this.distanceToSquared(A))},distanceToSquared:function(A){var P=this.x-A.x,R=this.y-A.y;return P*P+R*R},setLength:function(A){return this.multiplyScalar(A/this.length())},lerp:function(A,P){return this.x+=(A.x-this.x)*P,this.y+=(A.y-this.y)*P,this},lerpVectors:function(A,P,R){return this.subVectors(P,A).multiplyScalar(R).add(A),this},equals:function(A){return A.x===this.x&&A.y===this.y},fromArray:function(A,P){return void 0===P&&(P=0),this.x=A[P],this.y=A[P+1],this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this.x,A[P+1]=this.y,A},fromAttribute:function(A,P,R){return void 0===R&&(R=0),P=P*A.itemSize+R,this.x=A.array[P],this.y=A.array[P+1],this},rotateAround:function(A,P){var R=_Mathcos2(P),D=_Mathsin2(P),I=this.x-A.x,U=this.y-A.y;return this.x=I*R-U*D+A.x,this.y=I*D+U*R+A.y,this}},C.Vector3=function(A,P,R){this.x=A||0,this.y=P||0,this.z=R||0},C.Vector3.prototype={constructor:C.Vector3,set:function(A,P,R){return this.x=A,this.y=P,this.z=R,this},setScalar:function(A){return this.x=A,this.y=A,this.z=A,this},setX:function(A){return this.x=A,this},setY:function(A){return this.y=A,this},setZ:function(A){return this.z=A,this},setComponent:function(A,P){switch(A){case 0:this.x=P;break;case 1:this.y=P;break;case 2:this.z=P;break;default:throw new Error("index is out of range: "+A);}},getComponent:function(A){switch(A){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+A);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this},add:function(A,P){return void 0===P?(this.x+=A.x,this.y+=A.y,this.z+=A.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(A,P))},addScalar:function(A){return this.x+=A,this.y+=A,this.z+=A,this},addVectors:function(A,P){return this.x=A.x+P.x,this.y=A.y+P.y,this.z=A.z+P.z,this},addScaledVector:function(A,P){return this.x+=A.x*P,this.y+=A.y*P,this.z+=A.z*P,this},sub:function(A,P){return void 0===P?(this.x-=A.x,this.y-=A.y,this.z-=A.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(A,P))},subScalar:function(A){return this.x-=A,this.y-=A,this.z-=A,this},subVectors:function(A,P){return this.x=A.x-P.x,this.y=A.y-P.y,this.z=A.z-P.z,this},multiply:function(A,P){return void 0===P?(this.x*=A.x,this.y*=A.y,this.z*=A.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(A,P))},multiplyScalar:function(A){return isFinite(A)?(this.x*=A,this.y*=A,this.z*=A):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(A,P){return this.x=A.x*P.x,this.y=A.y*P.y,this.z=A.z*P.z,this},applyEuler:function(){var A;return function(R){return!1==R instanceof C.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0==A&&(A=new C.Quaternion),this.applyQuaternion(A.setFromEuler(R)),this}}(),applyAxisAngle:function(){var A;return function(R,D){return void 0==A&&(A=new C.Quaternion),this.applyQuaternion(A.setFromAxisAngle(R,D)),this}}(),applyMatrix3:function(A){var P=this.x,R=this.y,D=this.z,I=A.elements;return this.x=I[0]*P+I[3]*R+I[6]*D,this.y=I[1]*P+I[4]*R+I[7]*D,this.z=I[2]*P+I[5]*R+I[8]*D,this},applyMatrix4:function(A){var P=this.x,R=this.y,D=this.z,I=A.elements;return this.x=I[0]*P+I[4]*R+I[8]*D+I[12],this.y=I[1]*P+I[5]*R+I[9]*D+I[13],this.z=I[2]*P+I[6]*R+I[10]*D+I[14],this},applyProjection:function(A){var P=this.x,R=this.y,D=this.z,I=A.elements,U=1/(I[3]*P+I[7]*R+I[11]*D+I[15]);return this.x=(I[0]*P+I[4]*R+I[8]*D+I[12])*U,this.y=(I[1]*P+I[5]*R+I[9]*D+I[13])*U,this.z=(I[2]*P+I[6]*R+I[10]*D+I[14])*U,this},applyQuaternion:function(A){var P=this.x,R=this.y,D=this.z,I=A.x,U=A.y,F=A.z,V=A.w,G=V*P+U*D-F*R,O=V*R+F*P-I*D,H=V*D+I*R-U*P,W=-I*P-U*R-F*D;return this.x=G*V+W*-I+O*-F-H*-U,this.y=O*V+W*-U+H*-I-G*-F,this.z=H*V+W*-F+G*-U-O*-I,this},project:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.multiplyMatrices(R.projectionMatrix,A.getInverse(R.matrixWorld)),this.applyProjection(A)}}(),unproject:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.multiplyMatrices(R.matrixWorld,A.getInverse(R.projectionMatrix)),this.applyProjection(A)}}(),transformDirection:function(A){var P=this.x,R=this.y,D=this.z,I=A.elements;return this.x=I[0]*P+I[4]*R+I[8]*D,this.y=I[1]*P+I[5]*R+I[9]*D,this.z=I[2]*P+I[6]*R+I[10]*D,this.normalize(),this},divide:function(A){return this.x/=A.x,this.y/=A.y,this.z/=A.z,this},divideScalar:function(A){return this.multiplyScalar(1/A)},min:function(A){return this.x=_Mathmin(this.x,A.x),this.y=_Mathmin(this.y,A.y),this.z=_Mathmin(this.z,A.z),this},max:function(A){return this.x=_Mathmax(this.x,A.x),this.y=_Mathmax(this.y,A.y),this.z=_Mathmax(this.z,A.z),this},clamp:function(A,P){return this.x=_Mathmax(A.x,_Mathmin(P.x,this.x)),this.y=_Mathmax(A.y,_Mathmin(P.y,this.y)),this.z=_Mathmax(A.z,_Mathmin(P.z,this.z)),this},clampScalar:function(){var A,P;return function(D,I){return void 0==A&&(A=new C.Vector3,P=new C.Vector3),A.set(D,D,D),P.set(I,I,I),this.clamp(A,P)}}(),clampLength:function(A,P){var R=this.length();return this.multiplyScalar(_Mathmax(A,_Mathmin(P,R))/R),this},floor:function(){return this.x=_Mathfloor(this.x),this.y=_Mathfloor(this.y),this.z=_Mathfloor(this.z),this},ceil:function(){return this.x=_Mathceil(this.x),this.y=_Mathceil(this.y),this.z=_Mathceil(this.z),this},round:function(){return this.x=_Mathround(this.x),this.y=_Mathround(this.y),this.z=_Mathround(this.z),this},roundToZero:function(){return this.x=0>this.x?_Mathceil(this.x):_Mathfloor(this.x),this.y=0>this.y?_Mathceil(this.y):_Mathfloor(this.y),this.z=0>this.z?_Mathceil(this.z):_Mathfloor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(A){return this.x*A.x+this.y*A.y+this.z*A.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return _Mathsqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return _Mathabs(this.x)+_Mathabs(this.y)+_Mathabs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(A){return this.multiplyScalar(A/this.length())},lerp:function(A,P){return this.x+=(A.x-this.x)*P,this.y+=(A.y-this.y)*P,this.z+=(A.z-this.z)*P,this},lerpVectors:function(A,P,R){return this.subVectors(P,A).multiplyScalar(R).add(A),this},cross:function(A,P){if(void 0!==P)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(A,P);var R=this.x,D=this.y,I=this.z;return this.x=D*A.z-I*A.y,this.y=I*A.x-R*A.z,this.z=R*A.y-D*A.x,this},crossVectors:function(A,P){var R=A.x,D=A.y,I=A.z,U=P.x,F=P.y,V=P.z;return this.x=D*V-I*F,this.y=I*U-R*V,this.z=R*F-D*U,this},projectOnVector:function(){var A,P;return function(D){return void 0==A&&(A=new C.Vector3),A.copy(D).normalize(),P=this.dot(A),this.copy(A).multiplyScalar(P)}}(),projectOnPlane:function(){var A;return function(R){return void 0==A&&(A=new C.Vector3),A.copy(this).projectOnVector(R),this.sub(A)}}(),reflect:function(){var A;return function(R){return void 0==A&&(A=new C.Vector3),this.sub(A.copy(R).multiplyScalar(2*this.dot(R)))}}(),angleTo:function(A){var P=this.dot(A)/_Mathsqrt(this.lengthSq()*A.lengthSq());return _Mathacos(C.Math.clamp(P,-1,1))},distanceTo:function(A){return _Mathsqrt(this.distanceToSquared(A))},distanceToSquared:function(A){var P=this.x-A.x,R=this.y-A.y,D=this.z-A.z;return P*P+R*R+D*D},setFromSpherical:function(A){var P=_Mathsin2(A.phi)*A.radius;return this.x=P*_Mathsin2(A.theta),this.y=_Mathcos2(A.phi)*A.radius,this.z=P*_Mathcos2(A.theta),this},setFromMatrixPosition:function(A){return this.setFromMatrixColumn(A,3)},setFromMatrixScale:function(A){var P=this.setFromMatrixColumn(A,0).length(),R=this.setFromMatrixColumn(A,1).length(),D=this.setFromMatrixColumn(A,2).length();return this.x=P,this.y=R,this.z=D,this},setFromMatrixColumn:function(A,P){return"number"==typeof A&&(console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index )."),A=arguments[1],P=arguments[0]),this.fromArray(A.elements,4*P)},equals:function(A){return A.x===this.x&&A.y===this.y&&A.z===this.z},fromArray:function(A,P){return void 0===P&&(P=0),this.x=A[P],this.y=A[P+1],this.z=A[P+2],this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this.x,A[P+1]=this.y,A[P+2]=this.z,A},fromAttribute:function(A,P,R){return void 0===R&&(R=0),P=P*A.itemSize+R,this.x=A.array[P],this.y=A.array[P+1],this.z=A.array[P+2],this}},C.Vector4=function(A,P,R,D){this.x=A||0,this.y=P||0,this.z=R||0,this.w=D===void 0?1:D},C.Vector4.prototype={constructor:C.Vector4,set:function(A,P,R,D){return this.x=A,this.y=P,this.z=R,this.w=D,this},setScalar:function(A){return this.x=A,this.y=A,this.z=A,this.w=A,this},setX:function(A){return this.x=A,this},setY:function(A){return this.y=A,this},setZ:function(A){return this.z=A,this},setW:function(A){return this.w=A,this},setComponent:function(A,P){switch(A){case 0:this.x=P;break;case 1:this.y=P;break;case 2:this.z=P;break;case 3:this.w=P;break;default:throw new Error("index is out of range: "+A);}},getComponent:function(A){switch(A){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+A);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this.w=void 0===A.w?1:A.w,this},add:function(A,P){return void 0===P?(this.x+=A.x,this.y+=A.y,this.z+=A.z,this.w+=A.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(A,P))},addScalar:function(A){return this.x+=A,this.y+=A,this.z+=A,this.w+=A,this},addVectors:function(A,P){return this.x=A.x+P.x,this.y=A.y+P.y,this.z=A.z+P.z,this.w=A.w+P.w,this},addScaledVector:function(A,P){return this.x+=A.x*P,this.y+=A.y*P,this.z+=A.z*P,this.w+=A.w*P,this},sub:function(A,P){return void 0===P?(this.x-=A.x,this.y-=A.y,this.z-=A.z,this.w-=A.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(A,P))},subScalar:function(A){return this.x-=A,this.y-=A,this.z-=A,this.w-=A,this},subVectors:function(A,P){return this.x=A.x-P.x,this.y=A.y-P.y,this.z=A.z-P.z,this.w=A.w-P.w,this},multiplyScalar:function(A){return isFinite(A)?(this.x*=A,this.y*=A,this.z*=A,this.w*=A):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(A){var P=this.x,R=this.y,D=this.z,I=this.w,U=A.elements;return this.x=U[0]*P+U[4]*R+U[8]*D+U[12]*I,this.y=U[1]*P+U[5]*R+U[9]*D+U[13]*I,this.z=U[2]*P+U[6]*R+U[10]*D+U[14]*I,this.w=U[3]*P+U[7]*R+U[11]*D+U[15]*I,this},divideScalar:function(A){return this.multiplyScalar(1/A)},setAxisAngleFromQuaternion:function(A){this.w=2*_Mathacos(A.w);var P=_Mathsqrt(1-A.w*A.w);return 1e-4>P?(this.x=1,this.y=0,this.z=0):(this.x=A.x/P,this.y=A.y/P,this.z=A.z/P),this},setAxisAngleFromRotationMatrix:function(A){var U=0.01,F=0.1,V=A.elements,G=V[0],O=V[4],H=V[8],W=V[1],X=V[5],Y=V[9],Z=V[2],K=V[6],Q=V[10],P,R,D,I;if(_Mathabs(O-W)<U&&_Mathabs(H-Z)<U&&_Mathabs(Y-K)<U){if(_Mathabs(O+W)<F&&_Mathabs(H+Z)<F&&_Mathabs(Y+K)<F&&_Mathabs(G+X+Q-3)<F)return this.set(1,0,0,0),this;P=_MathPI2;var J=(G+1)/2,ee=(X+1)/2,oe=(Q+1)/2,ne=(O+W)/4,ie=(H+Z)/4,se=(Y+K)/4;return J>ee&&J>oe?J<U?(R=0,D=0.707106781,I=0.707106781):(R=_Mathsqrt(J),D=ne/R,I=ie/R):ee>oe?ee<U?(R=0.707106781,D=0,I=0.707106781):(D=_Mathsqrt(ee),R=ne/D,I=se/D):oe<U?(R=0.707106781,D=0.707106781,I=0):(I=_Mathsqrt(oe),R=ie/I,D=se/I),this.set(R,D,I,P),this}var le=_Mathsqrt((K-Y)*(K-Y)+(H-Z)*(H-Z)+(W-O)*(W-O));return 1e-3>_Mathabs(le)&&(le=1),this.x=(K-Y)/le,this.y=(H-Z)/le,this.z=(W-O)/le,this.w=_Mathacos((G+X+Q-1)/2),this},min:function(A){return this.x=_Mathmin(this.x,A.x),this.y=_Mathmin(this.y,A.y),this.z=_Mathmin(this.z,A.z),this.w=_Mathmin(this.w,A.w),this},max:function(A){return this.x=_Mathmax(this.x,A.x),this.y=_Mathmax(this.y,A.y),this.z=_Mathmax(this.z,A.z),this.w=_Mathmax(this.w,A.w),this},clamp:function(A,P){return this.x=_Mathmax(A.x,_Mathmin(P.x,this.x)),this.y=_Mathmax(A.y,_Mathmin(P.y,this.y)),this.z=_Mathmax(A.z,_Mathmin(P.z,this.z)),this.w=_Mathmax(A.w,_Mathmin(P.w,this.w)),this},clampScalar:function(){var A,P;return function(D,I){return void 0==A&&(A=new C.Vector4,P=new C.Vector4),A.set(D,D,D,D),P.set(I,I,I,I),this.clamp(A,P)}}(),floor:function(){return this.x=_Mathfloor(this.x),this.y=_Mathfloor(this.y),this.z=_Mathfloor(this.z),this.w=_Mathfloor(this.w),this},ceil:function(){return this.x=_Mathceil(this.x),this.y=_Mathceil(this.y),this.z=_Mathceil(this.z),this.w=_Mathceil(this.w),this},round:function(){return this.x=_Mathround(this.x),this.y=_Mathround(this.y),this.z=_Mathround(this.z),this.w=_Mathround(this.w),this},roundToZero:function(){return this.x=0>this.x?_Mathceil(this.x):_Mathfloor(this.x),this.y=0>this.y?_Mathceil(this.y):_Mathfloor(this.y),this.z=0>this.z?_Mathceil(this.z):_Mathfloor(this.z),this.w=0>this.w?_Mathceil(this.w):_Mathfloor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(A){return this.x*A.x+this.y*A.y+this.z*A.z+this.w*A.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return _Mathsqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return _Mathabs(this.x)+_Mathabs(this.y)+_Mathabs(this.z)+_Mathabs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(A){return this.multiplyScalar(A/this.length())},lerp:function(A,P){return this.x+=(A.x-this.x)*P,this.y+=(A.y-this.y)*P,this.z+=(A.z-this.z)*P,this.w+=(A.w-this.w)*P,this},lerpVectors:function(A,P,R){return this.subVectors(P,A).multiplyScalar(R).add(A),this},equals:function(A){return A.x===this.x&&A.y===this.y&&A.z===this.z&&A.w===this.w},fromArray:function(A,P){return void 0===P&&(P=0),this.x=A[P],this.y=A[P+1],this.z=A[P+2],this.w=A[P+3],this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this.x,A[P+1]=this.y,A[P+2]=this.z,A[P+3]=this.w,A},fromAttribute:function(A,P,R){return void 0===R&&(R=0),P=P*A.itemSize+R,this.x=A.array[P],this.y=A.array[P+1],this.z=A.array[P+2],this.w=A.array[P+3],this}},C.Euler=function(A,P,R,D){this._x=A||0,this._y=P||0,this._z=R||0,this._order=D||C.Euler.DefaultOrder},C.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],C.Euler.DefaultOrder="XYZ",C.Euler.prototype={constructor:C.Euler,get x(){return this._x},set x(A){this._x=A,this.onChangeCallback()},get y(){return this._y},set y(A){this._y=A,this.onChangeCallback()},get z(){return this._z},set z(A){this._z=A,this.onChangeCallback()},get order(){return this._order},set order(A){this._order=A,this.onChangeCallback()},set:function(A,P,R,D){return this._x=A,this._y=P,this._z=R,this._order=D||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(A){return this._x=A._x,this._y=A._y,this._z=A._z,this._order=A._order,this.onChangeCallback(),this},setFromRotationMatrix:function(A,P,R){var D=C.Math.clamp,I=A.elements,U=I[0],F=I[4],V=I[8],G=I[1],O=I[5],H=I[9],W=I[2],X=I[6],Y=I[10];return P=P||this._order,"XYZ"===P?(this._y=_Mathasin(D(V,-1,1)),0.99999>_Mathabs(V)?(this._x=_Mathatan(-H,Y),this._z=_Mathatan(-F,U)):(this._x=_Mathatan(X,O),this._z=0)):"YXZ"===P?(this._x=_Mathasin(-D(H,-1,1)),0.99999>_Mathabs(H)?(this._y=_Mathatan(V,Y),this._z=_Mathatan(G,O)):(this._y=_Mathatan(-W,U),this._z=0)):"ZXY"===P?(this._x=_Mathasin(D(X,-1,1)),0.99999>_Mathabs(X)?(this._y=_Mathatan(-W,Y),this._z=_Mathatan(-F,O)):(this._y=0,this._z=_Mathatan(G,U))):"ZYX"===P?(this._y=_Mathasin(-D(W,-1,1)),0.99999>_Mathabs(W)?(this._x=_Mathatan(X,Y),this._z=_Mathatan(G,U)):(this._x=0,this._z=_Mathatan(-F,O))):"YZX"===P?(this._z=_Mathasin(D(G,-1,1)),0.99999>_Mathabs(G)?(this._x=_Mathatan(-H,O),this._y=_Mathatan(-W,U)):(this._x=0,this._y=_Mathatan(V,Y))):"XZY"===P?(this._z=_Mathasin(-D(F,-1,1)),0.99999>_Mathabs(F)?(this._x=_Mathatan(X,O),this._y=_Mathatan(V,U)):(this._x=_Mathatan(-H,Y),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+P),this._order=P,!1!==R&&this.onChangeCallback(),this},setFromQuaternion:function(){var A;return function(P,R,D){return void 0==A&&(A=new C.Matrix4),A.makeRotationFromQuaternion(P),this.setFromRotationMatrix(A,R,D),this}}(),setFromVector3:function(A,P){return this.set(A.x,A.y,A.z,P||this._order)},reorder:function(){var A=new C.Quaternion;return function(P){A.setFromEuler(this),this.setFromQuaternion(A,P)}}(),equals:function(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._order===this._order},fromArray:function(A){return this._x=A[0],this._y=A[1],this._z=A[2],void 0!==A[3]&&(this._order=A[3]),this.onChangeCallback(),this},toArray:function(A,P){return void 0===A&&(A=[]),void 0===P&&(P=0),A[P]=this._x,A[P+1]=this._y,A[P+2]=this._z,A[P+3]=this._order,A},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new C.Vector3(this._x,this._y,this._z)},onChange:function(A){return this.onChangeCallback=A,this},onChangeCallback:function(){}},C.Line3=function(A,P){this.start=A===void 0?new C.Vector3:A,this.end=P===void 0?new C.Vector3:P},C.Line3.prototype={constructor:C.Line3,set:function(A,P){return this.start.copy(A),this.end.copy(P),this},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.start.copy(A.start),this.end.copy(A.end),this},center:function(A){var P=A||new C.Vector3;return P.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(A){var P=A||new C.Vector3;return P.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(A,P){var R=P||new C.Vector3;return this.delta(R).multiplyScalar(A).add(this.start)},closestPointToPointParameter:function(){var A=new C.Vector3,P=new C.Vector3;return function(R,D){A.subVectors(R,this.start),P.subVectors(this.end,this.start);var I=P.dot(P),U=P.dot(A),F=U/I;return D&&(F=C.Math.clamp(F,0,1)),F}}(),closestPointToPoint:function(A,P,R){var D=this.closestPointToPointParameter(A,P),I=R||new C.Vector3;return this.delta(I).multiplyScalar(D).add(this.start)},applyMatrix4:function(A){return this.start.applyMatrix4(A),this.end.applyMatrix4(A),this},equals:function(A){return A.start.equals(this.start)&&A.end.equals(this.end)}},C.Box2=function(A,P){this.min=A===void 0?new C.Vector2(+Infinity,+Infinity):A,this.max=P===void 0?new C.Vector2(-Infinity,-Infinity):P},C.Box2.prototype={constructor:C.Box2,set:function(A,P){return this.min.copy(A),this.max.copy(P),this},setFromPoints:function(A){this.makeEmpty();for(var P=0,R=A.length;P<R;P++)this.expandByPoint(A[P]);return this},setFromCenterAndSize:function(){var A=new C.Vector2;return function(P,R){var D=A.copy(R).multiplyScalar(0.5);return this.min.copy(P).sub(D),this.max.copy(P).add(D),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.min.copy(A.min),this.max.copy(A.max),this},makeEmpty:function(){return this.min.x=this.min.y=+Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(A){var P=A||new C.Vector2;return P.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(A){var P=A||new C.Vector2;return P.subVectors(this.max,this.min)},expandByPoint:function(A){return this.min.min(A),this.max.max(A),this},expandByVector:function(A){return this.min.sub(A),this.max.add(A),this},expandByScalar:function(A){return this.min.addScalar(-A),this.max.addScalar(A),this},containsPoint:function(A){return A.x<this.min.x||A.x>this.max.x||A.y<this.min.y||A.y>this.max.y?!1:!0},containsBox:function(A){return this.min.x<=A.min.x&&A.max.x<=this.max.x&&this.min.y<=A.min.y&&A.max.y<=this.max.y},getParameter:function(A,P){var R=P||new C.Vector2;return R.set((A.x-this.min.x)/(this.max.x-this.min.x),(A.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(A){return A.max.x<this.min.x||A.min.x>this.max.x||A.max.y<this.min.y||A.min.y>this.max.y?!1:!0},clampPoint:function(A,P){var R=P||new C.Vector2;return R.copy(A).clamp(this.min,this.max)},distanceToPoint:function(){var A=new C.Vector2;return function(P){var R=A.copy(P).clamp(this.min,this.max);return R.sub(P).length()}}(),intersect:function(A){return this.min.max(A.min),this.max.min(A.max),this},union:function(A){return this.min.min(A.min),this.max.max(A.max),this},translate:function(A){return this.min.add(A),this.max.add(A),this},equals:function(A){return A.min.equals(this.min)&&A.max.equals(this.max)}},C.Box3=function(A,P){this.min=A===void 0?new C.Vector3(+Infinity,+Infinity,+Infinity):A,this.max=P===void 0?new C.Vector3(-Infinity,-Infinity,-Infinity):P},C.Box3.prototype={constructor:C.Box3,set:function(A,P){return this.min.copy(A),this.max.copy(P),this},setFromArray:function(A){for(var P=+Infinity,R=+Infinity,D=+Infinity,I=-Infinity,U=-Infinity,F=-Infinity,V=0,G=A.length;V<G;V+=3){var O=A[V],H=A[V+1],W=A[V+2];O<P&&(P=O),H<R&&(R=H),W<D&&(D=W),O>I&&(I=O),H>U&&(U=H),W>F&&(F=W)}this.min.set(P,R,D),this.max.set(I,U,F)},setFromPoints:function(A){this.makeEmpty();for(var P=0,R=A.length;P<R;P++)this.expandByPoint(A[P]);return this},setFromCenterAndSize:function(){var A=new C.Vector3;return function(P,R){var D=A.copy(R).multiplyScalar(0.5);return this.min.copy(P).sub(D),this.max.copy(P).add(D),this}}(),setFromObject:function(){var A=new C.Vector3;return function(P){var R=this;return P.updateMatrixWorld(!0),this.makeEmpty(),P.traverse(function(D){var I=D.geometry;if(void 0!==I)if(I instanceof C.Geometry)for(var U=I.vertices,F=0,V=U.length;F<V;F++)A.copy(U[F]),A.applyMatrix4(D.matrixWorld),R.expandByPoint(A);else if(I instanceof C.BufferGeometry&&void 0!==I.attributes.position)for(var G=I.attributes.position.array,F=0,V=G.length;F<V;F+=3)A.fromArray(G,F),A.applyMatrix4(D.matrixWorld),R.expandByPoint(A)}),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.min.copy(A.min),this.max.copy(A.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(A){var P=A||new C.Vector3;return P.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(A){var P=A||new C.Vector3;return P.subVectors(this.max,this.min)},expandByPoint:function(A){return this.min.min(A),this.max.max(A),this},expandByVector:function(A){return this.min.sub(A),this.max.add(A),this},expandByScalar:function(A){return this.min.addScalar(-A),this.max.addScalar(A),this},containsPoint:function(A){return A.x<this.min.x||A.x>this.max.x||A.y<this.min.y||A.y>this.max.y||A.z<this.min.z||A.z>this.max.z?!1:!0},containsBox:function(A){return this.min.x<=A.min.x&&A.max.x<=this.max.x&&this.min.y<=A.min.y&&A.max.y<=this.max.y&&this.min.z<=A.min.z&&A.max.z<=this.max.z},getParameter:function(A,P){var R=P||new C.Vector3;return R.set((A.x-this.min.x)/(this.max.x-this.min.x),(A.y-this.min.y)/(this.max.y-this.min.y),(A.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(A){return A.max.x<this.min.x||A.min.x>this.max.x||A.max.y<this.min.y||A.min.y>this.max.y||A.max.z<this.min.z||A.min.z>this.max.z?!1:!0},intersectsSphere:function(){var A;return function(R){return void 0==A&&(A=new C.Vector3),this.clampPoint(R.center,A),A.distanceToSquared(R.center)<=R.radius*R.radius}}(),intersectsPlane:function(A){var P,R;return 0<A.normal.x?(P=A.normal.x*this.min.x,R=A.normal.x*this.max.x):(P=A.normal.x*this.max.x,R=A.normal.x*this.min.x),0<A.normal.y?(P+=A.normal.y*this.min.y,R+=A.normal.y*this.max.y):(P+=A.normal.y*this.max.y,R+=A.normal.y*this.min.y),0<A.normal.z?(P+=A.normal.z*this.min.z,R+=A.normal.z*this.max.z):(P+=A.normal.z*this.max.z,R+=A.normal.z*this.min.z),P<=A.constant&&R>=A.constant},clampPoint:function(A,P){var R=P||new C.Vector3;return R.copy(A).clamp(this.min,this.max)},distanceToPoint:function(){var A=new C.Vector3;return function(P){var R=A.copy(P).clamp(this.min,this.max);return R.sub(P).length()}}(),getBoundingSphere:function(){var A=new C.Vector3;return function(P){var R=P||new C.Sphere;return R.center=this.center(),R.radius=0.5*this.size(A).length(),R}}(),intersect:function(A){return this.min.max(A.min),this.max.min(A.max),this.isEmpty()&&this.makeEmpty(),this},union:function(A){return this.min.min(A.min),this.max.max(A.max),this},applyMatrix4:function(){var A=[new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3];return function(P){return this.isEmpty()?this:(A[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(P),A[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(P),A[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(P),A[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(P),A[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(P),A[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(P),A[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(P),A[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(P),this.setFromPoints(A),this)}}(),translate:function(A){return this.min.add(A),this.max.add(A),this},equals:function(A){return A.min.equals(this.min)&&A.max.equals(this.max)}},C.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},C.Matrix3.prototype={constructor:C.Matrix3,set:function(A,P,R,D,I,U,F,V,G){var O=this.elements;return O[0]=A,O[1]=D,O[2]=F,O[3]=P,O[4]=I,O[5]=V,O[6]=R,O[7]=U,O[8]=G,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(A){var P=A.elements;return this.set(P[0],P[3],P[6],P[1],P[4],P[7],P[2],P[5],P[8]),this},setFromMatrix4:function(A){var P=A.elements;return this.set(P[0],P[4],P[8],P[1],P[5],P[9],P[2],P[6],P[10]),this},applyToVector3Array:function(){var A;return function(P,R,D){A==void 0&&(A=new C.Vector3),R===void 0&&(R=0),D===void 0&&(D=P.length);for(var I=0,U=R;I<D;I+=3,U+=3)A.fromArray(P,U),A.applyMatrix3(this),A.toArray(P,U);return P}}(),applyToBuffer:function(){var A;return function(R,D,I){A==void 0&&(A=new C.Vector3),D===void 0&&(D=0),I===void 0&&(I=R.length/R.itemSize);for(var U=0,F=D;U<I;U++,F++)A.x=R.getX(F),A.y=R.getY(F),A.z=R.getZ(F),A.applyMatrix3(this),R.setXYZ(A.x,A.y,A.z);return R}}(),multiplyScalar:function(A){var P=this.elements;return P[0]*=A,P[3]*=A,P[6]*=A,P[1]*=A,P[4]*=A,P[7]*=A,P[2]*=A,P[5]*=A,P[8]*=A,this},determinant:function(){var A=this.elements,P=A[0],R=A[1],D=A[2],I=A[3],U=A[4],F=A[5],V=A[6],G=A[7],O=A[8];return P*U*O-P*F*G-R*I*O+R*F*V+D*I*G-D*U*V},getInverse:function(A,P){A instanceof C.Matrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var R=A.elements,D=this.elements,I=R[0],U=R[1],F=R[2],V=R[3],G=R[4],O=R[5],H=R[6],W=R[7],X=R[8],Y=X*G-O*W,Z=O*H-X*V,K=W*V-G*H,Q=I*Y+U*Z+F*K;if(0==Q){var J="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(P||!1)throw new Error(J);else console.warn(J);return this.identity()}return D[0]=Y,D[1]=F*W-X*U,D[2]=O*U-F*G,D[3]=Z,D[4]=X*I-F*H,D[5]=F*V-O*I,D[6]=K,D[7]=U*H-W*I,D[8]=G*I-U*V,this.multiplyScalar(1/Q)},transpose:function(){var P=this.elements,A;return A=P[1],P[1]=P[3],P[3]=A,A=P[2],P[2]=P[6],P[6]=A,A=P[5],P[5]=P[7],P[7]=A,this},flattenToArrayOffset:function(A,P){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(A,P)},getNormalMatrix:function(A){return this.setFromMatrix4(A).getInverse(this).transpose()},transposeIntoArray:function(A){var P=this.elements;return A[0]=P[0],A[1]=P[3],A[2]=P[6],A[3]=P[1],A[4]=P[4],A[5]=P[7],A[6]=P[2],A[7]=P[5],A[8]=P[8],this},fromArray:function(A){return this.elements.set(A),this},toArray:function(A,P){void 0===A&&(A=[]),void 0===P&&(P=0);var R=this.elements;return A[P]=R[0],A[P+1]=R[1],A[P+2]=R[2],A[P+3]=R[3],A[P+4]=R[4],A[P+5]=R[5],A[P+6]=R[6],A[P+7]=R[7],A[P+8]=R[8],A}},C.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},C.Matrix4.prototype={constructor:C.Matrix4,set:function(A,P,R,D,I,U,F,V,G,O,H,W,X,Y,Z,K){var Q=this.elements;return Q[0]=A,Q[4]=P,Q[8]=R,Q[12]=D,Q[1]=I,Q[5]=U,Q[9]=F,Q[13]=V,Q[2]=G,Q[6]=O,Q[10]=H,Q[14]=W,Q[3]=X,Q[7]=Y,Q[11]=Z,Q[15]=K,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new C.Matrix4().fromArray(this.elements)},copy:function(A){return this.elements.set(A.elements),this},copyPosition:function(A){var P=this.elements,R=A.elements;return P[12]=R[12],P[13]=R[13],P[14]=R[14],this},extractBasis:function(A,P,R){return A.setFromMatrixColumn(this,0),P.setFromMatrixColumn(this,1),R.setFromMatrixColumn(this,2),this},makeBasis:function(A,P,R){return this.set(A.x,P.x,R.x,0,A.y,P.y,R.y,0,A.z,P.z,R.z,0,0,0,0,1),this},extractRotation:function(){var A;return function(P){void 0==A&&(A=new C.Vector3);var R=this.elements,D=P.elements,I=1/A.setFromMatrixColumn(P,0).length(),U=1/A.setFromMatrixColumn(P,1).length(),F=1/A.setFromMatrixColumn(P,2).length();return R[0]=D[0]*I,R[1]=D[1]*I,R[2]=D[2]*I,R[4]=D[4]*U,R[5]=D[5]*U,R[6]=D[6]*U,R[8]=D[8]*F,R[9]=D[9]*F,R[10]=D[10]*F,this}}(),makeRotationFromEuler:function(A){!1==A instanceof C.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var P=this.elements,R=A.x,D=A.y,I=A.z,U=_Mathcos2(R),F=_Mathsin2(R),V=_Mathcos2(D),G=_Mathsin2(D),O=_Mathcos2(I),H=_Mathsin2(I);if("XYZ"===A.order){var W=U*O,X=U*H,Y=F*O,Z=F*H;P[0]=V*O,P[4]=-V*H,P[8]=G,P[1]=X+Y*G,P[5]=W-Z*G,P[9]=-F*V,P[2]=Z-W*G,P[6]=Y+X*G,P[10]=U*V}else if("YXZ"===A.order){var K=V*O,Q=V*H,J=G*O,ee=G*H;P[0]=K+ee*F,P[4]=J*F-Q,P[8]=U*G,P[1]=U*H,P[5]=U*O,P[9]=-F,P[2]=Q*F-J,P[6]=ee+K*F,P[10]=U*V}else if("ZXY"===A.order){var K=V*O,Q=V*H,J=G*O,ee=G*H;P[0]=K-ee*F,P[4]=-U*H,P[8]=J+Q*F,P[1]=Q+J*F,P[5]=U*O,P[9]=ee-K*F,P[2]=-U*G,P[6]=F,P[10]=U*V}else if("ZYX"===A.order){var W=U*O,X=U*H,Y=F*O,Z=F*H;P[0]=V*O,P[4]=Y*G-X,P[8]=W*G+Z,P[1]=V*H,P[5]=Z*G+W,P[9]=X*G-Y,P[2]=-G,P[6]=F*V,P[10]=U*V}else if("YZX"===A.order){var oe=U*V,ne=U*G,ie=F*V,se=F*G;P[0]=V*O,P[4]=se-oe*H,P[8]=ie*H+ne,P[1]=H,P[5]=U*O,P[9]=-F*O,P[2]=-G*O,P[6]=ne*H+ie,P[10]=oe-se*H}else if("XZY"===A.order){var oe=U*V,ne=U*G,ie=F*V,se=F*G;P[0]=V*O,P[4]=-H,P[8]=G*O,P[1]=oe*H+se,P[5]=U*O,P[9]=ne*H-ie,P[2]=ie*H-ne,P[6]=F*O,P[10]=se*H+oe}return P[3]=0,P[7]=0,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,this},makeRotationFromQuaternion:function(A){var P=this.elements,R=A.x,D=A.y,I=A.z,U=A.w,F=R+R,V=D+D,G=I+I,O=R*F,H=R*V,W=R*G,X=D*V,Y=D*G,Z=I*G,K=U*F,Q=U*V,J=U*G;return P[0]=1-(X+Z),P[4]=H-J,P[8]=W+Q,P[1]=H+J,P[5]=1-(O+Z),P[9]=Y-K,P[2]=W-Q,P[6]=Y+K,P[10]=1-(O+X),P[3]=0,P[7]=0,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,this},lookAt:function(){var A,P,R;return function(D,I,U){void 0==A&&(A=new C.Vector3),void 0==P&&(P=new C.Vector3),void 0==R&&(R=new C.Vector3);var F=this.elements;return R.subVectors(D,I).normalize(),0===R.lengthSq()&&(R.z=1),A.crossVectors(U,R).normalize(),0===A.lengthSq()&&(R.x+=1e-4,A.crossVectors(U,R).normalize()),P.crossVectors(R,A),F[0]=A.x,F[4]=P.x,F[8]=R.x,F[1]=A.y,F[5]=P.y,F[9]=R.y,F[2]=A.z,F[6]=P.z,F[10]=R.z,this}}(),multiply:function(A,P){return void 0===P?this.multiplyMatrices(this,A):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(A,P))},premultiply:function(A){return this.multiplyMatrices(A,this)},multiplyMatrices:function(A,P){var R=A.elements,D=P.elements,I=this.elements,U=R[0],F=R[4],V=R[8],G=R[12],O=R[1],H=R[5],W=R[9],X=R[13],Y=R[2],Z=R[6],K=R[10],Q=R[14],J=R[3],ee=R[7],oe=R[11],ne=R[15],ie=D[0],se=D[4],le=D[8],pe=D[12],ue=D[1],ge=D[5],fe=D[9],he=D[13],ye=D[2],xe=D[6],ve=D[10],_e=D[14],Se=D[3],Me=D[7],Te=D[11],Ee=D[15];return I[0]=U*ie+F*ue+V*ye+G*Se,I[4]=U*se+F*ge+V*xe+G*Me,I[8]=U*le+F*fe+V*ve+G*Te,I[12]=U*pe+F*he+V*_e+G*Ee,I[1]=O*ie+H*ue+W*ye+X*Se,I[5]=O*se+H*ge+W*xe+X*Me,I[9]=O*le+H*fe+W*ve+X*Te,I[13]=O*pe+H*he+W*_e+X*Ee,I[2]=Y*ie+Z*ue+K*ye+Q*Se,I[6]=Y*se+Z*ge+K*xe+Q*Me,I[10]=Y*le+Z*fe+K*ve+Q*Te,I[14]=Y*pe+Z*he+K*_e+Q*Ee,I[3]=J*ie+ee*ue+oe*ye+ne*Se,I[7]=J*se+ee*ge+oe*xe+ne*Me,I[11]=J*le+ee*fe+oe*ve+ne*Te,I[15]=J*pe+ee*he+oe*_e+ne*Ee,this},multiplyToArray:function(A,P,R){var D=this.elements;return this.multiplyMatrices(A,P),R[0]=D[0],R[1]=D[1],R[2]=D[2],R[3]=D[3],R[4]=D[4],R[5]=D[5],R[6]=D[6],R[7]=D[7],R[8]=D[8],R[9]=D[9],R[10]=D[10],R[11]=D[11],R[12]=D[12],R[13]=D[13],R[14]=D[14],R[15]=D[15],this},multiplyScalar:function(A){var P=this.elements;return P[0]*=A,P[4]*=A,P[8]*=A,P[12]*=A,P[1]*=A,P[5]*=A,P[9]*=A,P[13]*=A,P[2]*=A,P[6]*=A,P[10]*=A,P[14]*=A,P[3]*=A,P[7]*=A,P[11]*=A,P[15]*=A,this},applyToVector3Array:function(){var A;return function(P,R,D){A==void 0&&(A=new C.Vector3),R===void 0&&(R=0),D===void 0&&(D=P.length);for(var I=0,U=R;I<D;I+=3,U+=3)A.fromArray(P,U),A.applyMatrix4(this),A.toArray(P,U);return P}}(),applyToBuffer:function(){var A;return function(R,D,I){A==void 0&&(A=new C.Vector3),D===void 0&&(D=0),I===void 0&&(I=R.length/R.itemSize);for(var U=0,F=D;U<I;U++,F++)A.x=R.getX(F),A.y=R.getY(F),A.z=R.getZ(F),A.applyMatrix4(this),R.setXYZ(A.x,A.y,A.z);return R}}(),determinant:function(){var A=this.elements,P=A[0],R=A[4],D=A[8],I=A[12],U=A[1],F=A[5],V=A[9],G=A[13],O=A[2],H=A[6],W=A[10],X=A[14],Y=A[3],Z=A[7],K=A[11],Q=A[15];return Y*(+I*V*H-D*G*H-I*F*W+R*G*W+D*F*X-R*V*X)+Z*(+P*V*X-P*G*W+I*U*W-D*U*X+D*G*O-I*V*O)+K*(+P*G*H-P*F*X-I*U*H+R*U*X+I*F*O-R*G*O)+Q*(-D*F*O-P*V*H+P*F*W+D*U*H-R*U*W+R*V*O)},transpose:function(){var A=this.elements,P;return P=A[1],A[1]=A[4],A[4]=P,P=A[2],A[2]=A[8],A[8]=P,P=A[6],A[6]=A[9],A[9]=P,P=A[3],A[3]=A[12],A[12]=P,P=A[7],A[7]=A[13],A[13]=P,P=A[11],A[11]=A[14],A[14]=P,this},flattenToArrayOffset:function(A,P){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(A,P)},getPosition:function(){var A;return function(){return void 0==A&&(A=new C.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),A.setFromMatrixColumn(this,3)}}(),setPosition:function(A){var P=this.elements;return P[12]=A.x,P[13]=A.y,P[14]=A.z,this},getInverse:function(A,P){var R=this.elements,D=A.elements,I=D[0],U=D[1],F=D[2],V=D[3],G=D[4],O=D[5],H=D[6],W=D[7],X=D[8],Y=D[9],Z=D[10],K=D[11],Q=D[12],J=D[13],ee=D[14],oe=D[15],ne=Y*ee*W-J*Z*W+J*H*K-O*ee*K-Y*H*oe+O*Z*oe,ie=Q*Z*W-X*ee*W-Q*H*K+G*ee*K+X*H*oe-G*Z*oe,se=X*J*W-Q*Y*W+Q*O*K-G*J*K-X*O*oe+G*Y*oe,le=Q*Y*H-X*J*H-Q*O*Z+G*J*Z+X*O*ee-G*Y*ee,pe=I*ne+U*ie+F*se+V*le;if(0==pe){var ue="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(P||!1)throw new Error(ue);else console.warn(ue);return this.identity()}return R[0]=ne,R[1]=J*Z*V-Y*ee*V-J*F*K+U*ee*K+Y*F*oe-U*Z*oe,R[2]=O*ee*V-J*H*V+J*F*W-U*ee*W-O*F*oe+U*H*oe,R[3]=Y*H*V-O*Z*V-Y*F*W+U*Z*W+O*F*K-U*H*K,R[4]=ie,R[5]=X*ee*V-Q*Z*V+Q*F*K-I*ee*K-X*F*oe+I*Z*oe,R[6]=Q*H*V-G*ee*V-Q*F*W+I*ee*W+G*F*oe-I*H*oe,R[7]=G*Z*V-X*H*V+X*F*W-I*Z*W-G*F*K+I*H*K,R[8]=se,R[9]=Q*Y*V-X*J*V-Q*U*K+I*J*K+X*U*oe-I*Y*oe,R[10]=G*J*V-Q*O*V+Q*U*W-I*J*W-G*U*oe+I*O*oe,R[11]=X*O*V-G*Y*V-X*U*W+I*Y*W+G*U*K-I*O*K,R[12]=le,R[13]=X*J*F-Q*Y*F+Q*U*Z-I*J*Z-X*U*ee+I*Y*ee,R[14]=Q*O*F-G*J*F-Q*U*H+I*J*H+G*U*ee-I*O*ee,R[15]=G*Y*F-X*O*F+X*U*H-I*Y*H-G*U*Z+I*O*Z,this.multiplyScalar(1/pe)},scale:function(A){var P=this.elements,R=A.x,D=A.y,I=A.z;return P[0]*=R,P[4]*=D,P[8]*=I,P[1]*=R,P[5]*=D,P[9]*=I,P[2]*=R,P[6]*=D,P[10]*=I,P[3]*=R,P[7]*=D,P[11]*=I,this},getMaxScaleOnAxis:function(){var A=this.elements,P=A[0]*A[0]+A[1]*A[1]+A[2]*A[2],R=A[4]*A[4]+A[5]*A[5]+A[6]*A[6],D=A[8]*A[8]+A[9]*A[9]+A[10]*A[10];return _Mathsqrt(_Mathmax(P,R,D))},makeTranslation:function(A,P,R){return this.set(1,0,0,A,0,1,0,P,0,0,1,R,0,0,0,1),this},makeRotationX:function(A){var P=_Mathcos2(A),R=_Mathsin2(A);return this.set(1,0,0,0,0,P,-R,0,0,R,P,0,0,0,0,1),this},makeRotationY:function(A){var P=_Mathcos2(A),R=_Mathsin2(A);return this.set(P,0,R,0,0,1,0,0,-R,0,P,0,0,0,0,1),this},makeRotationZ:function(A){var P=_Mathcos2(A),R=_Mathsin2(A);return this.set(P,-R,0,0,R,P,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(A,P){var R=_Mathcos2(P),D=_Mathsin2(P),I=1-R,U=A.x,F=A.y,V=A.z,G=I*U,O=I*F;return this.set(G*U+R,G*F-D*V,G*V+D*F,0,G*F+D*V,O*F+R,O*V-D*U,0,G*V-D*F,O*V+D*U,I*V*V+R,0,0,0,0,1),this},makeScale:function(A,P,R){return this.set(A,0,0,0,0,P,0,0,0,0,R,0,0,0,0,1),this},compose:function(A,P,R){return this.makeRotationFromQuaternion(P),this.scale(R),this.setPosition(A),this},decompose:function(){var A,P;return function(R,D,I){void 0==A&&(A=new C.Vector3),void 0==P&&(P=new C.Matrix4);var U=this.elements,F=A.set(U[0],U[1],U[2]).length(),V=A.set(U[4],U[5],U[6]).length(),G=A.set(U[8],U[9],U[10]).length(),O=this.determinant();0>O&&(F=-F),R.x=U[12],R.y=U[13],R.z=U[14],P.elements.set(this.elements);var H=1/F,W=1/V,X=1/G;return P.elements[0]*=H,P.elements[1]*=H,P.elements[2]*=H,P.elements[4]*=W,P.elements[5]*=W,P.elements[6]*=W,P.elements[8]*=X,P.elements[9]*=X,P.elements[10]*=X,D.setFromRotationMatrix(P),I.x=F,I.y=V,I.z=G,this}}(),makeFrustum:function(A,P,R,D,I,U){var F=this.elements;return F[0]=2*I/(P-A),F[4]=0,F[8]=(P+A)/(P-A),F[12]=0,F[1]=0,F[5]=2*I/(D-R),F[9]=(D+R)/(D-R),F[13]=0,F[2]=0,F[6]=0,F[10]=-(U+I)/(U-I),F[14]=-2*U*I/(U-I),F[3]=0,F[7]=0,F[11]=-1,F[15]=0,this},makePerspective:function(A,P,R,D){var I=R*_Mathtan(0.5*(C.Math.DEG2RAD*A)),U=-I;return this.makeFrustum(U*P,I*P,U,I,R,D)},makeOrthographic:function(A,P,R,D,I,U){var F=this.elements,V=1/(P-A),G=1/(R-D),O=1/(U-I);return F[0]=2*V,F[4]=0,F[8]=0,F[12]=-((P+A)*V),F[1]=0,F[5]=2*G,F[9]=0,F[13]=-((R+D)*G),F[2]=0,F[6]=0,F[10]=-2*O,F[14]=-((U+I)*O),F[3]=0,F[7]=0,F[11]=0,F[15]=1,this},equals:function(A){for(var P=this.elements,R=A.elements,D=0;16>D;D++)if(P[D]!==R[D])return!1;return!0},fromArray:function(A){return this.elements.set(A),this},toArray:function(A,P){void 0===A&&(A=[]),void 0===P&&(P=0);var R=this.elements;return A[P]=R[0],A[P+1]=R[1],A[P+2]=R[2],A[P+3]=R[3],A[P+4]=R[4],A[P+5]=R[5],A[P+6]=R[6],A[P+7]=R[7],A[P+8]=R[8],A[P+9]=R[9],A[P+10]=R[10],A[P+11]=R[11],A[P+12]=R[12],A[P+13]=R[13],A[P+14]=R[14],A[P+15]=R[15],A}},C.Ray=function(A,P){this.origin=A===void 0?new C.Vector3:A,this.direction=P===void 0?new C.Vector3:P},C.Ray.prototype={constructor:C.Ray,set:function(A,P){return this.origin.copy(A),this.direction.copy(P),this},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.origin.copy(A.origin),this.direction.copy(A.direction),this},at:function(A,P){var R=P||new C.Vector3;return R.copy(this.direction).multiplyScalar(A).add(this.origin)},lookAt:function(A){this.direction.copy(A).sub(this.origin).normalize()},recast:function(){var A=new C.Vector3;return function(P){return this.origin.copy(this.at(P,A)),this}}(),closestPointToPoint:function(A,P){var R=P||new C.Vector3;R.subVectors(A,this.origin);var D=R.dot(this.direction);return 0>D?R.copy(this.origin):R.copy(this.direction).multiplyScalar(D).add(this.origin)},distanceToPoint:function(A){return _Mathsqrt(this.distanceSqToPoint(A))},distanceSqToPoint:function(){var A=new C.Vector3;return function(P){var R=A.subVectors(P,this.origin).dot(this.direction);return 0>R?this.origin.distanceToSquared(P):(A.copy(this.direction).multiplyScalar(R).add(this.origin),A.distanceToSquared(P))}}(),distanceSqToSegment:function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Vector3;return function(D,I,U,F){A.copy(D).add(I).multiplyScalar(0.5),P.copy(I).sub(D).normalize(),R.copy(this.origin).sub(A);var V=0.5*D.distanceTo(I),G=-this.direction.dot(P),O=R.dot(this.direction),H=-R.dot(P),W=R.lengthSq(),X=_Mathabs(1-G*G),Y,Z,K,Q;if(!(0<X))Z=0<G?-V:V,Y=_Mathmax(0,-(G*Z+O)),K=-Y*Y+Z*(Z+2*H)+W;else if(Y=G*H-O,Z=G*O-H,Q=V*X,!(0<=Y))Z<=-Q?(Y=_Mathmax(0,-(-G*V+O)),Z=0<Y?-V:_Mathmin(_Mathmax(-V,-H),V),K=-Y*Y+Z*(Z+2*H)+W):Z<=Q?(Y=0,Z=_Mathmin(_Mathmax(-V,-H),V),K=Z*(Z+2*H)+W):(Y=_Mathmax(0,-(G*V+O)),Z=0<Y?V:_Mathmin(_Mathmax(-V,-H),V),K=-Y*Y+Z*(Z+2*H)+W);else if(!(Z>=-Q))Z=-V,Y=_Mathmax(0,-(G*Z+O)),K=-Y*Y+Z*(Z+2*H)+W;else if(Z<=Q){var J=1/X;Y*=J,Z*=J,K=Y*(Y+G*Z+2*O)+Z*(G*Y+Z+2*H)+W}else Z=V,Y=_Mathmax(0,-(G*Z+O)),K=-Y*Y+Z*(Z+2*H)+W;return U&&U.copy(this.direction).multiplyScalar(Y).add(this.origin),F&&F.copy(P).multiplyScalar(Z).add(A),K}}(),intersectSphere:function(){var A=new C.Vector3;return function(P,R){A.subVectors(P.center,this.origin);var D=A.dot(this.direction),I=A.dot(A)-D*D,U=P.radius*P.radius;if(I>U)return null;var F=_Mathsqrt(U-I),V=D-F,G=D+F;return 0>V&&0>G?null:0>V?this.at(G,R):this.at(V,R)}}(),intersectsSphere:function(A){return this.distanceToPoint(A.center)<=A.radius},distanceToPlane:function(A){var P=A.normal.dot(this.direction);if(0===P)return 0===A.distanceToPoint(this.origin)?0:null;var R=-(this.origin.dot(A.normal)+A.constant)/P;return 0<=R?R:null},intersectPlane:function(A,P){var R=this.distanceToPlane(A);return null===R?null:this.at(R,P)},intersectsPlane:function(A){var P=A.distanceToPoint(this.origin);if(0===P)return!0;var R=A.normal.dot(this.direction);return!!(0>R*P)},intersectBox:function(A,P){var G=1/this.direction.x,O=1/this.direction.y,H=1/this.direction.z,W=this.origin,R,D,I,U,F,V;return(0<=G?(R=(A.min.x-W.x)*G,D=(A.max.x-W.x)*G):(R=(A.max.x-W.x)*G,D=(A.min.x-W.x)*G),0<=O?(I=(A.min.y-W.y)*O,U=(A.max.y-W.y)*O):(I=(A.max.y-W.y)*O,U=(A.min.y-W.y)*O),R>U||I>D)?null:((I>R||R!==R)&&(R=I),(U<D||D!==D)&&(D=U),0<=H?(F=(A.min.z-W.z)*H,V=(A.max.z-W.z)*H):(F=(A.max.z-W.z)*H,V=(A.min.z-W.z)*H),R>V||F>D)?null:((F>R||R!==R)&&(R=F),(V<D||D!==D)&&(D=V),0>D?null:this.at(0<=R?R:D,P))},intersectsBox:function(){var A=new C.Vector3;return function(P){return null!==this.intersectBox(P,A)}}(),intersectTriangle:function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Vector3,D=new C.Vector3;return function(I,U,F,V,G){P.subVectors(U,I),R.subVectors(F,I),D.crossVectors(P,R);var O=this.direction.dot(D),H;if(0<O){if(V)return null;H=1}else if(0>O)H=-1,O=-O;else return null;A.subVectors(this.origin,I);var W=H*this.direction.dot(R.crossVectors(A,R));if(0>W)return null;var X=H*this.direction.dot(P.cross(A));if(0>X)return null;if(W+X>O)return null;var Y=-H*A.dot(D);return 0>Y?null:this.at(Y/O,G)}}(),applyMatrix4:function(A){return this.direction.add(this.origin).applyMatrix4(A),this.origin.applyMatrix4(A),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(A){return A.origin.equals(this.origin)&&A.direction.equals(this.direction)}},C.Sphere=function(A,P){this.center=A===void 0?new C.Vector3:A,this.radius=P===void 0?0:P},C.Sphere.prototype={constructor:C.Sphere,set:function(A,P){return this.center.copy(A),this.radius=P,this},setFromPoints:function(){var A=new C.Box3;return function(P,R){var D=this.center;void 0===R?A.setFromPoints(P).center(D):D.copy(R);for(var I=0,U=0,F=P.length;U<F;U++)I=_Mathmax(I,D.distanceToSquared(P[U]));return this.radius=_Mathsqrt(I),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.center.copy(A.center),this.radius=A.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(A){return A.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(A){return A.distanceTo(this.center)-this.radius},intersectsSphere:function(A){var P=this.radius+A.radius;return A.center.distanceToSquared(this.center)<=P*P},intersectsBox:function(A){return A.intersectsSphere(this)},intersectsPlane:function(A){return _Mathabs(this.center.dot(A.normal)-A.constant)<=this.radius},clampPoint:function(A,P){var R=this.center.distanceToSquared(A),D=P||new C.Vector3;return D.copy(A),R>this.radius*this.radius&&(D.sub(this.center).normalize(),D.multiplyScalar(this.radius).add(this.center)),D},getBoundingBox:function(A){var P=A||new C.Box3;return P.set(this.center,this.center),P.expandByScalar(this.radius),P},applyMatrix4:function(A){return this.center.applyMatrix4(A),this.radius*=A.getMaxScaleOnAxis(),this},translate:function(A){return this.center.add(A),this},equals:function(A){return A.center.equals(this.center)&&A.radius===this.radius}},C.Frustum=function(A,P,R,D,I,U){this.planes=[A===void 0?new C.Plane:A,P===void 0?new C.Plane:P,R===void 0?new C.Plane:R,D===void 0?new C.Plane:D,I===void 0?new C.Plane:I,U===void 0?new C.Plane:U]},C.Frustum.prototype={constructor:C.Frustum,set:function(A,P,R,D,I,U){var F=this.planes;return F[0].copy(A),F[1].copy(P),F[2].copy(R),F[3].copy(D),F[4].copy(I),F[5].copy(U),this},clone:function(){return new this.constructor().copy(this)},copy:function(A){for(var P=this.planes,R=0;6>R;R++)P[R].copy(A.planes[R]);return this},setFromMatrix:function(A){var P=this.planes,R=A.elements,D=R[0],I=R[1],U=R[2],F=R[3],V=R[4],G=R[5],O=R[6],H=R[7],W=R[8],X=R[9],Y=R[10],Z=R[11],K=R[12],Q=R[13],J=R[14],ee=R[15];return P[0].setComponents(F-D,H-V,Z-W,ee-K).normalize(),P[1].setComponents(F+D,H+V,Z+W,ee+K).normalize(),P[2].setComponents(F+I,H+G,Z+X,ee+Q).normalize(),P[3].setComponents(F-I,H-G,Z-X,ee-Q).normalize(),P[4].setComponents(F-U,H-O,Z-Y,ee-J).normalize(),P[5].setComponents(F+U,H+O,Z+Y,ee+J).normalize(),this},intersectsObject:function(){var A=new C.Sphere;return function(P){var R=P.geometry;return null===R.boundingSphere&&R.computeBoundingSphere(),A.copy(R.boundingSphere),A.applyMatrix4(P.matrixWorld),this.intersectsSphere(A)}}(),intersectsSphere:function(A){for(var P=this.planes,R=A.center,D=-A.radius,I=0,U;6>I;I++)if(U=P[I].distanceToPoint(R),U<D)return!1;return!0},intersectsBox:function(){var A=new C.Vector3,P=new C.Vector3;return function(R){for(var D=this.planes,I=0,U;6>I;I++){U=D[I],A.x=0<U.normal.x?R.min.x:R.max.x,P.x=0<U.normal.x?R.max.x:R.min.x,A.y=0<U.normal.y?R.min.y:R.max.y,P.y=0<U.normal.y?R.max.y:R.min.y,A.z=0<U.normal.z?R.min.z:R.max.z,P.z=0<U.normal.z?R.max.z:R.min.z;var F=U.distanceToPoint(A),V=U.distanceToPoint(P);if(0>F&&0>V)return!1}return!0}}(),containsPoint:function(A){for(var P=this.planes,R=0;6>R;R++)if(0>P[R].distanceToPoint(A))return!1;return!0}},C.Plane=function(A,P){this.normal=A===void 0?new C.Vector3(1,0,0):A,this.constant=P===void 0?0:P},C.Plane.prototype={constructor:C.Plane,set:function(A,P){return this.normal.copy(A),this.constant=P,this},setComponents:function(A,P,R,D){return this.normal.set(A,P,R),this.constant=D,this},setFromNormalAndCoplanarPoint:function(A,P){return this.normal.copy(A),this.constant=-P.dot(this.normal),this},setFromCoplanarPoints:function(){var A=new C.Vector3,P=new C.Vector3;return function(R,D,I){var U=A.subVectors(I,D).cross(P.subVectors(R,D)).normalize();return this.setFromNormalAndCoplanarPoint(U,R),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.normal.copy(A.normal),this.constant=A.constant,this},normalize:function(){var A=1/this.normal.length();return this.normal.multiplyScalar(A),this.constant*=A,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(A){return this.normal.dot(A)+this.constant},distanceToSphere:function(A){return this.distanceToPoint(A.center)-A.radius},projectPoint:function(A,P){return this.orthoPoint(A,P).sub(A).negate()},orthoPoint:function(A,P){var R=this.distanceToPoint(A),D=P||new C.Vector3;return D.copy(this.normal).multiplyScalar(R)},intersectLine:function(){var A=new C.Vector3;return function(P,R){var D=R||new C.Vector3,I=P.delta(A),U=this.normal.dot(I);if(0===U)return 0===this.distanceToPoint(P.start)?D.copy(P.start):void 0;var F=-(P.start.dot(this.normal)+this.constant)/U;return 0>F||1<F?void 0:D.copy(I).multiplyScalar(F).add(P.start)}}(),intersectsLine:function(A){var P=this.distanceToPoint(A.start),R=this.distanceToPoint(A.end);return 0>P&&0<R||0>R&&0<P},intersectsBox:function(A){return A.intersectsPlane(this)},intersectsSphere:function(A){return A.intersectsPlane(this)},coplanarPoint:function(A){var P=A||new C.Vector3;return P.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var A=new C.Vector3,P=new C.Matrix3;return function(R,D){var I=this.coplanarPoint(A).applyMatrix4(R),U=D||P.getNormalMatrix(R),F=this.normal.applyMatrix3(U).normalize();return this.constant=-I.dot(F),this}}(),translate:function(A){return this.constant-=A.dot(this.normal),this},equals:function(A){return A.normal.equals(this.normal)&&A.constant===this.constant}},C.Spherical=function(A,P,R){return this.radius=void 0===A?1:A,this.phi=void 0===P?0:P,this.theta=void 0===R?0:R,this},C.Spherical.prototype={constructor:C.Spherical,set:function(A,P,R){this.radius=A,this.phi=P,this.theta=R},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.radius.copy(A.radius),this.phi.copy(A.phi),this.theta.copy(A.theta),this},makeSafe:function(){var A=1e-6;this.phi=_Mathmax(A,_Mathmin(_MathPI2-A,this.phi))},setFromVector3:function(A){return this.radius=A.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=_Mathatan(A.x,A.z),this.phi=_Mathacos(C.Math.clamp(A.y/this.radius,-1,1))),this}},C.Math={DEG2RAD:_MathPI2/180,RAD2DEG:180/_MathPI2,generateUUID:function(){var A="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),P=Array(36),R=0,D;return function(){for(var I=0;36>I;I++)8===I||13===I||18===I||23===I?P[I]="-":14===I?P[I]="4":(2>=R&&(R=0|33554432+16777216*Math.random()),D=15&R,R>>=4,P[I]=A[19===I?8|3&D:D]);return P.join("")}}(),clamp:function(A,P,R){return _Mathmax(P,_Mathmin(R,A))},euclideanModulo:function(A,P){return(A%P+P)%P},mapLinear:function(A,P,R,D,I){return D+(A-P)*(I-D)/(R-P)},smoothstep:function(A,P,R){return A<=P?0:A>=R?1:(A=(A-P)/(R-P),A*A*(3-2*A))},smootherstep:function(A,P,R){return A<=P?0:A>=R?1:(A=(A-P)/(R-P),A*A*A*(A*(6*A-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(A,P){return A+_Mathfloor(Math.random()*(P-A+1))},randFloat:function(A,P){return A+Math.random()*(P-A)},randFloatSpread:function(A){return A*(0.5-Math.random())},degToRad:function(A){return A*C.Math.DEG2RAD},radToDeg:function(A){return A*C.Math.RAD2DEG},isPowerOfTwo:function(A){return 0==(A&A-1)&&0!==A},nearestPowerOfTwo:function(A){return _Mathpow(2,_Mathround(_Mathlog(A)/_MathLN))},nextPowerOfTwo:function(A){return A--,A|=A>>1,A|=A>>2,A|=A>>4,A|=A>>8,A|=A>>16,A++,A}},C.Spline=function(A){function P(Y,Z,K,Q,J,ee,oe){var ne=0.5*(K-Y),ie=0.5*(Q-Z);return(2*(Z-K)+ne+ie)*oe+(-3*(Z-K)-2*ne-ie)*ee+ne*J+Z}this.points=A;var R=[],D={x:0,y:0,z:0},I,U,F,V,G,O,H,W,X;this.initFromArray=function(Y){this.points=[];for(var Z=0;Z<Y.length;Z++)this.points[Z]={x:Y[Z][0],y:Y[Z][1],z:Y[Z][2]}},this.getPoint=function(Y){return I=(this.points.length-1)*Y,U=_Mathfloor(I),F=I-U,R[0]=0===U?U:U-1,R[1]=U,R[2]=U>this.points.length-2?this.points.length-1:U+1,R[3]=U>this.points.length-3?this.points.length-1:U+2,O=this.points[R[0]],H=this.points[R[1]],W=this.points[R[2]],X=this.points[R[3]],V=F*F,G=F*V,D.x=P(O.x,H.x,W.x,X.x,F,V,G),D.y=P(O.y,H.y,W.y,X.y,F,V,G),D.z=P(O.z,H.z,W.z,X.z,F,V,G),D},this.getControlPointsArray=function(){var K=this.points.length,Q=[],Y,Z;for(Y=0;Y<K;Y++)Z=this.points[Y],Q[Y]=[Z.x,Z.y,Z.z];return Q},this.getLength=function(Y){var ee=0,oe=0,ne=0,ie=new C.Vector3,se=new C.Vector3,le=[],pe=0,Z,K,Q,J;for(le[0]=0,Y||(Y=100),Q=this.points.length*Y,ie.copy(this.points[0]),Z=1;Z<Q;Z++)K=Z/Q,J=this.getPoint(K),se.copy(J),pe+=se.distanceTo(ie),ie.copy(J),ee=(this.points.length-1)*K,oe=_Mathfloor(ee),oe!==ne&&(le[oe]=pe,ne=oe);return le[le.length]=pe,{chunks:le,total:pe}},this.reparametrizeByArcLength=function(Y){var se=[],le=new C.Vector3,pe=this.getLength(),Z,K,Q,J,ee,oe,ne,ie;for(se.push(le.copy(this.points[0]).clone()),Z=1;Z<this.points.length;Z++){for(oe=pe.chunks[Z]-pe.chunks[Z-1],ne=_Mathceil(Y*oe/pe.total),J=(Z-1)/(this.points.length-1),ee=Z/(this.points.length-1),K=1;K<ne-1;K++)Q=J+K*(1/ne)*(ee-J),ie=this.getPoint(Q),se.push(le.copy(ie).clone());se.push(le.copy(this.points[Z]).clone())}this.points=se}},C.Triangle=function(A,P,R){this.a=A===void 0?new C.Vector3:A,this.b=P===void 0?new C.Vector3:P,this.c=R===void 0?new C.Vector3:R},C.Triangle.normal=function(){var A=new C.Vector3;return function(P,R,D,I){var U=I||new C.Vector3;U.subVectors(D,R),A.subVectors(P,R),U.cross(A);var F=U.lengthSq();return 0<F?U.multiplyScalar(1/_Mathsqrt(F)):U.set(0,0,0)}}(),C.Triangle.barycoordFromPoint=function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Vector3;return function(D,I,U,F,V){A.subVectors(F,I),P.subVectors(U,I),R.subVectors(D,I);var G=A.dot(A),O=A.dot(P),H=A.dot(R),W=P.dot(P),X=P.dot(R),Y=G*W-O*O,Z=V||new C.Vector3;if(0==Y)return Z.set(-2,-1,-1);var K=1/Y,Q=(W*H-O*X)*K,J=(G*X-O*H)*K;return Z.set(1-Q-J,J,Q)}}(),C.Triangle.containsPoint=function(){var A=new C.Vector3;return function(P,R,D,I){var U=C.Triangle.barycoordFromPoint(P,R,D,I,A);return 0<=U.x&&0<=U.y&&1>=U.x+U.y}}(),C.Triangle.prototype={constructor:C.Triangle,set:function(A,P,R){return this.a.copy(A),this.b.copy(P),this.c.copy(R),this},setFromPointsAndIndices:function(A,P,R,D){return this.a.copy(A[P]),this.b.copy(A[R]),this.c.copy(A[D]),this},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.a.copy(A.a),this.b.copy(A.b),this.c.copy(A.c),this},area:function(){var A=new C.Vector3,P=new C.Vector3;return function(){return A.subVectors(this.c,this.b),P.subVectors(this.a,this.b),0.5*A.cross(P).length()}}(),midpoint:function(A){var P=A||new C.Vector3;return P.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(A){return C.Triangle.normal(this.a,this.b,this.c,A)},plane:function(A){var P=A||new C.Plane;return P.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(A,P){return C.Triangle.barycoordFromPoint(A,this.a,this.b,this.c,P)},containsPoint:function(A){return C.Triangle.containsPoint(A,this.a,this.b,this.c)},closestPointToPoint:function(){var A,P,R,D;return function(U,F){void 0==A&&(A=new C.Plane,P=[new C.Line3,new C.Line3,new C.Line3],R=new C.Vector3,D=new C.Vector3);var V=F||new C.Vector3,G=Infinity;if(A.setFromCoplanarPoints(this.a,this.b,this.c),A.projectPoint(U,R),!0===this.containsPoint(R))V.copy(R);else{P[0].set(this.a,this.b),P[1].set(this.b,this.c),P[2].set(this.c,this.a);for(var O=0;O<P.length;O++){P[O].closestPointToPoint(R,!0,D);var H=R.distanceToSquared(D);H<G&&(G=H,V.copy(D))}}return V}}(),equals:function(A){return A.a.equals(this.a)&&A.b.equals(this.b)&&A.c.equals(this.c)}},C.Interpolant=function(A,P,R,D){this.parameterPositions=A,this._cachedIndex=0,this.resultBuffer=D===void 0?new P.constructor(R):D,this.sampleValues=P,this.valueSize=R},C.Interpolant.prototype={constructor:C.Interpolant,evaluate:function(A){var P=this.parameterPositions,R=this._cachedIndex,D=P[R],I=P[R-1];validate_interval:{seek:{var U;linear_scan:{forward_scan:if(!(A<D)){for(var F=R+2;;){if(void 0===D){if(A<I)break forward_scan;return R=P.length,this._cachedIndex=R,this.afterEnd_(R-1,A,I)}if(R===F)break;if(I=D,D=P[++R],A<D)break seek}U=P.length;break linear_scan}if(!(A>=I)){var V=P[1];A<V&&(R=2,I=V);for(var F=R-2;;){if(void 0===I)return this._cachedIndex=0,this.beforeStart_(0,A,D);if(R===F)break;if(D=I,I=P[--R-1],A>=I)break seek}U=R,R=0;break linear_scan}break validate_interval}for(;R<U;){var G=R+U>>>1;A<P[G]?U=G:R=G+1}if(D=P[R],I=P[R-1],void 0===I)return this._cachedIndex=0,this.beforeStart_(0,A,D);if(void 0===D)return R=P.length,this._cachedIndex=R,this.afterEnd_(R-1,I,A)}this._cachedIndex=R,this.intervalChanged_(R,I,D)}return this.interpolate_(R,I,A,D)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(A){for(var P=this.resultBuffer,R=this.sampleValues,D=this.valueSize,U=0;U!==D;++U)P[U]=R[A*D+U];return P},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}},Object.assign(C.Interpolant.prototype,{beforeStart_:C.Interpolant.prototype.copySampleValue_,afterEnd_:C.Interpolant.prototype.copySampleValue_}),C.CubicInterpolant=function(A,P,R,D){C.Interpolant.call(this,A,P,R,D),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},C.CubicInterpolant.prototype=Object.assign(Object.create(C.Interpolant.prototype),{constructor:C.CubicInterpolant,DefaultSettings_:{endingStart:C.ZeroCurvatureEnding,endingEnd:C.ZeroCurvatureEnding},intervalChanged_:function(A,P,R){var D=this.parameterPositions,I=A-2,U=A+1,F=D[I],V=D[U];if(F===void 0)switch(this.getSettings_().endingStart){case C.ZeroSlopeEnding:I=A,F=2*P-R;break;case C.WrapAroundEnding:I=D.length-2,F=P+D[I]-D[I+1];break;default:I=A,F=R;}if(void 0===V)switch(this.getSettings_().endingEnd){case C.ZeroSlopeEnding:U=A,V=2*R-P;break;case C.WrapAroundEnding:U=1,V=R+D[1]-D[0];break;default:U=A-1,V=P;}var G=0.5*(R-P),O=this.valueSize;this._weightPrev=G/(P-F),this._weightNext=G/(V-R),this._offsetPrev=I*O,this._offsetNext=U*O},interpolate_:function(A,P,R,D){for(var I=this.resultBuffer,U=this.sampleValues,F=this.valueSize,V=A*F,O=this._offsetPrev,H=this._offsetNext,W=this._weightPrev,X=this._weightNext,Y=(R-P)/(D-P),Z=Y*Y,K=Z*Y,ne=0;ne!==F;++ne)I[ne]=(-W*K+2*W*Z-W*Y)*U[O+ne]+((1+W)*K+(-1.5-2*W)*Z+(-0.5+W)*Y+1)*U[V-F+ne]+((-1-X)*K+(1.5+X)*Z+0.5*Y)*U[V+ne]+(X*K-X*Z)*U[H+ne];return I}}),C.DiscreteInterpolant=function(A,P,R,D){C.Interpolant.call(this,A,P,R,D)},C.DiscreteInterpolant.prototype=Object.assign(Object.create(C.Interpolant.prototype),{constructor:C.DiscreteInterpolant,interpolate_:function(A){return this.copySampleValue_(A-1)}}),C.LinearInterpolant=function(A,P,R,D){C.Interpolant.call(this,A,P,R,D)},C.LinearInterpolant.prototype=Object.assign(Object.create(C.Interpolant.prototype),{constructor:C.LinearInterpolant,interpolate_:function(A,P,R,D){for(var I=this.resultBuffer,U=this.sampleValues,F=this.valueSize,V=A*F,O=(R-P)/(D-P),W=0;W!==F;++W)I[W]=U[V-F+W]*(1-O)+U[V+W]*O;return I}}),C.QuaternionLinearInterpolant=function(A,P,R,D){C.Interpolant.call(this,A,P,R,D)},C.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(C.Interpolant.prototype),{constructor:C.QuaternionLinearInterpolant,interpolate_:function(A,P,R,D){for(var I=this.resultBuffer,U=this.sampleValues,F=this.valueSize,V=A*F,O=V+F;V!==O;V+=4)C.Quaternion.slerpFlat(I,0,U,V-F,U,V,(R-P)/(D-P));return I}}),C.Clock=function(A){this.autoStart=!(A!==void 0)||A,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},C.Clock.prototype={constructor:C.Clock,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var A=0;if(this.autoStart&&!this.running&&this.start(),this.running){var P=(performance||Date).now();A=(P-this.oldTime)/1e3,this.oldTime=P,this.elapsedTime+=A}return A}},C.EventDispatcher=function(){},C.EventDispatcher.prototype={constructor:C.EventDispatcher,apply:function(A){A.addEventListener=C.EventDispatcher.prototype.addEventListener,A.hasEventListener=C.EventDispatcher.prototype.hasEventListener,A.removeEventListener=C.EventDispatcher.prototype.removeEventListener,A.dispatchEvent=C.EventDispatcher.prototype.dispatchEvent},addEventListener:function(A,P){this._listeners===void 0&&(this._listeners={});var R=this._listeners;R[A]===void 0&&(R[A]=[]),-1===R[A].indexOf(P)&&R[A].push(P)},hasEventListener:function(A,P){if(this._listeners===void 0)return!1;var R=this._listeners;return void 0!==R[A]&&-1!==R[A].indexOf(P)},removeEventListener:function(A,P){if(void 0!==this._listeners){var R=this._listeners,D=R[A];if(void 0!==D){var I=D.indexOf(P);-1!==I&&D.splice(I,1)}}},dispatchEvent:function(A){if(void 0!==this._listeners){var P=this._listeners,R=P[A.type];if(void 0!==R){A.target=this;for(var D=[],I=R.length,U=0;U<I;U++)D[U]=R[U];for(var U=0;U<I;U++)D[U].call(this,A)}}}},C.Layers=function(){this.mask=1},C.Layers.prototype={constructor:C.Layers,set:function(A){this.mask=1<<A},enable:function(A){this.mask|=1<<A},toggle:function(A){this.mask^=1<<A},disable:function(A){this.mask&=~(1<<A)},test:function(A){return 0!=(this.mask&A.mask)}},function(A){function P(D,I){return D.distance-I.distance}function R(D,I,U,F){if(!1!==D.visible&&(D.raycast(I,U),!0===F))for(var V=D.children,G=0,O=V.length;G<O;G++)R(V[G],I,U,!0)}A.Raycaster=function(D,I,U,F){this.ray=new A.Ray(D,I),this.near=U||0,this.far=F||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})},A.Raycaster.prototype={constructor:A.Raycaster,linePrecision:1,set:function(D,I){this.ray.set(D,I)},setFromCamera:function(D,I){I instanceof A.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(I.matrixWorld),this.ray.direction.set(D.x,D.y,0.5).unproject(I).sub(this.ray.origin).normalize()):I instanceof A.OrthographicCamera?(this.ray.origin.set(D.x,D.y,-1).unproject(I),this.ray.direction.set(0,0,-1).transformDirection(I.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(D,I){var U=[];return R(D,this,U,I),U.sort(P),U},intersectObjects:function(D,I){var U=[];if(!1===Array.isArray(D))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),U;for(var F=0,V=D.length;F<V;F++)R(D[F],this,U,I);return U.sort(P),U}}}(C),C.Object3D=function(){Object.defineProperty(this,"id",{value:C.Object3DIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=C.Object3D.DefaultUp.clone();var R=new C.Vector3,D=new C.Euler,I=new C.Quaternion,U=new C.Vector3(1,1,1);D.onChange(function(){I.setFromEuler(D,!1)}),I.onChange(function(){D.setFromQuaternion(I,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:R},rotation:{enumerable:!0,value:D},quaternion:{enumerable:!0,value:I},scale:{enumerable:!0,value:U},modelViewMatrix:{value:new C.Matrix4},normalMatrix:{value:new C.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new C.Matrix4,this.matrixWorld=new C.Matrix4,this.matrixAutoUpdate=C.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new C.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},C.Object3D.DefaultUp=new C.Vector3(0,1,0),C.Object3D.DefaultMatrixAutoUpdate=!0,C.Object3D.prototype={constructor:C.Object3D,applyMatrix:function(A){this.matrix.multiplyMatrices(A,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(A,P){this.quaternion.setFromAxisAngle(A,P)},setRotationFromEuler:function(A){this.quaternion.setFromEuler(A,!0)},setRotationFromMatrix:function(A){this.quaternion.setFromRotationMatrix(A)},setRotationFromQuaternion:function(A){this.quaternion.copy(A)},rotateOnAxis:function(){var A=new C.Quaternion;return function(P,R){return A.setFromAxisAngle(P,R),this.quaternion.multiply(A),this}}(),rotateX:function(){var A=new C.Vector3(1,0,0);return function(P){return this.rotateOnAxis(A,P)}}(),rotateY:function(){var A=new C.Vector3(0,1,0);return function(P){return this.rotateOnAxis(A,P)}}(),rotateZ:function(){var A=new C.Vector3(0,0,1);return function(P){return this.rotateOnAxis(A,P)}}(),translateOnAxis:function(){var A=new C.Vector3;return function(P,R){return A.copy(P).applyQuaternion(this.quaternion),this.position.add(A.multiplyScalar(R)),this}}(),translateX:function(){var A=new C.Vector3(1,0,0);return function(P){return this.translateOnAxis(A,P)}}(),translateY:function(){var A=new C.Vector3(0,1,0);return function(P){return this.translateOnAxis(A,P)}}(),translateZ:function(){var A=new C.Vector3(0,0,1);return function(P){return this.translateOnAxis(A,P)}}(),localToWorld:function(A){return A.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var A=new C.Matrix4;return function(P){return P.applyMatrix4(A.getInverse(this.matrixWorld))}}(),lookAt:function(){var A=new C.Matrix4;return function(P){A.lookAt(P,this.position,this.up),this.quaternion.setFromRotationMatrix(A)}}(),add:function(A){if(1<arguments.length){for(var P=0;P<arguments.length;P++)this.add(arguments[P]);return this}return A===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",A),this):(A instanceof C.Object3D?(null!==A.parent&&A.parent.remove(A),A.parent=this,A.dispatchEvent({type:"added"}),this.children.push(A)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",A),this)},remove:function(A){if(1<arguments.length)for(var P=0;P<arguments.length;P++)this.remove(arguments[P]);var R=this.children.indexOf(A);-1!==R&&(A.parent=null,A.dispatchEvent({type:"removed"}),this.children.splice(R,1))},getObjectById:function(A){return this.getObjectByProperty("id",A)},getObjectByName:function(A){return this.getObjectByProperty("name",A)},getObjectByProperty:function(A,P){if(this[A]===P)return this;for(var R=0,D=this.children.length;R<D;R++){var I=this.children[R],U=I.getObjectByProperty(A,P);if(U!==void 0)return U}},getWorldPosition:function(A){var P=A||new C.Vector3;return this.updateMatrixWorld(!0),P.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var A=new C.Vector3,P=new C.Vector3;return function(R){var D=R||new C.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(A,D,P),D}}(),getWorldRotation:function(){var A=new C.Quaternion;return function(P){var R=P||new C.Euler;return this.getWorldQuaternion(A),R.setFromQuaternion(A,this.rotation.order,!1)}}(),getWorldScale:function(){var A=new C.Vector3,P=new C.Quaternion;return function(R){var D=R||new C.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(A,P,D),D}}(),getWorldDirection:function(){var A=new C.Quaternion;return function(P){var R=P||new C.Vector3;return this.getWorldQuaternion(A),R.set(0,0,1).applyQuaternion(A)}}(),raycast:function(){},traverse:function(A){A(this);for(var P=this.children,R=0,D=P.length;R<D;R++)P[R].traverse(A)},traverseVisible:function(A){if(!1!==this.visible){A(this);for(var P=this.children,R=0,D=P.length;R<D;R++)P[R].traverseVisible(A)}},traverseAncestors:function(A){var P=this.parent;null!==P&&(A(P),P.traverseAncestors(A))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(A){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===A)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,A=!0);for(var P=0,R=this.children.length;P<R;P++)this.children[P].updateMatrixWorld(A)},toJSON:function(A){function P(H){var W=[];for(var X in H){var Y=H[X];delete Y.metadata,W.push(Y)}return W}var R=void 0===A||""===A,D={};R&&(A={geometries:{},materials:{},textures:{},images:{}},D.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var I={};if(I.uuid=this.uuid,I.type=this.type,""!==this.name&&(I.name=this.name),"{}"!==JSON.stringify(this.userData)&&(I.userData=this.userData),!0===this.castShadow&&(I.castShadow=!0),!0===this.receiveShadow&&(I.receiveShadow=!0),!1===this.visible&&(I.visible=!1),I.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===A.geometries[this.geometry.uuid]&&(A.geometries[this.geometry.uuid]=this.geometry.toJSON(A)),I.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===A.materials[this.material.uuid]&&(A.materials[this.material.uuid]=this.material.toJSON(A)),I.material=this.material.uuid),0<this.children.length){I.children=[];for(var U=0;U<this.children.length;U++)I.children.push(this.children[U].toJSON(A).object)}if(R){var F=P(A.geometries),V=P(A.materials),G=P(A.textures),O=P(A.images);0<F.length&&(D.geometries=F),0<V.length&&(D.materials=V),0<G.length&&(D.textures=G),0<O.length&&(D.images=O)}return D.object=I,D},clone:function(A){return new this.constructor().copy(this,A)},copy:function(A,P){if(void 0===P&&(P=!0),this.name=A.name,this.up.copy(A.up),this.position.copy(A.position),this.quaternion.copy(A.quaternion),this.scale.copy(A.scale),this.rotationAutoUpdate=A.rotationAutoUpdate,this.matrix.copy(A.matrix),this.matrixWorld.copy(A.matrixWorld),this.matrixAutoUpdate=A.matrixAutoUpdate,this.matrixWorldNeedsUpdate=A.matrixWorldNeedsUpdate,this.visible=A.visible,this.castShadow=A.castShadow,this.receiveShadow=A.receiveShadow,this.frustumCulled=A.frustumCulled,this.renderOrder=A.renderOrder,this.userData=JSON.parse(JSON.stringify(A.userData)),!0===P)for(var R=0,D;R<A.children.length;R++)D=A.children[R],this.add(D.clone());return this}},C.EventDispatcher.prototype.apply(C.Object3D.prototype),C.Object3DIdCount=0,C.Face3=function(A,P,R,D,I,U){this.a=A,this.b=P,this.c=R,this.normal=D instanceof C.Vector3?D:new C.Vector3,this.vertexNormals=Array.isArray(D)?D:[],this.color=I instanceof C.Color?I:new C.Color,this.vertexColors=Array.isArray(I)?I:[],this.materialIndex=U===void 0?0:U},C.Face3.prototype={constructor:C.Face3,clone:function(){return new this.constructor().copy(this)},copy:function(A){this.a=A.a,this.b=A.b,this.c=A.c,this.normal.copy(A.normal),this.color.copy(A.color),this.materialIndex=A.materialIndex;for(var P=0,R=A.vertexNormals.length;P<R;P++)this.vertexNormals[P]=A.vertexNormals[P].clone();for(var P=0,R=A.vertexColors.length;P<R;P++)this.vertexColors[P]=A.vertexColors[P].clone();return this}},C.BufferAttribute=function(A,P,R){this.uuid=C.Math.generateUUID(),this.array=A,this.itemSize=P,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.normalized=!0===R},C.BufferAttribute.prototype={constructor:C.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(A){!0===A&&this.version++},setDynamic:function(A){return this.dynamic=A,this},copy:function(A){return this.array=new A.array.constructor(A.array),this.itemSize=A.itemSize,this.dynamic=A.dynamic,this},copyAt:function(A,P,R){A*=this.itemSize,R*=P.itemSize;for(var D=0,I=this.itemSize;D<I;D++)this.array[A+D]=P.array[R+D];return this},copyArray:function(A){return this.array.set(A),this},copyColorsArray:function(A){for(var P=this.array,R=0,D=0,I=A.length,U;D<I;D++)U=A[D],void 0===U&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",D),U=new C.Color),P[R++]=U.r,P[R++]=U.g,P[R++]=U.b;return this},copyIndicesArray:function(A){for(var P=this.array,R=0,D=0,I=A.length,U;D<I;D++)U=A[D],P[R++]=U.a,P[R++]=U.b,P[R++]=U.c;return this},copyVector2sArray:function(A){for(var P=this.array,R=0,D=0,I=A.length,U;D<I;D++)U=A[D],void 0===U&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",D),U=new C.Vector2),P[R++]=U.x,P[R++]=U.y;return this},copyVector3sArray:function(A){for(var P=this.array,R=0,D=0,I=A.length,U;D<I;D++)U=A[D],void 0===U&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",D),U=new C.Vector3),P[R++]=U.x,P[R++]=U.y,P[R++]=U.z;return this},copyVector4sArray:function(A){for(var P=this.array,R=0,D=0,I=A.length,U;D<I;D++)U=A[D],void 0===U&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",D),U=new C.Vector4),P[R++]=U.x,P[R++]=U.y,P[R++]=U.z,P[R++]=U.w;return this},set:function(A,P){return void 0===P&&(P=0),this.array.set(A,P),this},getX:function(A){return this.array[A*this.itemSize]},setX:function(A,P){return this.array[A*this.itemSize]=P,this},getY:function(A){return this.array[A*this.itemSize+1]},setY:function(A,P){return this.array[A*this.itemSize+1]=P,this},getZ:function(A){return this.array[A*this.itemSize+2]},setZ:function(A,P){return this.array[A*this.itemSize+2]=P,this},getW:function(A){return this.array[A*this.itemSize+3]},setW:function(A,P){return this.array[A*this.itemSize+3]=P,this},setXY:function(A,P,R){return A*=this.itemSize,this.array[A+0]=P,this.array[A+1]=R,this},setXYZ:function(A,P,R,D){return A*=this.itemSize,this.array[A+0]=P,this.array[A+1]=R,this.array[A+2]=D,this},setXYZW:function(A,P,R,D,I){return A*=this.itemSize,this.array[A+0]=P,this.array[A+1]=R,this.array[A+2]=D,this.array[A+3]=I,this},clone:function(){return new this.constructor().copy(this)}},C.Int8Attribute=function(A,P){return new C.BufferAttribute(new Int8Array(A),P)},C.Uint8Attribute=function(A,P){return new C.BufferAttribute(new Uint8Array(A),P)},C.Uint8ClampedAttribute=function(A,P){return new C.BufferAttribute(new Uint8ClampedArray(A),P)},C.Int16Attribute=function(A,P){return new C.BufferAttribute(new Int16Array(A),P)},C.Uint16Attribute=function(A,P){return new C.BufferAttribute(new Uint16Array(A),P)},C.Int32Attribute=function(A,P){return new C.BufferAttribute(new Int32Array(A),P)},C.Uint32Attribute=function(A,P){return new C.BufferAttribute(new Uint32Array(A),P)},C.Float32Attribute=function(A,P){return new C.BufferAttribute(new Float32Array(A),P)},C.Float64Attribute=function(A,P){return new C.BufferAttribute(new Float64Array(A),P)},C.DynamicBufferAttribute=function(A,P){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new C.BufferAttribute(A,P).setDynamic(!0)},C.InstancedBufferAttribute=function(A,P,R){C.BufferAttribute.call(this,A,P),this.meshPerAttribute=R||1},C.InstancedBufferAttribute.prototype=Object.create(C.BufferAttribute.prototype),C.InstancedBufferAttribute.prototype.constructor=C.InstancedBufferAttribute,C.InstancedBufferAttribute.prototype.copy=function(A){return C.BufferAttribute.prototype.copy.call(this,A),this.meshPerAttribute=A.meshPerAttribute,this},C.InterleavedBuffer=function(A,P){this.uuid=C.Math.generateUUID(),this.array=A,this.stride=P,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},C.InterleavedBuffer.prototype={constructor:C.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(A){!0===A&&this.version++},setDynamic:function(A){return this.dynamic=A,this},copy:function(A){return this.array=new A.array.constructor(A.array),this.stride=A.stride,this.dynamic=A.dynamic,this},copyAt:function(A,P,R){A*=this.stride,R*=P.stride;for(var D=0,I=this.stride;D<I;D++)this.array[A+D]=P.array[R+D];return this},set:function(A,P){return void 0===P&&(P=0),this.array.set(A,P),this},clone:function(){return new this.constructor().copy(this)}},C.InstancedInterleavedBuffer=function(A,P,R){C.InterleavedBuffer.call(this,A,P),this.meshPerAttribute=R||1},C.InstancedInterleavedBuffer.prototype=Object.create(C.InterleavedBuffer.prototype),C.InstancedInterleavedBuffer.prototype.constructor=C.InstancedInterleavedBuffer,C.InstancedInterleavedBuffer.prototype.copy=function(A){return C.InterleavedBuffer.prototype.copy.call(this,A),this.meshPerAttribute=A.meshPerAttribute,this},C.InterleavedBufferAttribute=function(A,P,R){this.uuid=C.Math.generateUUID(),this.data=A,this.itemSize=P,this.offset=R},C.InterleavedBufferAttribute.prototype={constructor:C.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.count},setX:function(A,P){return this.data.array[A*this.data.stride+this.offset]=P,this},setY:function(A,P){return this.data.array[A*this.data.stride+this.offset+1]=P,this},setZ:function(A,P){return this.data.array[A*this.data.stride+this.offset+2]=P,this},setW:function(A,P){return this.data.array[A*this.data.stride+this.offset+3]=P,this},getX:function(A){return this.data.array[A*this.data.stride+this.offset]},getY:function(A){return this.data.array[A*this.data.stride+this.offset+1]},getZ:function(A){return this.data.array[A*this.data.stride+this.offset+2]},getW:function(A){return this.data.array[A*this.data.stride+this.offset+3]},setXY:function(A,P,R){return A=A*this.data.stride+this.offset,this.data.array[A+0]=P,this.data.array[A+1]=R,this},setXYZ:function(A,P,R,D){return A=A*this.data.stride+this.offset,this.data.array[A+0]=P,this.data.array[A+1]=R,this.data.array[A+2]=D,this},setXYZW:function(A,P,R,D,I){return A=A*this.data.stride+this.offset,this.data.array[A+0]=P,this.data.array[A+1]=R,this.data.array[A+2]=D,this.data.array[A+3]=I,this}},C.Geometry=function(){Object.defineProperty(this,"id",{value:C.GeometryIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},C.Geometry.prototype={constructor:C.Geometry,applyMatrix:function(A){for(var P=new C.Matrix3().getNormalMatrix(A),R=0,D=this.vertices.length,I;R<D;R++)I=this.vertices[R],I.applyMatrix4(A);for(var R=0,D=this.faces.length,U;R<D;R++){U=this.faces[R],U.normal.applyMatrix3(P).normalize();for(var F=0,V=U.vertexNormals.length;F<V;F++)U.vertexNormals[F].applyMatrix3(P).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationX(R),this.applyMatrix(A),this}}(),rotateY:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationY(R),this.applyMatrix(A),this}}(),rotateZ:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationZ(R),this.applyMatrix(A),this}}(),translate:function(){var A;return function(R,D,I){return void 0==A&&(A=new C.Matrix4),A.makeTranslation(R,D,I),this.applyMatrix(A),this}}(),scale:function(){var A;return function(R,D,I){return void 0==A&&(A=new C.Matrix4),A.makeScale(R,D,I),this.applyMatrix(A),this}}(),lookAt:function(){var A;return function(R){A==void 0&&(A=new C.Object3D),A.lookAt(R),A.updateMatrix(),this.applyMatrix(A.matrix)}}(),fromBufferGeometry:function(A){function P(ne,ie,se,le){var pe=void 0===F?[]:[H[ne].clone(),H[ie].clone(),H[se].clone()],ue=void 0===V?[]:[R.colors[ne].clone(),R.colors[ie].clone(),R.colors[se].clone()],ge=new C.Face3(ne,ie,se,pe,ue,le);R.faces.push(ge),void 0!==G&&R.faceVertexUvs[0].push([W[ne].clone(),W[ie].clone(),W[se].clone()]),void 0!==O&&R.faceVertexUvs[1].push([X[ne].clone(),X[ie].clone(),X[se].clone()])}var R=this,D=null===A.index?void 0:A.index.array,I=A.attributes,U=I.position.array,F=void 0===I.normal?void 0:I.normal.array,V=void 0===I.color?void 0:I.color.array,G=void 0===I.uv?void 0:I.uv.array,O=void 0===I.uv2?void 0:I.uv2.array;void 0!==O&&(this.faceVertexUvs[1]=[]);for(var H=[],W=[],X=[],Y=0,Z=0;Y<U.length;Y+=3,Z+=2)R.vertices.push(new C.Vector3(U[Y],U[Y+1],U[Y+2])),void 0!==F&&H.push(new C.Vector3(F[Y],F[Y+1],F[Y+2])),void 0!==V&&R.colors.push(new C.Color(V[Y],V[Y+1],V[Y+2])),void 0!==G&&W.push(new C.Vector2(G[Z],G[Z+1])),void 0!==O&&X.push(new C.Vector2(O[Z],O[Z+1]));if(void 0!==D){var K=A.groups;if(0<K.length)for(var Y=0;Y<K.length;Y++)for(var Q=K[Y],J=Q.start,ee=Q.count,Z=J;Z<J+ee;Z+=3)P(D[Z],D[Z+1],D[Z+2],Q.materialIndex);else for(var Y=0;Y<D.length;Y+=3)P(D[Y],D[Y+1],D[Y+2])}else for(var Y=0;Y<U.length/3;Y+=3)P(Y,Y+1,Y+2);return this.computeFaceNormals(),null!==A.boundingBox&&(this.boundingBox=A.boundingBox.clone()),null!==A.boundingSphere&&(this.boundingSphere=A.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var A=this.boundingBox.center().negate();return this.translate(A.x,A.y,A.z),A},normalize:function(){this.computeBoundingSphere();var A=this.boundingSphere.center,P=this.boundingSphere.radius,R=0===P?1:1/P,D=new C.Matrix4;return D.set(R,0,0,-R*A.x,0,R,0,-R*A.y,0,0,R,-R*A.z,0,0,0,1),this.applyMatrix(D),this},computeFaceNormals:function(){for(var A=new C.Vector3,P=new C.Vector3,R=0,D=this.faces.length;R<D;R++){var I=this.faces[R],U=this.vertices[I.a],F=this.vertices[I.b],V=this.vertices[I.c];A.subVectors(V,F),P.subVectors(U,F),A.cross(P),A.normalize(),I.normal.copy(A)}},computeVertexNormals:function(A){A===void 0&&(A=!0);var P,R,D,I,U,F;for(F=Array(this.vertices.length),P=0,R=this.vertices.length;P<R;P++)F[P]=new C.Vector3;if(A){var V,G,O,H=new C.Vector3,W=new C.Vector3;for(D=0,I=this.faces.length;D<I;D++)U=this.faces[D],V=this.vertices[U.a],G=this.vertices[U.b],O=this.vertices[U.c],H.subVectors(O,G),W.subVectors(V,G),H.cross(W),F[U.a].add(H),F[U.b].add(H),F[U.c].add(H)}else for(D=0,I=this.faces.length;D<I;D++)U=this.faces[D],F[U.a].add(U.normal),F[U.b].add(U.normal),F[U.c].add(U.normal);for(P=0,R=this.vertices.length;P<R;P++)F[P].normalize();for(D=0,I=this.faces.length;D<I;D++){U=this.faces[D];var X=U.vertexNormals;3===X.length?(X[0].copy(F[U.a]),X[1].copy(F[U.b]),X[2].copy(F[U.c])):(X[0]=F[U.a].clone(),X[1]=F[U.b].clone(),X[2]=F[U.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var A,P,R,D,I;for(R=0,D=this.faces.length;R<D;R++)for(I=this.faces[R],I.__originalFaceNormal?I.__originalFaceNormal.copy(I.normal):I.__originalFaceNormal=I.normal.clone(),I.__originalVertexNormals||(I.__originalVertexNormals=[]),(A=0,P=I.vertexNormals.length);A<P;A++)I.__originalVertexNormals[A]?I.__originalVertexNormals[A].copy(I.vertexNormals[A]):I.__originalVertexNormals[A]=I.vertexNormals[A].clone();var U=new C.Geometry;for(U.faces=this.faces,A=0,P=this.morphTargets.length;A<P;A++){if(!this.morphNormals[A]){this.morphNormals[A]={},this.morphNormals[A].faceNormals=[],this.morphNormals[A].vertexNormals=[];var F=this.morphNormals[A].faceNormals,V=this.morphNormals[A].vertexNormals,G,O;for(R=0,D=this.faces.length;R<D;R++)G=new C.Vector3,O={a:new C.Vector3,b:new C.Vector3,c:new C.Vector3},F.push(G),V.push(O)}var H=this.morphNormals[A];U.vertices=this.morphTargets[A].vertices,U.computeFaceNormals(),U.computeVertexNormals();var G,O;for(R=0,D=this.faces.length;R<D;R++)I=this.faces[R],G=H.faceNormals[R],O=H.vertexNormals[R],G.copy(I.normal),O.a.copy(I.vertexNormals[0]),O.b.copy(I.vertexNormals[1]),O.c.copy(I.vertexNormals[2])}for(R=0,D=this.faces.length;R<D;R++)I=this.faces[R],I.normal=I.__originalFaceNormal,I.vertexNormals=I.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var A=0,P=this.vertices,R=0,D=P.length;R<D;R++)0<R&&(A+=P[R].distanceTo(P[R-1])),this.lineDistances[R]=A},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new C.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new C.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(A,P,R){if(!1==A instanceof C.Geometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",A);var I=this.vertices.length,U=this.vertices,F=A.vertices,V=this.faces,G=A.faces,O=this.faceVertexUvs[0],H=A.faceVertexUvs[0],D;R===void 0&&(R=0),P!==void 0&&(D=new C.Matrix3().getNormalMatrix(P));for(var W=0,X=F.length;W<X;W++){var Y=F[W],Z=Y.clone();P!==void 0&&Z.applyMatrix4(P),U.push(Z)}for(W=0,X=G.length;W<X;W++){var K=G[W],oe=K.vertexNormals,ne=K.vertexColors,Q,J,ee;Q=new C.Face3(K.a+I,K.b+I,K.c+I),Q.normal.copy(K.normal),D!==void 0&&Q.normal.applyMatrix3(D).normalize();for(var ie=0,se=oe.length;ie<se;ie++)J=oe[ie].clone(),void 0!==D&&J.applyMatrix3(D).normalize(),Q.vertexNormals.push(J);Q.color.copy(K.color);for(var ie=0,se=ne.length;ie<se;ie++)ee=ne[ie],Q.vertexColors.push(ee.clone());Q.materialIndex=K.materialIndex+R,V.push(Q)}for(W=0,X=H.length;W<X;W++){var le=H[W],pe=[];if(void 0!==le){for(var ie=0,se=le.length;ie<se;ie++)pe.push(le[ie].clone());O.push(pe)}}},mergeMesh:function(A){return!1==A instanceof C.Mesh?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",A):void(A.matrixAutoUpdate&&A.updateMatrix(),this.merge(A.geometry,A.matrix))},mergeVertices:function(){var A={},P=[],R=[],F=10000,D,I,V,G,O,H,W,X;for(V=0,G=this.vertices.length;V<G;V++)D=this.vertices[V],I=_Mathround(D.x*F)+"_"+_Mathround(D.y*F)+"_"+_Mathround(D.z*F),void 0===A[I]?(A[I]=V,P.push(this.vertices[V]),R[V]=P.length-1):R[V]=R[A[I]];var Y=[];for(V=0,G=this.faces.length;V<G;V++){O=this.faces[V],O.a=R[O.a],O.b=R[O.b],O.c=R[O.c],H=[O.a,O.b,O.c];for(var Z=-1,K=0;3>K;K++)if(H[K]===H[(K+1)%3]){Z=K,Y.push(V);break}}for(V=Y.length-1;0<=V;V--){var Q=Y[V];for(this.faces.splice(Q,1),W=0,X=this.faceVertexUvs.length;W<X;W++)this.faceVertexUvs[W].splice(Q,1)}var J=this.vertices.length-P.length;return this.vertices=P,J},sortFacesByMaterialIndex:function(){for(var P=this.faces,R=P.length,D=0;D<R;D++)P[D]._id=D;P.sort(function(O,H){return O.materialIndex-H.materialIndex});var I=this.faceVertexUvs[0],U=this.faceVertexUvs[1],F,V;I&&I.length===R&&(F=[]),U&&U.length===R&&(V=[]);for(var D=0,G;D<R;D++)G=P[D]._id,F&&F.push(I[G]),V&&V.push(U[G]);F&&(this.faceVertexUvs[0]=F),V&&(this.faceVertexUvs[1]=V)},toJSON:function(){function A(ye,xe,ve){return ve?ye|1<<xe:ye&~(1<<xe)}function P(ye){var xe=ye.x.toString()+ye.y.toString()+ye.z.toString();return void 0===X[xe]?(X[xe]=W.length/3,W.push(ye.x,ye.y,ye.z),X[xe]):X[xe]}function R(ye){var xe=ye.r.toString()+ye.g.toString()+ye.b.toString();return void 0===Z[xe]?(Z[xe]=Y.length,Y.push(ye.getHex()),Z[xe]):Z[xe]}function D(ye){var xe=ye.x.toString()+ye.y.toString();return void 0===Q[xe]?(Q[xe]=K.length/2,K.push(ye.x,ye.y),Q[xe]):Q[xe]}var I={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(I.uuid=this.uuid,I.type=this.type,""!==this.name&&(I.name=this.name),void 0!==this.parameters){var U=this.parameters;for(var F in U)void 0!==U[F]&&(I[F]=U[F]);return I}for(var V=[],G=0,O;G<this.vertices.length;G++)O=this.vertices[G],V.push(O.x,O.y,O.z);for(var H=[],W=[],X={},Y=[],Z={},K=[],Q={},G=0;G<this.faces.length;G++){var J=this.faces[G],ne=void 0!==this.faceVertexUvs[0][G],ie=0<J.normal.length(),se=0<J.vertexNormals.length,le=1!==J.color.r||1!==J.color.g||1!==J.color.b,pe=0<J.vertexColors.length,ue=0;if(ue=A(ue,0,0),ue=A(ue,1,!0),ue=A(ue,2,!1),ue=A(ue,3,ne),ue=A(ue,4,ie),ue=A(ue,5,se),ue=A(ue,6,le),ue=A(ue,7,pe),H.push(ue),H.push(J.a,J.b,J.c),H.push(J.materialIndex),ne){var ge=this.faceVertexUvs[0][G];H.push(D(ge[0]),D(ge[1]),D(ge[2]))}if(ie&&H.push(P(J.normal)),se){var fe=J.vertexNormals;H.push(P(fe[0]),P(fe[1]),P(fe[2]))}if(le&&H.push(R(J.color)),pe){var he=J.vertexColors;H.push(R(he[0]),R(he[1]),R(he[2]))}}return I.data={},I.data.vertices=V,I.data.normals=W,0<Y.length&&(I.data.colors=Y),0<K.length&&(I.data.uvs=[K]),I.data.faces=H,I},clone:function(){return new C.Geometry().copy(this)},copy:function(A){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var P=A.vertices,R=0,D=P.length;R<D;R++)this.vertices.push(P[R].clone());for(var I=A.faces,R=0,D=I.length;R<D;R++)this.faces.push(I[R].clone());for(var R=0,D=A.faceVertexUvs.length,U;R<D;R++){U=A.faceVertexUvs[R],this.faceVertexUvs[R]===void 0&&(this.faceVertexUvs[R]=[]);for(var F=0,V=U.length;F<V;F++){for(var G=U[F],O=[],H=0,W=G.length,X;H<W;H++)X=G[H],O.push(X.clone());this.faceVertexUvs[R].push(O)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},C.EventDispatcher.prototype.apply(C.Geometry.prototype),C.GeometryIdCount=0,C.DirectGeometry=function(){Object.defineProperty(this,"id",{value:C.GeometryIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},C.DirectGeometry.prototype={constructor:C.DirectGeometry,computeBoundingBox:C.Geometry.prototype.computeBoundingBox,computeBoundingSphere:C.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(A){for(var R=[],I=A.faces,U=0,P,D,F;U<I.length;U++)F=I[U],F.materialIndex!==D&&(D=F.materialIndex,void 0!=P&&(P.count=3*U-P.start,R.push(P)),P={start:3*U,materialIndex:D});P!==void 0&&(P.count=3*U-P.start,R.push(P)),this.groups=R},fromGeometry:function(A){var P=A.faces,R=A.vertices,D=A.faceVertexUvs,I=D[0]&&0<D[0].length,U=D[1]&&0<D[1].length,F=A.morphTargets,V=F.length,G;if(0<V){G=[];for(var O=0;O<V;O++)G[O]=[];this.morphTargets.position=G}var H=A.morphNormals,W=H.length,X;if(0<W){X=[];for(var O=0;O<W;O++)X[O]=[];this.morphTargets.normal=X}for(var Y=A.skinIndices,Z=A.skinWeights,K=Y.length===R.length,Q=Z.length===R.length,O=0,J;O<P.length;O++){J=P[O],this.vertices.push(R[J.a],R[J.b],R[J.c]);var ee=J.vertexNormals;if(3===ee.length)this.normals.push(ee[0],ee[1],ee[2]);else{var oe=J.normal;this.normals.push(oe,oe,oe)}var ne=J.vertexColors;if(3===ne.length)this.colors.push(ne[0],ne[1],ne[2]);else{var ie=J.color;this.colors.push(ie,ie,ie)}if(!0===I){var se=D[0][O];void 0===se?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",O),this.uvs.push(new C.Vector2,new C.Vector2,new C.Vector2)):this.uvs.push(se[0],se[1],se[2])}if(!0===U){var se=D[1][O];void 0===se?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",O),this.uvs2.push(new C.Vector2,new C.Vector2,new C.Vector2)):this.uvs2.push(se[0],se[1],se[2])}for(var le=0,pe;le<V;le++)pe=F[le].vertices,G[le].push(pe[J.a],pe[J.b],pe[J.c]);for(var le=0,ue;le<W;le++)ue=H[le].vertexNormals[O],X[le].push(ue.a,ue.b,ue.c);K&&this.skinIndices.push(Y[J.a],Y[J.b],Y[J.c]),Q&&this.skinWeights.push(Z[J.a],Z[J.b],Z[J.c])}return this.computeGroups(A),this.verticesNeedUpdate=A.verticesNeedUpdate,this.normalsNeedUpdate=A.normalsNeedUpdate,this.colorsNeedUpdate=A.colorsNeedUpdate,this.uvsNeedUpdate=A.uvsNeedUpdate,this.groupsNeedUpdate=A.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},C.EventDispatcher.prototype.apply(C.DirectGeometry.prototype),C.BufferGeometry=function(){Object.defineProperty(this,"id",{value:C.GeometryIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity}},C.BufferGeometry.prototype={constructor:C.BufferGeometry,getIndex:function(){return this.index},setIndex:function(A){this.index=A},addAttribute:function(A,P){return!1==P instanceof C.BufferAttribute&&!1==P instanceof C.InterleavedBufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(A,new C.BufferAttribute(arguments[1],arguments[2]))):"index"===A?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(P)):(this.attributes[A]=P,this)},getAttribute:function(A){return this.attributes[A]},removeAttribute:function(A){return delete this.attributes[A],this},addGroup:function(A,P,R){this.groups.push({start:A,count:P,materialIndex:R===void 0?0:R})},clearGroups:function(){this.groups=[]},setDrawRange:function(A,P){this.drawRange.start=A,this.drawRange.count=P},applyMatrix:function(A){var P=this.attributes.position;void 0!==P&&(A.applyToVector3Array(P.array),P.needsUpdate=!0);var R=this.attributes.normal;if(void 0!==R){var D=new C.Matrix3().getNormalMatrix(A);D.applyToVector3Array(R.array),R.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationX(R),this.applyMatrix(A),this}}(),rotateY:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationY(R),this.applyMatrix(A),this}}(),rotateZ:function(){var A;return function(R){return void 0==A&&(A=new C.Matrix4),A.makeRotationZ(R),this.applyMatrix(A),this}}(),translate:function(){var A;return function(R,D,I){return void 0==A&&(A=new C.Matrix4),A.makeTranslation(R,D,I),this.applyMatrix(A),this}}(),scale:function(){var A;return function(R,D,I){return void 0==A&&(A=new C.Matrix4),A.makeScale(R,D,I),this.applyMatrix(A),this}}(),lookAt:function(){var A;return function(R){A==void 0&&(A=new C.Object3D),A.lookAt(R),A.updateMatrix(),this.applyMatrix(A.matrix)}}(),center:function(){this.computeBoundingBox();var A=this.boundingBox.center().negate();return this.translate(A.x,A.y,A.z),A},setFromObject:function(A){var P=A.geometry;if(A instanceof C.Points||A instanceof C.Line){var R=new C.Float32Attribute(3*P.vertices.length,3),D=new C.Float32Attribute(3*P.colors.length,3);if(this.addAttribute("position",R.copyVector3sArray(P.vertices)),this.addAttribute("color",D.copyColorsArray(P.colors)),P.lineDistances&&P.lineDistances.length===P.vertices.length){var I=new C.Float32Attribute(P.lineDistances.length,1);this.addAttribute("lineDistance",I.copyArray(P.lineDistances))}null!==P.boundingSphere&&(this.boundingSphere=P.boundingSphere.clone()),null!==P.boundingBox&&(this.boundingBox=P.boundingBox.clone())}else A instanceof C.Mesh&&P instanceof C.Geometry&&this.fromGeometry(P);return this},updateFromObject:function(A){var P=A.geometry;if(A instanceof C.Mesh){var R=P.__directGeometry;if(void 0===R)return this.fromGeometry(P);R.verticesNeedUpdate=P.verticesNeedUpdate,R.normalsNeedUpdate=P.normalsNeedUpdate,R.colorsNeedUpdate=P.colorsNeedUpdate,R.uvsNeedUpdate=P.uvsNeedUpdate,R.groupsNeedUpdate=P.groupsNeedUpdate,P.verticesNeedUpdate=!1,P.normalsNeedUpdate=!1,P.colorsNeedUpdate=!1,P.uvsNeedUpdate=!1,P.groupsNeedUpdate=!1,P=R}if(!0===P.verticesNeedUpdate){var D=this.attributes.position;void 0!==D&&(D.copyVector3sArray(P.vertices),D.needsUpdate=!0),P.verticesNeedUpdate=!1}if(!0===P.normalsNeedUpdate){var D=this.attributes.normal;void 0!==D&&(D.copyVector3sArray(P.normals),D.needsUpdate=!0),P.normalsNeedUpdate=!1}if(!0===P.colorsNeedUpdate){var D=this.attributes.color;void 0!==D&&(D.copyColorsArray(P.colors),D.needsUpdate=!0),P.colorsNeedUpdate=!1}if(P.uvsNeedUpdate){var D=this.attributes.uv;void 0!==D&&(D.copyVector2sArray(P.uvs),D.needsUpdate=!0),P.uvsNeedUpdate=!1}if(P.lineDistancesNeedUpdate){var D=this.attributes.lineDistance;void 0!==D&&(D.copyArray(P.lineDistances),D.needsUpdate=!0),P.lineDistancesNeedUpdate=!1}return P.groupsNeedUpdate&&(P.computeGroups(A.geometry),this.groups=P.groups,P.groupsNeedUpdate=!1),this},fromGeometry:function(A){return A.__directGeometry=new C.DirectGeometry().fromGeometry(A),this.fromDirectGeometry(A.__directGeometry)},fromDirectGeometry:function(A){var P=new Float32Array(3*A.vertices.length);if(this.addAttribute("position",new C.BufferAttribute(P,3).copyVector3sArray(A.vertices)),0<A.normals.length){var R=new Float32Array(3*A.normals.length);this.addAttribute("normal",new C.BufferAttribute(R,3).copyVector3sArray(A.normals))}if(0<A.colors.length){var D=new Float32Array(3*A.colors.length);this.addAttribute("color",new C.BufferAttribute(D,3).copyColorsArray(A.colors))}if(0<A.uvs.length){var I=new Float32Array(2*A.uvs.length);this.addAttribute("uv",new C.BufferAttribute(I,2).copyVector2sArray(A.uvs))}if(0<A.uvs2.length){var U=new Float32Array(2*A.uvs2.length);this.addAttribute("uv2",new C.BufferAttribute(U,2).copyVector2sArray(A.uvs2))}if(0<A.indices.length){var F=65535<A.vertices.length?Uint32Array:Uint16Array,V=new F(3*A.indices.length);this.setIndex(new C.BufferAttribute(V,1).copyIndicesArray(A.indices))}for(var G in this.groups=A.groups,A.morphTargets){for(var O=[],H=A.morphTargets[G],W=0,X=H.length;W<X;W++){var Y=H[W],Z=new C.Float32Attribute(3*Y.length,3);O.push(Z.copyVector3sArray(Y))}this.morphAttributes[G]=O}if(0<A.skinIndices.length){var K=new C.Float32Attribute(4*A.skinIndices.length,4);this.addAttribute("skinIndex",K.copyVector4sArray(A.skinIndices))}if(0<A.skinWeights.length){var Q=new C.Float32Attribute(4*A.skinWeights.length,4);this.addAttribute("skinWeight",Q.copyVector4sArray(A.skinWeights))}return null!==A.boundingSphere&&(this.boundingSphere=A.boundingSphere.clone()),null!==A.boundingBox&&(this.boundingBox=A.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new C.Box3);var A=this.attributes.position.array;A===void 0?this.boundingBox.makeEmpty():this.boundingBox.setFromArray(A),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){var A=new C.Box3,P=new C.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new C.Sphere);var R=this.attributes.position.array;if(R){var D=this.boundingSphere.center;A.setFromArray(R),A.center(D);for(var I=0,U=0,F=R.length;U<F;U+=3)P.fromArray(R,U),I=_Mathmax(I,D.distanceToSquared(P));this.boundingSphere.radius=_Mathsqrt(I),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var A=this.index,P=this.attributes,R=this.groups;if(P.position){var D=P.position.array;if(P.normal===void 0)this.addAttribute("normal",new C.BufferAttribute(new Float32Array(D.length),3));else for(var I=P.normal.array,U=0,F=I.length;U<F;U++)I[U]=0;var V=P.normal.array,G,O,H,W=new C.Vector3,X=new C.Vector3,Y=new C.Vector3,Z=new C.Vector3,K=new C.Vector3;if(A){var Q=A.array;0===R.length&&this.addGroup(0,Q.length);for(var J=0,ee=R.length;J<ee;++J)for(var oe=R[J],ne=oe.start,ie=oe.count,U=ne,F=ne+ie;U<F;U+=3)G=3*Q[U+0],O=3*Q[U+1],H=3*Q[U+2],W.fromArray(D,G),X.fromArray(D,O),Y.fromArray(D,H),Z.subVectors(Y,X),K.subVectors(W,X),Z.cross(K),V[G]+=Z.x,V[G+1]+=Z.y,V[G+2]+=Z.z,V[O]+=Z.x,V[O+1]+=Z.y,V[O+2]+=Z.z,V[H]+=Z.x,V[H+1]+=Z.y,V[H+2]+=Z.z}else for(var U=0,F=D.length;U<F;U+=9)W.fromArray(D,U),X.fromArray(D,U+3),Y.fromArray(D,U+6),Z.subVectors(Y,X),K.subVectors(W,X),Z.cross(K),V[U]=Z.x,V[U+1]=Z.y,V[U+2]=Z.z,V[U+3]=Z.x,V[U+4]=Z.y,V[U+5]=Z.z,V[U+6]=Z.x,V[U+7]=Z.y,V[U+8]=Z.z;this.normalizeNormals(),P.normal.needsUpdate=!0}},merge:function(A,P){if(!1==A instanceof C.BufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",A);P===void 0&&(P=0);var R=this.attributes;for(var D in R)if(A.attributes[D]!==void 0)for(var I=R[D],U=I.array,F=A.attributes[D],V=F.array,G=F.itemSize,O=0,H=G*P;O<V.length;O++,H++)U[H]=V[O];return this},normalizeNormals:function(){for(var A=this.attributes.normal.array,U=0,F=A.length,P,R,D,I;U<F;U+=3)P=A[U],R=A[U+1],D=A[U+2],I=1/_Mathsqrt(P*P+R*R+D*D),A[U]*=I,A[U+1]*=I,A[U+2]*=I},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var A=new C.BufferGeometry,P=this.index.array,R=this.attributes;for(var D in R){for(var I=R[D],U=I.array,F=I.itemSize,V=new U.constructor(P.length*F),G=0,O=0,H=0,W=P.length;H<W;H++){G=P[H]*F;for(var X=0;X<F;X++)V[O++]=U[G++]}A.addAttribute(D,new C.BufferAttribute(V,F))}return A},toJSON:function(){var A={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(A.uuid=this.uuid,A.type=this.type,""!==this.name&&(A.name=this.name),void 0!==this.parameters){var P=this.parameters;for(var R in P)void 0!==P[R]&&(A[R]=P[R]);return A}A.data={attributes:{}};var D=this.index;if(null!==D){var I=Array.prototype.slice.call(D.array);A.data.index={type:D.array.constructor.name,array:I}}var U=this.attributes;for(var R in U){var F=U[R],I=Array.prototype.slice.call(F.array);A.data.attributes[R]={itemSize:F.itemSize,type:F.array.constructor.name,array:I,normalized:F.normalized}}var V=this.groups;0<V.length&&(A.data.groups=JSON.parse(JSON.stringify(V)));var G=this.boundingSphere;return null!==G&&(A.data.boundingSphere={center:G.center.toArray(),radius:G.radius}),A},clone:function(){return new C.BufferGeometry().copy(this)},copy:function(A){var P=A.index;null!==P&&this.setIndex(P.clone());var R=A.attributes;for(var D in R){var I=R[D];this.addAttribute(D,I.clone())}for(var U=A.groups,F=0,V=U.length,G;F<V;F++)G=U[F],this.addGroup(G.start,G.count,G.materialIndex);return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},C.EventDispatcher.prototype.apply(C.BufferGeometry.prototype),C.BufferGeometry.MaxIndex=65535,C.InstancedBufferGeometry=function(){C.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},C.InstancedBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.InstancedBufferGeometry.prototype.constructor=C.InstancedBufferGeometry,C.InstancedBufferGeometry.prototype.addGroup=function(A,P,R){this.groups.push({start:A,count:P,instances:R})},C.InstancedBufferGeometry.prototype.copy=function(A){var P=A.index;null!==P&&this.setIndex(P.clone());var R=A.attributes;for(var D in R){var I=R[D];this.addAttribute(D,I.clone())}for(var U=A.groups,F=0,V=U.length,G;F<V;F++)G=U[F],this.addGroup(G.start,G.count,G.instances);return this},C.EventDispatcher.prototype.apply(C.InstancedBufferGeometry.prototype),C.Uniform=function(A){"string"==typeof A&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),A=arguments[1]),this.value=A,this.dynamic=!1},C.Uniform.prototype={constructor:C.Uniform,onUpdate:function(A){return this.dynamic=!0,this.onUpdateCallback=A,this}},C.AnimationClip=function(A,P,R){this.name=A||C.Math.generateUUID(),this.tracks=R,this.duration=P===void 0?-1:P,0>this.duration&&this.resetDuration(),this.trim(),this.optimize()},C.AnimationClip.prototype={constructor:C.AnimationClip,resetDuration:function(){for(var A=this.tracks,P=0,R=0,D=A.length,I;R!==D;++R)I=this.tracks[R],P=_Mathmax(P,I.times[I.times.length-1]);this.duration=P},trim:function(){for(var A=0;A<this.tracks.length;A++)this.tracks[A].trim(0,this.duration);return this},optimize:function(){for(var A=0;A<this.tracks.length;A++)this.tracks[A].optimize();return this}},Object.assign(C.AnimationClip,{parse:function(A){for(var P=[],R=A.tracks,D=1/(A.fps||1),I=0,U=R.length;I!==U;++I)P.push(C.KeyframeTrack.parse(R[I]).scale(D));return new C.AnimationClip(A.name,A.duration,P)},toJSON:function(A){for(var P=[],R=A.tracks,D={name:A.name,duration:A.duration,tracks:P},I=0,U=R.length;I!==U;++I)P.push(C.KeyframeTrack.toJSON(R[I]));return D},CreateFromMorphTargetSequence:function(A,P,R,D){for(var I=P.length,U=[],F=0;F<I;F++){var V=[],G=[];V.push((F+I-1)%I,F,(F+1)%I),G.push(0,1,0);var O=C.AnimationUtils.getKeyframeOrder(V);V=C.AnimationUtils.sortedArray(V,1,O),G=C.AnimationUtils.sortedArray(G,1,O),D||0!==V[0]||(V.push(I),G.push(G[0])),U.push(new C.NumberKeyframeTrack(".morphTargetInfluences["+P[F].name+"]",V,G).scale(1/R))}return new C.AnimationClip(A,-1,U)},findByName:function(A,P){for(var R=0;R<A.length;R++)if(A[R].name===P)return A[R];return null},CreateClipsFromMorphTargetSequences:function(A,P,R){for(var D={},I=/^([\w-]*?)([\d]+)$/,U=0,F=A.length;U<F;U++){var V=A[U],G=V.name.match(I);if(G&&1<G.length){var O=G[1],H=D[O];H||(D[O]=H=[]),H.push(V)}}var W=[];for(var O in D)W.push(C.AnimationClip.CreateFromMorphTargetSequence(O,D[O],P,R));return W},parseAnimation:function(A,P){if(!A)return console.error("  no animation in JSONLoader data"),null;for(var D=function(ne,ie,se,le,pe){if(0!==se.length){var ue=[],ge=[];C.AnimationUtils.flattenJSON(se,ue,ge,le),0!==ue.length&&pe.push(new ne(ie,ue,ge))}},I=[],U=A.name||"default",F=A.length||-1,V=A.fps||30,G=A.hierarchy||[],O=0,H;O<G.length;O++)if(H=G[O].keys,H&&0!=H.length)if(H[0].morphTargets){for(var W={},X=0;X<H.length;X++)if(H[X].morphTargets)for(var Y=0;Y<H[X].morphTargets.length;Y++)W[H[X].morphTargets[Y]]=-1;for(var Z in W){for(var K=[],Q=[],Y=0,J;Y!==H[X].morphTargets.length;++Y)J=H[X],K.push(J.time),Q.push(J.morphTarget===Z?1:0);I.push(new C.NumberKeyframeTrack(".morphTargetInfluence["+Z+"]",K,Q))}F=W.length*(V||1)}else{var ee=".bones["+P[O].name+"]";D(C.VectorKeyframeTrack,ee+".position",H,"pos",I),D(C.QuaternionKeyframeTrack,ee+".quaternion",H,"rot",I),D(C.VectorKeyframeTrack,ee+".scale",H,"scl",I)}if(0===I.length)return null;var oe=new C.AnimationClip(U,F,I);return oe}}),C.AnimationMixer=function(A){this._root=A,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},C.AnimationMixer.prototype={constructor:C.AnimationMixer,clipAction:function(A,P){var R=P||this._root,D=R.uuid,I="string"==typeof A?A:A.name,U=A===I?null:A,F=this._actionsByClip[I],V;if(void 0!==F){var G=F.actionByRoot[D];if(void 0!==G)return G;if(V=F.knownActions[0],U=V._clip,A!==I&&A!==U)throw new Error("Different clips with the same name detected!")}if(null===U)return null;var O=new C.AnimationMixer._Action(this,U,P);return this._bindAction(O,V),this._addInactiveAction(O,I,D),O},existingAction:function(A,P){var R=P||this._root,D=R.uuid,I="string"==typeof A?A:A.name,U=this._actionsByClip[I];return void 0===U?null:U.actionByRoot[D]||null},stopAllAction:function(){var A=this._actions,P=this._nActiveActions,R=this._bindings,D=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var I=0;I!==P;++I)A[I].reset();for(var I=0;I!==D;++I)R[I].useCount=0;return this},update:function(A){A*=this.timeScale;for(var P=this._actions,R=this._nActiveActions,D=this.time+=A,I=_Mathsign(A),U=this._accuIndex^=1,F=0,V;F!==R;++F)V=P[F],V.enabled&&V._update(D,A,I,U);for(var G=this._bindings,O=this._nActiveBindings,F=0;F!==O;++F)G[F].apply(U);return this},getRoot:function(){return this._root},uncacheClip:function(A){var P=this._actions,R=A.name,D=this._actionsByClip,I=D[R];if(I!==void 0){for(var U=I.knownActions,F=0,V=U.length,G;F!==V;++F){G=U[F],this._deactivateAction(G);var O=G._cacheIndex,H=P[P.length-1];G._cacheIndex=null,G._byClipCacheIndex=null,H._cacheIndex=O,P[O]=H,P.pop(),this._removeInactiveBindingsForAction(G)}delete D[R]}},uncacheRoot:function(A){var P=A.uuid,R=this._actionsByClip;for(var D in R){var I=R[D].actionByRoot,U=I[P];U!==void 0&&(this._deactivateAction(U),this._removeInactiveAction(U))}var F=this._bindingsByRootAndName,V=F[P];if(V!==void 0)for(var G in V){var O=V[G];O.restoreOriginalState(),this._removeInactiveBinding(O)}},uncacheAction:function(A,P){var R=this.existingAction(A,P);null!==R&&(this._deactivateAction(R),this._removeInactiveAction(R))}},C.EventDispatcher.prototype.apply(C.AnimationMixer.prototype),C.AnimationMixer._Action=function(A,P,R){this._mixer=A,this._clip=P,this._localRoot=R||null;for(var D=P.tracks,I=D.length,U=Array(I),F={endingStart:C.ZeroCurvatureEnding,endingEnd:C.ZeroCurvatureEnding},V=0,G;V!==I;++V)G=D[V].createInterpolant(null),U[V]=G,G.settings=F;this._interpolantSettings=F,this._interpolants=U,this._propertyBindings=Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=C.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},C.AnimationMixer._Action.prototype={constructor:C.AnimationMixer._Action,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){this._startTime;return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(A){return this._startTime=A,this},setLoop:function(A,P){return this.loop=A,this.repetitions=P,this},setEffectiveWeight:function(A){return this.weight=A,this._effectiveWeight=this.enabled?A:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(A){return this._scheduleFading(A,0,1)},fadeOut:function(A){return this._scheduleFading(A,1,0)},crossFadeFrom:function(A,P,R){this._mixer;if(A.fadeOut(P),this.fadeIn(P),R){var I=this._clip.duration,U=A._clip.duration;A.warp(1,U/I,P),this.warp(I/U,1,P)}return this},crossFadeTo:function(A,P,R){return A.crossFadeFrom(this,P,R)},stopFading:function(){var A=this._weightInterpolant;return null!==A&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(A)),this},setEffectiveTimeScale:function(A){return this.timeScale=A,this._effectiveTimeScale=this.paused?0:A,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(A){return this.timeScale=this._clip.duration/A,this.stopWarping()},syncWith:function(A){return this.time=A.time,this.timeScale=A.timeScale,this.stopWarping()},halt:function(A){return this.warp(this._currentTimeScale,0,A)},warp:function(A,P,R){var D=this._mixer,I=D.time,U=this._timeScaleInterpolant,F=this.timeScale;null===U&&(U=D._lendControlInterpolant(),this._timeScaleInterpolant=U);var V=U.parameterPositions,G=U.sampleValues;return V[0]=I,V[1]=I+R,G[0]=A/F,G[1]=P/F,this},stopWarping:function(){var A=this._timeScaleInterpolant;return null!==A&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(A)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(A,P,R,D){var I=this._startTime;if(null!==I){var U=(A-I)*R;if(0>U||0===R)return;this._startTime=null,P=R*U}P*=this._updateTimeScale(A);var F=this._updateTime(P),V=this._updateWeight(A);if(0<V)for(var G=this._interpolants,O=this._propertyBindings,H=0,W=G.length;H!==W;++H)G[H].evaluate(F),O[H].accumulate(D,V)},_updateWeight:function(A){var P=0;if(this.enabled){P=this.weight;var R=this._weightInterpolant;if(null!==R){var D=R.evaluate(A)[0];P*=D,A>R.parameterPositions[1]&&(this.stopFading(),0===D&&(this.enabled=!1))}}return this._effectiveWeight=P,P},_updateTimeScale:function(A){var P=0;if(!this.paused){P=this.timeScale;var R=this._timeScaleInterpolant;if(null!==R){var D=R.evaluate(A)[0];P*=D,A>R.parameterPositions[1]&&(this.stopWarping(),0===P?this.pause=!0:this.timeScale=P)}}return this._effectiveTimeScale=P,P},_updateTime:function(A){var P=this.time+A;if(0===A)return P;var R=this._clip.duration,D=this.loop,I=this._loopCount,U=!1;switch(D){case C.LoopOnce:if(-1===I&&(this.loopCount=0,this._setEndings(!0,!0,!1)),P>=R)P=R;else if(0>P)P=0;else break;this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>A?-1:1});break;case C.LoopPingPong:U=!0;case C.LoopRepeat:if(-1===I&&(0<A?(I=0,this._setEndings(!0,0===this.repetitions,U)):this._setEndings(0===this.repetitions,!0,U)),P>=R||0>P){var F=_Mathfloor(P/R);P-=R*F,I+=_Mathabs(F);var V=this.repetitions-I;if(0>V){this.clampWhenFinished?this.paused=!0:this.enabled=!1,P=0<A?R:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<A?1:-1});break}else if(0==V){var G=0>A;this._setEndings(G,!G,U)}else this._setEndings(!1,!1,U);this._loopCount=I,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:F})}if(D===C.LoopPingPong&&1==(1&I))return this.time=P,R-P;}return this.time=P,P},_setEndings:function(A,P,R){var D=this._interpolantSettings;R?(D.endingStart=C.ZeroSlopeEnding,D.endingEnd=C.ZeroSlopeEnding):(D.endingStart=A?this.zeroSlopeAtStart?C.ZeroSlopeEnding:C.ZeroCurvatureEnding:C.WrapAroundEnding,D.endingEnd=P?this.zeroSlopeAtEnd?C.ZeroSlopeEnding:C.ZeroCurvatureEnding:C.WrapAroundEnding)},_scheduleFading:function(A,P,R){var D=this._mixer,I=D.time,U=this._weightInterpolant;null===U&&(U=D._lendControlInterpolant(),this._weightInterpolant=U);var F=U.parameterPositions,V=U.sampleValues;return F[0]=I,V[0]=P,F[1]=I+A,V[1]=R,this}},Object.assign(C.AnimationMixer.prototype,{_bindAction:function(A,P){var R=A._localRoot||this._root,D=A._clip.tracks,I=D.length,U=A._propertyBindings,F=A._interpolants,V=R.uuid,G=this._bindingsByRootAndName,O=G[V];O===void 0&&(O={},G[V]=O);for(var H=0;H!==I;++H){var W=D[H],X=W.name,Y=O[X];if(void 0!==Y)U[H]=Y;else{if(Y=U[H],void 0!==Y){null===Y._cacheIndex&&(++Y.referenceCount,this._addInactiveBinding(Y,V,X));continue}var Z=P&&P._propertyBindings[H].binding.parsedPath;Y=new C.PropertyMixer(C.PropertyBinding.create(R,X,Z),W.ValueTypeName,W.getValueSize()),++Y.referenceCount,this._addInactiveBinding(Y,V,X),U[H]=Y}F[H].resultBuffer=Y.buffer}},_activateAction:function(A){if(!this._isActiveAction(A)){if(null===A._cacheIndex){var P=(A._localRoot||this._root).uuid,R=A._clip.name,D=this._actionsByClip[R];this._bindAction(A,D&&D.knownActions[0]),this._addInactiveAction(A,R,P)}for(var I=A._propertyBindings,U=0,F=I.length,V;U!==F;++U)V=I[U],0==V.useCount++&&(this._lendBinding(V),V.saveOriginalState());this._lendAction(A)}},_deactivateAction:function(A){if(this._isActiveAction(A)){for(var P=A._propertyBindings,R=0,D=P.length,I;R!==D;++R)I=P[R],0==--I.useCount&&(I.restoreOriginalState(),this._takeBackBinding(I));this._takeBackAction(A)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var A=this;this.stats={actions:{get total(){return A._actions.length},get inUse(){return A._nActiveActions}},bindings:{get total(){return A._bindings.length},get inUse(){return A._nActiveBindings}},controlInterpolants:{get total(){return A._controlInterpolants.length},get inUse(){return A._nActiveControlInterpolants}}}},_isActiveAction:function(A){var P=A._cacheIndex;return null!==P&&P<this._nActiveActions},_addInactiveAction:function(A,P,R){var D=this._actions,I=this._actionsByClip,U=I[P];if(U===void 0)U={knownActions:[A],actionByRoot:{}},A._byClipCacheIndex=0,I[P]=U;else{var F=U.knownActions;A._byClipCacheIndex=F.length,F.push(A)}A._cacheIndex=D.length,D.push(A),U.actionByRoot[R]=A},_removeInactiveAction:function(A){var P=this._actions,R=P[P.length-1],D=A._cacheIndex;R._cacheIndex=D,P[D]=R,P.pop(),A._cacheIndex=null;var I=A._clip.name,U=this._actionsByClip,F=U[I],V=F.knownActions,G=V[V.length-1],O=A._byClipCacheIndex;G._byClipCacheIndex=O,V[O]=G,V.pop(),A._byClipCacheIndex=null;var H=F.actionByRoot,W=(P._localRoot||this._root).uuid;delete H[W],0===V.length&&delete U[I],this._removeInactiveBindingsForAction(A)},_removeInactiveBindingsForAction:function(A){for(var P=A._propertyBindings,R=0,D=P.length,I;R!==D;++R)I=P[R],0==--I.referenceCount&&this._removeInactiveBinding(I)},_lendAction:function(A){var P=this._actions,R=A._cacheIndex,D=this._nActiveActions++,I=P[D];A._cacheIndex=D,P[D]=A,I._cacheIndex=R,P[R]=I},_takeBackAction:function(A){var P=this._actions,R=A._cacheIndex,D=--this._nActiveActions,I=P[D];A._cacheIndex=D,P[D]=A,I._cacheIndex=R,P[R]=I},_addInactiveBinding:function(A,P,R){var D=this._bindingsByRootAndName,I=D[P],U=this._bindings;I===void 0&&(I={},D[P]=I),I[R]=A,A._cacheIndex=U.length,U.push(A)},_removeInactiveBinding:function(A){var P=this._bindings,R=A.binding,D=R.rootNode.uuid,I=R.path,U=this._bindingsByRootAndName,F=U[D],V=P[P.length-1],G=A._cacheIndex;V._cacheIndex=G,P[G]=V,P.pop(),delete F[I];remove_empty_map:{for(var O in F)break remove_empty_map;delete U[D]}},_lendBinding:function(A){var P=this._bindings,R=A._cacheIndex,D=this._nActiveBindings++,I=P[D];A._cacheIndex=D,P[D]=A,I._cacheIndex=R,P[R]=I},_takeBackBinding:function(A){var P=this._bindings,R=A._cacheIndex,D=--this._nActiveBindings,I=P[D];A._cacheIndex=D,P[D]=A,I._cacheIndex=R,P[R]=I},_lendControlInterpolant:function(){var A=this._controlInterpolants,P=this._nActiveControlInterpolants++,R=A[P];return void 0===R&&(R=new C.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),R.__cacheIndex=P,A[P]=R),R},_takeBackControlInterpolant:function(A){var P=this._controlInterpolants,R=A.__cacheIndex,D=--this._nActiveControlInterpolants,I=P[D];A.__cacheIndex=D,P[D]=A,I.__cacheIndex=R,P[R]=I},_controlInterpolantsResultBuffer:new Float32Array(1)}),C.AnimationObjectGroup=function(){this.uuid=C.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var P={};this._indicesByUUID=P;for(var R=0,D=arguments.length;R!==D;++R)P[arguments[R].uuid]=R;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var I=this;this.stats={objects:{get total(){return I._objects.length},get inUse(){return this.total-I.nCachedObjects_}},get bindingsPerObject(){return I._bindings.length}}},C.AnimationObjectGroup.prototype={constructor:C.AnimationObjectGroup,add:function(){for(var P=this._objects,R=P.length,D=this.nCachedObjects_,I=this._indicesByUUID,U=this._paths,F=this._parsedPaths,V=this._bindings,G=V.length,O=0,H=arguments.length;O!==H;++O){var W=arguments[O],X=W.uuid,Y=I[X];if(Y===void 0){Y=R++,I[X]=Y,P.push(W);for(var Z=0,K=G;Z!==K;++Z)V[Z].push(new C.PropertyBinding(W,U[Z],F[Z]))}else if(Y<D){var Q=P[Y],J=--D,ee=P[J];I[ee.uuid]=Y,P[Y]=ee,I[X]=J,P[J]=W;for(var Z=0,K=G;Z!==K;++Z){var oe=V[Z],ne=oe[J],ie=oe[Y];oe[Y]=ne,ie===void 0&&(ie=new C.PropertyBinding(W,U[Z],F[Z])),oe[J]=ie}}else P[Y]!==Q&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=D},remove:function(){for(var P=this._objects,R=P.length,D=this.nCachedObjects_,I=this._indicesByUUID,U=this._bindings,F=U.length,V=0,G=arguments.length;V!==G;++V){var O=arguments[V],H=O.uuid,W=I[H];if(W!==void 0&&W>=D){var X=D++,Y=P[X];I[Y.uuid]=W,P[W]=Y,I[H]=X,P[X]=O;for(var Z=0;Z!==F;++Z){var Q=U[Z],J=Q[X],ee=Q[W];Q[W]=J,Q[X]=ee}}}this.nCachedObjects_=D},uncache:function(){for(var P=this._objects,R=P.length,D=this.nCachedObjects_,I=this._indicesByUUID,U=this._bindings,F=U.length,V=0,G=arguments.length;V!==G;++V){var O=arguments[V],H=O.uuid,W=I[H];if(void 0!==W)if(delete I[H],W<D){var X=--D,Y=P[X],Z=--R,K=P[Z];I[Y.uuid]=W,P[W]=Y,I[K.uuid]=X,P[X]=K,P.pop();for(var Q=0,J=F;Q!==J;++Q){var ee=U[Q],oe=ee[X],ne=ee[Z];ee[W]=oe,ee[X]=ne,ee.pop()}}else{var Z=--R,K=P[Z];I[K.uuid]=W,P[W]=K,P.pop();for(var Q=0,J=F,ee;Q!==J;++Q)ee=U[Q],ee[W]=ee[Z],ee.pop()}}this.nCachedObjects_=D},subscribe_:function(A,P){var R=this._bindingsIndicesByPath,D=R[A],I=this._bindings;if(D!==void 0)return I[D];var U=this._paths,F=this._parsedPaths,V=this._objects,G=V.length,O=this.nCachedObjects_,H=Array(G);D=I.length,R[A]=D,U.push(A),F.push(P),I.push(H);for(var W=O,X=V.length,Y;W!==X;++W)Y=V[W],H[W]=new C.PropertyBinding(Y,A,P);return H},unsubscribe_:function(A){var P=this._bindingsIndicesByPath,R=P[A];if(R!==void 0){var D=this._paths,I=this._parsedPaths,U=this._bindings,F=U.length-1,V=U[F],G=A[F];P[G]=R,U[R]=V,U.pop(),I[R]=I[F],I.pop(),D[R]=D[F],D.pop()}}},C.AnimationUtils={arraySlice:function(A,P,R){return C.AnimationUtils.isTypedArray(A)?new A.constructor(A.subarray(P,R)):A.slice(P,R)},convertArray:function(A,P,R){return A&&(R||A.constructor!==P)?"number"==typeof P.BYTES_PER_ELEMENT?new P(A):Array.prototype.slice.call(A):A},isTypedArray:function(A){return ArrayBuffer.isView(A)&&!(A instanceof DataView)},getKeyframeOrder:function(A){for(var R=A.length,D=Array(R),I=0;I!==R;++I)D[I]=I;return D.sort(function(U,F){return A[U]-A[F]}),D},sortedArray:function(A,P,R){for(var D=A.length,I=new A.constructor(D),U=0,F=0,V;F!==D;++U){V=R[U]*P;for(var G=0;G!==P;++G)I[F++]=A[V+G]}return I},flattenJSON:function(A,P,R,D){for(var I=1,U=A[0];U!==void 0&&U[D]===void 0;)U=A[I++];if(void 0!==U){var F=U[D];if(void 0!==F)if(Array.isArray(F))do F=U[D],void 0!==F&&(P.push(U.time),R.push.apply(R,F)),U=A[I++];while(void 0!==U);else if(void 0!==F.toArray)do F=U[D],void 0!==F&&(P.push(U.time),F.toArray(R,R.length)),U=A[I++];while(void 0!==U);else do F=U[D],void 0!==F&&(P.push(U.time),R.push(F)),U=A[I++];while(void 0!==U)}}},C.KeyframeTrack=function(A,P,R,D){if(A===void 0)throw new Error("track name is undefined");if(void 0===P||0===P.length)throw new Error("no keyframes in track named "+A);this.name=A,this.times=C.AnimationUtils.convertArray(P,this.TimeBufferType),this.values=C.AnimationUtils.convertArray(R,this.ValueBufferType),this.setInterpolation(D||this.DefaultInterpolation),this.validate(),this.optimize()},C.KeyframeTrack.prototype={constructor:C.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:C.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(A){return new C.DiscreteInterpolant(this.times,this.values,this.getValueSize(),A)},InterpolantFactoryMethodLinear:function(A){return new C.LinearInterpolant(this.times,this.values,this.getValueSize(),A)},InterpolantFactoryMethodSmooth:function(A){return new C.CubicInterpolant(this.times,this.values,this.getValueSize(),A)},setInterpolation:function(A){var P;if(A===C.InterpolateDiscrete?P=this.InterpolantFactoryMethodDiscrete:A===C.InterpolateLinear?P=this.InterpolantFactoryMethodLinear:A===C.InterpolateSmooth?P=this.InterpolantFactoryMethodSmooth:void 0,void 0===P){var R="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(A!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(R);return void console.warn(R)}this.createInterpolant=P},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return C.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return C.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return C.InterpolateSmooth;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(A){if(0!==A)for(var P=this.times,R=0,D=P.length;R!==D;++R)P[R]+=A;return this},scale:function(A){if(1!==A)for(var P=this.times,R=0,D=P.length;R!==D;++R)P[R]*=A;return this},trim:function(A,P){for(var R=this.times,D=R.length,I=0,U=D-1;I!==D&&R[I]<A;)++I;for(;-1!=U&&R[U]>P;)--U;if(++U,0!=I||U!==D){I>=U&&(U=_Mathmax(U,1),I=U-1);var F=this.getValueSize();this.times=C.AnimationUtils.arraySlice(R,I,U),this.values=C.AnimationUtils.arraySlice(this.values,I*F,U*F)}return this},validate:function(){var A=!0,P=this.getValueSize();0!=P-_Mathfloor(P)&&(console.error("invalid value size in track",this),A=!1);var R=this.times,D=this.values,I=R.length;0===I&&(console.error("track is empty",this),A=!1);for(var U=null,F=0,V;F!==I;F++){if(V=R[F],"number"==typeof V&&isNaN(V)){console.error("time is not a valid number",this,F,V),A=!1;break}if(null!=U&&U>V){console.error("out of order keys",this,F,V,U),A=!1;break}U=V}if(D!==void 0&&C.AnimationUtils.isTypedArray(D))for(var F=0,G=D.length,O;F!==G;++F)if(O=D[F],isNaN(O)){console.error("value is not a valid number",this,F,O),A=!1;break}return A},optimize:function(){for(var A=this.times,P=this.values,R=this.getValueSize(),D=1,I=1,U=A.length-1;I<=U;++I){var F=!1,V=A[I],G=A[I+1];if(V!==G&&(1!==I||V!==V[0]))for(var O=I*R,X=0,Y;X!==R;++X)if(Y=P[O+X],Y!==P[O-R+X]||Y!==P[O+R+X]){F=!0;break}if(F){if(I!==D){A[D]=A[I];for(var Z=I*R,K=D*R,X=0;X!==R;++X)P[K+X]=P[Z+X]}++D}}return D!==A.length&&(this.times=C.AnimationUtils.arraySlice(A,0,D),this.values=C.AnimationUtils.arraySlice(P,0,D*R)),this}},Object.assign(C.KeyframeTrack,{parse:function(A){if(A.type===void 0)throw new Error("track type undefined, can not parse");var P=C.KeyframeTrack._getTrackTypeForValueTypeName(A.type);if(A.times===void 0){console.warn("legacy JSON format detected, converting");var R=[],D=[];C.AnimationUtils.flattenJSON(A.keys,R,D,"value"),A.times=R,A.values=D}return void 0===P.parse?new P(A.name,A.times,A.values,A.interpolation):P.parse(A)},toJSON:function(A){var P=A.constructor,R;if(void 0!==P.toJSON)R=P.toJSON(A);else{R={name:A.name,times:C.AnimationUtils.convertArray(A.times,Array),values:C.AnimationUtils.convertArray(A.values,Array)};var D=A.getInterpolation();D!==A.DefaultInterpolation&&(R.interpolation=D)}return R.type=A.ValueTypeName,R},_getTrackTypeForValueTypeName:function(A){switch(A.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return C.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return C.VectorKeyframeTrack;case"color":return C.ColorKeyframeTrack;case"quaternion":return C.QuaternionKeyframeTrack;case"bool":case"boolean":return C.BooleanKeyframeTrack;case"string":return C.StringKeyframeTrack;}throw new Error("Unsupported typeName: "+A)}}),C.PropertyBinding=function(A,P,R){this.path=P,this.parsedPath=R||C.PropertyBinding.parseTrackName(P),this.node=C.PropertyBinding.findNode(A,this.parsedPath.nodeName)||A,this.rootNode=A},C.PropertyBinding.prototype={constructor:C.PropertyBinding,getValue:function(P,R){this.bind(),this.getValue(P,R)},setValue:function(P,R){this.bind(),this.setValue(P,R)},bind:function(){var A=this.node,P=this.parsedPath,R=P.objectName,D=P.propertyName,I=P.propertyIndex;if(A||(A=C.PropertyBinding.findNode(this.rootNode,P.nodeName)||this.rootNode,this.node=A),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!A)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(R){var U=P.objectIndex;switch(R){case"materials":if(!A.material)return void console.error("  can not bind to material as node does not have a material",this);if(!A.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);A=A.material.materials;break;case"bones":if(!A.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);A=A.skeleton.bones;for(var F=0;F<A.length;F++)if(A[F].name===U){U=F;break}break;default:if(void 0===A[R])return void console.error("  can not bind to objectName of node, undefined",this);A=A[R];}if(void 0!==U){if(void 0===A[U])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,A);A=A[U]}}var V=A[D];if(!V){var G=P.nodeName;return void console.error("  trying to update property for track: "+G+"."+D+" but it wasn't found.",A)}var O=this.Versioning.None;void 0===A.needsUpdate?void 0!==A.matrixWorldNeedsUpdate&&(O=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=A):(O=this.Versioning.NeedsUpdate,this.targetObject=A);var H=this.BindingType.Direct;if(void 0!==I){if("morphTargetInfluences"===D){if(!A.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!A.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var F=0;F<this.node.geometry.morphTargets.length;F++)if(A.geometry.morphTargets[F].name===I){I=F;break}}H=this.BindingType.ArrayElement,this.resolvedProperty=V,this.propertyIndex=I}else void 0!==V.fromArray&&void 0!==V.toArray?(H=this.BindingType.HasFromToArray,this.resolvedProperty=V):void 0===V.length?this.propertyName=D:(H=this.BindingType.EntireArray,this.resolvedProperty=V);this.getValue=this.GetterByBindingType[H],this.setValue=this.SetterByBindingTypeAndVersioning[H][O]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(C.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:C.PropertyBinding.prototype.getValue,_setValue_unbound:C.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(P,R){P[R]=this.node[this.propertyName]},function(P,R){for(var D=this.resolvedProperty,I=0,U=D.length;I!==U;++I)P[R++]=D[I]},function(P,R){P[R]=this.resolvedProperty[this.propertyIndex]},function(P,R){this.resolvedProperty.toArray(P,R)}],SetterByBindingTypeAndVersioning:[[function(P,R){this.node[this.propertyName]=P[R]},function(P,R){this.node[this.propertyName]=P[R],this.targetObject.needsUpdate=!0},function(P,R){this.node[this.propertyName]=P[R],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(P,R){for(var D=this.resolvedProperty,I=0,U=D.length;I!==U;++I)D[I]=P[R++]},function(P,R){for(var D=this.resolvedProperty,I=0,U=D.length;I!==U;++I)D[I]=P[R++];this.targetObject.needsUpdate=!0},function(P,R){for(var D=this.resolvedProperty,I=0,U=D.length;I!==U;++I)D[I]=P[R++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(P,R){this.resolvedProperty[this.propertyIndex]=P[R]},function(P,R){this.resolvedProperty[this.propertyIndex]=P[R],this.targetObject.needsUpdate=!0},function(P,R){this.resolvedProperty[this.propertyIndex]=P[R],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(P,R){this.resolvedProperty.fromArray(P,R)},function(P,R){this.resolvedProperty.fromArray(P,R),this.targetObject.needsUpdate=!0},function(P,R){this.resolvedProperty.fromArray(P,R),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),C.PropertyBinding.Composite=function(A,P,R){var D=R||C.PropertyBinding.parseTrackName(P);this._targetGroup=A,this._bindings=A.subscribe_(P,D)},C.PropertyBinding.Composite.prototype={constructor:C.PropertyBinding.Composite,getValue:function(A,P){this.bind();var R=this._targetGroup.nCachedObjects_,D=this._bindings[R];D!==void 0&&D.getValue(A,P)},setValue:function(A,P){for(var R=this._bindings,D=this._targetGroup.nCachedObjects_,I=R.length;D!==I;++D)R[D].setValue(A,P)},bind:function(){for(var A=this._bindings,P=this._targetGroup.nCachedObjects_,R=A.length;P!==R;++P)A[P].bind()},unbind:function(){for(var A=this._bindings,P=this._targetGroup.nCachedObjects_,R=A.length;P!==R;++P)A[P].unbind()}},C.PropertyBinding.create=function(A,P,R){return A instanceof C.AnimationObjectGroup?new C.PropertyBinding.Composite(A,P,R):new C.PropertyBinding(A,P,R)},C.PropertyBinding.parseTrackName=function(A){var P=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,R=P.exec(A);if(!R)throw new Error("cannot parse trackName at all: "+A);R.index===P.lastIndex&&P.lastIndex++;var D={nodeName:R[3],objectName:R[5],objectIndex:R[7],propertyName:R[9],propertyIndex:R[11]};if(null===D.propertyName||0===D.propertyName.length)throw new Error("can not parse propertyName from trackName: "+A);return D},C.PropertyBinding.findNode=function(A,P){if(!P||""===P||"root"===P||"."===P||-1===P||P===A.name||P===A.uuid)return A;if(A.skeleton){var R=function(F){for(var V=0,G;V<F.bones.length;V++)if(G=F.bones[V],G.name===P)return G;return null},D=R(A.skeleton);if(D)return D}if(A.children){var I=function(F){for(var V=0,G;V<F.length;V++){if(G=F[V],G.name===P||G.uuid===P)return G;var O=I(G.children);if(O)return O}return null},U=I(A.children);if(U)return U}return null},C.PropertyMixer=function(A,P,R){this.binding=A,this.valueSize=R;var D=Float64Array,I;"quaternion"===P?I=this._slerp:"string"===P||"bool"===P?(D=Array,I=this._select):I=this._lerp;this.buffer=new D(4*R),this._mixBufferRegion=I,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},C.PropertyMixer.prototype={constructor:C.PropertyMixer,accumulate:function(A,P){var R=this.buffer,D=this.valueSize,I=A*D+D,U=this.cumulativeWeight;if(0===U){for(var F=0;F!==D;++F)R[I+F]=R[F];U=P}else{U+=P;var V=P/U;this._mixBufferRegion(R,I,0,V,D)}this.cumulativeWeight=U},apply:function(A){var P=this.valueSize,R=this.buffer,D=A*P+P,I=this.cumulativeWeight,U=this.binding;if(this.cumulativeWeight=0,1>I){this._mixBufferRegion(R,D,3*P,1-I,P)}for(var V=P;V!==P+P;++V)if(R[V]!==R[V+P]){U.setValue(R,D);break}},saveOriginalState:function(){var A=this.binding,P=this.buffer,R=this.valueSize,D=3*R;A.getValue(P,D);for(var I=R;I!==D;++I)P[I]=P[D+I%R];this.cumulativeWeight=0},restoreOriginalState:function(){var A=3*this.valueSize;this.binding.setValue(this.buffer,A)},_select:function(A,P,R,D,I){if(0.5<=D)for(var U=0;U!==I;++U)A[P+U]=A[R+U]},_slerp:function(A,P,R,D){C.Quaternion.slerpFlat(A,P,A,P,A,R,D)},_lerp:function(A,P,R,D,I){for(var F=0,V;F!==I;++F)V=P+F,A[V]=A[V]*(1-D)+A[R+F]*D}},C.BooleanKeyframeTrack=function(A,P,R){C.KeyframeTrack.call(this,A,P,R)},C.BooleanKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:C.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),C.ColorKeyframeTrack=function(A,P,R,D){C.KeyframeTrack.call(this,A,P,R,D)},C.ColorKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.ColorKeyframeTrack,ValueTypeName:"color"}),C.NumberKeyframeTrack=function(A,P,R,D){C.KeyframeTrack.call(this,A,P,R,D)},C.NumberKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.NumberKeyframeTrack,ValueTypeName:"number"}),C.QuaternionKeyframeTrack=function(A,P,R,D){C.KeyframeTrack.call(this,A,P,R,D)},C.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:C.InterpolateLinear,InterpolantFactoryMethodLinear:function(A){return new C.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),A)},InterpolantFactoryMethodSmooth:void 0}),C.StringKeyframeTrack=function(A,P,R,D){C.KeyframeTrack.call(this,A,P,R,D)},C.StringKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:C.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),C.VectorKeyframeTrack=function(A,P,R,D){C.KeyframeTrack.call(this,A,P,R,D)},C.VectorKeyframeTrack.prototype=Object.assign(Object.create(C.KeyframeTrack.prototype),{constructor:C.VectorKeyframeTrack,ValueTypeName:"vector"}),C.Audio=function(A){C.Object3D.call(this),this.type="Audio",this.context=A.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(A.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null},C.Audio.prototype=Object.create(C.Object3D.prototype),C.Audio.prototype.constructor=C.Audio,C.Audio.prototype.getOutput=function(){return this.gain},C.Audio.prototype.setNodeSource=function(A){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=A,this.connect(),this},C.Audio.prototype.setBuffer=function(A){var P=this;return P.source.buffer=A,P.sourceType="buffer",P.autoplay&&P.play(),this},C.Audio.prototype.play=function(){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");var A=this.context.createBufferSource();A.buffer=this.source.buffer,A.loop=this.source.loop,A.onended=this.source.onended,A.start(0,this.startTime),A.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=A,this.connect()},C.Audio.prototype.pause=function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.stop(),this.startTime=this.context.currentTime)},C.Audio.prototype.stop=function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.stop(),this.startTime=0)},C.Audio.prototype.connect=function(){null===this.filter?this.source.connect(this.getOutput()):(this.source.connect(this.filter),this.filter.connect(this.getOutput()))},C.Audio.prototype.disconnect=function(){null===this.filter?this.source.disconnect(this.getOutput()):(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput()))},C.Audio.prototype.getFilter=function(){return this.filter},C.Audio.prototype.setFilter=function(A){A===void 0&&(A=null),!0===this.isPlaying?(this.disconnect(),this.filter=A,this.connect()):this.filter=A},C.Audio.prototype.setPlaybackRate=function(A){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.playbackRate=A,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate))},C.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},C.Audio.prototype.onEnded=function(){this.isPlaying=!1},C.Audio.prototype.setLoop=function(A){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.loop=A)},C.Audio.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},C.Audio.prototype.setVolume=function(A){this.gain.gain.value=A},C.Audio.prototype.getVolume=function(){return this.gain.gain.value},C.AudioAnalyser=function(A,P){this.analyser=A.context.createAnalyser(),this.analyser.fftSize=P===void 0?2048:P,this.data=new Uint8Array(this.analyser.frequencyBinCount),A.getOutput().connect(this.analyser)},C.AudioAnalyser.prototype={constructor:C.AudioAnalyser,getData:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},Object.defineProperty(C,"AudioContext",{get:function(){var A;return function(){return void 0==A&&(A=new(window.AudioContext||window.webkitAudioContext)),A}}()}),C.PositionalAudio=function(A){C.Audio.call(this,A),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},C.PositionalAudio.prototype=Object.create(C.Audio.prototype),C.PositionalAudio.prototype.constructor=C.PositionalAudio,C.PositionalAudio.prototype.getOutput=function(){return this.panner},C.PositionalAudio.prototype.setRefDistance=function(A){this.panner.refDistance=A},C.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance},C.PositionalAudio.prototype.setRolloffFactor=function(A){this.panner.rolloffFactor=A},C.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},C.PositionalAudio.prototype.setDistanceModel=function(A){this.panner.distanceModel=A},C.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel},C.PositionalAudio.prototype.setMaxDistance=function(A){this.panner.maxDistance=A},C.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance},C.PositionalAudio.prototype.updateMatrixWorld=function(){var A=new C.Vector3;return function(R){C.Object3D.prototype.updateMatrixWorld.call(this,R),A.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(A.x,A.y,A.z)}}(),C.AudioListener=function(){C.Object3D.call(this),this.type="AudioListener",this.context=C.AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},C.AudioListener.prototype=Object.create(C.Object3D.prototype),C.AudioListener.prototype.constructor=C.AudioListener,C.AudioListener.prototype.getInput=function(){return this.gain},C.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},C.AudioListener.prototype.setFilter=function(A){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=A,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},C.AudioListener.prototype.getFilter=function(){return this.filter},C.AudioListener.prototype.setMasterVolume=function(A){this.gain.gain.value=A},C.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value},C.AudioListener.prototype.updateMatrixWorld=function(){var A=new C.Vector3,P=new C.Quaternion,R=new C.Vector3,D=new C.Vector3;return function(U){C.Object3D.prototype.updateMatrixWorld.call(this,U);var F=this.context.listener,V=this.up;this.matrixWorld.decompose(A,P,R),D.set(0,0,-1).applyQuaternion(P),F.setPosition(A.x,A.y,A.z),F.setOrientation(D.x,D.y,D.z,V.x,V.y,V.z)}}(),C.Camera=function(){C.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new C.Matrix4,this.projectionMatrix=new C.Matrix4},C.Camera.prototype=Object.create(C.Object3D.prototype),C.Camera.prototype.constructor=C.Camera,C.Camera.prototype.getWorldDirection=function(){var A=new C.Quaternion;return function(P){var R=P||new C.Vector3;return this.getWorldQuaternion(A),R.set(0,0,-1).applyQuaternion(A)}}(),C.Camera.prototype.lookAt=function(){var A=new C.Matrix4;return function(P){A.lookAt(this.position,P,this.up),this.quaternion.setFromRotationMatrix(A)}}(),C.Camera.prototype.clone=function(){return new this.constructor().copy(this)},C.Camera.prototype.copy=function(A){return C.Object3D.prototype.copy.call(this,A),this.matrixWorldInverse.copy(A.matrixWorldInverse),this.projectionMatrix.copy(A.projectionMatrix),this},C.CubeCamera=function(A,P,R){C.Object3D.call(this),this.type="CubeCamera";var D=90,I=1,U=new C.PerspectiveCamera(D,I,A,P);U.up.set(0,-1,0),U.lookAt(new C.Vector3(1,0,0)),this.add(U);var F=new C.PerspectiveCamera(D,I,A,P);F.up.set(0,-1,0),F.lookAt(new C.Vector3(-1,0,0)),this.add(F);var V=new C.PerspectiveCamera(D,I,A,P);V.up.set(0,0,1),V.lookAt(new C.Vector3(0,1,0)),this.add(V);var G=new C.PerspectiveCamera(D,I,A,P);G.up.set(0,0,-1),G.lookAt(new C.Vector3(0,-1,0)),this.add(G);var O=new C.PerspectiveCamera(D,I,A,P);O.up.set(0,-1,0),O.lookAt(new C.Vector3(0,0,1)),this.add(O);var H=new C.PerspectiveCamera(D,I,A,P);H.up.set(0,-1,0),H.lookAt(new C.Vector3(0,0,-1)),this.add(H);var W={format:C.RGBFormat,magFilter:C.LinearFilter,minFilter:C.LinearFilter};this.renderTarget=new C.WebGLRenderTargetCube(R,R,W),this.updateCubeMap=function(X,Y){null===this.parent&&this.updateMatrixWorld();var Z=this.renderTarget,K=Z.texture.generateMipmaps;Z.texture.generateMipmaps=!1,Z.activeCubeFace=0,X.render(Y,U,Z),Z.activeCubeFace=1,X.render(Y,F,Z),Z.activeCubeFace=2,X.render(Y,V,Z),Z.activeCubeFace=3,X.render(Y,G,Z),Z.activeCubeFace=4,X.render(Y,O,Z),Z.texture.generateMipmaps=K,Z.activeCubeFace=5,X.render(Y,H,Z),X.setRenderTarget(null)}},C.CubeCamera.prototype=Object.create(C.Object3D.prototype),C.CubeCamera.prototype.constructor=C.CubeCamera,C.OrthographicCamera=function(A,P,R,D,I,U){C.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=A,this.right=P,this.top=R,this.bottom=D,this.near=I===void 0?0.1:I,this.far=U===void 0?2e3:U,this.updateProjectionMatrix()},C.OrthographicCamera.prototype=Object.create(C.Camera.prototype),C.OrthographicCamera.prototype.constructor=C.OrthographicCamera,C.OrthographicCamera.prototype.updateProjectionMatrix=function(){var A=(this.right-this.left)/(2*this.zoom),P=(this.top-this.bottom)/(2*this.zoom),R=(this.right+this.left)/2,D=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(R-A,R+A,D+P,D-P,this.near,this.far)},C.OrthographicCamera.prototype.copy=function(A){return C.Camera.prototype.copy.call(this,A),this.left=A.left,this.right=A.right,this.top=A.top,this.bottom=A.bottom,this.near=A.near,this.far=A.far,this.zoom=A.zoom,this},C.OrthographicCamera.prototype.toJSON=function(A){var P=C.Object3D.prototype.toJSON.call(this,A);return P.object.zoom=this.zoom,P.object.left=this.left,P.object.right=this.right,P.object.top=this.top,P.object.bottom=this.bottom,P.object.near=this.near,P.object.far=this.far,P},C.PerspectiveCamera=function(A,P,R,D){C.Camera.call(this),this.type="PerspectiveCamera",this.fov=A===void 0?50:A,this.zoom=1,this.near=R===void 0?0.1:R,this.far=D===void 0?2e3:D,this.focus=10,this.aspect=P===void 0?1:P,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()},C.PerspectiveCamera.prototype=Object.create(C.Camera.prototype),C.PerspectiveCamera.prototype.constructor=C.PerspectiveCamera,C.PerspectiveCamera.prototype.setLens=function(A,P){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),P!==void 0&&(this.filmGauge=P),this.setFocalLength(A)},C.PerspectiveCamera.prototype.setFocalLength=function(A){var P=0.5*this.getFilmHeight()/A;this.fov=2*C.Math.RAD2DEG*_Mathatan2(P),this.updateProjectionMatrix()},C.PerspectiveCamera.prototype.getFocalLength=function(){var A=_Mathtan(0.5*C.Math.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/A},C.PerspectiveCamera.prototype.getEffectiveFOV=function(){return 2*C.Math.RAD2DEG*_Mathatan2(_Mathtan(0.5*C.Math.DEG2RAD*this.fov)/this.zoom)},C.PerspectiveCamera.prototype.getFilmWidth=function(){return this.filmGauge*_Mathmin(this.aspect,1)},C.PerspectiveCamera.prototype.getFilmHeight=function(){return this.filmGauge/_Mathmax(this.aspect,1)},C.PerspectiveCamera.prototype.setViewOffset=function(A,P,R,D,I,U){this.aspect=A/P,this.view={fullWidth:A,fullHeight:P,offsetX:R,offsetY:D,width:I,height:U},this.updateProjectionMatrix()},C.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var A=this.near,P=A*_Mathtan(0.5*C.Math.DEG2RAD*this.fov)/this.zoom,R=2*P,D=this.aspect*R,I=-0.5*D,U=this.view;if(null!==U){var F=U.fullWidth,V=U.fullHeight;I+=U.offsetX*D/F,P-=U.offsetY*R/V,D*=U.width/F,R*=U.height/V}var G=this.filmOffset;0!==G&&(I+=A*G/this.getFilmWidth()),this.projectionMatrix.makeFrustum(I,I+D,P-R,P,A,this.far)},C.PerspectiveCamera.prototype.copy=function(A){return C.Camera.prototype.copy.call(this,A),this.fov=A.fov,this.zoom=A.zoom,this.near=A.near,this.far=A.far,this.focus=A.focus,this.aspect=A.aspect,this.view=null===A.view?null:Object.assign({},A.view),this.filmGauge=A.filmGauge,this.filmOffset=A.filmOffset,this},C.PerspectiveCamera.prototype.toJSON=function(A){var P=C.Object3D.prototype.toJSON.call(this,A);return P.object.fov=this.fov,P.object.zoom=this.zoom,P.object.near=this.near,P.object.far=this.far,P.object.focus=this.focus,P.object.aspect=this.aspect,null!==this.view&&(P.object.view=Object.assign({},this.view)),P.object.filmGauge=this.filmGauge,P.object.filmOffset=this.filmOffset,P},C.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new C.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new C.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},C.StereoCamera.prototype={constructor:C.StereoCamera,update:function(){var A,P,R,D,I,U=new C.Matrix4,F=new C.Matrix4;return function(G){var O=A!==G.focus||P!==G.fov||R!==G.aspect*this.aspect||D!==G.near||I!==G.far;if(O){A=G.focus,P=G.fov,R=G.aspect*this.aspect,D=G.near,I=G.far;var H=G.projectionMatrix.clone(),W=0.064/2,X=W*D/A,Y=D*_Mathtan(0.5*(C.Math.DEG2RAD*P)),Z,K;F.elements[12]=-W,U.elements[12]=W,Z=-Y*R+X,K=Y*R+X,H.elements[0]=2*D/(K-Z),H.elements[8]=(K+Z)/(K-Z),this.cameraL.projectionMatrix.copy(H),Z=-Y*R-X,K=Y*R-X,H.elements[0]=2*D/(K-Z),H.elements[8]=(K+Z)/(K-Z),this.cameraR.projectionMatrix.copy(H)}this.cameraL.matrixWorld.copy(G.matrixWorld).multiply(F),this.cameraR.matrixWorld.copy(G.matrixWorld).multiply(U)}}()},C.Light=function(A,P){C.Object3D.call(this),this.type="Light",this.color=new C.Color(A),this.intensity=P===void 0?1:P,this.receiveShadow=void 0},C.Light.prototype=Object.create(C.Object3D.prototype),C.Light.prototype.constructor=C.Light,C.Light.prototype.copy=function(A){return C.Object3D.prototype.copy.call(this,A),this.color.copy(A.color),this.intensity=A.intensity,this},C.Light.prototype.toJSON=function(A){var P=C.Object3D.prototype.toJSON.call(this,A);return P.object.color=this.color.getHex(),P.object.intensity=this.intensity,void 0!==this.groundColor&&(P.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(P.object.distance=this.distance),void 0!==this.angle&&(P.object.angle=this.angle),void 0!==this.decay&&(P.object.decay=this.decay),void 0!==this.penumbra&&(P.object.penumbra=this.penumbra),P},C.LightShadow=function(A){this.camera=A,this.bias=0,this.radius=1,this.mapSize=new C.Vector2(512,512),this.map=null,this.matrix=new C.Matrix4},C.LightShadow.prototype={constructor:C.LightShadow,copy:function(A){return this.camera=A.camera.clone(),this.bias=A.bias,this.radius=A.radius,this.mapSize.copy(A.mapSize),this},clone:function(){return new this.constructor().copy(this)}},C.AmbientLight=function(A,P){C.Light.call(this,A,P),this.type="AmbientLight",this.castShadow=void 0},C.AmbientLight.prototype=Object.create(C.Light.prototype),C.AmbientLight.prototype.constructor=C.AmbientLight,C.DirectionalLight=function(A,P){C.Light.call(this,A,P),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new C.Object3D,this.shadow=new C.DirectionalLightShadow},C.DirectionalLight.prototype=Object.create(C.Light.prototype),C.DirectionalLight.prototype.constructor=C.DirectionalLight,C.DirectionalLight.prototype.copy=function(A){return C.Light.prototype.copy.call(this,A),this.target=A.target.clone(),this.shadow=A.shadow.clone(),this},C.DirectionalLightShadow=function(){C.LightShadow.call(this,new C.OrthographicCamera(-5,5,5,-5,0.5,500))},C.DirectionalLightShadow.prototype=Object.create(C.LightShadow.prototype),C.DirectionalLightShadow.prototype.constructor=C.DirectionalLightShadow,C.HemisphereLight=function(A,P,R){C.Light.call(this,A,R),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new C.Color(P)},C.HemisphereLight.prototype=Object.create(C.Light.prototype),C.HemisphereLight.prototype.constructor=C.HemisphereLight,C.HemisphereLight.prototype.copy=function(A){return C.Light.prototype.copy.call(this,A),this.groundColor.copy(A.groundColor),this},C.PointLight=function(A,P,R,D){C.Light.call(this,A,P),this.type="PointLight",this.distance=R===void 0?0:R,this.decay=D===void 0?1:D,this.shadow=new C.LightShadow(new C.PerspectiveCamera(90,1,0.5,500))},C.PointLight.prototype=Object.create(C.Light.prototype),C.PointLight.prototype.constructor=C.PointLight,Object.defineProperty(C.PointLight.prototype,"power",{get:function(){return 4*this.intensity*_MathPI2},set:function(A){this.intensity=A/(4*_MathPI2)}}),C.PointLight.prototype.copy=function(A){return C.Light.prototype.copy.call(this,A),this.distance=A.distance,this.decay=A.decay,this.shadow=A.shadow.clone(),this},C.SpotLight=function(A,P,R,D,I,U){C.Light.call(this,A,P),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new C.Object3D,this.distance=R===void 0?0:R,this.angle=D===void 0?_MathPI2/3:D,this.penumbra=I===void 0?0:I,this.decay=U===void 0?1:U,this.shadow=new C.SpotLightShadow},C.SpotLight.prototype=Object.create(C.Light.prototype),C.SpotLight.prototype.constructor=C.SpotLight,Object.defineProperty(C.SpotLight.prototype,"power",{get:function(){return this.intensity*_MathPI2},set:function(A){this.intensity=A/_MathPI2}}),C.SpotLight.prototype.copy=function(A){return C.Light.prototype.copy.call(this,A),this.distance=A.distance,this.angle=A.angle,this.penumbra=A.penumbra,this.decay=A.decay,this.target=A.target.clone(),this.shadow=A.shadow.clone(),this},C.SpotLightShadow=function(){C.LightShadow.call(this,new C.PerspectiveCamera(50,1,0.5,500))},C.SpotLightShadow.prototype=Object.create(C.LightShadow.prototype),C.SpotLightShadow.prototype.constructor=C.SpotLightShadow,C.SpotLightShadow.prototype.update=function(A){var P=2*C.Math.RAD2DEG*A.angle,R=this.mapSize.width/this.mapSize.height,D=A.distance||500,I=this.camera;(P!==I.fov||R!==I.aspect||D!==I.far)&&(I.fov=P,I.aspect=R,I.far=D,I.updateProjectionMatrix())},C.AudioLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.AudioLoader.prototype={constructor:C.AudioLoader,load:function(A,P,R,D){var I=new C.XHRLoader(this.manager);I.setResponseType("arraybuffer"),I.load(A,function(U){var F=C.AudioContext;F.decodeAudioData(U,function(V){P(V)})},R,D)}},C.Cache={enabled:!1,files:{},add:function(A,P){!1===this.enabled||(this.files[A]=P)},get:function(A){return!1===this.enabled?void 0:this.files[A]},remove:function(A){delete this.files[A]},clear:function(){this.files={}}},C.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},C.Loader.prototype={constructor:C.Loader,crossOrigin:void 0,extractUrlBase:function(A){var P=A.split("/");return 1===P.length?"./":(P.pop(),P.join("/")+"/")},initMaterials:function(A,P,R){for(var D=[],I=0;I<A.length;++I)D[I]=this.createMaterial(A[I],P,R);return D},createMaterial:function(){var A,P,R;return function(D,I,U){function F(W,X,Y,Z,K){var Q=I+W,J=C.Loader.Handlers.get(Q),ee;null===J?(P.setCrossOrigin(U),ee=P.load(Q)):ee=J.load(Q),void 0!==X&&(ee.repeat.fromArray(X),1!==X[0]&&(ee.wrapS=C.RepeatWrapping),1!==X[1]&&(ee.wrapT=C.RepeatWrapping)),void 0!==Y&&ee.offset.fromArray(Y),void 0!==Z&&("repeat"===Z[0]&&(ee.wrapS=C.RepeatWrapping),"mirror"===Z[0]&&(ee.wrapS=C.MirroredRepeatWrapping),"repeat"===Z[1]&&(ee.wrapT=C.RepeatWrapping),"mirror"===Z[1]&&(ee.wrapT=C.MirroredRepeatWrapping)),void 0!==K&&(ee.anisotropy=K);var oe=C.Math.generateUUID();return V[oe]=ee,oe}void 0==A&&(A=new C.Color),void 0==P&&(P=new C.TextureLoader),void 0==R&&(R=new C.MaterialLoader);var V={},G={uuid:C.Math.generateUUID(),type:"MeshLambertMaterial"};for(var O in D){var H=D[O];switch(O){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":G.name=H;break;case"blending":G.blending=C[H];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",O,"is no longer supported.");break;case"colorDiffuse":G.color=A.fromArray(H).getHex();break;case"colorSpecular":G.specular=A.fromArray(H).getHex();break;case"colorEmissive":G.emissive=A.fromArray(H).getHex();break;case"specularCoef":G.shininess=H;break;case"shading":"basic"===H.toLowerCase()&&(G.type="MeshBasicMaterial"),"phong"===H.toLowerCase()&&(G.type="MeshPhongMaterial");break;case"mapDiffuse":G.map=F(H,D.mapDiffuseRepeat,D.mapDiffuseOffset,D.mapDiffuseWrap,D.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":G.lightMap=F(H,D.mapLightRepeat,D.mapLightOffset,D.mapLightWrap,D.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":G.aoMap=F(H,D.mapAORepeat,D.mapAOOffset,D.mapAOWrap,D.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":G.bumpMap=F(H,D.mapBumpRepeat,D.mapBumpOffset,D.mapBumpWrap,D.mapBumpAnisotropy);break;case"mapBumpScale":G.bumpScale=H;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":G.normalMap=F(H,D.mapNormalRepeat,D.mapNormalOffset,D.mapNormalWrap,D.mapNormalAnisotropy);break;case"mapNormalFactor":G.normalScale=[H,H];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":G.specularMap=F(H,D.mapSpecularRepeat,D.mapSpecularOffset,D.mapSpecularWrap,D.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":G.alphaMap=F(H,D.mapAlphaRepeat,D.mapAlphaOffset,D.mapAlphaWrap,D.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":G.side=C.BackSide;break;case"doubleSided":G.side=C.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),G.opacity=H;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":G[O]=H;break;case"vertexColors":!0===H&&(G.vertexColors=C.VertexColors),"face"===H&&(G.vertexColors=C.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",O,H);}}return"MeshBasicMaterial"===G.type&&delete G.emissive,"MeshPhongMaterial"!==G.type&&delete G.specular,1>G.opacity&&(G.transparent=!0),R.setTextures(V),R.parse(G)}}()},C.Loader.Handlers={handlers:[],add:function(A,P){this.handlers.push(A,P)},get:function(A){for(var P=this.handlers,R=0,D=P.length;R<D;R+=2){var I=P[R],U=P[R+1];if(I.test(A))return U}return null}},C.XHRLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.XHRLoader.prototype={constructor:C.XHRLoader,load:function(A,P,R,D){void 0!==this.path&&(A=this.path+A);var I=this,U=C.Cache.get(A);if(void 0!==U)return P&&setTimeout(function(){P(U)},0),U;var F=new XMLHttpRequest;return F.overrideMimeType("text/plain"),F.open("GET",A,!0),F.addEventListener("load",function(V){var G=V.target.response;C.Cache.add(A,G),200===this.status?(P&&P(G),I.manager.itemEnd(A)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),P&&P(G),I.manager.itemEnd(A)):(D&&D(V),I.manager.itemError(A))},!1),void 0!==R&&F.addEventListener("progress",function(V){R(V)},!1),F.addEventListener("error",function(V){D&&D(V),I.manager.itemError(A)},!1),void 0!==this.responseType&&(F.responseType=this.responseType),void 0!==this.withCredentials&&(F.withCredentials=this.withCredentials),F.send(null),I.manager.itemStart(A),F},setPath:function(A){this.path=A},setResponseType:function(A){this.responseType=A},setWithCredentials:function(A){this.withCredentials=A}},C.FontLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.FontLoader.prototype={constructor:C.FontLoader,load:function(A,P,R,D){var I=new C.XHRLoader(this.manager);I.load(A,function(U){P(new C.Font(JSON.parse(U.substring(65,U.length-2))))},R,D)}},C.ImageLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.ImageLoader.prototype={constructor:C.ImageLoader,load:function(A,P,R,D){void 0!==this.path&&(A=this.path+A);var I=this,U=C.Cache.get(A);if(void 0!==U)return I.manager.itemStart(A),P?setTimeout(function(){P(U),I.manager.itemEnd(A)},0):I.manager.itemEnd(A),U;var F=document.createElement("img");return F.addEventListener("load",function(){C.Cache.add(A,this),P&&P(this),I.manager.itemEnd(A)},!1),void 0!==R&&F.addEventListener("progress",function(V){R(V)},!1),F.addEventListener("error",function(V){D&&D(V),I.manager.itemError(A)},!1),void 0!==this.crossOrigin&&(F.crossOrigin=this.crossOrigin),I.manager.itemStart(A),F.src=A,F},setCrossOrigin:function(A){this.crossOrigin=A},setPath:function(A){this.path=A}},C.JSONLoader=function(A){"boolean"==typeof A&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),A=void 0),this.manager=A===void 0?C.DefaultLoadingManager:A,this.withCredentials=!1},C.JSONLoader.prototype={constructor:C.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(A,P,R,D){var I=this,U=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:C.Loader.prototype.extractUrlBase(A),F=new C.XHRLoader(this.manager);F.setWithCredentials(this.withCredentials),F.load(A,function(V){var G=JSON.parse(V),O=G.metadata;if(O!==void 0){var H=O.type;if(H!==void 0){if("object"===H.toLowerCase())return void console.error("THREE.JSONLoader: "+A+" should be loaded with THREE.ObjectLoader instead.");if("scene"===H.toLowerCase())return void console.error("THREE.JSONLoader: "+A+" should be loaded with THREE.SceneLoader instead.")}}var W=I.parse(G,U);P(W.geometry,W.materials)},R,D)},setTexturePath:function(A){this.texturePath=A},parse:function(A,P){var F=new C.Geometry,V=void 0===A.scale?1:1/A.scale;if(function(O){function H(De,Ie){return De&1<<Ie}var we=A.faces,Ce=A.vertices,Ae=A.normals,Pe=A.colors,Re=0,W,X,Y,Z,K,Q,J,ee,oe,ne,ie,se,le,pe,ue,ge,fe,he,ye,xe,ve,_e,Se,Me,Te,Ee,Le;if(void 0!==A.uvs){for(W=0;W<A.uvs.length;W++)A.uvs[W].length&&Re++;for(W=0;W<Re;W++)F.faceVertexUvs[W]=[]}for(Z=0,K=Ce.length;Z<K;)he=new C.Vector3,he.x=Ce[Z++]*O,he.y=Ce[Z++]*O,he.z=Ce[Z++]*O,F.vertices.push(he);for(Z=0,K=we.length;Z<K;)if(ne=we[Z++],ie=H(ne,0),se=H(ne,1),le=H(ne,3),pe=H(ne,4),ue=H(ne,5),ge=H(ne,6),fe=H(ne,7),ie){if(xe=new C.Face3,xe.a=we[Z],xe.b=we[Z+1],xe.c=we[Z+3],ve=new C.Face3,ve.a=we[Z+1],ve.b=we[Z+2],ve.c=we[Z+3],Z+=4,se&&(oe=we[Z++],xe.materialIndex=oe,ve.materialIndex=oe),Y=F.faces.length,le)for(W=0;W<Re;W++)for(Me=A.uvs[W],F.faceVertexUvs[W][Y]=[],F.faceVertexUvs[W][Y+1]=[],X=0;4>X;X++)ee=we[Z++],Ee=Me[2*ee],Le=Me[2*ee+1],Te=new C.Vector2(Ee,Le),2!==X&&F.faceVertexUvs[W][Y].push(Te),0!==X&&F.faceVertexUvs[W][Y+1].push(Te);if(pe&&(J=3*we[Z++],xe.normal.set(Ae[J++],Ae[J++],Ae[J]),ve.normal.copy(xe.normal)),ue)for(W=0;4>W;W++)J=3*we[Z++],Se=new C.Vector3(Ae[J++],Ae[J++],Ae[J]),2!==W&&xe.vertexNormals.push(Se),0!==W&&ve.vertexNormals.push(Se);if(ge&&(Q=we[Z++],_e=Pe[Q],xe.color.setHex(_e),ve.color.setHex(_e)),fe)for(W=0;4>W;W++)Q=we[Z++],_e=Pe[Q],2!==W&&xe.vertexColors.push(new C.Color(_e)),0!==W&&ve.vertexColors.push(new C.Color(_e));F.faces.push(xe),F.faces.push(ve)}else{if(ye=new C.Face3,ye.a=we[Z++],ye.b=we[Z++],ye.c=we[Z++],se&&(oe=we[Z++],ye.materialIndex=oe),Y=F.faces.length,le)for(W=0;W<Re;W++)for(Me=A.uvs[W],F.faceVertexUvs[W][Y]=[],X=0;3>X;X++)ee=we[Z++],Ee=Me[2*ee],Le=Me[2*ee+1],Te=new C.Vector2(Ee,Le),F.faceVertexUvs[W][Y].push(Te);if(pe&&(J=3*we[Z++],ye.normal.set(Ae[J++],Ae[J++],Ae[J])),ue)for(W=0;3>W;W++)J=3*we[Z++],Se=new C.Vector3(Ae[J++],Ae[J++],Ae[J]),ye.vertexNormals.push(Se);if(ge&&(Q=we[Z++],ye.color.setHex(Pe[Q])),fe)for(W=0;3>W;W++)Q=we[Z++],ye.vertexColors.push(new C.Color(Pe[Q]));F.faces.push(ye)}}(V),function(){var O=void 0===A.influencesPerVertex?2:A.influencesPerVertex;if(A.skinWeights)for(var H=0,W=A.skinWeights.length;H<W;H+=O){var X=A.skinWeights[H],Y=1<O?A.skinWeights[H+1]:0,Z=2<O?A.skinWeights[H+2]:0,K=3<O?A.skinWeights[H+3]:0;F.skinWeights.push(new C.Vector4(X,Y,Z,K))}if(A.skinIndices)for(var H=0,W=A.skinIndices.length;H<W;H+=O){var Q=A.skinIndices[H],J=1<O?A.skinIndices[H+1]:0,ee=2<O?A.skinIndices[H+2]:0,oe=3<O?A.skinIndices[H+3]:0;F.skinIndices.push(new C.Vector4(Q,J,ee,oe))}F.bones=A.bones,F.bones&&0<F.bones.length&&(F.skinWeights.length!==F.skinIndices.length||F.skinIndices.length!==F.vertices.length)&&console.warn("When skinning, number of vertices ("+F.vertices.length+"), skinIndices ("+F.skinIndices.length+"), and skinWeights ("+F.skinWeights.length+") should match.")}(),function(O){if(void 0!==A.morphTargets)for(var H=0,W=A.morphTargets.length;H<W;H++){F.morphTargets[H]={},F.morphTargets[H].name=A.morphTargets[H].name,F.morphTargets[H].vertices=[];for(var X=F.morphTargets[H].vertices,Y=A.morphTargets[H].vertices,Z=0,K=Y.length,Q;Z<K;Z+=3)Q=new C.Vector3,Q.x=Y[Z]*O,Q.y=Y[Z+1]*O,Q.z=Y[Z+2]*O,X.push(Q)}if(void 0!==A.morphColors&&0<A.morphColors.length){console.warn("THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.");for(var J=F.faces,ee=A.morphColors[0].colors,H=0,W=J.length;H<W;H++)J[H].color.fromArray(ee,3*H)}}(V),function(){var O=[],H=[];void 0!==A.animation&&H.push(A.animation),void 0!==A.animations&&(A.animations.length?H=H.concat(A.animations):H.push(A.animations));for(var W=0,X;W<H.length;W++)X=C.AnimationClip.parseAnimation(H[W],F.bones),X&&O.push(X);if(F.morphTargets){var Y=C.AnimationClip.CreateClipsFromMorphTargetSequences(F.morphTargets,10);O=O.concat(Y)}0<O.length&&(F.animations=O)}(),F.computeFaceNormals(),F.computeBoundingSphere(),void 0===A.materials||0===A.materials.length)return{geometry:F};var G=C.Loader.prototype.initMaterials(A.materials,P,this.crossOrigin);return{geometry:F,materials:G}}},C.LoadingManager=function(A,P,R){var D=this,I=!1,U=0,F=0;this.onStart=void 0,this.onLoad=A,this.onProgress=P,this.onError=R,this.itemStart=function(V){F++,!1==I&&D.onStart!==void 0&&D.onStart(V,U,F),I=!0},this.itemEnd=function(V){U++,D.onProgress!==void 0&&D.onProgress(V,U,F),U==F&&(I=!1,D.onLoad!==void 0&&D.onLoad())},this.itemError=function(V){D.onError!==void 0&&D.onError(V)}},C.DefaultLoadingManager=new C.LoadingManager,C.BufferGeometryLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.BufferGeometryLoader.prototype={constructor:C.BufferGeometryLoader,load:function(A,P,R,D){var I=this,U=new C.XHRLoader(I.manager);U.load(A,function(F){P(I.parse(JSON.parse(F)))},R,D)},parse:function(A){var P=new C.BufferGeometry,R=A.data.index,D={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(R!==void 0){var I=new D[R.type](R.array);P.setIndex(new C.BufferAttribute(I,1))}var U=A.data.attributes;for(var F in U){var V=U[F],I=new D[V.type](V.array);P.addAttribute(F,new C.BufferAttribute(I,V.itemSize,V.normalized))}var G=A.data.groups||A.data.drawcalls||A.data.offsets;if(G!==void 0)for(var O=0,H=G.length,W;O!==H;++O)W=G[O],P.addGroup(W.start,W.count,W.materialIndex);var X=A.data.boundingSphere;if(X!==void 0){var Y=new C.Vector3;X.center!==void 0&&Y.fromArray(X.center),P.boundingSphere=new C.Sphere(Y,X.radius)}return P}},C.MaterialLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A,this.textures={}},C.MaterialLoader.prototype={constructor:C.MaterialLoader,load:function(A,P,R,D){var I=this,U=new C.XHRLoader(I.manager);U.load(A,function(F){P(I.parse(JSON.parse(F)))},R,D)},setTextures:function(A){this.textures=A},getTexture:function(A){var P=this.textures;return void 0===P[A]&&console.warn("THREE.MaterialLoader: Undefined texture",A),P[A]},parse:function(A){var P=new C[A.type];if(void 0!==A.uuid&&(P.uuid=A.uuid),void 0!==A.name&&(P.name=A.name),void 0!==A.color&&P.color.setHex(A.color),void 0!==A.roughness&&(P.roughness=A.roughness),void 0!==A.metalness&&(P.metalness=A.metalness),void 0!==A.emissive&&P.emissive.setHex(A.emissive),void 0!==A.specular&&P.specular.setHex(A.specular),void 0!==A.shininess&&(P.shininess=A.shininess),void 0!==A.uniforms&&(P.uniforms=A.uniforms),void 0!==A.vertexShader&&(P.vertexShader=A.vertexShader),void 0!==A.fragmentShader&&(P.fragmentShader=A.fragmentShader),void 0!==A.vertexColors&&(P.vertexColors=A.vertexColors),void 0!==A.shading&&(P.shading=A.shading),void 0!==A.blending&&(P.blending=A.blending),void 0!==A.side&&(P.side=A.side),void 0!==A.opacity&&(P.opacity=A.opacity),void 0!==A.transparent&&(P.transparent=A.transparent),void 0!==A.alphaTest&&(P.alphaTest=A.alphaTest),void 0!==A.depthTest&&(P.depthTest=A.depthTest),void 0!==A.depthWrite&&(P.depthWrite=A.depthWrite),void 0!==A.colorWrite&&(P.colorWrite=A.colorWrite),void 0!==A.wireframe&&(P.wireframe=A.wireframe),void 0!==A.wireframeLinewidth&&(P.wireframeLinewidth=A.wireframeLinewidth),void 0!==A.size&&(P.size=A.size),void 0!==A.sizeAttenuation&&(P.sizeAttenuation=A.sizeAttenuation),void 0!==A.map&&(P.map=this.getTexture(A.map)),void 0!==A.alphaMap&&(P.alphaMap=this.getTexture(A.alphaMap),P.transparent=!0),void 0!==A.bumpMap&&(P.bumpMap=this.getTexture(A.bumpMap)),void 0!==A.bumpScale&&(P.bumpScale=A.bumpScale),void 0!==A.normalMap&&(P.normalMap=this.getTexture(A.normalMap)),void 0!==A.normalScale){var R=A.normalScale;!1===Array.isArray(R)&&(R=[R,R]),P.normalScale=new C.Vector2().fromArray(R)}if(void 0!==A.displacementMap&&(P.displacementMap=this.getTexture(A.displacementMap)),void 0!==A.displacementScale&&(P.displacementScale=A.displacementScale),void 0!==A.displacementBias&&(P.displacementBias=A.displacementBias),void 0!==A.roughnessMap&&(P.roughnessMap=this.getTexture(A.roughnessMap)),void 0!==A.metalnessMap&&(P.metalnessMap=this.getTexture(A.metalnessMap)),void 0!==A.emissiveMap&&(P.emissiveMap=this.getTexture(A.emissiveMap)),void 0!==A.emissiveIntensity&&(P.emissiveIntensity=A.emissiveIntensity),void 0!==A.specularMap&&(P.specularMap=this.getTexture(A.specularMap)),void 0!==A.envMap&&(P.envMap=this.getTexture(A.envMap),P.combine=C.MultiplyOperation),A.reflectivity&&(P.reflectivity=A.reflectivity),void 0!==A.lightMap&&(P.lightMap=this.getTexture(A.lightMap)),void 0!==A.lightMapIntensity&&(P.lightMapIntensity=A.lightMapIntensity),void 0!==A.aoMap&&(P.aoMap=this.getTexture(A.aoMap)),void 0!==A.aoMapIntensity&&(P.aoMapIntensity=A.aoMapIntensity),void 0!==A.materials)for(var D=0,I=A.materials.length;D<I;D++)P.materials.push(this.parse(A.materials[D]));return P}},C.ObjectLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A,this.texturePath=""},C.ObjectLoader.prototype={constructor:C.ObjectLoader,load:function(A,P,R,D){""===this.texturePath&&(this.texturePath=A.substring(0,A.lastIndexOf("/")+1));var I=this,U=new C.XHRLoader(I.manager);U.load(A,function(F){I.parse(JSON.parse(F),P)},R,D)},setTexturePath:function(A){this.texturePath=A},setCrossOrigin:function(A){this.crossOrigin=A},parse:function(A,P){var R=this.parseGeometries(A.geometries),D=this.parseImages(A.images,function(){void 0!==P&&P(F)}),I=this.parseTextures(A.textures,D),U=this.parseMaterials(A.materials,I),F=this.parseObject(A.object,R,U);return A.animations&&(F.animations=this.parseAnimations(A.animations)),(void 0===A.images||0===A.images.length)&&void 0!==P&&P(F),F},parseGeometries:function(A){var P={};if(A!==void 0)for(var R=new C.JSONLoader,D=new C.BufferGeometryLoader,I=0,U=A.length;I<U;I++){var V=A[I],F;switch(V.type){case"PlaneGeometry":case"PlaneBufferGeometry":F=new C[V.type](V.width,V.height,V.widthSegments,V.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":F=new C[V.type](V.width,V.height,V.depth,V.widthSegments,V.heightSegments,V.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":F=new C[V.type](V.radius,V.segments,V.thetaStart,V.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":F=new C[V.type](V.radiusTop,V.radiusBottom,V.height,V.radialSegments,V.heightSegments,V.openEnded,V.thetaStart,V.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":F=new C[V.type](V.radius,V.widthSegments,V.heightSegments,V.phiStart,V.phiLength,V.thetaStart,V.thetaLength);break;case"DodecahedronGeometry":F=new C.DodecahedronGeometry(V.radius,V.detail);break;case"IcosahedronGeometry":F=new C.IcosahedronGeometry(V.radius,V.detail);break;case"OctahedronGeometry":F=new C.OctahedronGeometry(V.radius,V.detail);break;case"TetrahedronGeometry":F=new C.TetrahedronGeometry(V.radius,V.detail);break;case"RingGeometry":case"RingBufferGeometry":F=new C[V.type](V.innerRadius,V.outerRadius,V.thetaSegments,V.phiSegments,V.thetaStart,V.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":F=new C[V.type](V.radius,V.tube,V.radialSegments,V.tubularSegments,V.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":F=new C[V.type](V.radius,V.tube,V.tubularSegments,V.radialSegments,V.p,V.q);break;case"LatheGeometry":case"LatheBufferGeometry":F=new C[V.type](V.points,V.segments,V.phiStart,V.phiLength);break;case"BufferGeometry":F=D.parse(V);break;case"Geometry":F=R.parse(V.data,this.texturePath).geometry;break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+V.type+"\"");continue;}F.uuid=V.uuid,void 0!==V.name&&(F.name=V.name),P[V.uuid]=F}return P},parseMaterials:function(A,P){var R={};if(A!==void 0){var D=new C.MaterialLoader;D.setTextures(P);for(var I=0,U=A.length,F;I<U;I++)F=D.parse(A[I]),R[F.uuid]=F}return R},parseAnimations:function(A){for(var P=[],R=0,D;R<A.length;R++)D=C.AnimationClip.parse(A[R]),P.push(D);return P},parseImages:function(A,P){function R(W){return D.manager.itemStart(W),F.load(W,function(){D.manager.itemEnd(W)})}var D=this,I={};if(A!==void 0&&0<A.length){var U=new C.LoadingManager(P),F=new C.ImageLoader(U);F.setCrossOrigin(this.crossOrigin);for(var V=0,G=A.length;V<G;V++){var O=A[V],H=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O.url)?O.url:D.texturePath+O.url;I[O.uuid]=R(H)}}return I},parseTextures:function(A,P){function R(G){return"number"==typeof G?G:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",G),C[G])}var D={};if(A!==void 0)for(var I=0,U=A.length,F;I<U;I++){F=A[I],void 0===F.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",F.uuid),void 0===P[F.image]&&console.warn("THREE.ObjectLoader: Undefined image",F.image);var V=new C.Texture(P[F.image]);V.needsUpdate=!0,V.uuid=F.uuid,void 0!==F.name&&(V.name=F.name),void 0!==F.mapping&&(V.mapping=R(F.mapping)),void 0!==F.offset&&(V.offset=new C.Vector2(F.offset[0],F.offset[1])),void 0!==F.repeat&&(V.repeat=new C.Vector2(F.repeat[0],F.repeat[1])),void 0!==F.minFilter&&(V.minFilter=R(F.minFilter)),void 0!==F.magFilter&&(V.magFilter=R(F.magFilter)),void 0!==F.anisotropy&&(V.anisotropy=F.anisotropy),Array.isArray(F.wrap)&&(V.wrapS=R(F.wrap[0]),V.wrapT=R(F.wrap[1])),D[F.uuid]=V}return D},parseObject:function(){var A=new C.Matrix4;return function(P,R,D){function I(Y){return void 0===R[Y]&&console.warn("THREE.ObjectLoader: Undefined geometry",Y),R[Y]}function U(Y){if(void 0!==Y)return void 0===D[Y]&&console.warn("THREE.ObjectLoader: Undefined material",Y),D[Y]}var F;switch(P.type){case"Scene":F=new C.Scene;break;case"PerspectiveCamera":F=new C.PerspectiveCamera(P.fov,P.aspect,P.near,P.far),void 0!==P.focus&&(F.focus=P.focus),void 0!==P.zoom&&(F.zoom=P.zoom),void 0!==P.filmGauge&&(F.filmGauge=P.filmGauge),void 0!==P.filmOffset&&(F.filmOffset=P.filmOffset),void 0!==P.view&&(F.view=Object.assign({},P.view));break;case"OrthographicCamera":F=new C.OrthographicCamera(P.left,P.right,P.top,P.bottom,P.near,P.far);break;case"AmbientLight":F=new C.AmbientLight(P.color,P.intensity);break;case"DirectionalLight":F=new C.DirectionalLight(P.color,P.intensity);break;case"PointLight":F=new C.PointLight(P.color,P.intensity,P.distance,P.decay);break;case"SpotLight":F=new C.SpotLight(P.color,P.intensity,P.distance,P.angle,P.penumbra,P.decay);break;case"HemisphereLight":F=new C.HemisphereLight(P.color,P.groundColor,P.intensity);break;case"Mesh":var V=I(P.geometry),G=U(P.material);F=V.bones&&0<V.bones.length?new C.SkinnedMesh(V,G):new C.Mesh(V,G);break;case"LOD":F=new C.LOD;break;case"Line":F=new C.Line(I(P.geometry),U(P.material),P.mode);break;case"PointCloud":case"Points":F=new C.Points(I(P.geometry),U(P.material));break;case"Sprite":F=new C.Sprite(U(P.material));break;case"Group":F=new C.Group;break;default:F=new C.Object3D;}if(F.uuid=P.uuid,void 0!==P.name&&(F.name=P.name),void 0===P.matrix?(void 0!==P.position&&F.position.fromArray(P.position),void 0!==P.rotation&&F.rotation.fromArray(P.rotation),void 0!==P.scale&&F.scale.fromArray(P.scale)):(A.fromArray(P.matrix),A.decompose(F.position,F.quaternion,F.scale)),void 0!==P.castShadow&&(F.castShadow=P.castShadow),void 0!==P.receiveShadow&&(F.receiveShadow=P.receiveShadow),void 0!==P.visible&&(F.visible=P.visible),void 0!==P.userData&&(F.userData=P.userData),void 0!==P.children)for(var O in P.children)F.add(this.parseObject(P.children[O],R,D));if("LOD"===P.type)for(var H=P.levels,W=0;W<H.length;W++){var X=H[W],O=F.getObjectByProperty("uuid",X.object);void 0!==O&&F.addLevel(O,X.distance)}return F}}()},C.TextureLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.TextureLoader.prototype={constructor:C.TextureLoader,load:function(A,P,R,D){var I=new C.Texture,U=new C.ImageLoader(this.manager);return U.setCrossOrigin(this.crossOrigin),U.setPath(this.path),U.load(A,function(F){I.image=F,I.needsUpdate=!0,void 0!==P&&P(I)},R,D),I},setCrossOrigin:function(A){this.crossOrigin=A},setPath:function(A){this.path=A}},C.CubeTextureLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A},C.CubeTextureLoader.prototype={constructor:C.CubeTextureLoader,load:function(A,P,R,D){function I(O){F.load(A[O],function(H){U.images[O]=H,V++,6==V&&(U.needsUpdate=!0,P&&P(U))},void 0,D)}var U=new C.CubeTexture,F=new C.ImageLoader(this.manager);F.setCrossOrigin(this.crossOrigin),F.setPath(this.path);for(var V=0,G=0;G<A.length;++G)I(G);return U},setCrossOrigin:function(A){this.crossOrigin=A},setPath:function(A){this.path=A}},C.DataTextureLoader=C.BinaryTextureLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A,this._parser=null},C.BinaryTextureLoader.prototype={constructor:C.BinaryTextureLoader,load:function(A,P,R,D){var I=this,U=new C.DataTexture,F=new C.XHRLoader(this.manager);return F.setResponseType("arraybuffer"),F.load(A,function(V){var G=I._parser(V);G&&(void 0===G.image?void 0!==G.data&&(U.image.width=G.width,U.image.height=G.height,U.image.data=G.data):U.image=G.image,U.wrapS=void 0===G.wrapS?C.ClampToEdgeWrapping:G.wrapS,U.wrapT=void 0===G.wrapT?C.ClampToEdgeWrapping:G.wrapT,U.magFilter=void 0===G.magFilter?C.LinearFilter:G.magFilter,U.minFilter=void 0===G.minFilter?C.LinearMipMapLinearFilter:G.minFilter,U.anisotropy=void 0===G.anisotropy?1:G.anisotropy,void 0!==G.format&&(U.format=G.format),void 0!==G.type&&(U.type=G.type),void 0!==G.mipmaps&&(U.mipmaps=G.mipmaps),1===G.mipmapCount&&(U.minFilter=C.LinearFilter),U.needsUpdate=!0,P&&P(U,G))},R,D),U}},C.CompressedTextureLoader=function(A){this.manager=A===void 0?C.DefaultLoadingManager:A,this._parser=null},C.CompressedTextureLoader.prototype={constructor:C.CompressedTextureLoader,load:function(A,P,R,D){function I(X){G.load(A[X],function(Y){var Z=U._parser(Y,!0);F[X]={width:Z.width,height:Z.height,format:Z.format,mipmaps:Z.mipmaps},O+=1,6==O&&(1===Z.mipmapCount&&(V.minFilter=C.LinearFilter),V.format=Z.format,V.needsUpdate=!0,P&&P(V))},R,D)}var U=this,F=[],V=new C.CompressedTexture;V.image=F;var G=new C.XHRLoader(this.manager);if(G.setPath(this.path),G.setResponseType("arraybuffer"),Array.isArray(A))for(var O=0,H=0,W=A.length;H<W;++H)I(H);else G.load(A,function(X){var Y=U._parser(X,!0);if(Y.isCubemap)for(var Z=Y.mipmaps.length/Y.mipmapCount,K=0;K<Z;K++){F[K]={mipmaps:[]};for(var Q=0;Q<Y.mipmapCount;Q++)F[K].mipmaps.push(Y.mipmaps[K*Y.mipmapCount+Q]),F[K].format=Y.format,F[K].width=Y.width,F[K].height=Y.height}else V.image.width=Y.width,V.image.height=Y.height,V.mipmaps=Y.mipmaps;1===Y.mipmapCount&&(V.minFilter=C.LinearFilter),V.format=Y.format,V.needsUpdate=!0,P&&P(V)},R,D);return V},setPath:function(A){this.path=A}},C.Material=function(){Object.defineProperty(this,"id",{value:C.MaterialIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.type="Material",this.side=C.FrontSide,this.opacity=1,this.transparent=!1,this.blending=C.NormalBlending,this.blendSrc=C.SrcAlphaFactor,this.blendDst=C.OneMinusSrcAlphaFactor,this.blendEquation=C.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=C.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},C.Material.prototype={constructor:C.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(A){!0===A&&this.update(),this._needsUpdate=A},setValues:function(A){if(void 0!==A)for(var P in A){var R=A[P];if(void 0===R){console.warn("THREE.Material: '"+P+"' parameter is undefined.");continue}var D=this[P];if(void 0===D){console.warn("THREE."+this.type+": '"+P+"' is not a property of this material.");continue}D instanceof C.Color?D.set(R):D instanceof C.Vector3&&R instanceof C.Vector3?D.copy(R):"overdraw"==P?this[P]=+R:this[P]=R}},toJSON:function(A){function P(F){var V=[];for(var G in F){var O=F[G];delete O.metadata,V.push(O)}return V}var R=void 0===A;R&&(A={textures:{},images:{}});var D={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(D.uuid=this.uuid,D.type=this.type,""!==this.name&&(D.name=this.name),this.color instanceof C.Color&&(D.color=this.color.getHex()),0.5!==this.roughness&&(D.roughness=this.roughness),0.5!==this.metalness&&(D.metalness=this.metalness),this.emissive instanceof C.Color&&(D.emissive=this.emissive.getHex()),this.specular instanceof C.Color&&(D.specular=this.specular.getHex()),void 0!==this.shininess&&(D.shininess=this.shininess),this.map instanceof C.Texture&&(D.map=this.map.toJSON(A).uuid),this.alphaMap instanceof C.Texture&&(D.alphaMap=this.alphaMap.toJSON(A).uuid),this.lightMap instanceof C.Texture&&(D.lightMap=this.lightMap.toJSON(A).uuid),this.bumpMap instanceof C.Texture&&(D.bumpMap=this.bumpMap.toJSON(A).uuid,D.bumpScale=this.bumpScale),this.normalMap instanceof C.Texture&&(D.normalMap=this.normalMap.toJSON(A).uuid,D.normalScale=this.normalScale.toArray()),this.displacementMap instanceof C.Texture&&(D.displacementMap=this.displacementMap.toJSON(A).uuid,D.displacementScale=this.displacementScale,D.displacementBias=this.displacementBias),this.roughnessMap instanceof C.Texture&&(D.roughnessMap=this.roughnessMap.toJSON(A).uuid),this.metalnessMap instanceof C.Texture&&(D.metalnessMap=this.metalnessMap.toJSON(A).uuid),this.emissiveMap instanceof C.Texture&&(D.emissiveMap=this.emissiveMap.toJSON(A).uuid),this.specularMap instanceof C.Texture&&(D.specularMap=this.specularMap.toJSON(A).uuid),this.envMap instanceof C.Texture&&(D.envMap=this.envMap.toJSON(A).uuid,D.reflectivity=this.reflectivity),void 0!==this.size&&(D.size=this.size),void 0!==this.sizeAttenuation&&(D.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==C.NoColors&&(D.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==C.SmoothShading&&(D.shading=this.shading),void 0!==this.blending&&this.blending!==C.NormalBlending&&(D.blending=this.blending),void 0!==this.side&&this.side!==C.FrontSide&&(D.side=this.side),1>this.opacity&&(D.opacity=this.opacity),!0===this.transparent&&(D.transparent=this.transparent),0<this.alphaTest&&(D.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(D.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(D.wireframe=this.wireframe),1<this.wireframeLinewidth&&(D.wireframeLinewidth=this.wireframeLinewidth),R){var I=P(A.textures),U=P(A.images);0<I.length&&(D.textures=I),0<U.length&&(D.images=U)}return D},clone:function(){return new this.constructor().copy(this)},copy:function(A){this.name=A.name,this.side=A.side,this.opacity=A.opacity,this.transparent=A.transparent,this.blending=A.blending,this.blendSrc=A.blendSrc,this.blendDst=A.blendDst,this.blendEquation=A.blendEquation,this.blendSrcAlpha=A.blendSrcAlpha,this.blendDstAlpha=A.blendDstAlpha,this.blendEquationAlpha=A.blendEquationAlpha,this.depthFunc=A.depthFunc,this.depthTest=A.depthTest,this.depthWrite=A.depthWrite,this.colorWrite=A.colorWrite,this.precision=A.precision,this.polygonOffset=A.polygonOffset,this.polygonOffsetFactor=A.polygonOffsetFactor,this.polygonOffsetUnits=A.polygonOffsetUnits,this.alphaTest=A.alphaTest,this.premultipliedAlpha=A.premultipliedAlpha,this.overdraw=A.overdraw,this.visible=A.visible,this.clipShadows=A.clipShadows;var P=A.clippingPlanes,R=null;if(null!==P){var D=P.length;R=Array(D);for(var I=0;I!==D;++I)R[I]=P[I].clone()}return this.clippingPlanes=R,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},C.EventDispatcher.prototype.apply(C.Material.prototype),C.MaterialIdCount=0,C.LineBasicMaterial=function(A){C.Material.call(this),this.type="LineBasicMaterial",this.color=new C.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.blending=C.NormalBlending,this.vertexColors=C.NoColors,this.fog=!0,this.setValues(A)},C.LineBasicMaterial.prototype=Object.create(C.Material.prototype),C.LineBasicMaterial.prototype.constructor=C.LineBasicMaterial,C.LineBasicMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.linewidth=A.linewidth,this.linecap=A.linecap,this.linejoin=A.linejoin,this.vertexColors=A.vertexColors,this.fog=A.fog,this},C.LineDashedMaterial=function(A){C.Material.call(this),this.type="LineDashedMaterial",this.color=new C.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.blending=C.NormalBlending,this.vertexColors=C.NoColors,this.fog=!0,this.setValues(A)},C.LineDashedMaterial.prototype=Object.create(C.Material.prototype),C.LineDashedMaterial.prototype.constructor=C.LineDashedMaterial,C.LineDashedMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.linewidth=A.linewidth,this.scale=A.scale,this.dashSize=A.dashSize,this.gapSize=A.gapSize,this.vertexColors=A.vertexColors,this.fog=A.fog,this},C.MeshBasicMaterial=function(A){C.Material.call(this),this.type="MeshBasicMaterial",this.color=new C.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=C.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=C.SmoothShading,this.blending=C.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=C.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(A)},C.MeshBasicMaterial.prototype=Object.create(C.Material.prototype),C.MeshBasicMaterial.prototype.constructor=C.MeshBasicMaterial,C.MeshBasicMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.map=A.map,this.aoMap=A.aoMap,this.aoMapIntensity=A.aoMapIntensity,this.specularMap=A.specularMap,this.alphaMap=A.alphaMap,this.envMap=A.envMap,this.combine=A.combine,this.reflectivity=A.reflectivity,this.refractionRatio=A.refractionRatio,this.fog=A.fog,this.shading=A.shading,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this.wireframeLinecap=A.wireframeLinecap,this.wireframeLinejoin=A.wireframeLinejoin,this.vertexColors=A.vertexColors,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this},C.MeshDepthMaterial=function(A){C.Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=C.BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(A)},C.MeshDepthMaterial.prototype=Object.create(C.Material.prototype),C.MeshDepthMaterial.prototype.constructor=C.MeshDepthMaterial,C.MeshDepthMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.depthPacking=A.depthPacking,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this.map=A.map,this.alphaMap=A.alphaMap,this.displacementMap=A.displacementMap,this.displacementScale=A.displacementScale,this.displacementBias=A.displacementBias,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this},C.MeshLambertMaterial=function(A){C.Material.call(this),this.type="MeshLambertMaterial",this.color=new C.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new C.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=C.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.blending=C.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=C.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(A)},C.MeshLambertMaterial.prototype=Object.create(C.Material.prototype),C.MeshLambertMaterial.prototype.constructor=C.MeshLambertMaterial,C.MeshLambertMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.map=A.map,this.lightMap=A.lightMap,this.lightMapIntensity=A.lightMapIntensity,this.aoMap=A.aoMap,this.aoMapIntensity=A.aoMapIntensity,this.emissive.copy(A.emissive),this.emissiveMap=A.emissiveMap,this.emissiveIntensity=A.emissiveIntensity,this.specularMap=A.specularMap,this.alphaMap=A.alphaMap,this.envMap=A.envMap,this.combine=A.combine,this.reflectivity=A.reflectivity,this.refractionRatio=A.refractionRatio,this.fog=A.fog,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this.wireframeLinecap=A.wireframeLinecap,this.wireframeLinejoin=A.wireframeLinejoin,this.vertexColors=A.vertexColors,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this.morphNormals=A.morphNormals,this},C.MeshNormalMaterial=function(A){C.Material.call(this,A),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(A)},C.MeshNormalMaterial.prototype=Object.create(C.Material.prototype),C.MeshNormalMaterial.prototype.constructor=C.MeshNormalMaterial,C.MeshNormalMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this},C.MeshPhongMaterial=function(A){C.Material.call(this),this.type="MeshPhongMaterial",this.color=new C.Color(16777215),this.specular=new C.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new C.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new C.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=C.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=C.SmoothShading,this.blending=C.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=C.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(A)},C.MeshPhongMaterial.prototype=Object.create(C.Material.prototype),C.MeshPhongMaterial.prototype.constructor=C.MeshPhongMaterial,C.MeshPhongMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.specular.copy(A.specular),this.shininess=A.shininess,this.map=A.map,this.lightMap=A.lightMap,this.lightMapIntensity=A.lightMapIntensity,this.aoMap=A.aoMap,this.aoMapIntensity=A.aoMapIntensity,this.emissive.copy(A.emissive),this.emissiveMap=A.emissiveMap,this.emissiveIntensity=A.emissiveIntensity,this.bumpMap=A.bumpMap,this.bumpScale=A.bumpScale,this.normalMap=A.normalMap,this.normalScale.copy(A.normalScale),this.displacementMap=A.displacementMap,this.displacementScale=A.displacementScale,this.displacementBias=A.displacementBias,this.specularMap=A.specularMap,this.alphaMap=A.alphaMap,this.envMap=A.envMap,this.combine=A.combine,this.reflectivity=A.reflectivity,this.refractionRatio=A.refractionRatio,this.fog=A.fog,this.shading=A.shading,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this.wireframeLinecap=A.wireframeLinecap,this.wireframeLinejoin=A.wireframeLinejoin,this.vertexColors=A.vertexColors,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this.morphNormals=A.morphNormals,this},C.MeshStandardMaterial=function(A){C.Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new C.Color(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new C.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new C.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.fog=!0,this.shading=C.SmoothShading,this.blending=C.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=C.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(A)},C.MeshStandardMaterial.prototype=Object.create(C.Material.prototype),C.MeshStandardMaterial.prototype.constructor=C.MeshStandardMaterial,C.MeshStandardMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.defines={STANDARD:""},this.color.copy(A.color),this.roughness=A.roughness,this.metalness=A.metalness,this.map=A.map,this.lightMap=A.lightMap,this.lightMapIntensity=A.lightMapIntensity,this.aoMap=A.aoMap,this.aoMapIntensity=A.aoMapIntensity,this.emissive.copy(A.emissive),this.emissiveMap=A.emissiveMap,this.emissiveIntensity=A.emissiveIntensity,this.bumpMap=A.bumpMap,this.bumpScale=A.bumpScale,this.normalMap=A.normalMap,this.normalScale.copy(A.normalScale),this.displacementMap=A.displacementMap,this.displacementScale=A.displacementScale,this.displacementBias=A.displacementBias,this.roughnessMap=A.roughnessMap,this.metalnessMap=A.metalnessMap,this.alphaMap=A.alphaMap,this.envMap=A.envMap,this.envMapIntensity=A.envMapIntensity,this.refractionRatio=A.refractionRatio,this.fog=A.fog,this.shading=A.shading,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this.wireframeLinecap=A.wireframeLinecap,this.wireframeLinejoin=A.wireframeLinejoin,this.vertexColors=A.vertexColors,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this.morphNormals=A.morphNormals,this},C.MeshPhysicalMaterial=function(A){C.MeshStandardMaterial.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=0.5,this.setValues(A)},C.MeshPhysicalMaterial.prototype=Object.create(C.MeshStandardMaterial.prototype),C.MeshPhysicalMaterial.prototype.constructor=C.MeshPhysicalMaterial,C.MeshPhysicalMaterial.prototype.copy=function(A){return C.MeshStandardMaterial.prototype.copy.call(this,A),this.defines={PHYSICAL:""},this.reflectivity=A.reflectivity,this},C.MultiMaterial=function(A){this.uuid=C.Math.generateUUID(),this.type="MultiMaterial",this.materials=A instanceof Array?A:[],this.visible=!0},C.MultiMaterial.prototype={constructor:C.MultiMaterial,toJSON:function(A){for(var P={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},R=this.materials,D=0,I=R.length,U;D<I;D++)U=R[D].toJSON(A),delete U.metadata,P.materials.push(U);return P.visible=this.visible,P},clone:function(){for(var A=new this.constructor,P=0;P<this.materials.length;P++)A.materials.push(this.materials[P].clone());return A.visible=this.visible,A}},C.PointsMaterial=function(A){C.Material.call(this),this.type="PointsMaterial",this.color=new C.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.blending=C.NormalBlending,this.vertexColors=C.NoColors,this.fog=!0,this.setValues(A)},C.PointsMaterial.prototype=Object.create(C.Material.prototype),C.PointsMaterial.prototype.constructor=C.PointsMaterial,C.PointsMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.map=A.map,this.size=A.size,this.sizeAttenuation=A.sizeAttenuation,this.vertexColors=A.vertexColors,this.fog=A.fog,this},C.ShaderMaterial=function(A){C.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=C.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.vertexColors=C.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,A!==void 0&&(A.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(A))},C.ShaderMaterial.prototype=Object.create(C.Material.prototype),C.ShaderMaterial.prototype.constructor=C.ShaderMaterial,C.ShaderMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.fragmentShader=A.fragmentShader,this.vertexShader=A.vertexShader,this.uniforms=C.UniformsUtils.clone(A.uniforms),this.defines=A.defines,this.shading=A.shading,this.wireframe=A.wireframe,this.wireframeLinewidth=A.wireframeLinewidth,this.fog=A.fog,this.lights=A.lights,this.clipping=A.clipping,this.vertexColors=A.vertexColors,this.skinning=A.skinning,this.morphTargets=A.morphTargets,this.morphNormals=A.morphNormals,this.extensions=A.extensions,this},C.ShaderMaterial.prototype.toJSON=function(A){var P=C.Material.prototype.toJSON.call(this,A);return P.uniforms=this.uniforms,P.vertexShader=this.vertexShader,P.fragmentShader=this.fragmentShader,P},C.RawShaderMaterial=function(A){C.ShaderMaterial.call(this,A),this.type="RawShaderMaterial"},C.RawShaderMaterial.prototype=Object.create(C.ShaderMaterial.prototype),C.RawShaderMaterial.prototype.constructor=C.RawShaderMaterial,C.SpriteMaterial=function(A){C.Material.call(this),this.type="SpriteMaterial",this.color=new C.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(A)},C.SpriteMaterial.prototype=Object.create(C.Material.prototype),C.SpriteMaterial.prototype.constructor=C.SpriteMaterial,C.SpriteMaterial.prototype.copy=function(A){return C.Material.prototype.copy.call(this,A),this.color.copy(A.color),this.map=A.map,this.rotation=A.rotation,this.fog=A.fog,this},C.Texture=function(A,P,R,D,I,U,F,V,G,O){Object.defineProperty(this,"id",{value:C.TextureIdCount++}),this.uuid=C.Math.generateUUID(),this.name="",this.sourceFile="",this.image=A===void 0?C.Texture.DEFAULT_IMAGE:A,this.mipmaps=[],this.mapping=P===void 0?C.Texture.DEFAULT_MAPPING:P,this.wrapS=R===void 0?C.ClampToEdgeWrapping:R,this.wrapT=D===void 0?C.ClampToEdgeWrapping:D,this.magFilter=I===void 0?C.LinearFilter:I,this.minFilter=U===void 0?C.LinearMipMapLinearFilter:U,this.anisotropy=G===void 0?1:G,this.format=F===void 0?C.RGBAFormat:F,this.type=V===void 0?C.UnsignedByteType:V,this.offset=new C.Vector2(0,0),this.repeat=new C.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=O===void 0?C.LinearEncoding:O,this.version=0,this.onUpdate=null},C.Texture.DEFAULT_IMAGE=void 0,C.Texture.DEFAULT_MAPPING=C.UVMapping,C.Texture.prototype={constructor:C.Texture,set needsUpdate(A){!0===A&&this.version++},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.image=A.image,this.mipmaps=A.mipmaps.slice(0),this.mapping=A.mapping,this.wrapS=A.wrapS,this.wrapT=A.wrapT,this.magFilter=A.magFilter,this.minFilter=A.minFilter,this.anisotropy=A.anisotropy,this.format=A.format,this.type=A.type,this.offset.copy(A.offset),this.repeat.copy(A.repeat),this.generateMipmaps=A.generateMipmaps,this.premultiplyAlpha=A.premultiplyAlpha,this.flipY=A.flipY,this.unpackAlignment=A.unpackAlignment,this.encoding=A.encoding,this},toJSON:function(A){function P(I){var U;return void 0===I.toDataURL?(U=document.createElement("canvas"),U.width=I.width,U.height=I.height,U.getContext("2d").drawImage(I,0,0,I.width,I.height)):U=I,2048<U.width||2048<U.height?U.toDataURL("image/jpeg",0.6):U.toDataURL("image/png")}if(void 0!==A.textures[this.uuid])return A.textures[this.uuid];var R={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var D=this.image;void 0===D.uuid&&(D.uuid=C.Math.generateUUID()),void 0===A.images[D.uuid]&&(A.images[D.uuid]={uuid:D.uuid,url:P(D)}),R.image=D.uuid}return A.textures[this.uuid]=R,R},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(A){if(this.mapping===C.UVMapping){if(A.multiply(this.repeat),A.add(this.offset),0>A.x||1<A.x)switch(this.wrapS){case C.RepeatWrapping:A.x-=_Mathfloor(A.x);break;case C.ClampToEdgeWrapping:A.x=0>A.x?0:1;break;case C.MirroredRepeatWrapping:1===_Mathabs(_Mathfloor(A.x)%2)?A.x=_Mathceil(A.x)-A.x:A.x-=_Mathfloor(A.x);}if(0>A.y||1<A.y)switch(this.wrapT){case C.RepeatWrapping:A.y-=_Mathfloor(A.y);break;case C.ClampToEdgeWrapping:A.y=0>A.y?0:1;break;case C.MirroredRepeatWrapping:1===_Mathabs(_Mathfloor(A.y)%2)?A.y=_Mathceil(A.y)-A.y:A.y-=_Mathfloor(A.y);}this.flipY&&(A.y=1-A.y)}}},C.EventDispatcher.prototype.apply(C.Texture.prototype),C.TextureIdCount=0,C.DepthTexture=function(A,P,R,D,I,U,F,V,G){C.Texture.call(this,null,D,I,U,F,V,C.DepthFormat,R,G),this.image={width:A,height:P},this.type=R===void 0?C.UnsignedShortType:R,this.magFilter=F===void 0?C.NearestFilter:F,this.minFilter=V===void 0?C.NearestFilter:V,this.flipY=!1,this.generateMipmaps=!1},C.DepthTexture.prototype=Object.create(C.Texture.prototype),C.DepthTexture.prototype.constructor=C.DepthTexture,C.CanvasTexture=function(A,P,R,D,I,U,F,V,G){C.Texture.call(this,A,P,R,D,I,U,F,V,G),this.needsUpdate=!0},C.CanvasTexture.prototype=Object.create(C.Texture.prototype),C.CanvasTexture.prototype.constructor=C.CanvasTexture,C.CubeTexture=function(A,P,R,D,I,U,F,V,G,O){A=A===void 0?[]:A,P=P===void 0?C.CubeReflectionMapping:P,C.Texture.call(this,A,P,R,D,I,U,F,V,G,O),this.flipY=!1},C.CubeTexture.prototype=Object.create(C.Texture.prototype),C.CubeTexture.prototype.constructor=C.CubeTexture,Object.defineProperty(C.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(A){this.image=A}}),C.CompressedTexture=function(A,P,R,D,I,U,F,V,G,O,H,W){C.Texture.call(this,null,U,F,V,G,O,D,I,H,W),this.image={width:P,height:R},this.mipmaps=A,this.flipY=!1,this.generateMipmaps=!1},C.CompressedTexture.prototype=Object.create(C.Texture.prototype),C.CompressedTexture.prototype.constructor=C.CompressedTexture,C.DataTexture=function(A,P,R,D,I,U,F,V,G,O,H,W){C.Texture.call(this,null,U,F,V,G,O,D,I,H,W),this.image={data:A,width:P,height:R},this.magFilter=G===void 0?C.NearestFilter:G,this.minFilter=O===void 0?C.NearestFilter:O,this.flipY=!1,this.generateMipmaps=!1},C.DataTexture.prototype=Object.create(C.Texture.prototype),C.DataTexture.prototype.constructor=C.DataTexture,C.VideoTexture=function(A,P,R,D,I,U,F,V,G){function O(){requestAnimationFrame(O),A.readyState>=A.HAVE_CURRENT_DATA&&(H.needsUpdate=!0)}C.Texture.call(this,A,P,R,D,I,U,F,V,G),this.generateMipmaps=!1;var H=this;O()},C.VideoTexture.prototype=Object.create(C.Texture.prototype),C.VideoTexture.prototype.constructor=C.VideoTexture,C.Group=function(){C.Object3D.call(this),this.type="Group"},C.Group.prototype=Object.create(C.Object3D.prototype),C.Group.prototype.constructor=C.Group,C.Points=function(A,P){C.Object3D.call(this),this.type="Points",this.geometry=A===void 0?new C.Geometry:A,this.material=P===void 0?new C.PointsMaterial({color:16777215*Math.random()}):P},C.Points.prototype=Object.create(C.Object3D.prototype),C.Points.prototype.constructor=C.Points,C.Points.prototype.raycast=function(){var A=new C.Matrix4,P=new C.Ray,R=new C.Sphere;return function(I,U){function F(le,pe){var ue=P.distanceSqToPoint(le);if(ue<X){var ge=P.closestPointToPoint(le);ge.applyMatrix4(O);var fe=I.ray.origin.distanceTo(ge);if(fe<I.near||fe>I.far)return;U.push({distance:fe,distanceToRay:_Mathsqrt(ue),point:ge.clone(),index:pe,face:null,object:V})}}var V=this,G=this.geometry,O=this.matrixWorld,H=I.params.Points.threshold;if(null===G.boundingSphere&&G.computeBoundingSphere(),R.copy(G.boundingSphere),R.applyMatrix4(O),!1!==I.ray.intersectsSphere(R)){A.getInverse(O),P.copy(I.ray).applyMatrix4(A);var W=H/((this.scale.x+this.scale.y+this.scale.z)/3),X=W*W,Y=new C.Vector3;if(G instanceof C.BufferGeometry){var Z=G.index,K=G.attributes,Q=K.position.array;if(null!==Z)for(var J=Z.array,ee=0,oe=J.length,ne;ee<oe;ee++)ne=J[ee],Y.fromArray(Q,3*ne),F(Y,ne);else for(var ee=0,ie=Q.length/3;ee<ie;ee++)Y.fromArray(Q,3*ee),F(Y,ee)}else for(var se=G.vertices,ee=0,ie=se.length;ee<ie;ee++)F(se[ee],ee)}}}(),C.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},C.Line=function(A,P,R){return 1===R?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new C.LineSegments(A,P)):void(C.Object3D.call(this),this.type="Line",this.geometry=A===void 0?new C.Geometry:A,this.material=P===void 0?new C.LineBasicMaterial({color:16777215*Math.random()}):P)},C.Line.prototype=Object.create(C.Object3D.prototype),C.Line.prototype.constructor=C.Line,C.Line.prototype.raycast=function(){var A=new C.Matrix4,P=new C.Ray,R=new C.Sphere;return function(I,U){var F=I.linePrecision,V=F*F,G=this.geometry,O=this.matrixWorld;if(null===G.boundingSphere&&G.computeBoundingSphere(),R.copy(G.boundingSphere),R.applyMatrix4(O),!1!==I.ray.intersectsSphere(R)){A.getInverse(O),P.copy(I.ray).applyMatrix4(A);var H=new C.Vector3,W=new C.Vector3,X=new C.Vector3,Y=new C.Vector3,Z=this instanceof C.LineSegments?2:1;if(G instanceof C.BufferGeometry){var K=G.index,Q=G.attributes,J=Q.position.array;if(null!==K)for(var ee=K.array,oe=0,ne=ee.length-1;oe<ne;oe+=Z){var ie=ee[oe],se=ee[oe+1];H.fromArray(J,3*ie),W.fromArray(J,3*se);var le=P.distanceSqToSegment(H,W,Y,X);if(!(le>V)){Y.applyMatrix4(this.matrixWorld);var pe=I.ray.origin.distanceTo(Y);pe<I.near||pe>I.far||U.push({distance:pe,point:X.clone().applyMatrix4(this.matrixWorld),index:oe,face:null,faceIndex:null,object:this})}}else for(var oe=0,ne=J.length/3-1;oe<ne;oe+=Z){H.fromArray(J,3*oe),W.fromArray(J,3*oe+3);var le=P.distanceSqToSegment(H,W,Y,X);if(!(le>V)){Y.applyMatrix4(this.matrixWorld);var pe=I.ray.origin.distanceTo(Y);pe<I.near||pe>I.far||U.push({distance:pe,point:X.clone().applyMatrix4(this.matrixWorld),index:oe,face:null,faceIndex:null,object:this})}}}else if(G instanceof C.Geometry)for(var ue=G.vertices,ge=ue.length,oe=0,le;oe<ge-1;oe+=Z)if(le=P.distanceSqToSegment(ue[oe],ue[oe+1],Y,X),!(le>V)){Y.applyMatrix4(this.matrixWorld);var pe=I.ray.origin.distanceTo(Y);pe<I.near||pe>I.far||U.push({distance:pe,point:X.clone().applyMatrix4(this.matrixWorld),index:oe,face:null,faceIndex:null,object:this})}}}}(),C.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},C.LineStrip=0,C.LinePieces=1,C.LineSegments=function(A,P){C.Line.call(this,A,P),this.type="LineSegments"},C.LineSegments.prototype=Object.create(C.Line.prototype),C.LineSegments.prototype.constructor=C.LineSegments,C.Mesh=function(A,P){C.Object3D.call(this),this.type="Mesh",this.geometry=A===void 0?new C.Geometry:A,this.material=P===void 0?new C.MeshBasicMaterial({color:16777215*Math.random()}):P,this.drawMode=C.TrianglesDrawMode,this.updateMorphTargets()},C.Mesh.prototype=Object.create(C.Object3D.prototype),C.Mesh.prototype.constructor=C.Mesh,C.Mesh.prototype.setDrawMode=function(A){this.drawMode=A},C.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets!==void 0&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var A=0,P=this.geometry.morphTargets.length;A<P;A++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[A].name]=A}},C.Mesh.prototype.getMorphTargetIndexByName=function(A){return void 0===this.morphTargetDictionary[A]?(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+A+" does not exist. Returning 0."),0):this.morphTargetDictionary[A]},C.Mesh.prototype.raycast=function(){function A(ee,oe,ne,ie,se,le,pe){return C.Triangle.barycoordFromPoint(ee,oe,ne,ie,K),se.multiplyScalar(K.x),le.multiplyScalar(K.y),pe.multiplyScalar(K.z),se.add(le).add(pe),se.clone()}function P(ee,oe,ne,ie,se,le,pe){var ge=ee.material,ue;if(ue=ge.side===C.BackSide?ne.intersectTriangle(le,se,ie,!0,pe):ne.intersectTriangle(ie,se,le,ge.side!==C.DoubleSide,pe),null===ue)return null;J.copy(pe),J.applyMatrix4(ee.matrixWorld);var fe=oe.ray.origin.distanceTo(J);return fe<oe.near||fe>oe.far?null:{distance:fe,point:J.clone(),object:ee}}function R(ee,oe,ne,ie,se,le,pe,ue){F.fromArray(ie,3*le),V.fromArray(ie,3*pe),G.fromArray(ie,3*ue);var ge=P(ee,oe,ne,F,V,G,Q);return ge&&(se&&(X.fromArray(se,2*le),Y.fromArray(se,2*pe),Z.fromArray(se,2*ue),ge.uv=A(Q,F,V,G,X,Y,Z)),ge.face=new C.Face3(le,pe,ue,C.Triangle.normal(F,V,G)),ge.faceIndex=le),ge}var D=new C.Matrix4,I=new C.Ray,U=new C.Sphere,F=new C.Vector3,V=new C.Vector3,G=new C.Vector3,O=new C.Vector3,H=new C.Vector3,W=new C.Vector3,X=new C.Vector2,Y=new C.Vector2,Z=new C.Vector2,K=new C.Vector3,Q=new C.Vector3,J=new C.Vector3;return function(oe,ne){var ie=this.geometry,se=this.material,le=this.matrixWorld;if(void 0!==se&&(null===ie.boundingSphere&&ie.computeBoundingSphere(),U.copy(ie.boundingSphere),U.applyMatrix4(le),!1!==oe.ray.intersectsSphere(U))&&(D.getInverse(le),I.copy(oe.ray).applyMatrix4(D),null===ie.boundingBox||!1!==I.intersectsBox(ie.boundingBox))){var pe,ue;if(ie instanceof C.BufferGeometry){var ye=ie.index,xe=ie.attributes,ve=xe.position.array,ge,fe,he;if(void 0!==xe.uv&&(pe=xe.uv.array),null!==ye)for(var _e=ye.array,Se=0,Me=_e.length;Se<Me;Se+=3)ge=_e[Se],fe=_e[Se+1],he=_e[Se+2],ue=R(this,oe,I,ve,pe,ge,fe,he),ue&&(ue.faceIndex=_Mathfloor(Se/3),ne.push(ue));else for(var Se=0,Me=ve.length;Se<Me;Se+=9)ge=Se/3,fe=ge+1,he=ge+2,ue=R(this,oe,I,ve,pe,ge,fe,he),ue&&(ue.index=ge,ne.push(ue))}else if(ie instanceof C.Geometry){var we=se instanceof C.MultiMaterial,Ce=!0==we?se.materials:null,Ae=ie.vertices,Pe=ie.faces,Re=ie.faceVertexUvs[0],Te,Ee,Le;0<Re.length&&(pe=Re);for(var De=0,Ie=Pe.length;De<Ie;De++){var Be=Pe[De],Ne=!0==we?Ce[Be.materialIndex]:se;if(void 0!==Ne){if(Te=Ae[Be.a],Ee=Ae[Be.b],Le=Ae[Be.c],!0===Ne.morphTargets){var Ue=ie.morphTargets,Fe=this.morphTargetInfluences;F.set(0,0,0),V.set(0,0,0),G.set(0,0,0);for(var Ve=0,Ge=Ue.length,ke;Ve<Ge;Ve++)if(ke=Fe[Ve],0!==ke){var ze=Ue[Ve].vertices;F.addScaledVector(O.subVectors(ze[Be.a],Te),ke),V.addScaledVector(H.subVectors(ze[Be.b],Ee),ke),G.addScaledVector(W.subVectors(ze[Be.c],Le),ke)}F.add(Te),V.add(Ee),G.add(Le),Te=F,Ee=V,Le=G}if(ue=P(this,oe,I,Te,Ee,Le,Q),ue){if(pe){var Oe=pe[De];X.copy(Oe[0]),Y.copy(Oe[1]),Z.copy(Oe[2]),ue.uv=A(Q,Te,Ee,Le,X,Y,Z)}ue.face=Be,ue.faceIndex=De,ne.push(ue)}}}}}}}(),C.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},C.Bone=function(A){C.Object3D.call(this),this.type="Bone",this.skin=A},C.Bone.prototype=Object.create(C.Object3D.prototype),C.Bone.prototype.constructor=C.Bone,C.Bone.prototype.copy=function(A){return C.Object3D.prototype.copy.call(this,A),this.skin=A.skin,this},C.Skeleton=function(A,P,R){if(this.useVertexTexture=void 0===R||R,this.identityMatrix=new C.Matrix4,A=A||[],this.bones=A.slice(0),this.useVertexTexture){var D=_Mathsqrt(4*this.bones.length);D=C.Math.nextPowerOfTwo(_Mathceil(D)),D=_Mathmax(D,4),this.boneTextureWidth=D,this.boneTextureHeight=D,this.boneMatrices=new Float32Array(4*(this.boneTextureWidth*this.boneTextureHeight)),this.boneTexture=new C.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,C.RGBAFormat,C.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===P)this.calculateInverses();else if(this.bones.length===P.length)this.boneInverses=P.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var I=0,U=this.bones.length;I<U;I++)this.boneInverses.push(new C.Matrix4)}},C.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var A=0,P=this.bones.length,R;A<P;A++)R=new C.Matrix4,this.bones[A]&&R.getInverse(this.bones[A].matrixWorld),this.boneInverses.push(R)},C.Skeleton.prototype.pose=function(){for(var P=0,R=this.bones.length,A;P<R;P++)A=this.bones[P],A&&A.matrixWorld.getInverse(this.boneInverses[P]);for(var P=0,R=this.bones.length;P<R;P++)A=this.bones[P],A&&(A.parent?(A.matrix.getInverse(A.parent.matrixWorld),A.matrix.multiply(A.matrixWorld)):A.matrix.copy(A.matrixWorld),A.matrix.decompose(A.position,A.quaternion,A.scale))},C.Skeleton.prototype.update=function(){var A=new C.Matrix4;return function(){for(var R=0,D=this.bones.length,I;R<D;R++)I=this.bones[R]?this.bones[R].matrixWorld:this.identityMatrix,A.multiplyMatrices(I,this.boneInverses[R]),A.toArray(this.boneMatrices,16*R);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),C.Skeleton.prototype.clone=function(){return new C.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},C.SkinnedMesh=function(A,P,R){C.Mesh.call(this,A,P),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new C.Matrix4,this.bindMatrixInverse=new C.Matrix4;var D=[];if(this.geometry&&this.geometry.bones!==void 0){for(var F=0,V=this.geometry.bones.length,I,U;F<V;++F)U=this.geometry.bones[F],I=new C.Bone(this),D.push(I),I.name=U.name,I.position.fromArray(U.pos),I.quaternion.fromArray(U.rotq),void 0!==U.scl&&I.scale.fromArray(U.scl);for(var F=0,V=this.geometry.bones.length;F<V;++F)U=this.geometry.bones[F],-1!==U.parent&&null!==U.parent&&void 0!==D[U.parent]?D[U.parent].add(D[F]):this.add(D[F])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new C.Skeleton(D,void 0,R),this.matrixWorld)},C.SkinnedMesh.prototype=Object.create(C.Mesh.prototype),C.SkinnedMesh.prototype.constructor=C.SkinnedMesh,C.SkinnedMesh.prototype.bind=function(A,P){this.skeleton=A,P===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),P=this.matrixWorld),this.bindMatrix.copy(P),this.bindMatrixInverse.getInverse(P)},C.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},C.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof C.Geometry)for(var A=0;A<this.geometry.skinWeights.length;A++){var P=this.geometry.skinWeights[A],R=1/P.lengthManhattan();R==Infinity?P.set(1,0,0,0):P.multiplyScalar(R)}else if(this.geometry instanceof C.BufferGeometry)for(var D=new C.Vector4,I=this.geometry.attributes.skinWeight,A=0;A<I.count;A++){D.x=I.getX(A),D.y=I.getY(A),D.z=I.getZ(A),D.w=I.getW(A);var R=1/D.lengthManhattan();R==Infinity?D.set(1,0,0,0):D.multiplyScalar(R),I.setXYZW(A,D.x,D.y,D.z,D.w)}},C.SkinnedMesh.prototype.updateMatrixWorld=function(){C.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},C.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},C.LOD=function(){C.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})},C.LOD.prototype=Object.create(C.Object3D.prototype),C.LOD.prototype.constructor=C.LOD,C.LOD.prototype.addLevel=function(A,P){P===void 0&&(P=0),P=_Mathabs(P);for(var R=this.levels,D=0;D<R.length&&!(P<R[D].distance);D++);R.splice(D,0,{distance:P,object:A}),this.add(A)},C.LOD.prototype.getObjectForDistance=function(A){for(var P=this.levels,R=1,D=P.length;R<D&&!(A<P[R].distance);R++);return P[R-1].object},C.LOD.prototype.raycast=function(){var A=new C.Vector3;return function(R,D){A.setFromMatrixPosition(this.matrixWorld);var I=R.ray.origin.distanceTo(A);this.getObjectForDistance(I).raycast(R,D)}}(),C.LOD.prototype.update=function(){var A=new C.Vector3,P=new C.Vector3;return function(D){var I=this.levels;if(1<I.length){A.setFromMatrixPosition(D.matrixWorld),P.setFromMatrixPosition(this.matrixWorld);var U=A.distanceTo(P);I[0].object.visible=!0;for(var F=1,V=I.length;F<V&&U>=I[F].distance;F++)I[F-1].object.visible=!1,I[F].object.visible=!0;for(;F<V;F++)I[F].object.visible=!1}}}(),C.LOD.prototype.copy=function(A){C.Object3D.prototype.copy.call(this,A,!1);for(var P=A.levels,R=0,D=P.length,I;R<D;R++)I=P[R],this.addLevel(I.object.clone(),I.distance);return this},C.LOD.prototype.toJSON=function(A){var P=C.Object3D.prototype.toJSON.call(this,A);P.object.levels=[];for(var R=this.levels,D=0,I=R.length,U;D<I;D++)U=R[D],P.object.levels.push({object:U.object.uuid,distance:U.distance});return P},C.Sprite=function(){var A=new Uint16Array([0,1,2,0,2,3]),P=new Float32Array([-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0,-0.5,0.5,0]),R=new Float32Array([0,0,1,0,1,1,0,1]),D=new C.BufferGeometry;return D.setIndex(new C.BufferAttribute(A,1)),D.addAttribute("position",new C.BufferAttribute(P,3)),D.addAttribute("uv",new C.BufferAttribute(R,2)),function(U){C.Object3D.call(this),this.type="Sprite",this.geometry=D,this.material=void 0===U?new C.SpriteMaterial:U}}(),C.Sprite.prototype=Object.create(C.Object3D.prototype),C.Sprite.prototype.constructor=C.Sprite,C.Sprite.prototype.raycast=function(){var A=new C.Vector3;return function(R,D){A.setFromMatrixPosition(this.matrixWorld);var I=R.ray.distanceSqToPoint(A),U=this.scale.x*this.scale.y/4;I>U||D.push({distance:_Mathsqrt(I),point:this.position,face:null,object:this})}}(),C.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},C.Particle=C.Sprite,C.LensFlare=function(A,P,R,D,I){C.Object3D.call(this),this.lensFlares=[],this.positionScreen=new C.Vector3,this.customUpdateCallback=void 0,A!==void 0&&this.add(A,P,R,D,I)},C.LensFlare.prototype=Object.create(C.Object3D.prototype),C.LensFlare.prototype.constructor=C.LensFlare,C.LensFlare.prototype.add=function(A,P,R,D,I,U){P===void 0&&(P=-1),R===void 0&&(R=0),U===void 0&&(U=1),I===void 0&&(I=new C.Color(16777215)),D===void 0&&(D=C.NormalBlending),R=_Mathmin(R,_Mathmax(0,R)),this.lensFlares.push({texture:A,size:P,distance:R,x:0,y:0,z:0,scale:1,rotation:0,opacity:U,color:I,blending:D})},C.LensFlare.prototype.updateLensFlares=function(){var P=this.lensFlares.length,A,R,D=2*-this.positionScreen.x,I=2*-this.positionScreen.y;for(A=0;A<P;A++)R=this.lensFlares[A],R.x=this.positionScreen.x+D*R.distance,R.y=this.positionScreen.y+I*R.distance,R.wantedRotation=0.25*(R.x*_MathPI2),R.rotation+=0.25*(R.wantedRotation-R.rotation)},C.LensFlare.prototype.copy=function(A){C.Object3D.prototype.copy.call(this,A),this.positionScreen.copy(A.positionScreen),this.customUpdateCallback=A.customUpdateCallback;for(var P=0,R=A.lensFlares.length;P<R;P++)this.lensFlares.push(A.lensFlares[P]);return this},C.Scene=function(){C.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},C.Scene.prototype=Object.create(C.Object3D.prototype),C.Scene.prototype.constructor=C.Scene,C.Scene.prototype.copy=function(A,P){return C.Object3D.prototype.copy.call(this,A,P),null!==A.fog&&(this.fog=A.fog.clone()),null!==A.overrideMaterial&&(this.overrideMaterial=A.overrideMaterial.clone()),this.autoUpdate=A.autoUpdate,this.matrixAutoUpdate=A.matrixAutoUpdate,this},C.Fog=function(A,P,R){this.name="",this.color=new C.Color(A),this.near=P===void 0?1:P,this.far=R===void 0?1e3:R},C.Fog.prototype.clone=function(){return new C.Fog(this.color.getHex(),this.near,this.far)},C.FogExp2=function(A,P){this.name="",this.color=new C.Color(A),this.density=P===void 0?2.5e-4:P},C.FogExp2.prototype.clone=function(){return new C.FogExp2(this.color.getHex(),this.density)},C.ShaderChunk={},C.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",C.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",C.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",C.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",C.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",C.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",C.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",C.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",C.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",C.ShaderChunk.clipping_planes_fragment="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",C.ShaderChunk.clipping_planes_pars_fragment="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",C.ShaderChunk.clipping_planes_pars_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",C.ShaderChunk.clipping_planes_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",C.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",C.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",C.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",C.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",C.ShaderChunk.common="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",C.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\nconst float cubeUV_textureSize = 1024.0;\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\nfloat cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\nfloat cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\nfloat cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\nfloat cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",C.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",C.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",C.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",C.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",C.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",C.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",C.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",C.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",C.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",C.ShaderChunk.envmap_pars_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",C.ShaderChunk.envmap_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",C.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",C.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",C.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",C.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",C.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",C.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",C.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",C.ShaderChunk.lights_phong_pars_fragment="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",C.ShaderChunk.lights_physical_fragment="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.16 * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#endif\n",C.ShaderChunk.lights_physical_pars_fragment="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t#endif\n};\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",C.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",C.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",C.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",C.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",C.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",C.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",C.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",C.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",C.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",C.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",C.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",C.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",C.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",C.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",C.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",C.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",C.ShaderChunk.packing="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nvec4 packDepthToRGBA( const in float value ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( value * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nfloat unpackRGBAToDepth( const in vec4 rgba ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( rgba, bitSh );\n}\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",C.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",C.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",C.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",C.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",C.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",C.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",C.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",C.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",C.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",C.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",C.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",C.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",C.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",C.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",C.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",C.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",C.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",C.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",C.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",C.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",C.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",C.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",C.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",C.UniformsUtils={merge:function(A){for(var P={},R=0,D;R<A.length;R++)for(var I in D=this.clone(A[R]),D)P[I]=D[I];return P},clone:function(A){var P={};for(var R in A)for(var D in P[R]={},A[R]){var I=A[R][D];P[R][D]=I instanceof C.Color||I instanceof C.Vector2||I instanceof C.Vector3||I instanceof C.Vector4||I instanceof C.Matrix3||I instanceof C.Matrix4||I instanceof C.Texture?I.clone():Array.isArray(I)?I.slice():I}return P}},C.UniformsLib={common:{diffuse:{type:"c",value:new C.Color(15658734)},opacity:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new C.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"1f",value:-1},reflectivity:{type:"1f",value:1},refractionRatio:{type:"1f",value:0.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"1f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"1f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"1f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new C.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"1f",value:1},displacementBias:{type:"1f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"1f",value:2.5e-4},fogNear:{type:"1f",value:1},fogFar:{type:"1f",value:2e3},fogColor:{type:"c",value:new C.Color(16777215)}},lights:{ambientLightColor:{type:"3fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"1f"},coneCos:{type:"1f"},penumbraCos:{type:"1f"},decay:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"1f"},distance:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new C.Color(15658734)},opacity:{type:"1f",value:1},size:{type:"1f",value:1},scale:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new C.Vector4(0,0,1,1)}}},C.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n",C.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",C.ShaderChunk.depth_frag="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",C.ShaderChunk.depth_vert="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",C.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",C.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",C.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n",C.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",C.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",C.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",C.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",C.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",C.ShaderChunk.meshphysical_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.meshphysical_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",C.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",C.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",C.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",C.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",C.ShaderLib={basic:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.aomap,C.UniformsLib.fog]),vertexShader:C.ShaderChunk.meshbasic_vert,fragmentShader:C.ShaderChunk.meshbasic_frag},lambert:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.aomap,C.UniformsLib.lightmap,C.UniformsLib.emissivemap,C.UniformsLib.fog,C.UniformsLib.lights,{emissive:{type:"c",value:new C.Color(0)}}]),vertexShader:C.ShaderChunk.meshlambert_vert,fragmentShader:C.ShaderChunk.meshlambert_frag},phong:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.aomap,C.UniformsLib.lightmap,C.UniformsLib.emissivemap,C.UniformsLib.bumpmap,C.UniformsLib.normalmap,C.UniformsLib.displacementmap,C.UniformsLib.fog,C.UniformsLib.lights,{emissive:{type:"c",value:new C.Color(0)},specular:{type:"c",value:new C.Color(1118481)},shininess:{type:"1f",value:30}}]),vertexShader:C.ShaderChunk.meshphong_vert,fragmentShader:C.ShaderChunk.meshphong_frag},standard:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.aomap,C.UniformsLib.lightmap,C.UniformsLib.emissivemap,C.UniformsLib.bumpmap,C.UniformsLib.normalmap,C.UniformsLib.displacementmap,C.UniformsLib.roughnessmap,C.UniformsLib.metalnessmap,C.UniformsLib.fog,C.UniformsLib.lights,{emissive:{type:"c",value:new C.Color(0)},roughness:{type:"1f",value:0.5},metalness:{type:"1f",value:0},envMapIntensity:{type:"1f",value:1}}]),vertexShader:C.ShaderChunk.meshphysical_vert,fragmentShader:C.ShaderChunk.meshphysical_frag},points:{uniforms:C.UniformsUtils.merge([C.UniformsLib.points,C.UniformsLib.fog]),vertexShader:C.ShaderChunk.points_vert,fragmentShader:C.ShaderChunk.points_frag},dashed:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.fog,{scale:{type:"1f",value:1},dashSize:{type:"1f",value:1},totalSize:{type:"1f",value:2}}]),vertexShader:C.ShaderChunk.linedashed_vert,fragmentShader:C.ShaderChunk.linedashed_frag},depth:{uniforms:C.UniformsUtils.merge([C.UniformsLib.common,C.UniformsLib.displacementmap]),vertexShader:C.ShaderChunk.depth_vert,fragmentShader:C.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{type:"1f",value:1}},vertexShader:C.ShaderChunk.normal_vert,fragmentShader:C.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:C.ShaderChunk.cube_vert,fragmentShader:C.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:C.ShaderChunk.equirect_vert,fragmentShader:C.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new C.Vector3}},vertexShader:C.ShaderChunk.distanceRGBA_vert,fragmentShader:C.ShaderChunk.distanceRGBA_frag}},C.ShaderLib.physical={uniforms:C.UniformsUtils.merge([C.ShaderLib.standard.uniforms,{}]),vertexShader:C.ShaderChunk.meshphysical_vert,fragmentShader:C.ShaderChunk.meshphysical_frag},C.WebGLRenderer=function(A){function P(){return null==ft?Ct:1}function R(ur,mr,gr,fr){!0===et&&(ur*=fr,mr*=fr,gr*=fr),$t.clearColor(ur,mr,gr,fr)}function D(){$t.init(),$t.scissor(bt.copy(At).multiplyScalar(Ct)),$t.viewport(St.copy(Rt).multiplyScalar(Ct)),R(Tt.r,Tt.g,Tt.b,Et)}function I(){gt=null,vt=null,xt="",yt=-1,$t.reset()}function U(ur){ur.preventDefault(),I(),D(),tr.clear()}function F(ur){var mr=ur.target;mr.removeEventListener("dispose",F),O(mr),qt.textures--}function V(ur){var mr=ur.target;mr.removeEventListener("dispose",V),H(mr),qt.textures--}function G(ur){var mr=ur.target;mr.removeEventListener("dispose",G),W(mr)}function O(ur){var mr=tr.get(ur);if(ur.image&&mr.__image__webglTextureCube)Yt.deleteTexture(mr.__image__webglTextureCube);else{if(mr.__webglInit===void 0)return;Yt.deleteTexture(mr.__webglTexture)}tr.delete(ur)}function H(ur){var mr=tr.get(ur),gr=tr.get(ur.texture);if(ur){if(void 0!==gr.__webglTexture&&Yt.deleteTexture(gr.__webglTexture),ur.depthTexture&&ur.depthTexture.dispose(),ur instanceof C.WebGLRenderTargetCube)for(var fr=0;6>fr;fr++)Yt.deleteFramebuffer(mr.__webglFramebuffer[fr]),mr.__webglDepthbuffer&&Yt.deleteRenderbuffer(mr.__webglDepthbuffer[fr]);else Yt.deleteFramebuffer(mr.__webglFramebuffer),mr.__webglDepthbuffer&&Yt.deleteRenderbuffer(mr.__webglDepthbuffer);tr.delete(ur.texture),tr.delete(ur)}}function W(ur){X(ur),tr.delete(ur)}function X(ur){var mr=tr.get(ur).program;ur.program=void 0,mr!==void 0&&or.releaseProgram(mr)}function Y(ur,mr,gr,fr){var yr;if(gr instanceof C.InstancedBufferGeometry&&(yr=Qt.get("ANGLE_instanced_arrays"),null===yr))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");fr===void 0&&(fr=0),$t.initAttributes();var xr=gr.attributes,vr=mr.getAttributes(),br=ur.defaultAttributeValues;for(var _r in vr){var Sr=vr[_r];if(0<=Sr){var Mr=xr[_r];if(Mr!==void 0){var Tr=Yt.FLOAT,Er=Mr.array,Lr=Mr.normalized;Er instanceof Float32Array?Tr=Yt.FLOAT:Er instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):Er instanceof Uint16Array?Tr=Yt.UNSIGNED_SHORT:Er instanceof Int16Array?Tr=Yt.SHORT:Er instanceof Uint32Array?Tr=Yt.UNSIGNED_INT:Er instanceof Int32Array?Tr=Yt.INT:Er instanceof Int8Array?Tr=Yt.BYTE:Er instanceof Uint8Array&&(Tr=Yt.UNSIGNED_BYTE);var wr=Mr.itemSize,Cr=rr.getAttributeBuffer(Mr);if(Mr instanceof C.InterleavedBufferAttribute){var Ar=Mr.data,Pr=Ar.stride,Rr=Mr.offset;Ar instanceof C.InstancedInterleavedBuffer?($t.enableAttributeAndDivisor(Sr,Ar.meshPerAttribute,yr),gr.maxInstancedCount===void 0&&(gr.maxInstancedCount=Ar.meshPerAttribute*Ar.count)):$t.enableAttribute(Sr),Yt.bindBuffer(Yt.ARRAY_BUFFER,Cr),Yt.vertexAttribPointer(Sr,wr,Tr,Lr,Pr*Ar.array.BYTES_PER_ELEMENT,(fr*Pr+Rr)*Ar.array.BYTES_PER_ELEMENT)}else Mr instanceof C.InstancedBufferAttribute?($t.enableAttributeAndDivisor(Sr,Mr.meshPerAttribute,yr),void 0===gr.maxInstancedCount&&(gr.maxInstancedCount=Mr.meshPerAttribute*Mr.count)):$t.enableAttribute(Sr),Yt.bindBuffer(Yt.ARRAY_BUFFER,Cr),Yt.vertexAttribPointer(Sr,wr,Tr,Lr,0,fr*wr*Mr.array.BYTES_PER_ELEMENT)}else if(br!==void 0){var Dr=br[_r];if(Dr!==void 0)switch(Dr.length){case 2:Yt.vertexAttrib2fv(Sr,Dr);break;case 3:Yt.vertexAttrib3fv(Sr,Dr);break;case 4:Yt.vertexAttrib4fv(Sr,Dr);break;default:Yt.vertexAttrib1fv(Sr,Dr);}}}}$t.disableUnusedAttributes()}function Z(ur,mr){return _Mathabs(mr[0])-_Mathabs(ur[0])}function K(ur,mr){return ur.object.renderOrder===mr.object.renderOrder?ur.material.id===mr.material.id?ur.z===mr.z?ur.id-mr.id:ur.z-mr.z:ur.material.id-mr.material.id:ur.object.renderOrder-mr.object.renderOrder}function Q(ur,mr){return ur.object.renderOrder===mr.object.renderOrder?ur.z===mr.z?ur.id-mr.id:mr.z-ur.z:ur.object.renderOrder-mr.object.renderOrder}function J(ur,mr,gr,fr,yr){var xr,vr;gr.transparent?(xr=nt,vr=++it):(xr=at,vr=++ot);var br=xr[vr];br===void 0?(br={id:ur.id,object:ur,geometry:mr,material:gr,z:jt.z,group:yr},xr.push(br)):(br.id=ur.id,br.object=ur,br.geometry=mr,br.material=gr,br.z=jt.z,br.group=yr)}function ee(ur){var mr=ur.geometry;null===mr.boundingSphere&&mr.computeBoundingSphere();var gr=zt.copy(mr.boundingSphere).applyMatrix4(ur.matrixWorld);if(!Dt.intersectsSphere(gr))return!1;if(0==Ut)return!0;var fr=mt.clippingPlanes,yr=gr.center,xr=-gr.radius,vr=0;do if(fr[vr].distanceToPoint(yr)<xr)return!1;while(++vr!=Ut);return!0}function oe(ur,mr){if(!1!==ur.visible){if(ur.layers.test(mr.layers))if(ur instanceof C.Light)rt.push(ur);else if(ur instanceof C.Sprite)(!1===ur.frustumCulled||!0===ee(ur))&&lt.push(ur);else if(ur instanceof C.LensFlare)ut.push(ur);else if(ur instanceof C.ImmediateRenderObject)!0===mt.sortObjects&&(jt.setFromMatrixPosition(ur.matrixWorld),jt.applyProjection(Ht)),J(ur,null,ur.material,jt.z,null);else if((ur instanceof C.Mesh||ur instanceof C.Line||ur instanceof C.Points)&&(ur instanceof C.SkinnedMesh&&ur.skeleton.update(),!1===ur.frustumCulled||!0===ee(ur))){var gr=ur.material;if(!0===gr.visible){!0===mt.sortObjects&&(jt.setFromMatrixPosition(ur.matrixWorld),jt.applyProjection(Ht));var fr=rr.update(ur);if(gr instanceof C.MultiMaterial)for(var yr=fr.groups,xr=gr.materials,vr=0,br=yr.length;vr<br;vr++){var _r=yr[vr],Sr=xr[_r.materialIndex];!0===Sr.visible&&J(ur,fr,Sr,jt.z,_r)}else J(ur,fr,gr,jt.z,null)}}for(var Mr=ur.children,vr=0,br=Mr.length;vr<br;vr++)oe(Mr[vr],mr)}}function ne(ur,mr,gr,fr){for(var yr=0,xr=ur.length;yr<xr;yr++){var vr=ur[yr],br=vr.object,_r=vr.geometry,Sr=void 0===fr?vr.material:fr,Mr=vr.group;if(br.modelViewMatrix.multiplyMatrices(mr.matrixWorldInverse,br.matrixWorld),br.normalMatrix.getNormalMatrix(br.modelViewMatrix),br instanceof C.ImmediateRenderObject){se(Sr);var Tr=pe(mr,gr,Sr,br);xt="",br.render(function(Er){mt.renderBufferImmediate(Er,Tr,Sr)})}else mt.renderBufferDirect(mr,gr,_r,Sr,br,Mr)}}function ie(ur,mr,gr){var fr=tr.get(ur),yr=or.getParameters(ur,Wt,mr,Ut,gr),xr=or.getProgramCode(ur,yr),vr=fr.program,br=!0;if(vr===void 0)ur.addEventListener("dispose",G);else if(vr.code!==xr)X(ur);else{if(yr.shaderID!==void 0)return;br=!1}if(br){if(yr.shaderID){var _r=C.ShaderLib[yr.shaderID];fr.__webglShader={name:ur.type,uniforms:C.UniformsUtils.clone(_r.uniforms),vertexShader:_r.vertexShader,fragmentShader:_r.fragmentShader}}else fr.__webglShader={name:ur.type,uniforms:ur.uniforms,vertexShader:ur.vertexShader,fragmentShader:ur.fragmentShader};ur.__webglShader=fr.__webglShader,vr=or.acquireProgram(ur,yr,xr),fr.program=vr,ur.program=vr}var Sr=vr.getAttributes();if(ur.morphTargets){ur.numSupportedMorphTargets=0;for(var Mr=0;Mr<mt.maxMorphTargets;Mr++)0<=Sr["morphTarget"+Mr]&&ur.numSupportedMorphTargets++}if(ur.morphNormals){ur.numSupportedMorphNormals=0;for(var Mr=0;Mr<mt.maxMorphNormals;Mr++)0<=Sr["morphNormal"+Mr]&&ur.numSupportedMorphNormals++}var Tr=fr.__webglShader.uniforms;(ur instanceof C.ShaderMaterial||ur instanceof C.RawShaderMaterial)&&!0!==ur.clipping||(fr.numClippingPlanes=Ut,Tr.clippingPlanes=Ft),(ur instanceof C.MeshPhongMaterial||ur instanceof C.MeshLambertMaterial||ur instanceof C.MeshStandardMaterial||ur.lights)&&(fr.lightsHash=Wt.hash,Tr.ambientLightColor.value=Wt.ambient,Tr.directionalLights.value=Wt.directional,Tr.spotLights.value=Wt.spot,Tr.pointLights.value=Wt.point,Tr.hemisphereLights.value=Wt.hemi,Tr.directionalShadowMap.value=Wt.directionalShadowMap,Tr.directionalShadowMatrix.value=Wt.directionalShadowMatrix,Tr.spotShadowMap.value=Wt.spotShadowMap,Tr.spotShadowMatrix.value=Wt.spotShadowMatrix,Tr.pointShadowMap.value=Wt.pointShadowMap,Tr.pointShadowMatrix.value=Wt.pointShadowMatrix);var Er=fr.program.getUniforms(),Lr=C.WebGLUniforms.seqWithValue(Er.seq,Tr);fr.uniformsList=Lr,fr.dynamicUniforms=C.WebGLUniforms.splitDynamic(Lr,Tr)}function se(ur){le(ur),!0===ur.transparent?$t.setBlending(ur.blending,ur.blendEquation,ur.blendSrc,ur.blendDst,ur.blendEquationAlpha,ur.blendSrcAlpha,ur.blendDstAlpha,ur.premultipliedAlpha):$t.setBlending(C.NoBlending),$t.setDepthFunc(ur.depthFunc),$t.setDepthTest(ur.depthTest),$t.setDepthWrite(ur.depthWrite),$t.setColorWrite(ur.colorWrite),$t.setPolygonOffset(ur.polygonOffset,ur.polygonOffsetFactor,ur.polygonOffsetUnits)}function le(ur){ur.side===C.DoubleSide?$t.disable(Yt.CULL_FACE):$t.enable(Yt.CULL_FACE),$t.setFlipSided(ur.side===C.BackSide)}function pe(ur,mr,gr,fr){Mt=0;var yr=tr.get(gr);if(It){if(Bt||ur!==vt){var xr=ur===vt&&gr.id===yt;Ae(gr.clippingPlanes,gr.clipShadows,ur,yr,xr)}void 0!==yr.numClippingPlanes&&yr.numClippingPlanes!==Ut&&(gr.needsUpdate=!0)}void 0===yr.program&&(gr.needsUpdate=!0),void 0!==yr.lightsHash&&yr.lightsHash!==Wt.hash&&(gr.needsUpdate=!0),gr.needsUpdate&&(ie(gr,mr,fr),gr.needsUpdate=!1);var vr=!1,br=!1,_r=!1,Sr=yr.program,Mr=Sr.getUniforms(),Tr=yr.__webglShader.uniforms;if(Sr.id!==gt&&(Yt.useProgram(Sr.program),gt=Sr.id,vr=!0,br=!0,_r=!0),gr.id!==yt&&(yt=gr.id,br=!0),vr||ur!==vt){if(Mr.set(Yt,ur,"projectionMatrix"),Jt.logarithmicDepthBuffer&&Mr.setValue(Yt,"logDepthBufFC",2/(_Mathlog(ur.far+1)/_MathLN)),ur!==vt&&(vt=ur,br=!0,_r=!0),gr instanceof C.ShaderMaterial||gr instanceof C.MeshPhongMaterial||gr instanceof C.MeshStandardMaterial||gr.envMap){var Er=Mr.map.cameraPosition;void 0!==Er&&Er.setValue(Yt,jt.setFromMatrixPosition(ur.matrixWorld))}(gr instanceof C.MeshPhongMaterial||gr instanceof C.MeshLambertMaterial||gr instanceof C.MeshBasicMaterial||gr instanceof C.MeshStandardMaterial||gr instanceof C.ShaderMaterial||gr.skinning)&&Mr.setValue(Yt,"viewMatrix",ur.matrixWorldInverse),Mr.set(Yt,mt,"toneMappingExposure"),Mr.set(Yt,mt,"toneMappingWhitePoint")}if(gr.skinning){Mr.setOptional(Yt,fr,"bindMatrix"),Mr.setOptional(Yt,fr,"bindMatrixInverse");var Lr=fr.skeleton;Lr&&(Jt.floatVertexTextures&&Lr.useVertexTexture?(Mr.set(Yt,Lr,"boneTexture"),Mr.set(Yt,Lr,"boneTextureWidth"),Mr.set(Yt,Lr,"boneTextureHeight")):Mr.setOptional(Yt,Lr,"boneMatrices"))}br&&((gr instanceof C.MeshPhongMaterial||gr instanceof C.MeshLambertMaterial||gr instanceof C.MeshStandardMaterial||gr.lights)&&Me(Tr,_r),mr&&gr.fog&&ye(Tr,mr),(gr instanceof C.MeshBasicMaterial||gr instanceof C.MeshLambertMaterial||gr instanceof C.MeshPhongMaterial||gr instanceof C.MeshStandardMaterial||gr instanceof C.MeshDepthMaterial)&&ue(Tr,gr),gr instanceof C.LineBasicMaterial?ge(Tr,gr):gr instanceof C.LineDashedMaterial?(ge(Tr,gr),fe(Tr,gr)):gr instanceof C.PointsMaterial?he(Tr,gr):gr instanceof C.MeshLambertMaterial?xe(Tr,gr):gr instanceof C.MeshPhongMaterial?ve(Tr,gr):gr instanceof C.MeshPhysicalMaterial?Se(Tr,gr):gr instanceof C.MeshStandardMaterial?_e(Tr,gr):gr instanceof C.MeshDepthMaterial?gr.displacementMap&&(Tr.displacementMap.value=gr.displacementMap,Tr.displacementScale.value=gr.displacementScale,Tr.displacementBias.value=gr.displacementBias):gr instanceof C.MeshNormalMaterial&&(Tr.opacity.value=gr.opacity),C.WebGLUniforms.upload(Yt,yr.uniformsList,Tr,mt)),Mr.set(Yt,fr,"modelViewMatrix"),Mr.set(Yt,fr,"normalMatrix"),Mr.setValue(Yt,"modelMatrix",fr.matrixWorld);var wr=yr.dynamicUniforms;return null!==wr&&(C.WebGLUniforms.evalDynamic(wr,Tr,fr,ur),C.WebGLUniforms.upload(Yt,wr,Tr,mt)),Sr}function ue(ur,mr){ur.opacity.value=mr.opacity,ur.diffuse.value=mr.color,mr.emissive&&ur.emissive.value.copy(mr.emissive).multiplyScalar(mr.emissiveIntensity),ur.map.value=mr.map,ur.specularMap.value=mr.specularMap,ur.alphaMap.value=mr.alphaMap,mr.aoMap&&(ur.aoMap.value=mr.aoMap,ur.aoMapIntensity.value=mr.aoMapIntensity);var gr;if(mr.map?gr=mr.map:mr.specularMap?gr=mr.specularMap:mr.displacementMap?gr=mr.displacementMap:mr.normalMap?gr=mr.normalMap:mr.bumpMap?gr=mr.bumpMap:mr.roughnessMap?gr=mr.roughnessMap:mr.metalnessMap?gr=mr.metalnessMap:mr.alphaMap?gr=mr.alphaMap:mr.emissiveMap&&(gr=mr.emissiveMap),void 0!==gr){gr instanceof C.WebGLRenderTarget&&(gr=gr.texture);var fr=gr.offset,yr=gr.repeat;ur.offsetRepeat.value.set(fr.x,fr.y,yr.x,yr.y)}ur.envMap.value=mr.envMap,ur.flipEnvMap.value=mr.envMap instanceof C.WebGLRenderTargetCube?1:-1,ur.reflectivity.value=mr.reflectivity,ur.refractionRatio.value=mr.refractionRatio}function ge(ur,mr){ur.diffuse.value=mr.color,ur.opacity.value=mr.opacity}function fe(ur,mr){ur.dashSize.value=mr.dashSize,ur.totalSize.value=mr.dashSize+mr.gapSize,ur.scale.value=mr.scale}function he(ur,mr){if(ur.diffuse.value=mr.color,ur.opacity.value=mr.opacity,ur.size.value=mr.size*Ct,ur.scale.value=0.5*Ye.clientHeight,ur.map.value=mr.map,null!==mr.map){var gr=mr.map.offset,fr=mr.map.repeat;ur.offsetRepeat.value.set(gr.x,gr.y,fr.x,fr.y)}}function ye(ur,mr){ur.fogColor.value=mr.color,mr instanceof C.Fog?(ur.fogNear.value=mr.near,ur.fogFar.value=mr.far):mr instanceof C.FogExp2&&(ur.fogDensity.value=mr.density)}function xe(ur,mr){mr.lightMap&&(ur.lightMap.value=mr.lightMap,ur.lightMapIntensity.value=mr.lightMapIntensity),mr.emissiveMap&&(ur.emissiveMap.value=mr.emissiveMap)}function ve(ur,mr){ur.specular.value=mr.specular,ur.shininess.value=_Mathmax(mr.shininess,1e-4),mr.lightMap&&(ur.lightMap.value=mr.lightMap,ur.lightMapIntensity.value=mr.lightMapIntensity),mr.emissiveMap&&(ur.emissiveMap.value=mr.emissiveMap),mr.bumpMap&&(ur.bumpMap.value=mr.bumpMap,ur.bumpScale.value=mr.bumpScale),mr.normalMap&&(ur.normalMap.value=mr.normalMap,ur.normalScale.value.copy(mr.normalScale)),mr.displacementMap&&(ur.displacementMap.value=mr.displacementMap,ur.displacementScale.value=mr.displacementScale,ur.displacementBias.value=mr.displacementBias)}function _e(ur,mr){ur.roughness.value=mr.roughness,ur.metalness.value=mr.metalness,mr.roughnessMap&&(ur.roughnessMap.value=mr.roughnessMap),mr.metalnessMap&&(ur.metalnessMap.value=mr.metalnessMap),mr.lightMap&&(ur.lightMap.value=mr.lightMap,ur.lightMapIntensity.value=mr.lightMapIntensity),mr.emissiveMap&&(ur.emissiveMap.value=mr.emissiveMap),mr.bumpMap&&(ur.bumpMap.value=mr.bumpMap,ur.bumpScale.value=mr.bumpScale),mr.normalMap&&(ur.normalMap.value=mr.normalMap,ur.normalScale.value.copy(mr.normalScale)),mr.displacementMap&&(ur.displacementMap.value=mr.displacementMap,ur.displacementScale.value=mr.displacementScale,ur.displacementBias.value=mr.displacementBias),mr.envMap&&(ur.envMapIntensity.value=mr.envMapIntensity)}function Se(ur,mr){_e(ur,mr)}function Me(ur,mr){ur.ambientLightColor.needsUpdate=mr,ur.directionalLights.needsUpdate=mr,ur.pointLights.needsUpdate=mr,ur.spotLights.needsUpdate=mr,ur.hemisphereLights.needsUpdate=mr}function Te(ur){for(var mr=0,gr=0,fr=ur.length,yr;gr<fr;gr++)yr=ur[gr],yr.castShadow&&(Wt.shadows[mr++]=yr);Wt.shadows.length=mr}function Ee(ur,mr){var xr=0,vr=0,br=0,Tr=mr.matrixWorldInverse,Er=0,Lr=0,wr=0,Cr=0,gr,fr,yr,_r,Sr,Mr;for(gr=0,fr=ur.length;gr<fr;gr++)if(yr=ur[gr],_r=yr.color,Sr=yr.intensity,Mr=yr.distance,yr instanceof C.AmbientLight)xr+=_r.r*Sr,vr+=_r.g*Sr,br+=_r.b*Sr;else if(yr instanceof C.DirectionalLight){var Ar=nr.get(yr);Ar.color.copy(yr.color).multiplyScalar(yr.intensity),Ar.direction.setFromMatrixPosition(yr.matrixWorld),jt.setFromMatrixPosition(yr.target.matrixWorld),Ar.direction.sub(jt),Ar.direction.transformDirection(Tr),Ar.shadow=yr.castShadow,yr.castShadow&&(Ar.shadowBias=yr.shadow.bias,Ar.shadowRadius=yr.shadow.radius,Ar.shadowMapSize=yr.shadow.mapSize),Wt.directionalShadowMap[Er]=yr.shadow.map,Wt.directionalShadowMatrix[Er]=yr.shadow.matrix,Wt.directional[Er++]=Ar}else if(yr instanceof C.SpotLight){var Ar=nr.get(yr);Ar.position.setFromMatrixPosition(yr.matrixWorld),Ar.position.applyMatrix4(Tr),Ar.color.copy(_r).multiplyScalar(Sr),Ar.distance=Mr,Ar.direction.setFromMatrixPosition(yr.matrixWorld),jt.setFromMatrixPosition(yr.target.matrixWorld),Ar.direction.sub(jt),Ar.direction.transformDirection(Tr),Ar.coneCos=_Mathcos2(yr.angle),Ar.penumbraCos=_Mathcos2(yr.angle*(1-yr.penumbra)),Ar.decay=0===yr.distance?0:yr.decay,Ar.shadow=yr.castShadow,yr.castShadow&&(Ar.shadowBias=yr.shadow.bias,Ar.shadowRadius=yr.shadow.radius,Ar.shadowMapSize=yr.shadow.mapSize),Wt.spotShadowMap[wr]=yr.shadow.map,Wt.spotShadowMatrix[wr]=yr.shadow.matrix,Wt.spot[wr++]=Ar}else if(yr instanceof C.PointLight){var Ar=nr.get(yr);Ar.position.setFromMatrixPosition(yr.matrixWorld),Ar.position.applyMatrix4(Tr),Ar.color.copy(yr.color).multiplyScalar(yr.intensity),Ar.distance=yr.distance,Ar.decay=0===yr.distance?0:yr.decay,Ar.shadow=yr.castShadow,yr.castShadow&&(Ar.shadowBias=yr.shadow.bias,Ar.shadowRadius=yr.shadow.radius,Ar.shadowMapSize=yr.shadow.mapSize),Wt.pointShadowMap[Lr]=yr.shadow.map,void 0===Wt.pointShadowMatrix[Lr]&&(Wt.pointShadowMatrix[Lr]=new C.Matrix4),jt.setFromMatrixPosition(yr.matrixWorld).negate(),Wt.pointShadowMatrix[Lr].identity().setPosition(jt),Wt.point[Lr++]=Ar}else if(yr instanceof C.HemisphereLight){var Ar=nr.get(yr);Ar.direction.setFromMatrixPosition(yr.matrixWorld),Ar.direction.transformDirection(Tr),Ar.direction.normalize(),Ar.skyColor.copy(yr.color).multiplyScalar(Sr),Ar.groundColor.copy(yr.groundColor).multiplyScalar(Sr),Wt.hemi[Cr++]=Ar}Wt.ambient[0]=xr,Wt.ambient[1]=vr,Wt.ambient[2]=br,Wt.directional.length=Er,Wt.spot.length=wr,Wt.point.length=Lr,Wt.hemi.length=Cr,Wt.hash=Er+","+Lr+","+wr+","+Cr+","+Wt.shadows.length}function Le(ur,mr){It=0!==mt.clippingPlanes.length||mt.localClippingEnabled||0!=Gt||Bt,Bt=mt.localClippingEnabled,Vt=we(ur,mr,0),Gt=null===ur?0:ur.length}function we(ur,mr,gr,fr){var yr=null===ur?0:ur.length,xr=null;if(0!==yr){if(xr=Ft.value,!0!==fr||null===xr){var vr=gr+4*yr,br=mr.matrixWorldInverse,_r=kt.getNormalMatrix(br);(null===xr||xr.length<vr)&&(xr=new Float32Array(vr));for(var Sr=0,Mr=gr,Tr;Sr!==yr;++Sr,Mr+=4)Tr=Ot.copy(ur[Sr]).applyMatrix4(br,_r),Tr.normal.toArray(xr,Mr),xr[Mr+3]=Tr.constant}Ft.value=xr,Ft.needsUpdate=!0}return Ut=yr,xr}function Ce(){Ft.value!==Vt&&(Ft.value=Vt,Ft.needsUpdate=0<Gt),Ut=Gt}function Ae(ur,mr,gr,fr,yr){if(!Bt||null===ur||0===ur.length||Nt&&!mr)Nt?we(null):Ce();else{var xr=Nt?0:Gt,vr=4*xr,br=fr.clippingState||null;Ft.value=br,br=we(ur,gr,vr,yr);for(var _r=0;_r!==vr;++_r)br[_r]=Vt[_r];fr.clippingState=br,Ut+=xr}}function Re(ur,mr,gr){var fr;if(gr?(Yt.texParameteri(ur,Yt.TEXTURE_WRAP_S,Xe(mr.wrapS)),Yt.texParameteri(ur,Yt.TEXTURE_WRAP_T,Xe(mr.wrapT)),Yt.texParameteri(ur,Yt.TEXTURE_MAG_FILTER,Xe(mr.magFilter)),Yt.texParameteri(ur,Yt.TEXTURE_MIN_FILTER,Xe(mr.minFilter))):(Yt.texParameteri(ur,Yt.TEXTURE_WRAP_S,Yt.CLAMP_TO_EDGE),Yt.texParameteri(ur,Yt.TEXTURE_WRAP_T,Yt.CLAMP_TO_EDGE),(mr.wrapS!==C.ClampToEdgeWrapping||mr.wrapT!==C.ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",mr),Yt.texParameteri(ur,Yt.TEXTURE_MAG_FILTER,qe(mr.magFilter)),Yt.texParameteri(ur,Yt.TEXTURE_MIN_FILTER,qe(mr.minFilter)),mr.minFilter!==C.NearestFilter&&mr.minFilter!==C.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",mr)),fr=Qt.get("EXT_texture_filter_anisotropic"),fr){if(mr.type===C.FloatType&&null===Qt.get("OES_texture_float_linear"))return;if(mr.type===C.HalfFloatType&&null===Qt.get("OES_texture_half_float_linear"))return;(1<mr.anisotropy||tr.get(mr).__currentAnisotropy)&&(Yt.texParameterf(ur,fr.TEXTURE_MAX_ANISOTROPY_EXT,_Mathmin(mr.anisotropy,mt.getMaxAnisotropy())),tr.get(mr).__currentAnisotropy=mr.anisotropy)}}function De(ur,mr,gr){ur.__webglInit===void 0&&(ur.__webglInit=!0,mr.addEventListener("dispose",F),ur.__webglTexture=Yt.createTexture(),qt.textures++),$t.activeTexture(Yt.TEXTURE0+gr),$t.bindTexture(Yt.TEXTURE_2D,ur.__webglTexture),Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,mr.flipY),Yt.pixelStorei(Yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,mr.premultiplyAlpha),Yt.pixelStorei(Yt.UNPACK_ALIGNMENT,mr.unpackAlignment);var fr=Be(mr.image,Jt.maxTextureSize);Ue(mr)&&!1===Ne(fr)&&(fr=Fe(fr));var yr=Ne(fr),xr=Xe(mr.format),vr=Xe(mr.type);Re(Yt.TEXTURE_2D,mr,yr);var _r=mr.mipmaps,br;if(mr instanceof C.DepthTexture){var Sr=Yt.DEPTH_COMPONENT;if(mr.type===C.FloatType){if(!Kt)throw new Error("Float Depth Texture only supported in WebGL2.0");Sr=Yt.DEPTH_COMPONENT32F}else Kt&&(Sr=Yt.DEPTH_COMPONENT16);$t.texImage2D(Yt.TEXTURE_2D,0,Sr,fr.width,fr.height,0,xr,vr,null)}else if(mr instanceof C.DataTexture){if(0<_r.length&&yr){for(var Mr=0,Tr=_r.length;Mr<Tr;Mr++)br=_r[Mr],$t.texImage2D(Yt.TEXTURE_2D,Mr,xr,br.width,br.height,0,xr,vr,br.data);mr.generateMipmaps=!1}else $t.texImage2D(Yt.TEXTURE_2D,0,xr,fr.width,fr.height,0,xr,vr,fr.data);}else if(mr instanceof C.CompressedTexture)for(var Mr=0,Tr=_r.length;Mr<Tr;Mr++)br=_r[Mr],mr.format!==C.RGBAFormat&&mr.format!==C.RGBFormat?-1<$t.getCompressedTextureFormats().indexOf(xr)?$t.compressedTexImage2D(Yt.TEXTURE_2D,Mr,xr,br.width,br.height,0,br.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t.texImage2D(Yt.TEXTURE_2D,Mr,xr,br.width,br.height,0,xr,vr,br.data);else if(0<_r.length&&yr){for(var Mr=0,Tr=_r.length;Mr<Tr;Mr++)br=_r[Mr],$t.texImage2D(Yt.TEXTURE_2D,Mr,xr,xr,vr,br);mr.generateMipmaps=!1}else $t.texImage2D(Yt.TEXTURE_2D,0,xr,xr,vr,fr);mr.generateMipmaps&&yr&&Yt.generateMipmap(Yt.TEXTURE_2D),ur.__version=mr.version,mr.onUpdate&&mr.onUpdate(mr)}function Ie(ur,mr){ur instanceof C.WebGLRenderTarget&&(ur=ur.texture);var gr=tr.get(ur);if(0<ur.version&&gr.__version!==ur.version){var fr=ur.image;return void 0===fr?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",ur):!1===fr.complete?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",ur):void De(gr,ur,mr)}$t.activeTexture(Yt.TEXTURE0+mr),$t.bindTexture(Yt.TEXTURE_2D,gr.__webglTexture)}function Be(ur,mr){if(ur.width>mr||ur.height>mr){var gr=mr/_Mathmax(ur.width,ur.height),fr=document.createElement("canvas");fr.width=_Mathfloor(ur.width*gr),fr.height=_Mathfloor(ur.height*gr);var yr=fr.getContext("2d");return yr.drawImage(ur,0,0,ur.width,ur.height,0,0,fr.width,fr.height),console.warn("THREE.WebGLRenderer: image is too big ("+ur.width+"x"+ur.height+"). Resized to "+fr.width+"x"+fr.height,ur),fr}return ur}function Ne(ur){return C.Math.isPowerOfTwo(ur.width)&&C.Math.isPowerOfTwo(ur.height)}function Ue(ur){return ur.wrapS!==C.ClampToEdgeWrapping||ur.wrapT!==C.ClampToEdgeWrapping||ur.minFilter!==C.NearestFilter&&ur.minFilter!==C.LinearFilter}function Fe(ur){if(ur instanceof HTMLImageElement||ur instanceof HTMLCanvasElement){var mr=document.createElement("canvas");mr.width=C.Math.nearestPowerOfTwo(ur.width),mr.height=C.Math.nearestPowerOfTwo(ur.height);var gr=mr.getContext("2d");return gr.drawImage(ur,0,0,mr.width,mr.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+ur.width+"x"+ur.height+"). Resized to "+mr.width+"x"+mr.height,ur),mr}return ur}function Ve(ur,mr){var gr=tr.get(ur);if(6===ur.image.length)if(0<ur.version&&gr.__version!==ur.version){gr.__image__webglTextureCube||(ur.addEventListener("dispose",F),gr.__image__webglTextureCube=Yt.createTexture(),qt.textures++),$t.activeTexture(Yt.TEXTURE0+mr),$t.bindTexture(Yt.TEXTURE_CUBE_MAP,gr.__image__webglTextureCube),Yt.pixelStorei(Yt.UNPACK_FLIP_Y_WEBGL,ur.flipY);for(var fr=ur instanceof C.CompressedTexture,yr=ur.image[0]instanceof C.DataTexture,xr=[],vr=0;6>vr;vr++)xr[vr]=!mt.autoScaleCubemaps||fr||yr?yr?ur.image[vr].image:ur.image[vr]:Be(ur.image[vr],Jt.maxCubemapSize);var br=xr[0],_r=Ne(br),Sr=Xe(ur.format),Mr=Xe(ur.type);Re(Yt.TEXTURE_CUBE_MAP,ur,_r);for(var vr=0;6>vr;vr++)if(!fr)yr?$t.texImage2D(Yt.TEXTURE_CUBE_MAP_POSITIVE_X+vr,0,Sr,xr[vr].width,xr[vr].height,0,Sr,Mr,xr[vr].data):$t.texImage2D(Yt.TEXTURE_CUBE_MAP_POSITIVE_X+vr,0,Sr,Sr,Mr,xr[vr]);else for(var Er=xr[vr].mipmaps,Lr=0,wr=Er.length,Tr;Lr<wr;Lr++)Tr=Er[Lr],ur.format!==C.RGBAFormat&&ur.format!==C.RGBFormat?-1<$t.getCompressedTextureFormats().indexOf(Sr)?$t.compressedTexImage2D(Yt.TEXTURE_CUBE_MAP_POSITIVE_X+vr,Lr,Sr,Tr.width,Tr.height,0,Tr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):$t.texImage2D(Yt.TEXTURE_CUBE_MAP_POSITIVE_X+vr,Lr,Sr,Tr.width,Tr.height,0,Sr,Mr,Tr.data);ur.generateMipmaps&&_r&&Yt.generateMipmap(Yt.TEXTURE_CUBE_MAP),gr.__version=ur.version,ur.onUpdate&&ur.onUpdate(ur)}else $t.activeTexture(Yt.TEXTURE0+mr),$t.bindTexture(Yt.TEXTURE_CUBE_MAP,gr.__image__webglTextureCube)}function Ge(ur,mr){$t.activeTexture(Yt.TEXTURE0+mr),$t.bindTexture(Yt.TEXTURE_CUBE_MAP,tr.get(ur).__webglTexture)}function ke(ur,mr,gr,fr){var yr=Xe(mr.texture.format),xr=Xe(mr.texture.type);$t.texImage2D(fr,0,yr,mr.width,mr.height,0,yr,xr,null),Yt.bindFramebuffer(Yt.FRAMEBUFFER,ur),Yt.framebufferTexture2D(Yt.FRAMEBUFFER,gr,fr,tr.get(mr.texture).__webglTexture,0),Yt.bindFramebuffer(Yt.FRAMEBUFFER,null)}function ze(ur,mr){Yt.bindRenderbuffer(Yt.RENDERBUFFER,ur),mr.depthBuffer&&!mr.stencilBuffer?(Yt.renderbufferStorage(Yt.RENDERBUFFER,Yt.DEPTH_COMPONENT16,mr.width,mr.height),Yt.framebufferRenderbuffer(Yt.FRAMEBUFFER,Yt.DEPTH_ATTACHMENT,Yt.RENDERBUFFER,ur)):mr.depthBuffer&&mr.stencilBuffer?(Yt.renderbufferStorage(Yt.RENDERBUFFER,Yt.DEPTH_STENCIL,mr.width,mr.height),Yt.framebufferRenderbuffer(Yt.FRAMEBUFFER,Yt.DEPTH_STENCIL_ATTACHMENT,Yt.RENDERBUFFER,ur)):Yt.renderbufferStorage(Yt.RENDERBUFFER,Yt.RGBA4,mr.width,mr.height),Yt.bindRenderbuffer(Yt.RENDERBUFFER,null)}function Oe(ur,mr){var gr=mr instanceof C.WebGLRenderTargetCube;if(gr)throw new Error("Depth Texture with cube render targets is not supported!");if(Yt.bindFramebuffer(Yt.FRAMEBUFFER,ur),!(mr.depthTexture instanceof C.DepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");tr.get(mr.depthTexture).__webglTexture&&mr.depthTexture.image.width===mr.width&&mr.depthTexture.image.height===mr.height||(mr.depthTexture.image.width=mr.width,mr.depthTexture.image.height=mr.height,mr.depthTexture.needsUpdate=!0),mt.setTexture(mr.depthTexture,0);var fr=tr.get(mr.depthTexture).__webglTexture;Yt.framebufferTexture2D(Yt.FRAMEBUFFER,Yt.DEPTH_ATTACHMENT,Yt.TEXTURE_2D,fr,0)}function He(ur){var mr=tr.get(ur),gr=ur instanceof C.WebGLRenderTargetCube;if(ur.depthTexture){if(gr)throw new Error("target.depthTexture not supported in Cube render targets");Oe(mr.__webglFramebuffer,ur)}else if(gr){mr.__webglDepthbuffer=[];for(var fr=0;6>fr;fr++)Yt.bindFramebuffer(Yt.FRAMEBUFFER,mr.__webglFramebuffer[fr]),mr.__webglDepthbuffer[fr]=Yt.createRenderbuffer(),ze(mr.__webglDepthbuffer[fr],ur)}else Yt.bindFramebuffer(Yt.FRAMEBUFFER,mr.__webglFramebuffer),mr.__webglDepthbuffer=Yt.createRenderbuffer(),ze(mr.__webglDepthbuffer,ur);Yt.bindFramebuffer(Yt.FRAMEBUFFER,null)}function je(ur){var mr=tr.get(ur),gr=tr.get(ur.texture);ur.addEventListener("dispose",V),gr.__webglTexture=Yt.createTexture(),qt.textures++;var fr=ur instanceof C.WebGLRenderTargetCube,yr=C.Math.isPowerOfTwo(ur.width)&&C.Math.isPowerOfTwo(ur.height);if(fr){mr.__webglFramebuffer=[];for(var xr=0;6>xr;xr++)mr.__webglFramebuffer[xr]=Yt.createFramebuffer()}else mr.__webglFramebuffer=Yt.createFramebuffer();if(fr){$t.bindTexture(Yt.TEXTURE_CUBE_MAP,gr.__webglTexture),Re(Yt.TEXTURE_CUBE_MAP,ur.texture,yr);for(var xr=0;6>xr;xr++)ke(mr.__webglFramebuffer[xr],ur,Yt.COLOR_ATTACHMENT0,Yt.TEXTURE_CUBE_MAP_POSITIVE_X+xr);ur.texture.generateMipmaps&&yr&&Yt.generateMipmap(Yt.TEXTURE_CUBE_MAP),$t.bindTexture(Yt.TEXTURE_CUBE_MAP,null)}else $t.bindTexture(Yt.TEXTURE_2D,gr.__webglTexture),Re(Yt.TEXTURE_2D,ur.texture,yr),ke(mr.__webglFramebuffer,ur,Yt.COLOR_ATTACHMENT0,Yt.TEXTURE_2D),ur.texture.generateMipmaps&&yr&&Yt.generateMipmap(Yt.TEXTURE_2D),$t.bindTexture(Yt.TEXTURE_2D,null);ur.depthBuffer&&He(ur)}function We(ur){var mr=ur instanceof C.WebGLRenderTargetCube?Yt.TEXTURE_CUBE_MAP:Yt.TEXTURE_2D,gr=tr.get(ur.texture).__webglTexture;$t.bindTexture(mr,gr),Yt.generateMipmap(mr),$t.bindTexture(mr,null)}function qe(ur){return ur===C.NearestFilter||ur===C.NearestMipMapNearestFilter||ur===C.NearestMipMapLinearFilter?Yt.NEAREST:Yt.LINEAR}function Xe(ur){var mr;if(ur===C.RepeatWrapping)return Yt.REPEAT;if(ur===C.ClampToEdgeWrapping)return Yt.CLAMP_TO_EDGE;if(ur===C.MirroredRepeatWrapping)return Yt.MIRRORED_REPEAT;if(ur===C.NearestFilter)return Yt.NEAREST;if(ur===C.NearestMipMapNearestFilter)return Yt.NEAREST_MIPMAP_NEAREST;if(ur===C.NearestMipMapLinearFilter)return Yt.NEAREST_MIPMAP_LINEAR;if(ur===C.LinearFilter)return Yt.LINEAR;if(ur===C.LinearMipMapNearestFilter)return Yt.LINEAR_MIPMAP_NEAREST;if(ur===C.LinearMipMapLinearFilter)return Yt.LINEAR_MIPMAP_LINEAR;if(ur===C.UnsignedByteType)return Yt.UNSIGNED_BYTE;if(ur===C.UnsignedShort4444Type)return Yt.UNSIGNED_SHORT_4_4_4_4;if(ur===C.UnsignedShort5551Type)return Yt.UNSIGNED_SHORT_5_5_5_1;if(ur===C.UnsignedShort565Type)return Yt.UNSIGNED_SHORT_5_6_5;if(ur===C.ByteType)return Yt.BYTE;if(ur===C.ShortType)return Yt.SHORT;if(ur===C.UnsignedShortType)return Yt.UNSIGNED_SHORT;if(ur===C.IntType)return Yt.INT;if(ur===C.UnsignedIntType)return Yt.UNSIGNED_INT;if(ur===C.FloatType)return Yt.FLOAT;if(mr=Qt.get("OES_texture_half_float"),null!==mr&&ur===C.HalfFloatType)return mr.HALF_FLOAT_OES;if(ur===C.AlphaFormat)return Yt.ALPHA;if(ur===C.RGBFormat)return Yt.RGB;if(ur===C.RGBAFormat)return Yt.RGBA;if(ur===C.LuminanceFormat)return Yt.LUMINANCE;if(ur===C.LuminanceAlphaFormat)return Yt.LUMINANCE_ALPHA;if(ur===C.DepthFormat)return Yt.DEPTH_COMPONENT;if(ur===C.AddEquation)return Yt.FUNC_ADD;if(ur===C.SubtractEquation)return Yt.FUNC_SUBTRACT;if(ur===C.ReverseSubtractEquation)return Yt.FUNC_REVERSE_SUBTRACT;if(ur===C.ZeroFactor)return Yt.ZERO;if(ur===C.OneFactor)return Yt.ONE;if(ur===C.SrcColorFactor)return Yt.SRC_COLOR;if(ur===C.OneMinusSrcColorFactor)return Yt.ONE_MINUS_SRC_COLOR;if(ur===C.SrcAlphaFactor)return Yt.SRC_ALPHA;if(ur===C.OneMinusSrcAlphaFactor)return Yt.ONE_MINUS_SRC_ALPHA;if(ur===C.DstAlphaFactor)return Yt.DST_ALPHA;if(ur===C.OneMinusDstAlphaFactor)return Yt.ONE_MINUS_DST_ALPHA;if(ur===C.DstColorFactor)return Yt.DST_COLOR;if(ur===C.OneMinusDstColorFactor)return Yt.ONE_MINUS_DST_COLOR;if(ur===C.SrcAlphaSaturateFactor)return Yt.SRC_ALPHA_SATURATE;if(mr=Qt.get("WEBGL_compressed_texture_s3tc"),null!==mr){if(ur===C.RGB_S3TC_DXT1_Format)return mr.COMPRESSED_RGB_S3TC_DXT1_EXT;if(ur===C.RGBA_S3TC_DXT1_Format)return mr.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(ur===C.RGBA_S3TC_DXT3_Format)return mr.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(ur===C.RGBA_S3TC_DXT5_Format)return mr.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(mr=Qt.get("WEBGL_compressed_texture_pvrtc"),null!==mr){if(ur===C.RGB_PVRTC_4BPPV1_Format)return mr.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(ur===C.RGB_PVRTC_2BPPV1_Format)return mr.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(ur===C.RGBA_PVRTC_4BPPV1_Format)return mr.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(ur===C.RGBA_PVRTC_2BPPV1_Format)return mr.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(mr=Qt.get("WEBGL_compressed_texture_etc1"),null!==mr&&ur===C.RGB_ETC1_Format)return mr.COMPRESSED_RGB_ETC1_WEBGL;if(mr=Qt.get("EXT_blend_minmax"),null!==mr){if(ur===C.MinEquation)return mr.MIN_EXT;if(ur===C.MaxEquation)return mr.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",C.REVISION),A=A||{};var Ye=A.canvas===void 0?document.createElement("canvas"):A.canvas,Ze=A.context===void 0?null:A.context,Ke=A.alpha!==void 0&&A.alpha,Qe=!(A.depth!==void 0)||A.depth,Je=!(A.stencil!==void 0)||A.stencil,$e=A.antialias!==void 0&&A.antialias,et=!(A.premultipliedAlpha!==void 0)||A.premultipliedAlpha,tt=A.preserveDrawingBuffer!==void 0&&A.preserveDrawingBuffer,rt=[],at=[],ot=-1,nt=[],it=-1,st=new Float32Array(8),lt=[],ut=[];this.domElement=Ye,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=C.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var mt=this,gt=null,ft=null,ht=null,yt=-1,xt="",vt=null,bt=new C.Vector4,_t=null,St=new C.Vector4,Mt=0,Tt=new C.Color(0),Et=0,Lt=Ye.width,wt=Ye.height,Ct=1,At=new C.Vector4(0,0,Lt,wt),Pt=!1,Rt=new C.Vector4(0,0,Lt,wt),Dt=new C.Frustum,It=!1,Bt=!1,Nt=!1,Ut=0,Ft={type:"4fv",value:null,needsUpdate:!1},Vt=null,Gt=0,kt=new C.Matrix3,zt=new C.Sphere,Ot=new C.Plane,Ht=new C.Matrix4,jt=new C.Vector3,Wt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},qt={geometries:0,textures:0},Xt={calls:0,vertices:0,faces:0,points:0};this.info={render:Xt,memory:qt,programs:null};var Yt;try{var Zt={alpha:Ke,depth:Qe,stencil:Je,antialias:$e,premultipliedAlpha:et,preserveDrawingBuffer:tt};if(Yt=Ze||Ye.getContext("webgl",Zt)||Ye.getContext("experimental-webgl",Zt),null===Yt)if(null!==Ye.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";else throw"Error creating WebGL context.";void 0===Yt.getShaderPrecisionFormat&&(Yt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),Ye.addEventListener("webglcontextlost",U,!1)}catch(ur){console.error("THREE.WebGLRenderer: "+ur)}var Kt="undefined"!=typeof WebGL2RenderingContext&&Yt instanceof WebGL2RenderingContext,Qt=new C.WebGLExtensions(Yt);Qt.get("WEBGL_depth_texture"),Qt.get("OES_texture_float"),Qt.get("OES_texture_float_linear"),Qt.get("OES_texture_half_float"),Qt.get("OES_texture_half_float_linear"),Qt.get("OES_standard_derivatives"),Qt.get("ANGLE_instanced_arrays"),Qt.get("OES_element_index_uint")&&(C.BufferGeometry.MaxIndex=4294967296);var Jt=new C.WebGLCapabilities(Yt,Qt,A),$t=new C.WebGLState(Yt,Qt,Xe),tr=new C.WebGLProperties,rr=new C.WebGLObjects(Yt,tr,this.info),or=new C.WebGLPrograms(this,Jt),nr=new C.WebGLLights;this.info.programs=or.programs;var ir=new C.WebGLBufferRenderer(Yt,Qt,Xt),sr=new C.WebGLIndexedBufferRenderer(Yt,Qt,Xt);D(),this.context=Yt,this.capabilities=Jt,this.extensions=Qt,this.properties=tr,this.state=$t;var lr=new C.WebGLShadowMap(this,Wt,rr);this.shadowMap=lr;var pr=new C.SpritePlugin(this,lt),dr=new C.LensFlarePlugin(this,ut);this.getContext=function(){return Yt},this.getContextAttributes=function(){return Yt.getContextAttributes()},this.forceContextLoss=function(){Qt.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var ur;return function(){if(void 0!=ur)return ur;var gr=Qt.get("EXT_texture_filter_anisotropic");return ur=null===gr?0:Yt.getParameter(gr.MAX_TEXTURE_MAX_ANISOTROPY_EXT),ur}}(),this.getPrecision=function(){return Jt.precision},this.getPixelRatio=function(){return Ct},this.setPixelRatio=function(ur){void 0===ur||(Ct=ur,this.setSize(Rt.z,Rt.w,!1))},this.getSize=function(){return{width:Lt,height:wt}},this.setSize=function(ur,mr,gr){Lt=ur,wt=mr,Ye.width=ur*Ct,Ye.height=mr*Ct,!1!==gr&&(Ye.style.width=ur+"px",Ye.style.height=mr+"px"),this.setViewport(0,0,ur,mr)},this.setViewport=function(ur,mr,gr,fr){$t.viewport(Rt.set(ur,mr,gr,fr))},this.setScissor=function(ur,mr,gr,fr){$t.scissor(At.set(ur,mr,gr,fr))},this.setScissorTest=function(ur){$t.setScissorTest(Pt=ur)},this.getClearColor=function(){return Tt},this.setClearColor=function(ur,mr){Tt.set(ur),Et=mr===void 0?1:mr,R(Tt.r,Tt.g,Tt.b,Et)},this.getClearAlpha=function(){return Et},this.setClearAlpha=function(ur){Et=ur,R(Tt.r,Tt.g,Tt.b,Et)},this.clear=function(ur,mr,gr){var fr=0;(ur===void 0||ur)&&(fr|=Yt.COLOR_BUFFER_BIT),(mr===void 0||mr)&&(fr|=Yt.DEPTH_BUFFER_BIT),(gr===void 0||gr)&&(fr|=Yt.STENCIL_BUFFER_BIT),Yt.clear(fr)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(ur,mr,gr,fr){this.setRenderTarget(ur),this.clear(mr,gr,fr)},this.resetGLState=I,this.dispose=function(){Ye.removeEventListener("webglcontextlost",U,!1)},this.renderBufferImmediate=function(ur,mr,gr){$t.initAttributes();var fr=tr.get(ur);ur.hasPositions&&!fr.position&&(fr.position=Yt.createBuffer()),ur.hasNormals&&!fr.normal&&(fr.normal=Yt.createBuffer()),ur.hasUvs&&!fr.uv&&(fr.uv=Yt.createBuffer()),ur.hasColors&&!fr.color&&(fr.color=Yt.createBuffer());var yr=mr.getAttributes();if(ur.hasPositions&&(Yt.bindBuffer(Yt.ARRAY_BUFFER,fr.position),Yt.bufferData(Yt.ARRAY_BUFFER,ur.positionArray,Yt.DYNAMIC_DRAW),$t.enableAttribute(yr.position),Yt.vertexAttribPointer(yr.position,3,Yt.FLOAT,!1,0,0)),ur.hasNormals){if(Yt.bindBuffer(Yt.ARRAY_BUFFER,fr.normal),"MeshPhongMaterial"!==gr.type&&"MeshStandardMaterial"!==gr.type&&"MeshPhysicalMaterial"!==gr.type&&gr.shading===C.FlatShading)for(var xr=0,vr=3*ur.count;xr<vr;xr+=9){var br=ur.normalArray,_r=(br[xr+0]+br[xr+3]+br[xr+6])/3,Sr=(br[xr+1]+br[xr+4]+br[xr+7])/3,Mr=(br[xr+2]+br[xr+5]+br[xr+8])/3;br[xr+0]=_r,br[xr+1]=Sr,br[xr+2]=Mr,br[xr+3]=_r,br[xr+4]=Sr,br[xr+5]=Mr,br[xr+6]=_r,br[xr+7]=Sr,br[xr+8]=Mr}Yt.bufferData(Yt.ARRAY_BUFFER,ur.normalArray,Yt.DYNAMIC_DRAW),$t.enableAttribute(yr.normal),Yt.vertexAttribPointer(yr.normal,3,Yt.FLOAT,!1,0,0)}ur.hasUvs&&gr.map&&(Yt.bindBuffer(Yt.ARRAY_BUFFER,fr.uv),Yt.bufferData(Yt.ARRAY_BUFFER,ur.uvArray,Yt.DYNAMIC_DRAW),$t.enableAttribute(yr.uv),Yt.vertexAttribPointer(yr.uv,2,Yt.FLOAT,!1,0,0)),ur.hasColors&&gr.vertexColors!==C.NoColors&&(Yt.bindBuffer(Yt.ARRAY_BUFFER,fr.color),Yt.bufferData(Yt.ARRAY_BUFFER,ur.colorArray,Yt.DYNAMIC_DRAW),$t.enableAttribute(yr.color),Yt.vertexAttribPointer(yr.color,3,Yt.FLOAT,!1,0,0)),$t.disableUnusedAttributes(),Yt.drawArrays(Yt.TRIANGLES,0,ur.count),ur.count=0},this.renderBufferDirect=function(ur,mr,gr,fr,yr,xr){se(fr);var vr=pe(ur,mr,fr,yr),br=!1,_r=gr.id+"_"+vr.id+"_"+fr.wireframe;_r!=xt&&(xt=_r,br=!0);var Sr=yr.morphTargetInfluences;if(Sr!==void 0){for(var Mr=[],Tr=0,Er=Sr.length,Lr;Tr<Er;Tr++)Lr=Sr[Tr],Mr.push([Lr,Tr]);Mr.sort(Z),8<Mr.length&&(Mr.length=8);for(var wr=gr.morphAttributes,Tr=0,Er=Mr.length,Lr;Tr<Er;Tr++)if(Lr=Mr[Tr],st[Tr]=Lr[0],0!==Lr[0]){var Cr=Lr[1];!0===fr.morphTargets&&wr.position&&gr.addAttribute("morphTarget"+Tr,wr.position[Cr]),!0===fr.morphNormals&&wr.normal&&gr.addAttribute("morphNormal"+Tr,wr.normal[Cr])}else!0===fr.morphTargets&&gr.removeAttribute("morphTarget"+Tr),!0===fr.morphNormals&&gr.removeAttribute("morphNormal"+Tr);vr.getUniforms().setValue(Yt,"morphTargetInfluences",st),br=!0}var Cr=gr.index,Ar=gr.attributes.position;!0===fr.wireframe&&(Cr=rr.getWireframeAttribute(gr));var Pr;null===Cr?Pr=ir:(Pr=sr,Pr.setIndex(Cr)),br&&(Y(fr,vr,gr),null!==Cr&&Yt.bindBuffer(Yt.ELEMENT_ARRAY_BUFFER,rr.getAttributeBuffer(Cr)));var Rr=0,Dr=Infinity;null===Cr?Ar!==void 0&&(Dr=Ar.count):Dr=Cr.count;var Ir=gr.drawRange.start,Br=gr.drawRange.count,Nr=null===xr?0:xr.start,Ur=null===xr?Infinity:xr.count,Fr=_Mathmax(Rr,Ir,Nr),Vr=_Mathmin(Rr+Dr,Ir+Br,Nr+Ur)-1,Gr=_Mathmax(0,Vr-Fr+1);if(yr instanceof C.Mesh){if(!0===fr.wireframe)$t.setLineWidth(fr.wireframeLinewidth*P()),Pr.setMode(Yt.LINES);else switch(yr.drawMode){case C.TrianglesDrawMode:Pr.setMode(Yt.TRIANGLES);break;case C.TriangleStripDrawMode:Pr.setMode(Yt.TRIANGLE_STRIP);break;case C.TriangleFanDrawMode:Pr.setMode(Yt.TRIANGLE_FAN);}}else if(yr instanceof C.Line){var kr=fr.linewidth;kr===void 0&&(kr=1),$t.setLineWidth(kr*P()),yr instanceof C.LineSegments?Pr.setMode(Yt.LINES):Pr.setMode(Yt.LINE_STRIP)}else yr instanceof C.Points&&Pr.setMode(Yt.POINTS);gr instanceof C.InstancedBufferGeometry?0<gr.maxInstancedCount&&Pr.renderInstances(gr,Fr,Gr):Pr.render(Fr,Gr)},this.render=function(ur,mr,gr,fr){if(!1==mr instanceof C.Camera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var yr=ur.fog;if(xt="",yt=-1,vt=null,!0===ur.autoUpdate&&ur.updateMatrixWorld(),null===mr.parent&&mr.updateMatrixWorld(),mr.matrixWorldInverse.getInverse(mr.matrixWorld),Ht.multiplyMatrices(mr.projectionMatrix,mr.matrixWorldInverse),Dt.setFromMatrix(Ht),rt.length=0,ot=-1,it=-1,lt.length=0,ut.length=0,Le(this.clippingPlanes,mr),oe(ur,mr),at.length=ot+1,nt.length=it+1,!0===mt.sortObjects&&(at.sort(K),nt.sort(Q)),It&&(Nt=!0,we(null)),Te(rt),lr.render(ur,mr),Ee(rt,mr),It&&(Nt=!1,Ce()),Xt.calls=0,Xt.vertices=0,Xt.faces=0,Xt.points=0,void 0===gr&&(gr=null),this.setRenderTarget(gr),(this.autoClear||fr)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),ur.overrideMaterial){var xr=ur.overrideMaterial;ne(at,mr,yr,xr),ne(nt,mr,yr,xr)}else $t.setBlending(C.NoBlending),ne(at,mr,yr),ne(nt,mr,yr);if(pr.render(ur,mr),dr.render(ur,mr,St),gr){var vr=gr.texture;vr.generateMipmaps&&Ne(gr)&&vr.minFilter!==C.NearestFilter&&vr.minFilter!==C.LinearFilter&&We(gr)}$t.setDepthTest(!0),$t.setDepthWrite(!0),$t.setColorWrite(!0)},this.setFaceCulling=function(ur,mr){ur===C.CullFaceNone?$t.disable(Yt.CULL_FACE):(mr===C.FrontFaceDirectionCW?Yt.frontFace(Yt.CW):Yt.frontFace(Yt.CCW),ur===C.CullFaceBack?Yt.cullFace(Yt.BACK):ur===C.CullFaceFront?Yt.cullFace(Yt.FRONT):Yt.cullFace(Yt.FRONT_AND_BACK),$t.enable(Yt.CULL_FACE))};var cr=!1;this.setTexture=function(ur,mr){cr||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),cr=!0),Ie(ur,mr)},this.allocTextureUnit=function(){var ur=Mt;return ur>=Jt.maxTextures&&console.warn("WebGLRenderer: trying to use "+ur+" texture units while this GPU supports only "+Jt.maxTextures),Mt+=1,ur},this.setTexture2D=Ie,this.setTextureCube=function(ur,mr){ur instanceof C.CubeTexture||Array.isArray(ur.image)&&6===ur.image.length?Ve(ur,mr):Ge(ur.texture,mr)},this.getCurrentRenderTarget=function(){return ft},this.setRenderTarget=function(ur){ft=ur,ur&&void 0===tr.get(ur).__webglFramebuffer&&je(ur);var mr=ur instanceof C.WebGLRenderTargetCube,gr;if(ur){var fr=tr.get(ur);gr=mr?fr.__webglFramebuffer[ur.activeCubeFace]:fr.__webglFramebuffer,bt.copy(ur.scissor),_t=ur.scissorTest,St.copy(ur.viewport)}else gr=null,bt.copy(At).multiplyScalar(Ct),_t=Pt,St.copy(Rt).multiplyScalar(Ct);if(ht!==gr&&(Yt.bindFramebuffer(Yt.FRAMEBUFFER,gr),ht=gr),$t.scissor(bt),$t.setScissorTest(_t),$t.viewport(St),mr){var yr=tr.get(ur.texture);Yt.framebufferTexture2D(Yt.FRAMEBUFFER,Yt.COLOR_ATTACHMENT0,Yt.TEXTURE_CUBE_MAP_POSITIVE_X+ur.activeCubeFace,yr.__webglTexture,ur.activeMipMapLevel)}},this.readRenderTargetPixels=function(ur,mr,gr,fr,yr,xr){if(!1==ur instanceof C.WebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var vr=tr.get(ur).__webglFramebuffer;if(vr){var br=!1;vr!==ht&&(Yt.bindFramebuffer(Yt.FRAMEBUFFER,vr),br=!0);try{var _r=ur.texture;if(_r.format!==C.RGBAFormat&&Xe(_r.format)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(_r.type!==C.UnsignedByteType&&Xe(_r.type)!==Yt.getParameter(Yt.IMPLEMENTATION_COLOR_READ_TYPE)&&!(_r.type===C.FloatType&&Qt.get("WEBGL_color_buffer_float"))&&!(_r.type===C.HalfFloatType&&Qt.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Yt.checkFramebufferStatus(Yt.FRAMEBUFFER)===Yt.FRAMEBUFFER_COMPLETE?0<mr&&mr<=ur.width-fr&&0<gr&&gr<=ur.height-yr&&Yt.readPixels(mr,gr,fr,yr,Xe(_r.format),Xe(_r.type),xr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{br&&Yt.bindFramebuffer(Yt.FRAMEBUFFER,ht)}}}},C.WebGLRenderTarget=function(A,P,R){this.uuid=C.Math.generateUUID(),this.width=A,this.height=P,this.scissor=new C.Vector4(0,0,A,P),this.scissorTest=!1,this.viewport=new C.Vector4(0,0,A,P),R=R||{},R.minFilter===void 0&&(R.minFilter=C.LinearFilter),this.texture=new C.Texture(void 0,void 0,R.wrapS,R.wrapT,R.magFilter,R.minFilter,R.format,R.type,R.anisotropy,R.encoding),this.depthBuffer=!(R.depthBuffer!==void 0)||R.depthBuffer,this.stencilBuffer=!(R.stencilBuffer!==void 0)||R.stencilBuffer,this.depthTexture=null},C.WebGLRenderTarget.prototype={constructor:C.WebGLRenderTarget,setSize:function(A,P){(this.width!==A||this.height!==P)&&(this.width=A,this.height=P,this.dispose()),this.viewport.set(0,0,A,P),this.scissor.set(0,0,A,P)},clone:function(){return new this.constructor().copy(this)},copy:function(A){return this.width=A.width,this.height=A.height,this.viewport.copy(A.viewport),this.texture=A.texture.clone(),this.depthBuffer=A.depthBuffer,this.stencilBuffer=A.stencilBuffer,this.depthTexture=A.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},C.EventDispatcher.prototype.apply(C.WebGLRenderTarget.prototype),C.WebGLRenderTargetCube=function(A,P,R){C.WebGLRenderTarget.call(this,A,P,R),this.activeCubeFace=0,this.activeMipMapLevel=0},C.WebGLRenderTargetCube.prototype=Object.create(C.WebGLRenderTarget.prototype),C.WebGLRenderTargetCube.prototype.constructor=C.WebGLRenderTargetCube,C.WebGLBufferRenderer=function(A,P,R){var F;this.setMode=function(V){F=V},this.render=function(V,G){A.drawArrays(F,V,G),R.calls++,R.vertices+=G,F===A.TRIANGLES&&(R.faces+=G/3)},this.renderInstances=function(V){var G=P.get("ANGLE_instanced_arrays");if(null===G)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var O=V.attributes.position,H=0;O instanceof C.InterleavedBufferAttribute?(H=O.data.count,G.drawArraysInstancedANGLE(F,0,H,V.maxInstancedCount)):(H=O.count,G.drawArraysInstancedANGLE(F,0,H,V.maxInstancedCount)),R.calls++,R.vertices+=H*V.maxInstancedCount,F===A.TRIANGLES&&(R.faces+=V.maxInstancedCount*H/3)}},C.WebGLIndexedBufferRenderer=function(A,P,R){var V,G,O;this.setMode=function(H){V=H},this.setIndex=function(H){H.array instanceof Uint32Array&&P.get("OES_element_index_uint")?(G=A.UNSIGNED_INT,O=4):(G=A.UNSIGNED_SHORT,O=2)},this.render=function(H,W){A.drawElements(V,W,G,H*O),R.calls++,R.vertices+=W,V===A.TRIANGLES&&(R.faces+=W/3)},this.renderInstances=function(H,W,X){var Y=P.get("ANGLE_instanced_arrays");return null===Y?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):void(Y.drawElementsInstancedANGLE(V,X,G,W*O,H.maxInstancedCount),R.calls++,R.vertices+=X*H.maxInstancedCount,V===A.TRIANGLES&&(R.faces+=H.maxInstancedCount*X/3))}},C.WebGLExtensions=function(A){var P={};this.get=function(R){if(void 0!==P[R])return P[R];var D;switch(R){case"WEBGL_depth_texture":D=A.getExtension("WEBGL_depth_texture")||A.getExtension("MOZ_WEBGL_depth_texture")||A.getExtension("WEBKIT_WEBGL_depth_texture");case"EXT_texture_filter_anisotropic":D=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":D=A.getExtension("WEBGL_compressed_texture_s3tc")||A.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":D=A.getExtension("WEBGL_compressed_texture_pvrtc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":D=A.getExtension("WEBGL_compressed_texture_etc1");break;default:D=A.getExtension(R);}return null===D&&console.warn("THREE.WebGLRenderer: "+R+" extension not supported."),P[R]=D,D}},C.WebGLCapabilities=function(A,P,R){function D(U){if("highp"===U){if(0<A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.HIGH_FLOAT).precision&&0<A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.HIGH_FLOAT).precision)return"highp";U="mediump"}return"mediump"===U&&0<A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.MEDIUM_FLOAT).precision&&0<A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=D,this.precision=R.precision===void 0?"highp":R.precision,this.logarithmicDepthBuffer=R.logarithmicDepthBuffer!==void 0&&R.logarithmicDepthBuffer,this.maxTextures=A.getParameter(A.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=A.getParameter(A.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=A.getParameter(A.MAX_TEXTURE_SIZE),this.maxCubemapSize=A.getParameter(A.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=A.getParameter(A.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=A.getParameter(A.MAX_VARYING_VECTORS),this.maxFragmentUniforms=A.getParameter(A.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!P.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var I=D(this.precision);I!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",I,"instead."),this.precision=I),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!P.get("EXT_frag_depth"))},C.WebGLGeometries=function(A,P,R){function I(H){var W=H.target,X=O[W.id];null!==X.index&&F(X.index),V(X.attributes),W.removeEventListener("dispose",I),delete O[W.id];var Y=P.get(W);Y.wireframe&&F(Y.wireframe),P.delete(W);var Z=P.get(X);Z.wireframe&&F(Z.wireframe),P.delete(X),R.memory.geometries--}function U(H){return H instanceof C.InterleavedBufferAttribute?P.get(H.data).__webglBuffer:P.get(H).__webglBuffer}function F(H){var W=U(H);W!==void 0&&(A.deleteBuffer(W),G(H))}function V(H){for(var W in H)F(H[W])}function G(H){H instanceof C.InterleavedBufferAttribute?P.delete(H.data):P.delete(H)}var O={};this.get=function(H){var W=H.geometry;if(void 0!==O[W.id])return O[W.id];W.addEventListener("dispose",I);var X;return W instanceof C.BufferGeometry?X=W:W instanceof C.Geometry&&(void 0===W._bufferGeometry&&(W._bufferGeometry=new C.BufferGeometry().setFromObject(H)),X=W._bufferGeometry),O[W.id]=X,R.memory.geometries++,X}},C.WebGLLights=function(){var A={};this.get=function(P){if(void 0!==A[P.id])return A[P.id];var R;switch(P.type){case"DirectionalLight":R={direction:new C.Vector3,color:new C.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C.Vector2};break;case"SpotLight":R={position:new C.Vector3,direction:new C.Vector3,color:new C.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C.Vector2};break;case"PointLight":R={position:new C.Vector3,color:new C.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C.Vector2};break;case"HemisphereLight":R={direction:new C.Vector3,skyColor:new C.Color,groundColor:new C.Color};}return A[P.id]=R,R}},C.WebGLObjects=function(A,P,R){function I(W,X){var Y=W instanceof C.InterleavedBufferAttribute?W.data:W,Z=P.get(Y);Z.__webglBuffer===void 0?U(Z,Y,X):Z.version!==Y.version&&F(Z,Y,X)}function U(W,X,Y){W.__webglBuffer=A.createBuffer(),A.bindBuffer(Y,W.__webglBuffer);var Z=X.dynamic?A.DYNAMIC_DRAW:A.STATIC_DRAW;A.bufferData(Y,X.array,Z),W.version=X.version}function F(W,X,Y){A.bindBuffer(Y,W.__webglBuffer),!1===X.dynamic||-1===X.updateRange.count?A.bufferSubData(Y,0,X.array):0===X.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(A.bufferSubData(Y,X.updateRange.offset*X.array.BYTES_PER_ELEMENT,X.array.subarray(X.updateRange.offset,X.updateRange.offset+X.updateRange.count)),X.updateRange.count=0),W.version=X.version}function O(W,X,Y){if(X>Y){var Z=X;X=Y,Y=Z}var K=W[X];return void 0===K?(W[X]=[Y],!0):!(-1!==K.indexOf(Y))&&(K.push(Y),!0)}var H=new C.WebGLGeometries(A,P,R);this.getAttributeBuffer=function(W){return W instanceof C.InterleavedBufferAttribute?P.get(W.data).__webglBuffer:P.get(W).__webglBuffer},this.getWireframeAttribute=function(W){var X=P.get(W);if(void 0!==X.wireframe)return X.wireframe;var Y=[],Z=W.index,K=W.attributes,Q=K.position;if(null!==Z)for(var J={},ee=Z.array,oe=0,ne=ee.length;oe<ne;oe+=3){var ie=ee[oe+0],se=ee[oe+1],le=ee[oe+2];O(J,ie,se)&&Y.push(ie,se),O(J,se,le)&&Y.push(se,le),O(J,le,ie)&&Y.push(le,ie)}else for(var ee=K.position.array,oe=0,ne=ee.length/3-1;oe<ne;oe+=3){var ie=oe+0,se=oe+1,le=oe+2;Y.push(ie,se,se,le,le,ie)}var pe=65535<Q.count?Uint32Array:Uint16Array,ue=new C.BufferAttribute(new pe(Y),1);return I(ue,A.ELEMENT_ARRAY_BUFFER),X.wireframe=ue,ue},this.update=function(W){var X=H.get(W);W.geometry instanceof C.Geometry&&X.updateFromObject(W);var Y=X.index,Z=X.attributes;for(var K in null!==Y&&I(Y,A.ELEMENT_ARRAY_BUFFER),Z)I(Z[K],A.ARRAY_BUFFER);var Q=X.morphAttributes;for(var K in Q)for(var J=Q[K],ee=0,oe=J.length;ee<oe;ee++)I(J[ee],A.ARRAY_BUFFER);return X}},C.WebGLProgram=function(){function A(X){switch(X){case C.LinearEncoding:return["Linear","( value )"];case C.sRGBEncoding:return["sRGB","( value )"];case C.RGBEEncoding:return["RGBE","( value )"];case C.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case C.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case C.RGBDEncoding:return["RGBD","( value, 256.0 )"];case C.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+X);}}function P(X,Y){var Z=A(Y);return"vec4 "+X+"( vec4 value ) { return "+Z[0]+"ToLinear"+Z[1]+"; }"}function R(X,Y){var Z=A(Y);return"vec4 "+X+"( vec4 value ) { return LinearTo"+Z[0]+Z[1]+"; }"}function D(X,Y){var Z;switch(Y){case C.LinearToneMapping:Z="Linear";break;case C.ReinhardToneMapping:Z="Reinhard";break;case C.Uncharted2ToneMapping:Z="Uncharted2";break;case C.CineonToneMapping:Z="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+Y);}return"vec3 "+X+"( vec3 color ) { return "+Z+"ToneMapping( color ); }"}function I(X,Y,Z){X=X||{};var K=[X.derivatives||Y.envMapCubeUV||Y.bumpMap||Y.normalMap||Y.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(X.fragDepth||Y.logarithmicDepthBuffer)&&Z.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",X.drawBuffers&&Z.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(X.shaderTextureLOD||Y.envMap)&&Z.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return K.filter(V).join("\n")}function U(X){var Y=[];for(var Z in X){var K=X[Z];!1===K||Y.push("#define "+Z+" "+K)}return Y.join("\n")}function F(X,Y){for(var K={},Q=X.getProgramParameter(Y,X.ACTIVE_ATTRIBUTES),J=0;J<Q;J++){var ee=X.getActiveAttrib(Y,J),oe=ee.name;K[oe]=X.getAttribLocation(Y,oe)}return K}function V(X){return""!==X}function G(X,Y){return X.replace(/NUM_DIR_LIGHTS/g,Y.numDirLights).replace(/NUM_SPOT_LIGHTS/g,Y.numSpotLights).replace(/NUM_POINT_LIGHTS/g,Y.numPointLights).replace(/NUM_HEMI_LIGHTS/g,Y.numHemiLights)}function O(X){var Z=/#include +<([\w\d.]+)>/g;return X.replace(Z,function(K,Q){var J=C.ShaderChunk[Q];if(J===void 0)throw new Error("Can not resolve #include <"+Q+">");return O(J)})}function H(X){var Z=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return X.replace(Z,function(K,Q,J,ee){for(var oe="",ne=parseInt(Q);ne<parseInt(J);ne++)oe+=ee.replace(/\[ i \]/g,"[ "+ne+" ]");return oe})}var W=0;return function(Y,Z,K,Q){var J=Y.context,ee=K.extensions,oe=K.defines,ne=K.__webglShader.vertexShader,ie=K.__webglShader.fragmentShader,se="SHADOWMAP_TYPE_BASIC";Q.shadowMapType===C.PCFShadowMap?se="SHADOWMAP_TYPE_PCF":Q.shadowMapType===C.PCFSoftShadowMap&&(se="SHADOWMAP_TYPE_PCF_SOFT");var le="ENVMAP_TYPE_CUBE",pe="ENVMAP_MODE_REFLECTION",ue="ENVMAP_BLENDING_MULTIPLY";if(Q.envMap){switch(K.envMap.mapping){case C.CubeReflectionMapping:case C.CubeRefractionMapping:le="ENVMAP_TYPE_CUBE";break;case C.CubeUVReflectionMapping:case C.CubeUVRefractionMapping:le="ENVMAP_TYPE_CUBE_UV";break;case C.EquirectangularReflectionMapping:case C.EquirectangularRefractionMapping:le="ENVMAP_TYPE_EQUIREC";break;case C.SphericalReflectionMapping:le="ENVMAP_TYPE_SPHERE";}switch(K.envMap.mapping){case C.CubeRefractionMapping:case C.EquirectangularRefractionMapping:pe="ENVMAP_MODE_REFRACTION";}switch(K.combine){case C.MultiplyOperation:ue="ENVMAP_BLENDING_MULTIPLY";break;case C.MixOperation:ue="ENVMAP_BLENDING_MIX";break;case C.AddOperation:ue="ENVMAP_BLENDING_ADD";}}var ge=0<Y.gammaFactor?Y.gammaFactor:1,fe=I(ee,Q,Y.extensions),he=U(oe),ye=J.createProgram(),xe,ve;K instanceof C.RawShaderMaterial?(xe="",ve=""):(xe=["precision "+Q.precision+" float;","precision "+Q.precision+" int;","#define SHADER_NAME "+K.__webglShader.name,he,Q.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+ge,"#define MAX_BONES "+Q.maxBones,Q.map?"#define USE_MAP":"",Q.envMap?"#define USE_ENVMAP":"",Q.envMap?"#define "+pe:"",Q.lightMap?"#define USE_LIGHTMAP":"",Q.aoMap?"#define USE_AOMAP":"",Q.emissiveMap?"#define USE_EMISSIVEMAP":"",Q.bumpMap?"#define USE_BUMPMAP":"",Q.normalMap?"#define USE_NORMALMAP":"",Q.displacementMap&&Q.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",Q.specularMap?"#define USE_SPECULARMAP":"",Q.roughnessMap?"#define USE_ROUGHNESSMAP":"",Q.metalnessMap?"#define USE_METALNESSMAP":"",Q.alphaMap?"#define USE_ALPHAMAP":"",Q.vertexColors?"#define USE_COLOR":"",Q.flatShading?"#define FLAT_SHADED":"",Q.skinning?"#define USE_SKINNING":"",Q.useVertexTexture?"#define BONE_TEXTURE":"",Q.morphTargets?"#define USE_MORPHTARGETS":"",Q.morphNormals&&!1===Q.flatShading?"#define USE_MORPHNORMALS":"",Q.doubleSided?"#define DOUBLE_SIDED":"",Q.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+Q.numClippingPlanes,Q.shadowMapEnabled?"#define USE_SHADOWMAP":"",Q.shadowMapEnabled?"#define "+se:"",Q.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Q.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Q.logarithmicDepthBuffer&&Y.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(V).join("\n"),ve=[fe,"precision "+Q.precision+" float;","precision "+Q.precision+" int;","#define SHADER_NAME "+K.__webglShader.name,he,Q.alphaTest?"#define ALPHATEST "+Q.alphaTest:"","#define GAMMA_FACTOR "+ge,Q.useFog&&Q.fog?"#define USE_FOG":"",Q.useFog&&Q.fogExp?"#define FOG_EXP2":"",Q.map?"#define USE_MAP":"",Q.envMap?"#define USE_ENVMAP":"",Q.envMap?"#define "+le:"",Q.envMap?"#define "+pe:"",Q.envMap?"#define "+ue:"",Q.lightMap?"#define USE_LIGHTMAP":"",Q.aoMap?"#define USE_AOMAP":"",Q.emissiveMap?"#define USE_EMISSIVEMAP":"",Q.bumpMap?"#define USE_BUMPMAP":"",Q.normalMap?"#define USE_NORMALMAP":"",Q.specularMap?"#define USE_SPECULARMAP":"",Q.roughnessMap?"#define USE_ROUGHNESSMAP":"",Q.metalnessMap?"#define USE_METALNESSMAP":"",Q.alphaMap?"#define USE_ALPHAMAP":"",Q.vertexColors?"#define USE_COLOR":"",Q.flatShading?"#define FLAT_SHADED":"",Q.doubleSided?"#define DOUBLE_SIDED":"",Q.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+Q.numClippingPlanes,Q.shadowMapEnabled?"#define USE_SHADOWMAP":"",Q.shadowMapEnabled?"#define "+se:"",Q.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Q.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",Q.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Q.logarithmicDepthBuffer&&Y.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",Q.envMap&&Y.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",Q.toneMapping===C.NoToneMapping?"":"#define TONE_MAPPING",Q.toneMapping===C.NoToneMapping?"":C.ShaderChunk.tonemapping_pars_fragment,Q.toneMapping===C.NoToneMapping?"":D("toneMapping",Q.toneMapping),Q.outputEncoding||Q.mapEncoding||Q.envMapEncoding||Q.emissiveMapEncoding?C.ShaderChunk.encodings_pars_fragment:"",Q.mapEncoding?P("mapTexelToLinear",Q.mapEncoding):"",Q.envMapEncoding?P("envMapTexelToLinear",Q.envMapEncoding):"",Q.emissiveMapEncoding?P("emissiveMapTexelToLinear",Q.emissiveMapEncoding):"",Q.outputEncoding?R("linearToOutputTexel",Q.outputEncoding):"",Q.depthPacking?"#define DEPTH_PACKING "+K.depthPacking:"","\n"].filter(V).join("\n")),ne=O(ne,Q),ne=G(ne,Q),ie=O(ie,Q),ie=G(ie,Q),!1==K instanceof C.ShaderMaterial&&(ne=H(ne),ie=H(ie));var _e=xe+ne,Se=ve+ie,Me=C.WebGLShader(J,J.VERTEX_SHADER,_e),Te=C.WebGLShader(J,J.FRAGMENT_SHADER,Se);J.attachShader(ye,Me),J.attachShader(ye,Te),void 0===K.index0AttributeName?!0===Q.morphTargets&&J.bindAttribLocation(ye,0,"position"):J.bindAttribLocation(ye,0,K.index0AttributeName),J.linkProgram(ye);var Ee=J.getProgramInfoLog(ye),Le=J.getShaderInfoLog(Me),we=J.getShaderInfoLog(Te),Ce=!0,Ae=!0;!1===J.getProgramParameter(ye,J.LINK_STATUS)?(Ce=!1,console.error("THREE.WebGLProgram: shader error: ",J.getError(),"gl.VALIDATE_STATUS",J.getProgramParameter(ye,J.VALIDATE_STATUS),"gl.getProgramInfoLog",Ee,Le,we)):""===Ee?(""===Le||""===we)&&(Ae=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Ee),Ae&&(this.diagnostics={runnable:Ce,material:K,programLog:Ee,vertexShader:{log:Le,prefix:xe},fragmentShader:{log:we,prefix:ve}}),J.deleteShader(Me),J.deleteShader(Te);var Pe;this.getUniforms=function(){return void 0==Pe&&(Pe=new C.WebGLUniforms(J,ye,Y)),Pe};var Re;return this.getAttributes=function(){return void 0==Re&&(Re=F(J,ye)),Re},this.destroy=function(){J.deleteProgram(ye),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=W++,this.code=Z,this.usedTimes=1,this.program=ye,this.vertexShader=Me,this.fragmentShader=Te,this}}(),C.WebGLPrograms=function(A,P){function R(V){if(P.floatVertexTextures&&V&&V.skeleton&&V.skeleton.useVertexTexture)return 1024;var G=P.maxVertexUniforms,O=_Mathfloor((G-20)/4),H=O;return void 0!==V&&V instanceof C.SkinnedMesh&&(H=_Mathmin(V.skeleton.bones.length,H),H<V.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+V.skeleton.bones.length+", this GPU supports just "+H+" (try OpenGL instead of ANGLE)")),H}function D(V,G){var O;return V?V instanceof C.Texture?O=V.encoding:V instanceof C.WebGLRenderTarget&&(O=V.texture.encoding):O=C.LinearEncoding,O===C.LinearEncoding&&G&&(O=C.GammaEncoding),O}var I=[],U={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},F=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","depthPacking"];this.getParameters=function(V,G,O,H,W){var X=U[V.type],Y=R(W),Z=A.getPrecision();null!==V.precision&&(Z=P.getMaxPrecision(V.precision),Z!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",Z,"instead."));var K={shaderID:X,precision:Z,supportsVertexTextures:P.vertexTextures,outputEncoding:D(A.getCurrentRenderTarget(),A.gammaOutput),map:!!V.map,mapEncoding:D(V.map,A.gammaInput),envMap:!!V.envMap,envMapMode:V.envMap&&V.envMap.mapping,envMapEncoding:D(V.envMap,A.gammaInput),envMapCubeUV:!!V.envMap&&(V.envMap.mapping===C.CubeUVReflectionMapping||V.envMap.mapping===C.CubeUVRefractionMapping),lightMap:!!V.lightMap,aoMap:!!V.aoMap,emissiveMap:!!V.emissiveMap,emissiveMapEncoding:D(V.emissiveMap,A.gammaInput),bumpMap:!!V.bumpMap,normalMap:!!V.normalMap,displacementMap:!!V.displacementMap,roughnessMap:!!V.roughnessMap,metalnessMap:!!V.metalnessMap,specularMap:!!V.specularMap,alphaMap:!!V.alphaMap,combine:V.combine,vertexColors:V.vertexColors,fog:O,useFog:V.fog,fogExp:O instanceof C.FogExp2,flatShading:V.shading===C.FlatShading,sizeAttenuation:V.sizeAttenuation,logarithmicDepthBuffer:P.logarithmicDepthBuffer,skinning:V.skinning,maxBones:Y,useVertexTexture:P.floatVertexTextures&&W&&W.skeleton&&W.skeleton.useVertexTexture,morphTargets:V.morphTargets,morphNormals:V.morphNormals,maxMorphTargets:A.maxMorphTargets,maxMorphNormals:A.maxMorphNormals,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numHemiLights:G.hemi.length,numClippingPlanes:H,shadowMapEnabled:A.shadowMap.enabled&&W.receiveShadow&&0<G.shadows.length,shadowMapType:A.shadowMap.type,toneMapping:A.toneMapping,physicallyCorrectLights:A.physicallyCorrectLights,premultipliedAlpha:V.premultipliedAlpha,alphaTest:V.alphaTest,doubleSided:V.side===C.DoubleSide,flipSided:V.side===C.BackSide,depthPacking:V.depthPacking!==void 0&&V.depthPacking};return K},this.getProgramCode=function(V,G){var O=[];if(G.shaderID?O.push(G.shaderID):(O.push(V.fragmentShader),O.push(V.vertexShader)),void 0!==V.defines)for(var H in V.defines)O.push(H),O.push(V.defines[H]);for(var W=0;W<F.length;W++)O.push(G[F[W]]);return O.join()},this.acquireProgram=function(V,G,O){for(var W=0,X=I.length,H,Y;W<X;W++)if(Y=I[W],Y.code===O){H=Y,++H.usedTimes;break}return void 0===H&&(H=new C.WebGLProgram(A,O,V,G),I.push(H)),H},this.releaseProgram=function(V){if(0==--V.usedTimes){var G=I.indexOf(V);I[G]=I[I.length-1],I.pop(),V.destroy()}},this.programs=I},C.WebGLProperties=function(){var A={};this.get=function(P){var R=P.uuid,D=A[R];return void 0===D&&(D={},A[R]=D),D},this.delete=function(P){delete A[P.uuid]},this.clear=function(){A={}}},C.WebGLShader=function(){function A(P){for(var R=P.split("\n"),D=0;D<R.length;D++)R[D]=D+1+": "+R[D];return R.join("\n")}return function(R,D,I){var U=R.createShader(D);return R.shaderSource(U,I),R.compileShader(U),!1===R.getShaderParameter(U,R.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==R.getShaderInfoLog(U)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",D===R.VERTEX_SHADER?"vertex":"fragment",R.getShaderInfoLog(U),A(I)),U}}(),C.WebGLShadowMap=function(A,P,R){function D(_e,Se,Me,Te){var Ee=_e.geometry,Le=null,we=J,Ce=_e.customDepthMaterial;if(Me&&(we=ee,Ce=_e.customDistanceMaterial),!Ce){var Ae=void 0!==Ee.morphTargets&&0<Ee.morphTargets.length&&Se.morphTargets,Pe=_e instanceof C.SkinnedMesh&&Se.skinning,Re=0;Ae&&(Re|=Z),Pe&&(Re|=K),Le=we[Re]}else Le=Ce;if(A.localClippingEnabled&&!0===Se.clipShadows&&0!==Se.clippingPlanes.length){var De=Le.uuid,Ie=Se.uuid,Be=oe[De];void 0===Be&&(Be={},oe[De]=Be);var Ne=Be[Ie];void 0===Ne&&(Ne=Le.clone(),Be[Ie]=Ne),Le=Ne}return Le.visible=Se.visible,Le.wireframe=Se.wireframe,Le.side=Se.side,Le.clipShadows=Se.clipShadows,Le.clippingPlanes=Se.clippingPlanes,Le.wireframeLinewidth=Se.wireframeLinewidth,Le.linewidth=Se.linewidth,Me&&void 0!==Le.uniforms.lightPos&&Le.uniforms.lightPos.value.copy(Te),Le}function I(_e,Se,Me){if(!1!==_e.visible){if(_e.layers.test(Se.layers)&&(_e instanceof C.Mesh||_e instanceof C.Line||_e instanceof C.Points)&&_e.castShadow&&(!1===_e.frustumCulled||!0===V.intersectsObject(_e))){var Te=_e.material;!0===Te.visible&&(_e.modelViewMatrix.multiplyMatrices(Me.matrixWorldInverse,_e.matrixWorld),Y.push(_e))}for(var Ee=_e.children,Le=0,we=Ee.length;Le<we;Le++)I(Ee[Le],Se,Me)}}var U=A.context,F=A.state,V=new C.Frustum,G=new C.Matrix4,O=P.shadows,H=new C.Vector2,W=new C.Vector3,X=new C.Vector3,Y=[],Z=1,K=2,J=[,,,,],ee=[,,,,],oe={},ne=[new C.Vector3(1,0,0),new C.Vector3(-1,0,0),new C.Vector3(0,0,1),new C.Vector3(0,0,-1),new C.Vector3(0,1,0),new C.Vector3(0,-1,0)],ie=[new C.Vector3(0,1,0),new C.Vector3(0,1,0),new C.Vector3(0,1,0),new C.Vector3(0,1,0),new C.Vector3(0,0,1),new C.Vector3(0,0,-1)],se=[new C.Vector4,new C.Vector4,new C.Vector4,new C.Vector4,new C.Vector4,new C.Vector4],le=new C.MeshDepthMaterial;le.depthPacking=C.RGBADepthPacking,le.clipping=!0;for(var pe=C.ShaderLib.distanceRGBA,ue=C.UniformsUtils.clone(pe.uniforms),ge=0;ge!==(Z|K)+1;++ge){var fe=0!=(ge&Z),he=0!=(ge&K),ye=le.clone();ye.morphTargets=fe,ye.skinning=he,J[ge]=ye;var xe=new C.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:ue,vertexShader:pe.vertexShader,fragmentShader:pe.fragmentShader,morphTargets:fe,skinning:he,clipping:!0});ee[ge]=xe}var ve=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=C.PCFShadowMap,this.cullFace=C.CullFaceFront,this.render=function(_e,Se){if(!1!==ve.enabled&&(!1!==ve.autoUpdate||!1!==ve.needsUpdate)&&0!==O.length){F.clearColor(1,1,1,1),F.disable(U.BLEND),F.enable(U.CULL_FACE),U.frontFace(U.CCW),U.cullFace(ve.cullFace===C.CullFaceFront?U.FRONT:U.BACK),F.setDepthTest(!0),F.setScissorTest(!1);for(var Ee=0,Le=O.length,Me,Te;Ee<Le;Ee++){var we=O[Ee],Ce=we.shadow,Ae=Ce.camera;if(H.copy(Ce.mapSize),we instanceof C.PointLight){Me=6,Te=!0;var Pe=H.x,Re=H.y;se[0].set(2*Pe,Re,Pe,Re),se[1].set(0,Re,Pe,Re),se[2].set(3*Pe,Re,Pe,Re),se[3].set(Pe,Re,Pe,Re),se[4].set(3*Pe,0,Pe,Re),se[5].set(Pe,0,Pe,Re),H.x*=4,H.y*=2}else Me=1,Te=!1;if(null===Ce.map){var De={minFilter:C.NearestFilter,magFilter:C.NearestFilter,format:C.RGBAFormat};Ce.map=new C.WebGLRenderTarget(H.x,H.y,De),Ae.updateProjectionMatrix()}Ce instanceof C.SpotLightShadow&&Ce.update(we);var Ie=Ce.map,Be=Ce.matrix;X.setFromMatrixPosition(we.matrixWorld),Ae.position.copy(X),A.setRenderTarget(Ie),A.clear();for(var Ne=0;Ne<Me;Ne++){if(Te){W.copy(Ae.position),W.add(ne[Ne]),Ae.up.copy(ie[Ne]),Ae.lookAt(W);var Ue=se[Ne];F.viewport(Ue)}else W.setFromMatrixPosition(we.target.matrixWorld),Ae.lookAt(W);Ae.updateMatrixWorld(),Ae.matrixWorldInverse.getInverse(Ae.matrixWorld),Be.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),Be.multiply(Ae.projectionMatrix),Be.multiply(Ae.matrixWorldInverse),G.multiplyMatrices(Ae.projectionMatrix,Ae.matrixWorldInverse),V.setFromMatrix(G),Y.length=0,I(_e,Se,Ae);for(var Fe=0,Ve=Y.length;Fe<Ve;Fe++){var Ge=Y[Fe],ke=R.update(Ge),ze=Ge.material;if(ze instanceof C.MultiMaterial)for(var Oe=ke.groups,He=ze.materials,je=0,We=Oe.length;je<We;je++){var qe=Oe[je],Xe=He[qe.materialIndex];if(!0===Xe.visible){var Ye=D(Ge,Xe,Te,X);A.renderBufferDirect(Ae,null,ke,Ye,Ge,qe)}}else{var Ye=D(Ge,ze,Te,X);A.renderBufferDirect(Ae,null,ke,Ye,Ge,null)}}}}var Ze=A.getClearColor(),Ke=A.getClearAlpha();A.setClearColor(Ze,Ke),F.enable(U.BLEND),ve.cullFace===C.CullFaceFront&&U.cullFace(U.BACK),ve.needsUpdate=!1}}},C.WebGLState=function(A,P,R){var D=this,I=new C.Vector4,U=A.getParameter(A.MAX_VERTEX_ATTRIBS),F=new Uint8Array(U),V=new Uint8Array(U),G=new Uint8Array(U),O={},H=null,W=null,X=null,Y=null,Z=null,K=null,Q=null,J=null,ee=!1,oe=null,ne=null,ie=null,se=null,le=null,pe=null,ue=null,ge=null,fe=null,he=null,ye=null,xe=null,ve=null,_e=null,Se=null,Me=A.getParameter(A.MAX_TEXTURE_IMAGE_UNITS),Te,Ee={},Le=new C.Vector4,we=null,Ce=null,Ae=new C.Vector4,Pe=new C.Vector4;this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL),A.frontFace(A.CCW),A.cullFace(A.BACK),this.enable(A.CULL_FACE),this.enable(A.BLEND),A.blendEquation(A.FUNC_ADD),A.blendFunc(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var Re=0,De=F.length;Re<De;Re++)F[Re]=0},this.enableAttribute=function(Re){if(F[Re]=1,0===V[Re]&&(A.enableVertexAttribArray(Re),V[Re]=1),0!==G[Re]){var De=P.get("ANGLE_instanced_arrays");De.vertexAttribDivisorANGLE(Re,0),G[Re]=0}},this.enableAttributeAndDivisor=function(Re,De,Ie){F[Re]=1,0===V[Re]&&(A.enableVertexAttribArray(Re),V[Re]=1),G[Re]!==De&&(Ie.vertexAttribDivisorANGLE(Re,De),G[Re]=De)},this.disableUnusedAttributes=function(){for(var Re=0,De=V.length;Re<De;Re++)V[Re]!==F[Re]&&(A.disableVertexAttribArray(Re),V[Re]=0)},this.enable=function(Re){!0!==O[Re]&&(A.enable(Re),O[Re]=!0)},this.disable=function(Re){!1!==O[Re]&&(A.disable(Re),O[Re]=!1)},this.getCompressedTextureFormats=function(){if(null==H&&(H=[],P.get("WEBGL_compressed_texture_pvrtc")||P.get("WEBGL_compressed_texture_s3tc")||P.get("WEBGL_compressed_texture_etc1")))for(var Re=A.getParameter(A.COMPRESSED_TEXTURE_FORMATS),De=0;De<Re.length;De++)H.push(Re[De]);return H},this.setBlending=function(Re,De,Ie,Be,Ne,Ue,Fe,Ve){Re===C.NoBlending?this.disable(A.BLEND):this.enable(A.BLEND),(Re!==W||Ve!==ee)&&(Re===C.AdditiveBlending?Ve?(A.blendEquationSeparate(A.FUNC_ADD,A.FUNC_ADD),A.blendFuncSeparate(A.ONE,A.ONE,A.ONE,A.ONE)):(A.blendEquation(A.FUNC_ADD),A.blendFunc(A.SRC_ALPHA,A.ONE)):Re===C.SubtractiveBlending?Ve?(A.blendEquationSeparate(A.FUNC_ADD,A.FUNC_ADD),A.blendFuncSeparate(A.ZERO,A.ZERO,A.ONE_MINUS_SRC_COLOR,A.ONE_MINUS_SRC_ALPHA)):(A.blendEquation(A.FUNC_ADD),A.blendFunc(A.ZERO,A.ONE_MINUS_SRC_COLOR)):Re===C.MultiplyBlending?Ve?(A.blendEquationSeparate(A.FUNC_ADD,A.FUNC_ADD),A.blendFuncSeparate(A.ZERO,A.ZERO,A.SRC_COLOR,A.SRC_ALPHA)):(A.blendEquation(A.FUNC_ADD),A.blendFunc(A.ZERO,A.SRC_COLOR)):Ve?(A.blendEquationSeparate(A.FUNC_ADD,A.FUNC_ADD),A.blendFuncSeparate(A.ONE,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA)):(A.blendEquationSeparate(A.FUNC_ADD,A.FUNC_ADD),A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA)),W=Re,ee=Ve),Re===C.CustomBlending?(Ne=Ne||De,Ue=Ue||Ie,Fe=Fe||Be,(De!==X||Ne!==K)&&(A.blendEquationSeparate(R(De),R(Ne)),X=De,K=Ne),(Ie!==Y||Be!==Z||Ue!==Q||Fe!==J)&&(A.blendFuncSeparate(R(Ie),R(Be),R(Ue),R(Fe)),Y=Ie,Z=Be,Q=Ue,J=Fe)):(X=null,Y=null,Z=null,K=null,Q=null,J=null)},this.setDepthFunc=function(Re){oe!==Re&&(Re?Re===C.NeverDepth?A.depthFunc(A.NEVER):Re===C.AlwaysDepth?A.depthFunc(A.ALWAYS):Re===C.LessDepth?A.depthFunc(A.LESS):Re===C.LessEqualDepth?A.depthFunc(A.LEQUAL):Re===C.EqualDepth?A.depthFunc(A.EQUAL):Re===C.GreaterEqualDepth?A.depthFunc(A.GEQUAL):Re===C.GreaterDepth?A.depthFunc(A.GREATER):Re===C.NotEqualDepth?A.depthFunc(A.NOTEQUAL):A.depthFunc(A.LEQUAL):A.depthFunc(A.LEQUAL),oe=Re)},this.setDepthTest=function(Re){Re?this.enable(A.DEPTH_TEST):this.disable(A.DEPTH_TEST)},this.setDepthWrite=function(Re){ne!==Re&&(A.depthMask(Re),ne=Re)},this.setColorWrite=function(Re){ie!==Re&&(A.colorMask(Re,Re,Re,Re),ie=Re)},this.setStencilFunc=function(Re,De,Ie){(le!==Re||pe!==De||ue!==Ie)&&(A.stencilFunc(Re,De,Ie),le=Re,pe=De,ue=Ie)},this.setStencilOp=function(Re,De,Ie){(ge!==Re||fe!==De||he!==Ie)&&(A.stencilOp(Re,De,Ie),ge=Re,fe=De,he=Ie)},this.setStencilTest=function(Re){Re?this.enable(A.STENCIL_TEST):this.disable(A.STENCIL_TEST)},this.setStencilWrite=function(Re){se!==Re&&(A.stencilMask(Re),se=Re)},this.setFlipSided=function(Re){ye!==Re&&(Re?A.frontFace(A.CW):A.frontFace(A.CCW),ye=Re)},this.setLineWidth=function(Re){Re!==xe&&(A.lineWidth(Re),xe=Re)},this.setPolygonOffset=function(Re,De,Ie){Re?this.enable(A.POLYGON_OFFSET_FILL):this.disable(A.POLYGON_OFFSET_FILL),Re&&(ve!==De||_e!==Ie)&&(A.polygonOffset(De,Ie),ve=De,_e=Ie)},this.getScissorTest=function(){return Se},this.setScissorTest=function(Re){Se=Re,Re?this.enable(A.SCISSOR_TEST):this.disable(A.SCISSOR_TEST)},this.activeTexture=function(Re){Re===void 0&&(Re=A.TEXTURE0+Me-1),Te!==Re&&(A.activeTexture(Re),Te=Re)},this.bindTexture=function(Re,De){Te===void 0&&D.activeTexture();var Ie=Ee[Te];Ie===void 0&&(Ie={type:void 0,texture:void 0},Ee[Te]=Ie),(Ie.type!==Re||Ie.texture!==De)&&(A.bindTexture(Re,De),Ie.type=Re,Ie.texture=De)},this.compressedTexImage2D=function(){try{A.compressedTexImage2D.apply(A,arguments)}catch(Re){console.error(Re)}},this.texImage2D=function(){try{A.texImage2D.apply(A,arguments)}catch(Re){console.error(Re)}},this.clearColor=function(Re,De,Ie,Be){I.set(Re,De,Ie,Be),!1===Le.equals(I)&&(A.clearColor(Re,De,Ie,Be),Le.copy(I))},this.clearDepth=function(Re){we!==Re&&(A.clearDepth(Re),we=Re)},this.clearStencil=function(Re){Ce!==Re&&(A.clearStencil(Re),Ce=Re)},this.scissor=function(Re){!1===Ae.equals(Re)&&(A.scissor(Re.x,Re.y,Re.z,Re.w),Ae.copy(Re))},this.viewport=function(Re){!1===Pe.equals(Re)&&(A.viewport(Re.x,Re.y,Re.z,Re.w),Pe.copy(Re))},this.reset=function(){for(var Re=0;Re<V.length;Re++)1===V[Re]&&(A.disableVertexAttribArray(Re),V[Re]=0);O={},H=null,Te=void 0,Ee={},W=null,ie=null,ne=null,se=null,ye=null}},C.WebGLUniforms=function(){var A=function(){this.seq=[],this.map={}},P=[],R=[],I=function(we,Ce,Ae){var Pe=we[0];if(0>=Pe||0<Pe)return we;var Re=Ce*Ae,De=P[Re];if(void 0===De&&(De=new Float32Array(Re),P[Re]=De),0!==Ce){Pe.toArray(De,0);for(var Ie=1,Be=0;Ie!==Ce;++Ie)Be+=Ae,we[Ie].toArray(De,Be)}return De},U=function(we,Ce){var Ae=R[Ce];void 0===Ae&&(Ae=new Int32Array(Ce),R[Ce]=Ae);for(var Pe=0;Pe!==Ce;++Pe)Ae[Pe]=we.allocTextureUnit();return Ae},F=function(we,Ce){we.uniform1f(this.addr,Ce)},V=function(we,Ce){we.uniform1i(this.addr,Ce)},G=function(we,Ce){void 0===Ce.x?we.uniform2fv(this.addr,Ce):we.uniform2f(this.addr,Ce.x,Ce.y)},O=function(we,Ce){void 0===Ce.x?void 0===Ce.r?we.uniform3fv(this.addr,Ce):we.uniform3f(this.addr,Ce.r,Ce.g,Ce.b):we.uniform3f(this.addr,Ce.x,Ce.y,Ce.z)},H=function(we,Ce){void 0===Ce.x?we.uniform4fv(this.addr,Ce):we.uniform4f(this.addr,Ce.x,Ce.y,Ce.z,Ce.w)},W=function(we,Ce){we.uniformMatrix2fv(this.addr,!1,Ce.elements||Ce)},X=function(we,Ce){we.uniformMatrix3fv(this.addr,!1,Ce.elements||Ce)},Y=function(we,Ce){we.uniformMatrix4fv(this.addr,!1,Ce.elements||Ce)},Z=function(we,Ce,Ae){var Pe=Ae.allocTextureUnit();we.uniform1i(this.addr,Pe),Ce&&Ae.setTexture2D(Ce,Pe)},K=function(we,Ce,Ae){var Pe=Ae.allocTextureUnit();we.uniform1i(this.addr,Pe),Ce&&Ae.setTextureCube(Ce,Pe)},Q=function(we,Ce){we.uniform2iv(this.addr,Ce)},J=function(we,Ce){we.uniform3iv(this.addr,Ce)},ee=function(we,Ce){we.uniform4iv(this.addr,Ce)},oe=function(we){return 5126===we?F:35664===we?G:35665===we?O:35666===we?H:35674===we?W:35675===we?X:35676===we?Y:35678===we?Z:35680===we?K:5124===we||35670===we?V:35667===we||35671===we?Q:35668===we||35672===we?J:35669===we||35673===we?ee:void 0},ne=function(we,Ce){we.uniform1fv(this.addr,Ce)},ie=function(we,Ce){we.uniform1iv(this.addr,Ce)},se=function(we,Ce){we.uniform2fv(this.addr,I(Ce,this.size,2))},le=function(we,Ce){we.uniform3fv(this.addr,I(Ce,this.size,3))},pe=function(we,Ce){we.uniform4fv(this.addr,I(Ce,this.size,4))},ue=function(we,Ce){we.uniformMatrix2fv(this.addr,!1,I(Ce,this.size,4))},ge=function(we,Ce){we.uniformMatrix3fv(this.addr,!1,I(Ce,this.size,9))},fe=function(we,Ce){we.uniformMatrix4fv(this.addr,!1,I(Ce,this.size,16))},he=function(we,Ce,Ae){var Pe=Ce.length,Re=U(Ae,Pe);we.uniform1iv(this.addr,Re);for(var De=0,Ie;De!==Pe;++De)Ie=Ce[De],Ie&&Ae.setTexture2D(Ie,Re[De])},ye=function(we,Ce,Ae){var Pe=Ce.length,Re=U(Ae,Pe);we.uniform1iv(this.addr,Re);for(var De=0,Ie;De!==Pe;++De)Ie=Ce[De],Ie&&Ae.setTextureCube(Ie,Re[De])},xe=function(we){return 5126===we?ne:35664===we?se:35665===we?le:35666===we?pe:35674===we?ue:35675===we?ge:35676===we?fe:35678===we?he:35680===we?ye:5124===we||35670===we?ie:35667===we||35671===we?Q:35668===we||35672===we?J:35669===we||35673===we?ee:void 0},ve=function(Ce,Ae,Pe){this.id=Ce,this.addr=Pe,this.setValue=oe(Ae.type)},_e=function(we,Ce,Ae){this.id=we,this.addr=Ae,this.size=Ce.size,this.setValue=xe(Ce.type)},Se=function(we){this.id=we,A.call(this)};Se.prototype.setValue=function(we,Ce){for(var Ae=this.seq,Pe=0,Re=Ae.length,De;Pe!==Re;++Pe)De=Ae[Pe],De.setValue(we,Ce[De.id])};var Me=/([\w\d_]+)(\])?(\[|\.)?/g,Te=function(we,Ce){we.seq.push(Ce),we.map[Ce.id]=Ce},Ee=function(we,Ce,Ae){var Pe=we.name,Re=Pe.length;for(Me.lastIndex=0;;){var De=Me.exec(Pe),Ie=Me.lastIndex,Be=De[1],Ne="]"===De[2],Ue=De[3];if(Ne&&(Be|=0),void 0===Ue||"["===Ue&&Ie+2===Re){Te(Ae,void 0===Ue?new ve(Be,we,Ce):new _e(Be,we,Ce));break}else{var Fe=Ae.map,Ve=Fe[Be];void 0===Ve&&(Ve=new Se(Be),Te(Ae,Ve)),Ae=Ve}}},Le=function(Ce,Ae,Pe){A.call(this),this.renderer=Pe;for(var Re=Ce.getProgramParameter(Ae,Ce.ACTIVE_UNIFORMS),De=0;De!==Re;++De){var Ie=Ce.getActiveUniform(Ae,De),Be=Ie.name,Ne=Ce.getUniformLocation(Ae,Be);Ee(Ie,Ne,this)}};return Le.prototype.setValue=function(we,Ce,Ae){var Pe=this.map[Ce];void 0!==Pe&&Pe.setValue(we,Ae,this.renderer)},Le.prototype.set=function(we,Ce,Ae){var Pe=this.map[Ae];void 0!==Pe&&Pe.setValue(we,Ce[Ae],this.renderer)},Le.prototype.setOptional=function(we,Ce,Ae){var Pe=Ce[Ae];void 0!==Pe&&this.setValue(we,Ae,Pe)},Le.upload=function(we,Ce,Ae,Pe){for(var Re=0,De=Ce.length;Re!==De;++Re){var Ie=Ce[Re],Be=Ae[Ie.id];!1!==Be.needsUpdate&&Ie.setValue(we,Be.value,Pe)}},Le.seqWithValue=function(we,Ce){for(var Ae=[],Pe=0,Re=we.length,De;Pe!==Re;++Pe)De=we[Pe],De.id in Ce&&Ae.push(De);return Ae},Le.splitDynamic=function(we,Ce){for(var Ae=null,Pe=we.length,Re=0,De=0;De!==Pe;++De){var Ie=we[De],Be=Ce[Ie.id];Be&&!0===Be.dynamic?(null==Ae&&(Ae=[]),Ae.push(Ie)):(Re<De&&(we[Re]=Ie),++Re)}return Re<Pe&&(we.length=Re),Ae},Le.evalDynamic=function(we,Ce,Ae,Pe){for(var Re=0,De=we.length;Re!==De;++Re){var Ie=Ce[we[Re].id],Be=Ie.onUpdateCallback;void 0!==Be&&Be.call(Ie,Ae,Pe)}},Le}(),C.LensFlarePlugin=function(A,P){function R(){var Z=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),K=new Uint16Array([0,1,2,0,2,3]);F=I.createBuffer(),V=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,F),I.bufferData(I.ARRAY_BUFFER,Z,I.STATIC_DRAW),I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,V),I.bufferData(I.ELEMENT_ARRAY_BUFFER,K,I.STATIC_DRAW),X=I.createTexture(),Y=I.createTexture(),U.bindTexture(I.TEXTURE_2D,X),I.texImage2D(I.TEXTURE_2D,0,I.RGB,16,16,0,I.RGB,I.UNSIGNED_BYTE,null),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.NEAREST),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.NEAREST),U.bindTexture(I.TEXTURE_2D,Y),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,16,16,0,I.RGBA,I.UNSIGNED_BYTE,null),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.NEAREST),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.NEAREST),G={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},O=D(G),H={vertex:I.getAttribLocation(O,"position"),uv:I.getAttribLocation(O,"uv")},W={renderType:I.getUniformLocation(O,"renderType"),map:I.getUniformLocation(O,"map"),occlusionMap:I.getUniformLocation(O,"occlusionMap"),opacity:I.getUniformLocation(O,"opacity"),color:I.getUniformLocation(O,"color"),scale:I.getUniformLocation(O,"scale"),rotation:I.getUniformLocation(O,"rotation"),screenPosition:I.getUniformLocation(O,"screenPosition")}}function D(Z){var K=I.createProgram(),Q=I.createShader(I.FRAGMENT_SHADER),J=I.createShader(I.VERTEX_SHADER),ee="precision "+A.getPrecision()+" float;\n";return I.shaderSource(Q,ee+Z.fragmentShader),I.shaderSource(J,ee+Z.vertexShader),I.compileShader(Q),I.compileShader(J),I.attachShader(K,Q),I.attachShader(K,J),I.linkProgram(K),K}var I=A.context,U=A.state,F,V,G,O,H,W,X,Y;this.render=function(Z,K,Q){if(0!==P.length){var J=new C.Vector3,ee=Q.w/Q.z,oe=0.5*Q.z,ne=0.5*Q.w,ie=16/Q.w,se=new C.Vector2(ie*ee,ie),le=new C.Vector3(1,1,0),pe=new C.Vector2(1,1),ue=new C.Box2;ue.min.set(0,0),ue.max.set(Q.z-16,Q.w-16),void 0===O&&R(),I.useProgram(O),U.initAttributes(),U.enableAttribute(H.vertex),U.enableAttribute(H.uv),U.disableUnusedAttributes(),I.uniform1i(W.occlusionMap,0),I.uniform1i(W.map,1),I.bindBuffer(I.ARRAY_BUFFER,F),I.vertexAttribPointer(H.vertex,2,I.FLOAT,!1,16,0),I.vertexAttribPointer(H.uv,2,I.FLOAT,!1,16,8),I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,V),U.disable(I.CULL_FACE),U.setDepthWrite(!1);for(var ge=0,fe=P.length;ge<fe;ge++){ie=16/Q.w,se.set(ie*ee,ie);var he=P[ge];if(J.set(he.matrixWorld.elements[12],he.matrixWorld.elements[13],he.matrixWorld.elements[14]),J.applyMatrix4(K.matrixWorldInverse),J.applyProjection(K.projectionMatrix),le.copy(J),pe.x=Q.x+le.x*oe+oe-8,pe.y=Q.y+le.y*ne+ne-8,!0===ue.containsPoint(pe)){U.activeTexture(I.TEXTURE0),U.bindTexture(I.TEXTURE_2D,null),U.activeTexture(I.TEXTURE1),U.bindTexture(I.TEXTURE_2D,X),I.copyTexImage2D(I.TEXTURE_2D,0,I.RGB,pe.x,pe.y,16,16,0),I.uniform1i(W.renderType,0),I.uniform2f(W.scale,se.x,se.y),I.uniform3f(W.screenPosition,le.x,le.y,le.z),U.disable(I.BLEND),U.enable(I.DEPTH_TEST),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0),U.activeTexture(I.TEXTURE0),U.bindTexture(I.TEXTURE_2D,Y),I.copyTexImage2D(I.TEXTURE_2D,0,I.RGBA,pe.x,pe.y,16,16,0),I.uniform1i(W.renderType,1),U.disable(I.DEPTH_TEST),U.activeTexture(I.TEXTURE1),U.bindTexture(I.TEXTURE_2D,X),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0),he.positionScreen.copy(le),he.customUpdateCallback?he.customUpdateCallback(he):he.updateLensFlares(),I.uniform1i(W.renderType,2),U.enable(I.BLEND);for(var ye=0,xe=he.lensFlares.length,ve;ye<xe;ye++)ve=he.lensFlares[ye],1e-3<ve.opacity&&1e-3<ve.scale&&(le.x=ve.x,le.y=ve.y,le.z=ve.z,ie=ve.size*ve.scale/Q.w,se.x=ie*ee,se.y=ie,I.uniform3f(W.screenPosition,le.x,le.y,le.z),I.uniform2f(W.scale,se.x,se.y),I.uniform1f(W.rotation,ve.rotation),I.uniform1f(W.opacity,ve.opacity),I.uniform3f(W.color,ve.color.r,ve.color.g,ve.color.b),U.setBlending(ve.blending,ve.blendEquation,ve.blendSrc,ve.blendDst),A.setTexture2D(ve.texture,1),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0))}}U.enable(I.CULL_FACE),U.enable(I.DEPTH_TEST),U.setDepthWrite(!0),A.resetGLState()}}},C.SpritePlugin=function(A,P){function R(){var Q=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),J=new Uint16Array([0,1,2,0,2,3]);V=U.createBuffer(),G=U.createBuffer(),U.bindBuffer(U.ARRAY_BUFFER,V),U.bufferData(U.ARRAY_BUFFER,Q,U.STATIC_DRAW),U.bindBuffer(U.ELEMENT_ARRAY_BUFFER,G),U.bufferData(U.ELEMENT_ARRAY_BUFFER,J,U.STATIC_DRAW),O=D(),H={position:U.getAttribLocation(O,"position"),uv:U.getAttribLocation(O,"uv")},W={uvOffset:U.getUniformLocation(O,"uvOffset"),uvScale:U.getUniformLocation(O,"uvScale"),rotation:U.getUniformLocation(O,"rotation"),scale:U.getUniformLocation(O,"scale"),color:U.getUniformLocation(O,"color"),map:U.getUniformLocation(O,"map"),opacity:U.getUniformLocation(O,"opacity"),modelViewMatrix:U.getUniformLocation(O,"modelViewMatrix"),projectionMatrix:U.getUniformLocation(O,"projectionMatrix"),fogType:U.getUniformLocation(O,"fogType"),fogDensity:U.getUniformLocation(O,"fogDensity"),fogNear:U.getUniformLocation(O,"fogNear"),fogFar:U.getUniformLocation(O,"fogFar"),fogColor:U.getUniformLocation(O,"fogColor"),alphaTest:U.getUniformLocation(O,"alphaTest")};var ee=document.createElement("canvas");ee.width=8,ee.height=8;var oe=ee.getContext("2d");oe.fillStyle="white",oe.fillRect(0,0,8,8),X=new C.Texture(ee),X.needsUpdate=!0}function D(){var Q=U.createProgram(),J=U.createShader(U.VERTEX_SHADER),ee=U.createShader(U.FRAGMENT_SHADER);return U.shaderSource(J,["precision "+A.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),U.shaderSource(ee,["precision "+A.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),U.compileShader(J),U.compileShader(ee),U.attachShader(Q,J),U.attachShader(Q,ee),U.linkProgram(Q),Q}function I(Q,J){return Q.renderOrder===J.renderOrder?Q.z===J.z?J.id-Q.id:J.z-Q.z:Q.renderOrder-J.renderOrder}var U=A.context,F=A.state,V,G,O,H,W,X,Y=new C.Vector3,Z=new C.Quaternion,K=new C.Vector3;this.render=function(Q,J){if(0!==P.length){void 0===O&&R(),U.useProgram(O),F.initAttributes(),F.enableAttribute(H.position),F.enableAttribute(H.uv),F.disableUnusedAttributes(),F.disable(U.CULL_FACE),F.enable(U.BLEND),U.bindBuffer(U.ARRAY_BUFFER,V),U.vertexAttribPointer(H.position,2,U.FLOAT,!1,16,0),U.vertexAttribPointer(H.uv,2,U.FLOAT,!1,16,8),U.bindBuffer(U.ELEMENT_ARRAY_BUFFER,G),U.uniformMatrix4fv(W.projectionMatrix,!1,J.projectionMatrix.elements),F.activeTexture(U.TEXTURE0),U.uniform1i(W.map,0);var ee=0,oe=0,ne=Q.fog;ne?(U.uniform3f(W.fogColor,ne.color.r,ne.color.g,ne.color.b),ne instanceof C.Fog?(U.uniform1f(W.fogNear,ne.near),U.uniform1f(W.fogFar,ne.far),U.uniform1i(W.fogType,1),ee=1,oe=1):ne instanceof C.FogExp2&&(U.uniform1f(W.fogDensity,ne.density),U.uniform1i(W.fogType,2),ee=2,oe=2)):(U.uniform1i(W.fogType,0),ee=0,oe=0);for(var ie=0,se=P.length,le;ie<se;ie++)le=P[ie],le.modelViewMatrix.multiplyMatrices(J.matrixWorldInverse,le.matrixWorld),le.z=-le.modelViewMatrix.elements[14];P.sort(I);for(var pe=[],ie=0,se=P.length;ie<se;ie++){var le=P[ie],ue=le.material;U.uniform1f(W.alphaTest,ue.alphaTest),U.uniformMatrix4fv(W.modelViewMatrix,!1,le.modelViewMatrix.elements),le.matrixWorld.decompose(Y,Z,K),pe[0]=K.x,pe[1]=K.y;var ge=0;Q.fog&&ue.fog&&(ge=oe),ee!=ge&&(U.uniform1i(W.fogType,ge),ee=ge),null===ue.map?(U.uniform2f(W.uvOffset,0,0),U.uniform2f(W.uvScale,1,1)):(U.uniform2f(W.uvOffset,ue.map.offset.x,ue.map.offset.y),U.uniform2f(W.uvScale,ue.map.repeat.x,ue.map.repeat.y)),U.uniform1f(W.opacity,ue.opacity),U.uniform3f(W.color,ue.color.r,ue.color.g,ue.color.b),U.uniform1f(W.rotation,ue.rotation),U.uniform2fv(W.scale,pe),F.setBlending(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst),F.setDepthTest(ue.depthTest),F.setDepthWrite(ue.depthWrite),ue.map?A.setTexture2D(ue.map,0):A.setTexture2D(X,0),U.drawElements(U.TRIANGLES,6,U.UNSIGNED_SHORT,0)}F.enable(U.CULL_FACE),A.resetGLState()}}},Object.defineProperties(C.Box2.prototype,{empty:{value:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(A){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)}}}),Object.defineProperties(C.Box3.prototype,{empty:{value:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(A){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)}},isIntersectionSphere:{value:function(A){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(A)}}}),Object.defineProperties(C.Matrix3.prototype,{multiplyVector3:{value:function(A){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),A.applyMatrix3(this)}},multiplyVector3Array:{value:function(A){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(A)}}}),Object.defineProperties(C.Matrix4.prototype,{extractPosition:{value:function(A){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(A)}},setRotationFromQuaternion:{value:function(A){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(A)}},multiplyVector3:{value:function(A){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),A.applyProjection(this)}},multiplyVector4:{value:function(A){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)}},multiplyVector3Array:{value:function(A){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(A)}},rotateAxis:{value:function(A){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),A.transformDirection(this)}},crossVector:{value:function(A){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)}},translate:{value:function(){console.error("THREE.Matrix4: .translate() has been removed.")}},rotateX:{value:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")}},rotateY:{value:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")}},rotateZ:{value:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")}},rotateByAxis:{value:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}}),Object.defineProperties(C.Plane.prototype,{isIntersectionLine:{value:function(A){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(A)}}}),Object.defineProperties(C.Quaternion.prototype,{multiplyVector3:{value:function(A){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),A.applyQuaternion(this)}}}),Object.defineProperties(C.Ray.prototype,{isIntersectionBox:{value:function(A){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)}},isIntersectionPlane:{value:function(A){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(A)}},isIntersectionSphere:{value:function(A){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(A)}}}),Object.defineProperties(C.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")}},setEulerFromQuaternion:{value:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")}},getPositionFromMatrix:{value:function(A){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(A)}},getScaleFromMatrix:{value:function(A){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(A)}},getColumnFromMatrix:{value:function(A,P){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(A,P)}}}),C.Face4=function(A,P,R,D,I,U,F){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new C.Face3(A,P,R,I,U,F)},C.Vertex=function(A,P,R){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new C.Vector3(A,P,R)},Object.defineProperties(C.Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(A){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=A}},getChildByName:{value:function(A){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(A)}},renderDepth:{set:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")}},translate:{value:function(A,P){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(P,A)}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(C,{PointCloud:{value:function(A,P){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new C.Points(A,P)}},ParticleSystem:{value:function(A,P){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new C.Points(A,P)}}}),Object.defineProperties(C.Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(A){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=A}},shadowCameraLeft:{set:function(A){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=A}},shadowCameraRight:{set:function(A){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=A}},shadowCameraTop:{set:function(A){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=A}},shadowCameraBottom:{set:function(A){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=A}},shadowCameraNear:{set:function(A){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=A}},shadowCameraFar:{set:function(A){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=A}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(A){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=A}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(A){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=A}},shadowMapHeight:{set:function(A){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=A}}}),Object.defineProperties(C.BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.defineProperties(C.BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}},addIndex:{value:function(A){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(A)}},addDrawCall:{value:function(A,P,R){R!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(A,P)}},clearDrawCalls:{value:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()}},computeTangents:{value:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")}},computeOffsets:{value:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}}),Object.defineProperties(C.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new C.Color}}}),Object.defineProperties(C,{PointCloudMaterial:{value:function(A){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new C.PointsMaterial(A)}},ParticleBasicMaterial:{value:function(A){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new C.PointsMaterial(A)}},ParticleSystemMaterial:{value:function(A){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new C.PointsMaterial(A)}}}),Object.defineProperties(C.MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(C.ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(A){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=A}}}),Object.defineProperties(C.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(A){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(A)}},initMaterial:{value:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")}},addPrePlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")}},addPostPlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")}},updateShadowMap:{value:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(A){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=A}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(A){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=A}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(A){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=A}}}),Object.defineProperties(C.WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(A){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=A}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(A){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=A}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(A){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=A}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(A){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=A}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(A){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=A}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(A){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=A}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(A){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=A}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(A){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=A}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(A){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=A}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(A){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=A}}}),Object.defineProperties(C.Audio.prototype,{load:{value:function(A){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var P=this,R=new C.AudioLoader;return R.load(A,function(D){P.setBuffer(D)}),this}}}),C.GeometryUtils={merge:function(A,P,R){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var D;P instanceof C.Mesh&&(P.matrixAutoUpdate&&P.updateMatrix(),D=P.matrix,P=P.geometry),A.merge(P,D,R)},center:function(A){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),A.center()}},C.ImageUtils={crossOrigin:void 0,loadTexture:function(A,P,R,D){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var I=new C.TextureLoader;I.setCrossOrigin(this.crossOrigin);var U=I.load(A,R,void 0,D);return P&&(U.mapping=P),U},loadTextureCube:function(A,P,R,D){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var I=new C.CubeTextureLoader;I.setCrossOrigin(this.crossOrigin);var U=I.load(A,R,void 0,D);return P&&(U.mapping=P),U},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},C.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(A,P){console.warn("THREE.Projector: .projectVector() is now vector.project()."),A.project(P)},this.unprojectVector=function(A,P){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),A.unproject(P)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},C.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},C.MeshFaceMaterial=C.MultiMaterial,Object.defineProperties(C.LOD.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),C.CurveUtils={tangentQuadraticBezier:function(A,P,R,D){return 2*(1-A)*(R-P)+2*A*(D-R)},tangentCubicBezier:function(A,P,R,D,I){return-3*P*(1-A)*(1-A)+3*R*(1-A)*(1-A)-6*A*R*(1-A)+6*A*D*(1-A)-3*A*A*D+3*A*A*I},tangentSpline:function(A){return 6*A*A-6*A+(3*A*A-4*A+1)+(-6*A*A+6*A)+(3*A*A-2*A)},interpolate:function(A,P,R,D,I){var U=0.5*(R-A),F=0.5*(D-P),V=I*I;return(2*P-2*R+U+F)*(I*V)+(-3*P+3*R-2*U-F)*V+U*I+P}},C.SceneUtils={createMultiMaterialObject:function(A,P){for(var R=new C.Group,D=0,I=P.length;D<I;D++)R.add(new C.Mesh(A,P[D]));return R},detach:function(A,P,R){A.applyMatrix(P.matrixWorld),P.remove(A),R.add(A)},attach:function(A,P,R){var D=new C.Matrix4;D.getInverse(R.matrixWorld),A.applyMatrix(D),P.remove(A),R.add(A)}},C.ShapeUtils={area:function(A){for(var P=A.length,R=0,D=P-1,I=0;I<P;D=I++)R+=A[D].x*A[I].y-A[I].x*A[D].y;return 0.5*R},triangulate:function(){function A(P,R,D,I,U,F){var V,G,O,H,W,X,Y,Z,K;if(G=P[F[R]].x,O=P[F[R]].y,H=P[F[D]].x,W=P[F[D]].y,X=P[F[I]].x,Y=P[F[I]].y,_NumberEPSILON>(H-G)*(Y-O)-(W-O)*(X-G))return!1;var Q,J,ee,oe,ne,ie,se,le,pe,ue,ge,fe,he,ye,xe;for(Q=X-H,J=Y-W,ee=G-X,oe=O-Y,ne=H-G,ie=W-O,V=0;V<U;V++)if(Z=P[F[V]].x,K=P[F[V]].y,(Z!==G||K!==O)&&(Z!==H||K!==W)&&(Z!==X||K!==Y)&&(se=Z-G,le=K-O,pe=Z-H,ue=K-W,ge=Z-X,fe=K-Y,xe=Q*ue-J*pe,he=ne*le-ie*se,ye=ee*fe-oe*ge,xe>=-_NumberEPSILON&&ye>=-_NumberEPSILON&&he>=-_NumberEPSILON))return!1;return!0}return function(P,R){var D=P.length;if(3>D)return null;var I=[],U=[],F=[],V,G,O;if(0<C.ShapeUtils.area(P))for(G=0;G<D;G++)U[G]=G;else for(G=0;G<D;G++)U[G]=D-1-G;var H=D,W=2*H;for(G=H-1;2<H;){if(0>=W--)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),R?F:I;if(V=G,H<=V&&(V=0),G=V+1,H<=G&&(G=0),O=G+1,H<=O&&(O=0),A(P,V,G,O,H,U)){var X,Y,Z,K,Q;for(X=U[V],Y=U[G],Z=U[O],I.push([P[X],P[Y],P[Z]]),F.push([U[V],U[G],U[O]]),(K=G,Q=G+1);Q<H;K++,Q++)U[K]=U[Q];H--,W=2*H}}return R?F:I}}(),triangulateShape:function(A,P){function R(ee,oe,ne){return ee.x===oe.x?ee.y<oe.y?ee.y<=ne.y&&ne.y<=oe.y:oe.y<=ne.y&&ne.y<=ee.y:ee.x<oe.x?ee.x<=ne.x&&ne.x<=oe.x:oe.x<=ne.x&&ne.x<=ee.x}function D(ee,oe,ne,ie,se){var le=oe.x-ee.x,pe=oe.y-ee.y,ue=ie.x-ne.x,ge=ie.y-ne.y,fe=ee.x-ne.x,he=ee.y-ne.y,ye=pe*ue-le*ge,xe=pe*fe-le*he;if(_Mathabs(ye)>_NumberEPSILON){var ve;if(0<ye){if(0>xe||xe>ye)return[];if(ve=ge*fe-ue*he,0>ve||ve>ye)return[]}else{if(0<xe||xe<ye)return[];if(ve=ge*fe-ue*he,0<ve||ve<ye)return[]}if(0===ve)return se&&(0==xe||xe==ye)?[]:[ee];if(ve===ye)return se&&(0==xe||xe==ye)?[]:[oe];if(0==xe)return[ne];if(xe==ye)return[ie];var _e=ve/ye;return[{x:ee.x+_e*le,y:ee.y+_e*pe}]}if(0!=xe||ge*fe!=ue*he)return[];var Se=0==le&&0==pe,Me=0==ue&&0==ge;if(Se&&Me)return ee.x!==ne.x||ee.y!==ne.y?[]:[ee];if(Se)return R(ne,ie,ee)?[ee]:[];if(Me)return R(ee,oe,ne)?[ne]:[];var Te,Ee,Le,we,Ce,Ae,Pe,Re;return 0==le?(ee.y<oe.y?(Te=ee,Le=ee.y,Ee=oe,we=oe.y):(Te=oe,Le=oe.y,Ee=ee,we=ee.y),ne.y<ie.y?(Ce=ne,Pe=ne.y,Ae=ie,Re=ie.y):(Ce=ie,Pe=ie.y,Ae=ne,Re=ne.y)):(ee.x<oe.x?(Te=ee,Le=ee.x,Ee=oe,we=oe.x):(Te=oe,Le=oe.x,Ee=ee,we=ee.x),ne.x<ie.x?(Ce=ne,Pe=ne.x,Ae=ie,Re=ie.x):(Ce=ie,Pe=ie.x,Ae=ne,Re=ne.x)),Le<=Pe?we<Pe?[]:we===Pe?se?[]:[Ce]:we<=Re?[Ce,Ee]:[Ce,Ae]:Le>Re?[]:Le===Re?se?[]:[Te]:we<=Re?[Te,Ee]:[Te,Ae]}function I(ee,oe,ne,ie){var se=oe.x-ee.x,le=oe.y-ee.y,pe=ne.x-ee.x,ue=ne.y-ee.y,ge=ie.x-ee.x,fe=ie.y-ee.y,he=se*ue-le*pe,ye=se*fe-le*ge;if(_Mathabs(he)>_NumberEPSILON){var xe=ge*ue-fe*pe;return 0<he?0<=ye&&0<=xe:0<=ye||0<=xe}return 0<ye}for(var X={},Y=A.concat(),Z=0,K=P.length,F,V,G,O,H,W;Z<K;Z++)Array.prototype.push.apply(Y,P[Z]);for(F=0,V=Y.length;F<V;F++)H=Y[F].x+":"+Y[F].y,void 0!==X[H]&&console.warn("THREE.Shape: Duplicate point",H),X[H]=F;var Q=function(ee,oe){function ne(Re,De){var Ie=le.length-1,Be=Re-1;0>Be&&(Be=Ie);var Ne=Re+1;Ne>Ie&&(Ne=0);var Ue=I(le[Re],le[Be],le[Ne],pe[De]);if(!Ue)return!1;var Fe=pe.length-1,Ve=De-1;0>Ve&&(Ve=Fe);var Ge=De+1;return Ge>Fe&&(Ge=0),Ue=I(pe[De],pe[Ve],pe[Ge],le[Re]),!!Ue}function ie(Re,De){var Ie,Be,Ne;for(Ie=0;Ie<le.length;Ie++)if(Be=Ie+1,Be%=le.length,Ne=D(Re,De,le[Ie],le[Be],!0),0<Ne.length)return!0;return!1}function se(Re,De){var Ie,Be,Ne,Ue,Fe;for(Ie=0;Ie<ue.length;Ie++)for(Be=oe[ue[Ie]],Ne=0;Ne<Be.length;Ne++)if(Ue=Ne+1,Ue%=Be.length,Fe=D(Re,De,Be[Ne],Be[Ue],!0),0<Fe.length)return!0;return!1}for(var le=ee.concat(),ue=[],_e=[],Le=0,we=oe.length,pe,ge,fe,he,ye,xe,ve,Se,Me,Te,Ee;Le<we;Le++)ue.push(Le);for(var Ce=0,Ae=2*ue.length;0<ue.length;){if(Ae--,0>Ae){console.log("Infinite Loop! Holes left:"+ue.length+", Probably Hole outside Shape!");break}for(fe=Ce;fe<le.length;fe++){he=le[fe],ge=-1;for(var Le=0;Le<ue.length;Le++)if(xe=ue[Le],ve=he.x+":"+he.y+":"+xe,void 0===_e[ve]){pe=oe[xe];for(var Pe=0;Pe<pe.length;Pe++)if(ye=pe[Pe],ne(fe,Pe)&&!ie(he,ye)&&!se(he,ye)){ge=Pe,ue.splice(Le,1),Se=le.slice(0,fe+1),Me=le.slice(fe),Te=pe.slice(ge),Ee=pe.slice(0,ge+1),le=Se.concat(Te).concat(Ee).concat(Me),Ce=fe;break}if(0<=ge)break;_e[ve]=!0}if(0<=ge)break}}return le}(A,P),J=C.ShapeUtils.triangulate(Q,!1);for(F=0,V=J.length;F<V;F++)for(O=J[F],G=0;3>G;G++)H=O[G].x+":"+O[G].y,W=X[H],void 0!==W&&(O[G]=W);return J.concat()},isClockWise:function(A){return 0>C.ShapeUtils.area(A)},b2:function(){function A(D,I){var U=1-D;return U*U*I}function P(D,I){return 2*(1-D)*D*I}function R(D,I){return D*D*I}return function(D,I,U,F){return A(D,I)+P(D,U)+R(D,F)}}(),b3:function(){function A(I,U){var F=1-I;return F*F*F*U}function P(I,U){var F=1-I;return 3*F*F*I*U}function R(I,U){return 3*(1-I)*I*I*U}function D(I,U){return I*I*I*U}return function(I,U,F,V,G){return A(I,U)+P(I,F)+R(I,V)+D(I,G)}}()},C.Curve=function(){},C.Curve.prototype={constructor:C.Curve,getPoint:function(){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(A){var P=this.getUtoTmapping(A);return this.getPoint(P)},getPoints:function(A){A||(A=5);var R=[],P;for(P=0;P<=A;P++)R.push(this.getPoint(P/A));return R},getSpacedPoints:function(A){A||(A=5);var R=[],P;for(P=0;P<=A;P++)R.push(this.getPointAt(P/A));return R},getLength:function(){var A=this.getLengths();return A[A.length-1]},getLengths:function(A){if(A||(A=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===A+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var P=[],D=this.getPoint(0),U=0,R,I;for(P.push(0),I=1;I<=A;I++)R=this.getPoint(I/A),U+=R.distanceTo(D),P.push(U),D=R;return this.cacheArcLengths=P,P},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(A,P){var R=this.getLengths(),D=0,I=R.length,U;U=P?P:A*R[I-1];for(var F=0,V=I-1,G;F<=V;)if(D=_Mathfloor(F+(V-F)/2),G=R[D]-U,0>G)F=D+1;else if(0<G)V=D-1;else{V=D;break}if(D=V,R[D]===U){var O=D/(I-1);return O}var H=R[D],W=R[D+1],Y=(U-H)/(W-H),O=(D+Y)/(I-1);return O},getTangent:function(A){var P=1e-4,R=A-P,D=A+P;0>R&&(R=0),1<D&&(D=1);var I=this.getPoint(R),U=this.getPoint(D),F=U.clone().sub(I);return F.normalize()},getTangentAt:function(A){var P=this.getUtoTmapping(A);return this.getTangent(P)}},C.Curve.create=function(A,P){return A.prototype=Object.create(C.Curve.prototype),A.prototype.constructor=A,A.prototype.getPoint=P,A},C.CurvePath=function(){this.curves=[],this.autoClose=!1},C.CurvePath.prototype=Object.create(C.Curve.prototype),C.CurvePath.prototype.constructor=C.CurvePath,C.CurvePath.prototype.add=function(A){this.curves.push(A)},C.CurvePath.prototype.closePath=function(){var A=this.curves[0].getPoint(0),P=this.curves[this.curves.length-1].getPoint(1);A.equals(P)||this.curves.push(new C.LineCurve(P,A))},C.CurvePath.prototype.getPoint=function(A){for(var P=A*this.getLength(),R=this.getCurveLengths(),D=0;D<R.length;){if(R[D]>=P){var I=R[D]-P,U=this.curves[D],F=1-I/U.getLength();return U.getPointAt(F)}D++}return null},C.CurvePath.prototype.getLength=function(){var A=this.getCurveLengths();return A[A.length-1]},C.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var A=[],P=0,R=0,D=this.curves.length;R<D;R++)P+=this.curves[R].getLength(),A.push(P);return this.cacheLengths=A,A},C.CurvePath.prototype.createPointsGeometry=function(A){var P=this.getPoints(A);return this.createGeometry(P)},C.CurvePath.prototype.createSpacedPointsGeometry=function(A){var P=this.getSpacedPoints(A);return this.createGeometry(P)},C.CurvePath.prototype.createGeometry=function(A){for(var P=new C.Geometry,R=0,D=A.length,I;R<D;R++)I=A[R],P.vertices.push(new C.Vector3(I.x,I.y,I.z||0));return P},C.Font=function(A){this.data=A},C.Font.prototype={constructor:C.Font,generateShapes:function(A,P,R){function D(H){for(var W=(H+"").split(""),X=P/U.resolution,Y=0,Z=[],K=0,Q;K<W.length;K++)Q=I(W[K],X,Y),Y+=Q.offset,Z.push(Q.path);return Z}function I(H,W,X){var Y=U.glyphs[H]||U.glyphs["?"];if(Y){var Z=new C.Path,K=[],Q=C.ShapeUtils.b2,J=C.ShapeUtils.b3,ee,oe,ne,ie,se,le,pe,ue,ge,fe,he;if(Y.o)for(var ye=Y._cachedOutline||(Y._cachedOutline=Y.o.split(" ")),xe=0,ve=ye.length,_e;xe<ve;)switch(_e=ye[xe++],_e){case"m":ee=ye[xe++]*W+X,oe=ye[xe++]*W,Z.moveTo(ee,oe);break;case"l":ee=ye[xe++]*W+X,oe=ye[xe++]*W,Z.lineTo(ee,oe);break;case"q":if(ne=ye[xe++]*W+X,ie=ye[xe++]*W,pe=ye[xe++]*W+X,ue=ye[xe++]*W,Z.quadraticCurveTo(pe,ue,ne,ie),he=K[K.length-1],he){se=he.x,le=he.y;for(var Se=1,Me;Se<=R;Se++)Me=Se/R,Q(Me,se,pe,ne),Q(Me,le,ue,ie)}break;case"b":if(ne=ye[xe++]*W+X,ie=ye[xe++]*W,pe=ye[xe++]*W+X,ue=ye[xe++]*W,ge=ye[xe++]*W+X,fe=ye[xe++]*W,Z.bezierCurveTo(pe,ue,ge,fe,ne,ie),he=K[K.length-1],he){se=he.x,le=he.y;for(var Se=1,Me;Se<=R;Se++)Me=Se/R,J(Me,se,pe,ge,ne),J(Me,le,ue,fe,ie)}}return{offset:Y.ha*W,path:Z}}}P===void 0&&(P=100),R===void 0&&(R=4);for(var U=this.data,F=D(A),V=[],G=0,O=F.length;G<O;G++)Array.prototype.push.apply(V,F[G].toShapes());return V}},C.Path=function(A){C.CurvePath.call(this),this.actions=[],A&&this.fromPoints(A)},C.Path.prototype=Object.create(C.CurvePath.prototype),C.Path.prototype.constructor=C.Path,C.Path.prototype.fromPoints=function(A){this.moveTo(A[0].x,A[0].y);for(var P=1,R=A.length;P<R;P++)this.lineTo(A[P].x,A[P].y)},C.Path.prototype.moveTo=function(A,P){this.actions.push({action:"moveTo",args:[A,P]})},C.Path.prototype.lineTo=function(A,P){var R=this.actions[this.actions.length-1].args,D=R[R.length-2],I=R[R.length-1],U=new C.LineCurve(new C.Vector2(D,I),new C.Vector2(A,P));this.curves.push(U),this.actions.push({action:"lineTo",args:[A,P]})},C.Path.prototype.quadraticCurveTo=function(A,P,R,D){var I=this.actions[this.actions.length-1].args,U=I[I.length-2],F=I[I.length-1],V=new C.QuadraticBezierCurve(new C.Vector2(U,F),new C.Vector2(A,P),new C.Vector2(R,D));this.curves.push(V),this.actions.push({action:"quadraticCurveTo",args:[A,P,R,D]})},C.Path.prototype.bezierCurveTo=function(A,P,R,D,I,U){var F=this.actions[this.actions.length-1].args,V=F[F.length-2],G=F[F.length-1],O=new C.CubicBezierCurve(new C.Vector2(V,G),new C.Vector2(A,P),new C.Vector2(R,D),new C.Vector2(I,U));this.curves.push(O),this.actions.push({action:"bezierCurveTo",args:[A,P,R,D,I,U]})},C.Path.prototype.splineThru=function(A){var P=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,D=R[R.length-2],I=R[R.length-1],U=[new C.Vector2(D,I)];Array.prototype.push.apply(U,A);var F=new C.SplineCurve(U);this.curves.push(F),this.actions.push({action:"splineThru",args:P})},C.Path.prototype.arc=function(A,P,R,D,I,U){var F=this.actions[this.actions.length-1].args,V=F[F.length-2],G=F[F.length-1];this.absarc(A+V,P+G,R,D,I,U)},C.Path.prototype.absarc=function(A,P,R,D,I,U){this.absellipse(A,P,R,R,D,I,U)},C.Path.prototype.ellipse=function(A,P,R,D,I,U,F,V){var G=this.actions[this.actions.length-1].args,O=G[G.length-2],H=G[G.length-1];this.absellipse(A+O,P+H,R,D,I,U,F,V)},C.Path.prototype.absellipse=function(A,P,R,D,I,U,F,V){var G=[A,P,R,D,I,U,F,V||0],O=new C.EllipseCurve(A,P,R,D,I,U,F,V);this.curves.push(O);var H=O.getPoint(1);G.push(H.x),G.push(H.y),this.actions.push({action:"ellipse",args:G})},C.Path.prototype.getSpacedPoints=function(A){A||(A=40);for(var P=[],R=0;R<A;R++)P.push(this.getPoint(R/A));return this.autoClose&&P.push(P[0]),P},C.Path.prototype.getPoints=function(A){A=A||12;for(var P=C.ShapeUtils.b2,R=C.ShapeUtils.b3,D=[],K=0,Q=this.actions.length,I,U,F,V,G,O,H,W,X,Y,Z;K<Q;K++){var J=this.actions[K],ee=J.action,oe=J.args;switch(ee){case"moveTo":D.push(new C.Vector2(oe[0],oe[1]));break;case"lineTo":D.push(new C.Vector2(oe[0],oe[1]));break;case"quadraticCurveTo":I=oe[2],U=oe[3],G=oe[0],O=oe[1],0<D.length?(X=D[D.length-1],H=X.x,W=X.y):(X=this.actions[K-1].args,H=X[X.length-2],W=X[X.length-1]);for(var ne=1,ie;ne<=A;ne++)ie=ne/A,Y=P(ie,H,G,I),Z=P(ie,W,O,U),D.push(new C.Vector2(Y,Z));break;case"bezierCurveTo":I=oe[4],U=oe[5],G=oe[0],O=oe[1],F=oe[2],V=oe[3],0<D.length?(X=D[D.length-1],H=X.x,W=X.y):(X=this.actions[K-1].args,H=X[X.length-2],W=X[X.length-1]);for(var ne=1,ie;ne<=A;ne++)ie=ne/A,Y=R(ie,H,G,F,I),Z=R(ie,W,O,V,U),D.push(new C.Vector2(Y,Z));break;case"splineThru":X=this.actions[K-1].args;var se=new C.Vector2(X[X.length-2],X[X.length-1]),le=[se],pe=A*oe[0].length;le=le.concat(oe[0]);for(var ue=new C.SplineCurve(le),ne=1;ne<=pe;ne++)D.push(ue.getPointAt(ne/pe));break;case"arc":for(var ge=oe[0],fe=oe[1],he=oe[2],ye=oe[3],xe=oe[4],ve=!!oe[5],_e=xe-ye,Me=2*A,ne=1,Se,ie;ne<=Me;ne++)ie=ne/Me,ve||(ie=1-ie),Se=ye+ie*_e,Y=ge+he*_Mathcos2(Se),Z=fe+he*_Mathsin2(Se),D.push(new C.Vector2(Y,Z));break;case"ellipse":var ge=oe[0],fe=oe[1],Te=oe[2],Ee=oe[3],ye=oe[4],xe=oe[5],ve=!!oe[6],Le=oe[7],_e=xe-ye,Me=2*A,Se,we,Ce;0!==Le&&(we=_Mathcos2(Le),Ce=_Mathsin2(Le));for(var ne=1,ie;ne<=Me;ne++){if(ie=ne/Me,ve||(ie=1-ie),Se=ye+ie*_e,Y=ge+Te*_Mathcos2(Se),Z=fe+Ee*_Mathsin2(Se),0!==Le){var Ae=Y,Pe=Z;Y=(Ae-ge)*we-(Pe-fe)*Ce+ge,Z=(Ae-ge)*Ce+(Pe-fe)*we+fe}D.push(new C.Vector2(Y,Z))}}}var Re=D[D.length-1];return _Mathabs(Re.x-D[0].x)<_NumberEPSILON&&_Mathabs(Re.y-D[0].y)<_NumberEPSILON&&D.splice(D.length-1,1),this.autoClose&&D.push(D[0]),D},C.Path.prototype.toShapes=function(A,P){function D(_e){for(var Se=[],Me=0,Te=_e.length;Me<Te;Me++){var Ee=_e[Me],Le=new C.Shape;Le.actions=Ee.actions,Le.curves=Ee.curves,Se.push(Le)}return Se}function I(_e,Se){for(var Me=Se.length,Te=!1,Ee=Me-1,Le=0;Le<Me;Ee=Le++){var we=Se[Ee],Ce=Se[Le],Ae=Ce.x-we.x,Pe=Ce.y-we.y;if(_Mathabs(Pe)>_NumberEPSILON){if(0>Pe&&(we=Se[Le],Ae=-Ae,Ce=Se[Ee],Pe=-Pe),_e.y<we.y||_e.y>Ce.y)continue;if(_e.y!==we.y){var Re=Pe*(_e.x-we.x)-Ae*(_e.y-we.y);if(0==Re)return!0;if(0>Re)continue;Te=!Te}else if(_e.x===we.x)return!0}else{if(_e.y!==we.y)continue;if(Ce.x<=_e.x&&_e.x<=we.x||we.x<=_e.x&&_e.x<=Ce.x)return!0}}return Te}var U=C.ShapeUtils.isClockWise,F=function(_e){for(var Se=[],Me=new C.Path,Te=0,Ee=_e.length;Te<Ee;Te++){var Le=_e[Te],we=Le.args,Ce=Le.action;"moveTo"===Ce&&0!==Me.actions.length&&(Se.push(Me),Me=new C.Path),Me[Ce].apply(Me,we)}return 0!==Me.actions.length&&Se.push(Me),Se}(this.actions);if(0===F.length)return[];if(!0===P)return D(F);var H=[],V,G,O;if(1===F.length)return G=F[0],O=new C.Shape,O.actions=G.actions,O.curves=G.curves,H.push(O),H;var W=!U(F[0].getPoints());W=A?!W:W;var X=[],Y=[],Z=[],K=0,Q;Y[K]=void 0,Z[K]=[];for(var J=0,ee=F.length;J<ee;J++)G=F[J],Q=G.getPoints(),V=U(Q),V=A?!V:V,V?(!W&&Y[K]&&K++,Y[K]={s:new C.Shape,p:Q},Y[K].s.actions=G.actions,Y[K].s.curves=G.curves,W&&K++,Z[K]=[]):Z[K].push({h:G,p:Q[0]});if(!Y[0])return D(F);if(1<Y.length){for(var oe=!1,ne=[],ie=0,se=Y.length;ie<se;ie++)X[ie]=[];for(var ie=0,se=Y.length,le;ie<se;ie++){le=Z[ie];for(var pe=0;pe<le.length;pe++){for(var ue=le[pe],ge=!0,fe=0;fe<Y.length;fe++)I(ue.p,Y[fe].p)&&(ie!==fe&&ne.push({froms:ie,tos:fe,hole:pe}),ge?(ge=!1,X[fe].push(ue)):oe=!0);ge&&X[ie].push(ue)}}0<ne.length&&!oe&&(Z=X)}for(var J=0,ye=Y.length,he;J<ye;J++){O=Y[J].s,H.push(O),he=Z[J];for(var xe=0,ve=he.length;xe<ve;xe++)O.holes.push(he[xe].h)}return H},C.Shape=function(){C.Path.apply(this,arguments),this.holes=[]},C.Shape.prototype=Object.create(C.Path.prototype),C.Shape.prototype.constructor=C.Shape,C.Shape.prototype.extrude=function(A){return new C.ExtrudeGeometry(this,A)},C.Shape.prototype.makeGeometry=function(A){return new C.ShapeGeometry(this,A)},C.Shape.prototype.getPointsHoles=function(A){for(var P=[],R=0,D=this.holes.length;R<D;R++)P[R]=this.holes[R].getPoints(A);return P},C.Shape.prototype.extractAllPoints=function(A){return{shape:this.getPoints(A),holes:this.getPointsHoles(A)}},C.Shape.prototype.extractPoints=function(A){return this.extractAllPoints(A)},C.LineCurve=function(A,P){this.v1=A,this.v2=P},C.LineCurve.prototype=Object.create(C.Curve.prototype),C.LineCurve.prototype.constructor=C.LineCurve,C.LineCurve.prototype.getPoint=function(A){var P=this.v2.clone().sub(this.v1);return P.multiplyScalar(A).add(this.v1),P},C.LineCurve.prototype.getPointAt=function(A){return this.getPoint(A)},C.LineCurve.prototype.getTangent=function(){var P=this.v2.clone().sub(this.v1);return P.normalize()},C.QuadraticBezierCurve=function(A,P,R){this.v0=A,this.v1=P,this.v2=R},C.QuadraticBezierCurve.prototype=Object.create(C.Curve.prototype),C.QuadraticBezierCurve.prototype.constructor=C.QuadraticBezierCurve,C.QuadraticBezierCurve.prototype.getPoint=function(A){var P=C.ShapeUtils.b2;return new C.Vector2(P(A,this.v0.x,this.v1.x,this.v2.x),P(A,this.v0.y,this.v1.y,this.v2.y))},C.QuadraticBezierCurve.prototype.getTangent=function(A){var P=C.CurveUtils.tangentQuadraticBezier;return new C.Vector2(P(A,this.v0.x,this.v1.x,this.v2.x),P(A,this.v0.y,this.v1.y,this.v2.y)).normalize()},C.CubicBezierCurve=function(A,P,R,D){this.v0=A,this.v1=P,this.v2=R,this.v3=D},C.CubicBezierCurve.prototype=Object.create(C.Curve.prototype),C.CubicBezierCurve.prototype.constructor=C.CubicBezierCurve,C.CubicBezierCurve.prototype.getPoint=function(A){var P=C.ShapeUtils.b3;return new C.Vector2(P(A,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P(A,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},C.CubicBezierCurve.prototype.getTangent=function(A){var P=C.CurveUtils.tangentCubicBezier;return new C.Vector2(P(A,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P(A,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},C.SplineCurve=function(A){this.points=A==void 0?[]:A},C.SplineCurve.prototype=Object.create(C.Curve.prototype),C.SplineCurve.prototype.constructor=C.SplineCurve,C.SplineCurve.prototype.getPoint=function(A){var P=this.points,R=(P.length-1)*A,D=_Mathfloor(R),I=R-D,U=P[0===D?D:D-1],F=P[D],V=P[D>P.length-2?P.length-1:D+1],G=P[D>P.length-3?P.length-1:D+2],O=C.CurveUtils.interpolate;return new C.Vector2(O(U.x,F.x,V.x,G.x,I),O(U.y,F.y,V.y,G.y,I))},C.EllipseCurve=function(A,P,R,D,I,U,F,V){this.aX=A,this.aY=P,this.xRadius=R,this.yRadius=D,this.aStartAngle=I,this.aEndAngle=U,this.aClockwise=F,this.aRotation=V||0},C.EllipseCurve.prototype=Object.create(C.Curve.prototype),C.EllipseCurve.prototype.constructor=C.EllipseCurve,C.EllipseCurve.prototype.getPoint=function(A){var P=this.aEndAngle-this.aStartAngle;0>P&&(P+=2*_MathPI2),P>2*_MathPI2&&(P-=2*_MathPI2);var R=!0===this.aClockwise?this.aEndAngle+(1-A)*(2*_MathPI2-P):this.aStartAngle+A*P;var D=this.aX+this.xRadius*_Mathcos2(R),I=this.aY+this.yRadius*_Mathsin2(R);if(0!==this.aRotation){var U=_Mathcos2(this.aRotation),F=_Mathsin2(this.aRotation),V=D,G=I;D=(V-this.aX)*U-(G-this.aY)*F+this.aX,I=(V-this.aX)*F+(G-this.aY)*U+this.aY}return new C.Vector2(D,I)},C.ArcCurve=function(A,P,R,D,I,U){C.EllipseCurve.call(this,A,P,R,R,D,I,U)},C.ArcCurve.prototype=Object.create(C.EllipseCurve.prototype),C.ArcCurve.prototype.constructor=C.ArcCurve,C.LineCurve3=C.Curve.create(function(A,P){this.v1=A,this.v2=P},function(A){var P=new C.Vector3;return P.subVectors(this.v2,this.v1),P.multiplyScalar(A),P.add(this.v1),P}),C.QuadraticBezierCurve3=C.Curve.create(function(A,P,R){this.v0=A,this.v1=P,this.v2=R},function(A){var P=C.ShapeUtils.b2;return new C.Vector3(P(A,this.v0.x,this.v1.x,this.v2.x),P(A,this.v0.y,this.v1.y,this.v2.y),P(A,this.v0.z,this.v1.z,this.v2.z))}),C.CubicBezierCurve3=C.Curve.create(function(A,P,R,D){this.v0=A,this.v1=P,this.v2=R,this.v3=D},function(A){var P=C.ShapeUtils.b3;return new C.Vector3(P(A,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P(A,this.v0.y,this.v1.y,this.v2.y,this.v3.y),P(A,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),C.SplineCurve3=C.Curve.create(function(A){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=A==void 0?[]:A},function(A){var P=this.points,R=(P.length-1)*A,D=_Mathfloor(R),I=R-D,U=P[0==D?D:D-1],F=P[D],V=P[D>P.length-2?P.length-1:D+1],G=P[D>P.length-3?P.length-1:D+2],O=C.CurveUtils.interpolate;return new C.Vector3(O(U.x,F.x,V.x,G.x,I),O(U.y,F.y,V.y,G.y,I),O(U.z,F.z,V.z,G.z,I))}),C.CatmullRomCurve3=function(){function A(){}var P=new C.Vector3,R=new A,D=new A,I=new A;return A.prototype.init=function(U,F,V,G){this.c0=U,this.c1=V,this.c2=-3*U+3*F-2*V-G,this.c3=2*U-2*F+V+G},A.prototype.initNonuniformCatmullRom=function(U,F,V,G,O,H,W){var X=(F-U)/O-(V-U)/(O+H)+(V-F)/H,Y=(V-F)/H-(G-F)/(H+W)+(G-V)/W;X*=H,Y*=H,this.init(F,V,X,Y)},A.prototype.initCatmullRom=function(U,F,V,G,O){this.init(F,V,O*(V-U),O*(G-F))},A.prototype.calc=function(U){var F=U*U;return this.c0+this.c1*U+this.c2*F+this.c3*(F*U)},C.Curve.create(function(U){this.points=U||[],this.closed=!1},function(U){var F=this.points,V,G,O,H;H=F.length,2>H&&console.log("duh, you need at least 2 points"),V=(H-(this.closed?0:1))*U,G=_Mathfloor(V),O=V-G,this.closed?G+=0<G?0:(_Mathfloor(_Mathabs(G)/F.length)+1)*F.length:0===O&&G===H-1&&(G=H-2,O=1);var W,X,Y,Z;if(this.closed||0<G?W=F[(G-1)%H]:(P.subVectors(F[0],F[1]).add(F[0]),W=P),X=F[G%H],Y=F[(G+1)%H],this.closed||G+2<H?Z=F[(G+2)%H]:(P.subVectors(F[H-1],F[H-2]).add(F[H-1]),Z=P),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var K="chordal"===this.type?0.5:0.25,Q=_Mathpow(W.distanceToSquared(X),K),J=_Mathpow(X.distanceToSquared(Y),K),ee=_Mathpow(Y.distanceToSquared(Z),K);1e-4>J&&(J=1),1e-4>Q&&(Q=J),1e-4>ee&&(ee=J),R.initNonuniformCatmullRom(W.x,X.x,Y.x,Z.x,Q,J,ee),D.initNonuniformCatmullRom(W.y,X.y,Y.y,Z.y,Q,J,ee),I.initNonuniformCatmullRom(W.z,X.z,Y.z,Z.z,Q,J,ee)}else if("catmullrom"===this.type){var oe=void 0===this.tension?0.5:this.tension;R.initCatmullRom(W.x,X.x,Y.x,Z.x,oe),D.initCatmullRom(W.y,X.y,Y.y,Z.y,oe),I.initCatmullRom(W.z,X.z,Y.z,Z.z,oe)}var ne=new C.Vector3(R.calc(O),D.calc(O),I.calc(O));return ne})}(),C.ClosedSplineCurve3=function(A){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),C.CatmullRomCurve3.call(this,A),this.type="catmullrom",this.closed=!0},C.ClosedSplineCurve3.prototype=Object.create(C.CatmullRomCurve3.prototype),C.BoxGeometry=function(A,P,R,D,I,U){C.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:A,height:P,depth:R,widthSegments:D,heightSegments:I,depthSegments:U},this.fromBufferGeometry(new C.BoxBufferGeometry(A,P,R,D,I,U)),this.mergeVertices()},C.BoxGeometry.prototype=Object.create(C.Geometry.prototype),C.BoxGeometry.prototype.constructor=C.BoxGeometry,C.CubeGeometry=C.BoxGeometry,C.BoxBufferGeometry=function(A,P,R,D,I,U){function V(ne,ie,se,le,pe,ue,ge,fe,he,ye,xe){for(var Ee=he+1,we=0,Ce=0,Ae=new C.Vector3,Pe=0,Re;Pe<ye+1;Pe++){Re=Pe*(ge/ye)-ge/2;for(var De=0,Ie;De<Ee;De++)Ie=De*(ue/he)-ue/2,Ae[ne]=Ie*le,Ae[ie]=Re*pe,Ae[se]=fe/2,X[K]=Ae.x,X[K+1]=Ae.y,X[K+2]=Ae.z,Ae[ne]=0,Ae[ie]=0,Ae[se]=0<fe?1:-1,Y[K]=Ae.x,Y[K+1]=Ae.y,Y[K+2]=Ae.z,Z[Q]=De/he,Z[Q+1]=1-Pe/ye,K+=3,Q+=2,we+=1}for(Pe=0;Pe<ye;Pe++)for(De=0;De<he;De++){var Be=ee+De+Ee*Pe,Ne=ee+De+Ee*(Pe+1),Ue=ee+(De+1)+Ee*(Pe+1),Fe=ee+(De+1)+Ee*Pe;W[J]=Be,W[J+1]=Ne,W[J+2]=Fe,W[J+3]=Ne,W[J+4]=Ue,W[J+5]=Fe,J+=6,Ce+=6}G.addGroup(oe,Ce,xe),oe+=Ce,ee+=we}C.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:A,height:P,depth:R,widthSegments:D,heightSegments:I,depthSegments:U};var G=this;D=_Mathfloor(D)||1,I=_Mathfloor(I)||1,U=_Mathfloor(U)||1;var O=function(ne,ie,se){var le=0;return le+=2*(ne*ie),le+=2*(ne*se),le+=2*(se*ie),4*le}(D,I,U),H=6*(O/4),W=new(65535<H?Uint32Array:Uint16Array)(H),X=new Float32Array(3*O),Y=new Float32Array(3*O),Z=new Float32Array(2*O),K=0,Q=0,J=0,ee=0,oe=0;V("z","y","x",-1,-1,R,P,A,U,I,0),V("z","y","x",1,-1,R,P,-A,U,I,1),V("x","z","y",1,1,A,R,P,D,U,2),V("x","z","y",1,-1,A,R,-P,D,U,3),V("x","y","z",1,-1,A,P,R,D,I,4),V("x","y","z",-1,-1,A,P,-R,D,I,5),this.setIndex(new C.BufferAttribute(W,1)),this.addAttribute("position",new C.BufferAttribute(X,3)),this.addAttribute("normal",new C.BufferAttribute(Y,3)),this.addAttribute("uv",new C.BufferAttribute(Z,2))},C.BoxBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.BoxBufferGeometry.prototype.constructor=C.BoxBufferGeometry,C.CircleGeometry=function(A,P,R,D){C.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:A,segments:P,thetaStart:R,thetaLength:D},this.fromBufferGeometry(new C.CircleBufferGeometry(A,P,R,D))},C.CircleGeometry.prototype=Object.create(C.Geometry.prototype),C.CircleGeometry.prototype.constructor=C.CircleGeometry,C.CircleBufferGeometry=function(A,P,R,D){C.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:A,segments:P,thetaStart:R,thetaLength:D},A=A||50,P=P===void 0?8:_Mathmax(3,P),R=R===void 0?0:R,D=D===void 0?2*_MathPI2:D;var I=P+2,U=new Float32Array(3*I),F=new Float32Array(3*I),V=new Float32Array(2*I);F[2]=1,V[0]=0.5,V[1]=0.5;for(var G=0,O=3,H=2,W;G<=P;G++,O+=3,H+=2)W=R+G/P*D,U[O]=A*_Mathcos2(W),U[O+1]=A*_Mathsin2(W),F[O+2]=1,V[H]=(U[O]/A+1)/2,V[H+1]=(U[O+1]/A+1)/2;for(var X=[],O=1;O<=P;O++)X.push(O,O+1,0);this.setIndex(new C.BufferAttribute(new Uint16Array(X),1)),this.addAttribute("position",new C.BufferAttribute(U,3)),this.addAttribute("normal",new C.BufferAttribute(F,3)),this.addAttribute("uv",new C.BufferAttribute(V,2)),this.boundingSphere=new C.Sphere(new C.Vector3(),A)},C.CircleBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.CircleBufferGeometry.prototype.constructor=C.CircleBufferGeometry,C.CylinderBufferGeometry=function(A,P,R,D,I,U,F,V){function W(pe){var ue,ge,fe,he=new C.Vector2,ye=new C.Vector3,xe=0,ve=!0===pe?A:P,_e=!0===pe?1:-1;for(ge=oe,ue=1;ue<=D;ue++)Q.setXYZ(oe,0,se*_e,0),J.setXYZ(oe,0,_e,0),!0===pe?(he.x=ue/D,he.y=0):(he.x=(ue-1)/D,he.y=1),ee.setXY(oe,he.x,he.y),oe++;for(fe=oe,ue=0;ue<=D;ue++){var Se=ue/D;ye.x=ve*_Mathsin2(Se*V+F),ye.y=se*_e,ye.z=ve*_Mathcos2(Se*V+F),Q.setXYZ(oe,ye.x,ye.y,ye.z),J.setXYZ(oe,0,_e,0),ee.setXY(oe,Se,!0===pe?1:0),oe++}for(ue=0;ue<D;ue++){var Me=ge+ue,Te=fe+ue;!0===pe?(K.setX(ne,Te),ne++,K.setX(ne,Te+1),ne++,K.setX(ne,Me),ne++):(K.setX(ne,Te+1),ne++,K.setX(ne,Te),ne++,K.setX(ne,Me),ne++),xe+=3}X.addGroup(le,xe,!0===pe?1:2),le+=xe}C.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:A,radiusBottom:P,height:R,radialSegments:D,heightSegments:I,openEnded:U,thetaStart:F,thetaLength:V};var X=this;A=A===void 0?20:A,P=P===void 0?20:P,R=R===void 0?100:R,D=_Mathfloor(D)||8,I=_Mathfloor(I)||1,U=U!==void 0&&U,F=F===void 0?0:F,V=V===void 0?2*_MathPI2:V;var Y=function(){var pe=(D+1)*(I+1);return!1===U&&(pe+=2*(D+1)+2*D),pe}(),Z=function(){var pe=3*(2*(D*I));return!1===U&&(pe+=3*(2*D)),pe}(),K=new C.BufferAttribute(new(65535<Z?Uint32Array:Uint16Array)(Z),1),Q=new C.BufferAttribute(new Float32Array(3*Y),3),J=new C.BufferAttribute(new Float32Array(3*Y),3),ee=new C.BufferAttribute(new Float32Array(2*Y),2),oe=0,ne=0,ie=[],se=R/2,le=0;(function(){var pe,ue,ge=new C.Vector3,fe=new C.Vector3,he=0,ye=(P-A)/R;for(ue=0;ue<=I;ue++){var xe=[],ve=ue/I,_e=ve*(P-A)+A;for(pe=0;pe<=D;pe++){var Se=pe/D;fe.x=_e*_Mathsin2(Se*V+F),fe.y=-ve*R+se,fe.z=_e*_Mathcos2(Se*V+F),Q.setXYZ(oe,fe.x,fe.y,fe.z),ge.copy(fe),(0===A&&0===ue||0===P&&ue===I)&&(ge.x=_Mathsin2(Se*V+F),ge.z=_Mathcos2(Se*V+F)),ge.setY(_Mathsqrt(ge.x*ge.x+ge.z*ge.z)*ye).normalize(),J.setXYZ(oe,ge.x,ge.y,ge.z),ee.setXY(oe,Se,1-ve),xe.push(oe),oe++}ie.push(xe)}for(pe=0;pe<D;pe++)for(ue=0;ue<I;ue++){var Me=ie[ue][pe],Te=ie[ue+1][pe],Ee=ie[ue+1][pe+1],Le=ie[ue][pe+1];K.setX(ne,Me),ne++,K.setX(ne,Te),ne++,K.setX(ne,Le),ne++,K.setX(ne,Te),ne++,K.setX(ne,Ee),ne++,K.setX(ne,Le),ne++,he+=6}X.addGroup(le,he,0),le+=he})(),!1===U&&(0<A&&W(!0),0<P&&W(!1)),this.setIndex(K),this.addAttribute("position",Q),this.addAttribute("normal",J),this.addAttribute("uv",ee)},C.CylinderBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.CylinderBufferGeometry.prototype.constructor=C.CylinderBufferGeometry,C.CylinderGeometry=function(A,P,R,D,I,U,F,V){C.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:A,radiusBottom:P,height:R,radialSegments:D,heightSegments:I,openEnded:U,thetaStart:F,thetaLength:V},this.fromBufferGeometry(new C.CylinderBufferGeometry(A,P,R,D,I,U,F,V)),this.mergeVertices()},C.CylinderGeometry.prototype=Object.create(C.Geometry.prototype),C.CylinderGeometry.prototype.constructor=C.CylinderGeometry,C.EdgesGeometry=function(A,P){function R(ee,oe){return ee-oe}C.BufferGeometry.call(this),P=P===void 0?1:P;var D=_Mathcos2(C.Math.DEG2RAD*P),I=[0,0],U={},F=["a","b","c"],V;A instanceof C.BufferGeometry?(V=new C.Geometry,V.fromBufferGeometry(A)):V=A.clone(),V.mergeVertices(),V.computeFaceNormals();for(var G=V.vertices,O=V.faces,H=0,W=O.length,X;H<W;H++){X=O[H];for(var Y=0;3>Y;Y++){I[0]=X[F[Y]],I[1]=X[F[(Y+1)%3]],I.sort(R);var Z=I.toString();U[Z]===void 0?U[Z]={vert1:I[0],vert2:I[1],face1:H,face2:void 0}:U[Z].face2=H}}var K=[];for(var Z in U){var Q=U[Z];if(Q.face2===void 0||O[Q.face1].normal.dot(O[Q.face2].normal)<=D){var J=G[Q.vert1];K.push(J.x),K.push(J.y),K.push(J.z),J=G[Q.vert2],K.push(J.x),K.push(J.y),K.push(J.z)}}this.addAttribute("position",new C.BufferAttribute(new Float32Array(K),3))},C.EdgesGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.EdgesGeometry.prototype.constructor=C.EdgesGeometry,C.ExtrudeGeometry=function(A,P){return"undefined"==typeof A?void(A=[]):void(C.Geometry.call(this),this.type="ExtrudeGeometry",A=Array.isArray(A)?A:[A],this.addShapeList(A,P),this.computeFaceNormals())},C.ExtrudeGeometry.prototype=Object.create(C.Geometry.prototype),C.ExtrudeGeometry.prototype.constructor=C.ExtrudeGeometry,C.ExtrudeGeometry.prototype.addShapeList=function(A,P){for(var R=A.length,D=0,I;D<R;D++)I=A[D],this.addShape(I,P)},C.ExtrudeGeometry.prototype.addShape=function(A,P){function R(Oe,He,je){return He||console.error("THREE.ExtrudeGeometry: vec does not exist"),He.clone().multiplyScalar(je).add(Oe)}function D(Oe,He,je){var Xe=1,We,qe,Ye=Oe.x-He.x,Ze=Oe.y-He.y,Ke=je.x-Oe.x,Qe=je.y-Oe.y,Je=Ye*Ye+Ze*Ze;if(_Mathabs(Ye*Qe-Ze*Ke)>_NumberEPSILON){var et=_Mathsqrt(Je),tt=_Mathsqrt(Ke*Ke+Qe*Qe),rt=He.x-Ze/et,at=He.y+Ye/et,ot=je.x-Qe/tt,nt=je.y+Ke/tt,it=((ot-rt)*Qe-(nt-at)*Ke)/(Ye*Qe-Ze*Ke);We=rt+Ye*it-Oe.x,qe=at+Ze*it-Oe.y;var st=We*We+qe*qe;if(2>=st)return new C.Vector2(We,qe);Xe=_Mathsqrt(st/2)}else{var lt=!1;Ye>_NumberEPSILON?Ke>_NumberEPSILON&&(lt=!0):Ye<-_NumberEPSILON?Ke<-_NumberEPSILON&&(lt=!0):_Mathsign(Ze)===_Mathsign(Qe)&&(lt=!0),lt?(We=-Ze,qe=Ye,Xe=_Mathsqrt(Je)):(We=Ye,qe=Ze,Xe=_Mathsqrt(Je/2))}return new C.Vector2(We/Xe,qe/Xe)}function F(Oe,He){var je,We;for(Be=Oe.length;0<=--Be;){je=Be,We=Be-1,0>We&&(We=Oe.length-1);var qe=0,Xe=Q+2*Y;for(qe=0;qe<Xe;qe++){var Ye=Pe*qe,Ze=Pe*(qe+1),Ke=He+je+Ye,Qe=He+We+Ye,Je=He+We+Ze,$e=He+je+Ze;O(Ke,Qe,Je,$e,Oe,qe,Xe,je,We)}}}function V(Oe,He,je){he.vertices.push(new C.Vector3(Oe,He,je))}function G(Oe,He,je){Oe+=ye,He+=ye,je+=ye,he.faces.push(new C.Face3(Oe,He,je,null,null,0));var We=ne.generateTopUV(he,Oe,He,je);he.faceVertexUvs[0].push(We)}function O(Oe,He,je,We){Oe+=ye,He+=ye,je+=ye,We+=ye,he.faces.push(new C.Face3(Oe,He,We,null,null,1)),he.faces.push(new C.Face3(He,je,We,null,null,1));var Qe=ne.generateSideWallUV(he,Oe,He,je,We);he.faceVertexUvs[0].push([Qe[0],Qe[1],Qe[3]]),he.faceVertexUvs[0].push([Qe[1],Qe[2],Qe[3]])}var H=P.amount===void 0?100:P.amount,W=P.bevelThickness===void 0?6:P.bevelThickness,X=P.bevelSize===void 0?W-2:P.bevelSize,Y=P.bevelSegments===void 0?3:P.bevelSegments,Z=!(P.bevelEnabled!==void 0)||P.bevelEnabled,K=P.curveSegments===void 0?12:P.curveSegments,Q=P.steps===void 0?1:P.steps,J=P.extrudePath,ee,oe=!1,ne=P.UVGenerator===void 0?C.ExtrudeGeometry.WorldUVGenerator:P.UVGenerator,ie,se,le,pe;J&&(ee=J.getSpacedPoints(Q),oe=!0,Z=!1,ie=P.frames===void 0?new C.TubeGeometry.FrenetFrames(J,Q,!1):P.frames,se=new C.Vector3,le=new C.Vector3,pe=new C.Vector3),Z||(Y=0,W=0,X=0);var ue,ge,fe,he=this,ye=this.vertices.length,xe=A.extractPoints(K),ve=xe.shape,_e=xe.holes,Se=!C.ShapeUtils.isClockWise(ve);if(Se){for(ve=ve.reverse(),ge=0,fe=_e.length;ge<fe;ge++)ue=_e[ge],C.ShapeUtils.isClockWise(ue)&&(_e[ge]=ue.reverse());Se=!1}var Me=C.ShapeUtils.triangulateShape(ve,_e),Te=ve;for(ge=0,fe=_e.length;ge<fe;ge++)ue=_e[ge],ve=ve.concat(ue);for(var Pe=ve.length,De=Me.length,Ie=[],Be=0,Ne=Te.length,Ue=Ne-1,Fe=Be+1,Ee,Le,we,Ce,Ae,Re;Be<Ne;Be++,Ue++,Fe++)Ue===Ne&&(Ue=0),Fe===Ne&&(Fe=0),Ie[Be]=D(Te[Be],Te[Ue],Te[Fe]);var Ve=[],ke=Ie.concat(),Ge;for(ge=0,fe=_e.length;ge<fe;ge++){for(ue=_e[ge],Ge=[],(Be=0,Ne=ue.length,Ue=Ne-1,Fe=Be+1);Be<Ne;Be++,Ue++,Fe++)Ue===Ne&&(Ue=0),Fe===Ne&&(Fe=0),Ge[Be]=D(ue[Be],ue[Ue],ue[Fe]);Ve.push(Ge),ke=ke.concat(Ge)}for(Ee=0;Ee<Y;Ee++){for(we=Ee/Y,Ce=W*(1-we),Le=X*_Mathsin2(we*_MathPI2/2),(Be=0,Ne=Te.length);Be<Ne;Be++)Ae=R(Te[Be],Ie[Be],Le),V(Ae.x,Ae.y,-Ce);for(ge=0,fe=_e.length;ge<fe;ge++)for(ue=_e[ge],Ge=Ve[ge],(Be=0,Ne=ue.length);Be<Ne;Be++)Ae=R(ue[Be],Ge[Be],Le),V(Ae.x,Ae.y,-Ce)}for(Le=X,Be=0;Be<Pe;Be++)Ae=Z?R(ve[Be],ke[Be],Le):ve[Be],oe?(le.copy(ie.normals[0]).multiplyScalar(Ae.x),se.copy(ie.binormals[0]).multiplyScalar(Ae.y),pe.copy(ee[0]).add(le).add(se),V(pe.x,pe.y,pe.z)):V(Ae.x,Ae.y,0);var ze;for(ze=1;ze<=Q;ze++)for(Be=0;Be<Pe;Be++)Ae=Z?R(ve[Be],ke[Be],Le):ve[Be],oe?(le.copy(ie.normals[ze]).multiplyScalar(Ae.x),se.copy(ie.binormals[ze]).multiplyScalar(Ae.y),pe.copy(ee[ze]).add(le).add(se),V(pe.x,pe.y,pe.z)):V(Ae.x,Ae.y,H/Q*ze);for(Ee=Y-1;0<=Ee;Ee--){for(we=Ee/Y,Ce=W*(1-we),Le=X*_Mathsin2(we*_MathPI2/2),(Be=0,Ne=Te.length);Be<Ne;Be++)Ae=R(Te[Be],Ie[Be],Le),V(Ae.x,Ae.y,H+Ce);for(ge=0,fe=_e.length;ge<fe;ge++)for(ue=_e[ge],Ge=Ve[ge],(Be=0,Ne=ue.length);Be<Ne;Be++)Ae=R(ue[Be],Ge[Be],Le),oe?V(Ae.x,Ae.y+ee[Q-1].y,ee[Q-1].x+Ce):V(Ae.x,Ae.y,H+Ce)}(function(){if(Z){var Oe=0,He=Pe*Oe;for(Be=0;Be<De;Be++)Re=Me[Be],G(Re[2]+He,Re[1]+He,Re[0]+He);for(Oe=Q+2*Y,He=Pe*Oe,Be=0;Be<De;Be++)Re=Me[Be],G(Re[0]+He,Re[1]+He,Re[2]+He)}else{for(Be=0;Be<De;Be++)Re=Me[Be],G(Re[2],Re[1],Re[0]);for(Be=0;Be<De;Be++)Re=Me[Be],G(Re[0]+Pe*Q,Re[1]+Pe*Q,Re[2]+Pe*Q)}})(),function(){var Oe=0;for(F(Te,Oe),Oe+=Te.length,(ge=0,fe=_e.length);ge<fe;ge++)ue=_e[ge],F(ue,Oe),Oe+=ue.length}()},C.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(A,P,R,D){var I=A.vertices,U=I[P],F=I[R],V=I[D];return[new C.Vector2(U.x,U.y),new C.Vector2(F.x,F.y),new C.Vector2(V.x,V.y)]},generateSideWallUV:function(A,P,R,D,I){var U=A.vertices,F=U[P],V=U[R],G=U[D],O=U[I];return 0.01>_Mathabs(F.y-V.y)?[new C.Vector2(F.x,1-F.z),new C.Vector2(V.x,1-V.z),new C.Vector2(G.x,1-G.z),new C.Vector2(O.x,1-O.z)]:[new C.Vector2(F.y,1-F.z),new C.Vector2(V.y,1-V.z),new C.Vector2(G.y,1-G.z),new C.Vector2(O.y,1-O.z)]}},C.ShapeGeometry=function(A,P){C.Geometry.call(this),this.type="ShapeGeometry",!1===Array.isArray(A)&&(A=[A]),this.addShapeList(A,P),this.computeFaceNormals()},C.ShapeGeometry.prototype=Object.create(C.Geometry.prototype),C.ShapeGeometry.prototype.constructor=C.ShapeGeometry,C.ShapeGeometry.prototype.addShapeList=function(A,P){for(var R=0,D=A.length;R<D;R++)this.addShape(A[R],P);return this},C.ShapeGeometry.prototype.addShape=function(A,P){P===void 0&&(P={});var R=P.curveSegments===void 0?12:P.curveSegments,D=P.material,I=P.UVGenerator===void 0?C.ExtrudeGeometry.WorldUVGenerator:P.UVGenerator,U,F,V,G=this.vertices.length,O=A.extractPoints(R),H=O.shape,W=O.holes,X=!C.ShapeUtils.isClockWise(H);if(X){for(H=H.reverse(),U=0,F=W.length;U<F;U++)V=W[U],C.ShapeUtils.isClockWise(V)&&(W[U]=V.reverse());X=!1}var Y=C.ShapeUtils.triangulateShape(H,W);for(U=0,F=W.length;U<F;U++)V=W[U],H=H.concat(V);var K=H.length,Z,Q,J=Y.length;for(U=0;U<K;U++)Z=H[U],this.vertices.push(new C.Vector3(Z.x,Z.y,0));for(U=0;U<J;U++){Q=Y[U];var ee=Q[0]+G,oe=Q[1]+G,ne=Q[2]+G;this.faces.push(new C.Face3(ee,oe,ne,null,null,D)),this.faceVertexUvs[0].push(I.generateTopUV(this,ee,oe,ne))}},C.LatheBufferGeometry=function(A,P,R,D){C.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:A,segments:P,phiStart:R,phiLength:D},P=_Mathfloor(P)||12,R=R||0,D=D||2*_MathPI2,D=C.Math.clamp(D,0,2*_MathPI2);var I=(P+1)*A.length,U=3*(2*(P*A.length)),F=new C.BufferAttribute(new(65535<U?Uint32Array:Uint16Array)(U),1),V=new C.BufferAttribute(new Float32Array(3*I),3),G=new C.BufferAttribute(new Float32Array(2*I),2),O=0,H=0,X=1/(A.length-1),Y=1/P,Z=new C.Vector3,K=new C.Vector2,W,Q,J;for(Q=0;Q<=P;Q++){var ee=R+Q*Y*D,oe=_Mathsin2(ee),ne=_Mathcos2(ee);for(J=0;J<=A.length-1;J++)Z.x=A[J].x*oe,Z.y=A[J].y,Z.z=A[J].x*ne,V.setXYZ(O,Z.x,Z.y,Z.z),K.x=Q/P,K.y=J/(A.length-1),G.setXY(O,K.x,K.y),O++}for(Q=0;Q<P;Q++)for(J=0;J<A.length-1;J++){W=J+Q*A.length;var ie=W,se=W+A.length,le=W+A.length+1,pe=W+1;F.setX(H,ie),H++,F.setX(H,se),H++,F.setX(H,pe),H++,F.setX(H,se),H++,F.setX(H,le),H++,F.setX(H,pe),H++}if(this.setIndex(F),this.addAttribute("position",V),this.addAttribute("uv",G),this.computeVertexNormals(),D===2*_MathPI2){var ue=this.attributes.normal.array,ge=new C.Vector3,fe=new C.Vector3,he=new C.Vector3;for(W=3*(P*A.length),Q=0,J=0;Q<A.length;Q++,J+=3)ge.x=ue[J+0],ge.y=ue[J+1],ge.z=ue[J+2],fe.x=ue[W+J+0],fe.y=ue[W+J+1],fe.z=ue[W+J+2],he.addVectors(ge,fe).normalize(),ue[J+0]=ue[W+J+0]=he.x,ue[J+1]=ue[W+J+1]=he.y,ue[J+2]=ue[W+J+2]=he.z}},C.LatheBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.LatheBufferGeometry.prototype.constructor=C.LatheBufferGeometry,C.LatheGeometry=function(A,P,R,D){C.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:A,segments:P,phiStart:R,phiLength:D},this.fromBufferGeometry(new C.LatheBufferGeometry(A,P,R,D)),this.mergeVertices()},C.LatheGeometry.prototype=Object.create(C.Geometry.prototype),C.LatheGeometry.prototype.constructor=C.LatheGeometry,C.PlaneGeometry=function(A,P,R,D){C.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:A,height:P,widthSegments:R,heightSegments:D},this.fromBufferGeometry(new C.PlaneBufferGeometry(A,P,R,D))},C.PlaneGeometry.prototype=Object.create(C.Geometry.prototype),C.PlaneGeometry.prototype.constructor=C.PlaneGeometry,C.PlaneBufferGeometry=function(A,P,R,D){C.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:A,height:P,widthSegments:R,heightSegments:D};for(var F=_Mathfloor(R)||1,V=_Mathfloor(D)||1,G=F+1,O=V+1,X=new Float32Array(3*(G*O)),Y=new Float32Array(3*(G*O)),Z=new Float32Array(2*(G*O)),K=0,Q=0,J=0,ee;J<O;J++){ee=J*(P/V)-P/2;for(var oe=0,ne;oe<G;oe++)ne=oe*(A/F)-A/2,X[K]=ne,X[K+1]=-ee,Y[K+2]=1,Z[Q]=oe/F,Z[Q+1]=1-J/V,K+=3,Q+=2}K=0;for(var ie=new(65535<X.length/3?Uint32Array:Uint16Array)(6*(F*V)),J=0;J<V;J++)for(var oe=0;oe<F;oe++){var se=oe+G*J,le=oe+G*(J+1),pe=oe+1+G*(J+1),ue=oe+1+G*J;ie[K]=se,ie[K+1]=le,ie[K+2]=ue,ie[K+3]=le,ie[K+4]=pe,ie[K+5]=ue,K+=6}this.setIndex(new C.BufferAttribute(ie,1)),this.addAttribute("position",new C.BufferAttribute(X,3)),this.addAttribute("normal",new C.BufferAttribute(Y,3)),this.addAttribute("uv",new C.BufferAttribute(Z,2))},C.PlaneBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.PlaneBufferGeometry.prototype.constructor=C.PlaneBufferGeometry,C.RingBufferGeometry=function(A,P,R,D,I,U){C.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:A,outerRadius:P,thetaSegments:R,phiSegments:D,thetaStart:I,thetaLength:U},A=A||20,P=P||50,I=I===void 0?0:I,U=U===void 0?2*_MathPI2:U,R=R===void 0?8:_Mathmax(3,R),D=D===void 0?1:_Mathmax(1,D);var F=(R+1)*(D+1),V=3*(2*(R*D)),G=new C.BufferAttribute(new(65535<V?Uint32Array:Uint16Array)(V),1),O=new C.BufferAttribute(new Float32Array(3*F),3),H=new C.BufferAttribute(new Float32Array(3*F),3),W=new C.BufferAttribute(new Float32Array(2*F),2),X=0,Y=0,Z,K=A,Q=(P-A)/D,J=new C.Vector3,ee=new C.Vector2,oe,ne;for(oe=0;oe<=D;oe++){for(ne=0;ne<=R;ne++)Z=I+ne/R*U,J.x=K*_Mathcos2(Z),J.y=K*_Mathsin2(Z),O.setXYZ(X,J.x,J.y,J.z),H.setXYZ(X,0,0,1),ee.x=(J.x/P+1)/2,ee.y=(J.y/P+1)/2,W.setXY(X,ee.x,ee.y),X++;K+=Q}for(oe=0;oe<D;oe++){var ie=oe*(R+1);for(ne=0;ne<R;ne++){Z=ne+ie;var se=Z,le=Z+R+1,pe=Z+R+2,ue=Z+1;G.setX(Y,se),Y++,G.setX(Y,le),Y++,G.setX(Y,pe),Y++,G.setX(Y,se),Y++,G.setX(Y,pe),Y++,G.setX(Y,ue),Y++}}this.setIndex(G),this.addAttribute("position",O),this.addAttribute("normal",H),this.addAttribute("uv",W)},C.RingBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.RingBufferGeometry.prototype.constructor=C.RingBufferGeometry,C.RingGeometry=function(A,P,R,D,I,U){C.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:A,outerRadius:P,thetaSegments:R,phiSegments:D,thetaStart:I,thetaLength:U},this.fromBufferGeometry(new C.RingBufferGeometry(A,P,R,D,I,U))},C.RingGeometry.prototype=Object.create(C.Geometry.prototype),C.RingGeometry.prototype.constructor=C.RingGeometry,C.SphereGeometry=function(A,P,R,D,I,U,F){C.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:A,widthSegments:P,heightSegments:R,phiStart:D,phiLength:I,thetaStart:U,thetaLength:F},this.fromBufferGeometry(new C.SphereBufferGeometry(A,P,R,D,I,U,F))},C.SphereGeometry.prototype=Object.create(C.Geometry.prototype),C.SphereGeometry.prototype.constructor=C.SphereGeometry,C.SphereBufferGeometry=function(A,P,R,D,I,U,F){C.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:A,widthSegments:P,heightSegments:R,phiStart:D,phiLength:I,thetaStart:U,thetaLength:F},A=A||50,P=_Mathmax(3,_Mathfloor(P)||8),R=_Mathmax(2,_Mathfloor(R)||6),D=D===void 0?0:D,I=I===void 0?2*_MathPI2:I,U=U===void 0?0:U,F=F===void 0?_MathPI2:F;for(var V=U+F,G=(P+1)*(R+1),O=new C.BufferAttribute(new Float32Array(3*G),3),H=new C.BufferAttribute(new Float32Array(3*G),3),W=new C.BufferAttribute(new Float32Array(2*G),2),X=0,Y=[],Z=new C.Vector3,K=0;K<=R;K++){for(var Q=[],J=K/R,ee=0;ee<=P;ee++){var oe=ee/P,ne=-A*_Mathcos2(D+oe*I)*_Mathsin2(U+J*F),ie=A*_Mathcos2(U+J*F),se=A*_Mathsin2(D+oe*I)*_Mathsin2(U+J*F);Z.set(ne,ie,se).normalize(),O.setXYZ(X,ne,ie,se),H.setXYZ(X,Z.x,Z.y,Z.z),W.setXY(X,oe,1-J),Q.push(X),X++}Y.push(Q)}for(var le=[],K=0;K<R;K++)for(var ee=0;ee<P;ee++){var pe=Y[K][ee+1],ue=Y[K][ee],ge=Y[K+1][ee],fe=Y[K+1][ee+1];(0!==K||0<U)&&le.push(pe,ue,fe),(K!==R-1||V<_MathPI2)&&le.push(ue,ge,fe)}this.setIndex(new(65535<O.count?C.Uint32Attribute:C.Uint16Attribute)(le,1)),this.addAttribute("position",O),this.addAttribute("normal",H),this.addAttribute("uv",W),this.boundingSphere=new C.Sphere(new C.Vector3(),A)},C.SphereBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.SphereBufferGeometry.prototype.constructor=C.SphereBufferGeometry,C.TextGeometry=function(A,P){P=P||{};var R=P.font;if(!1==R instanceof C.Font)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new C.Geometry;var D=R.generateShapes(A,P.size,P.curveSegments);P.amount=P.height===void 0?50:P.height,P.bevelThickness===void 0&&(P.bevelThickness=10),P.bevelSize===void 0&&(P.bevelSize=8),P.bevelEnabled===void 0&&(P.bevelEnabled=!1),C.ExtrudeGeometry.call(this,D,P),this.type="TextGeometry"},C.TextGeometry.prototype=Object.create(C.ExtrudeGeometry.prototype),C.TextGeometry.prototype.constructor=C.TextGeometry,C.TorusBufferGeometry=function(A,P,R,D,I){C.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:A,tube:P,radialSegments:R,tubularSegments:D,arc:I},A=A||100,P=P||40,R=_Mathfloor(R)||8,D=_Mathfloor(D)||6,I=I||2*_MathPI2;var U=(R+1)*(D+1),F=3*(2*(R*D)),V=new(65535<F?Uint32Array:Uint16Array)(F),G=new Float32Array(3*U),O=new Float32Array(3*U),H=new Float32Array(2*U),W=0,X=0,Y=0,Z=new C.Vector3,K=new C.Vector3,Q=new C.Vector3,J,ee;for(J=0;J<=R;J++)for(ee=0;ee<=D;ee++){var oe=ee/D*I,ne=2*(J/R*_MathPI2);K.x=(A+P*_Mathcos2(ne))*_Mathcos2(oe),K.y=(A+P*_Mathcos2(ne))*_Mathsin2(oe),K.z=P*_Mathsin2(ne),G[W]=K.x,G[W+1]=K.y,G[W+2]=K.z,Z.x=A*_Mathcos2(oe),Z.y=A*_Mathsin2(oe),Q.subVectors(K,Z).normalize(),O[W]=Q.x,O[W+1]=Q.y,O[W+2]=Q.z,H[X]=ee/D,H[X+1]=J/R,W+=3,X+=2}for(J=1;J<=R;J++)for(ee=1;ee<=D;ee++){var ie=(D+1)*J+ee-1,se=(D+1)*(J-1)+ee-1,le=(D+1)*(J-1)+ee,pe=(D+1)*J+ee;V[Y]=ie,V[Y+1]=se,V[Y+2]=pe,V[Y+3]=se,V[Y+4]=le,V[Y+5]=pe,Y+=6}this.setIndex(new C.BufferAttribute(V,1)),this.addAttribute("position",new C.BufferAttribute(G,3)),this.addAttribute("normal",new C.BufferAttribute(O,3)),this.addAttribute("uv",new C.BufferAttribute(H,2))},C.TorusBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.TorusBufferGeometry.prototype.constructor=C.TorusBufferGeometry,C.TorusGeometry=function(A,P,R,D,I){C.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:A,tube:P,radialSegments:R,tubularSegments:D,arc:I},this.fromBufferGeometry(new C.TorusBufferGeometry(A,P,R,D,I))},C.TorusGeometry.prototype=Object.create(C.Geometry.prototype),C.TorusGeometry.prototype.constructor=C.TorusGeometry,C.TorusKnotBufferGeometry=function(A,P,R,D,I,U){function F(Se,Me,Te,Ee,Le){var we=_Mathcos2(Se),Ce=_Mathsin2(Se),Ae=Te/Me*Se,Pe=_Mathcos2(Ae);Le.x=0.5*(Ee*(2+Pe))*we,Le.y=0.5*(Ee*(2+Pe)*Ce),Le.z=0.5*(Ee*_Mathsin2(Ae))}C.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:A,tube:P,tubularSegments:R,radialSegments:D,p:I,q:U},A=A||100,P=P||40,R=_Mathfloor(R)||64,D=_Mathfloor(D)||8,I=I||2,U=U||3;var V=(D+1)*(R+1),G=3*(2*(D*R)),O=new C.BufferAttribute(new(65535<G?Uint32Array:Uint16Array)(G),1),H=new C.BufferAttribute(new Float32Array(3*V),3),W=new C.BufferAttribute(new Float32Array(3*V),3),X=new C.BufferAttribute(new Float32Array(2*V),2),Y,Z,K=0,Q=0,J=new C.Vector3,ee=new C.Vector3,oe=new C.Vector2,ne=new C.Vector3,ie=new C.Vector3,se=new C.Vector3,le=new C.Vector3,pe=new C.Vector3;for(Y=0;Y<=R;++Y){var ue=2*(Y/R*I*_MathPI2);for(F(ue,I,U,A,ne),F(ue+0.01,I,U,A,ie),le.subVectors(ie,ne),pe.addVectors(ie,ne),se.crossVectors(le,pe),pe.crossVectors(se,le),se.normalize(),pe.normalize(),Z=0;Z<=D;++Z){var ge=2*(Z/D*_MathPI2),fe=-P*_Mathcos2(ge),he=P*_Mathsin2(ge);J.x=ne.x+(fe*pe.x+he*se.x),J.y=ne.y+(fe*pe.y+he*se.y),J.z=ne.z+(fe*pe.z+he*se.z),H.setXYZ(K,J.x,J.y,J.z),ee.subVectors(J,ne).normalize(),W.setXYZ(K,ee.x,ee.y,ee.z),oe.x=Y/R,oe.y=Z/D,X.setXY(K,oe.x,oe.y),K++}}for(Z=1;Z<=R;Z++)for(Y=1;Y<=D;Y++){var ye=(D+1)*(Z-1)+(Y-1),xe=(D+1)*Z+(Y-1),ve=(D+1)*Z+Y,_e=(D+1)*(Z-1)+Y;O.setX(Q,ye),Q++,O.setX(Q,xe),Q++,O.setX(Q,_e),Q++,O.setX(Q,xe),Q++,O.setX(Q,ve),Q++,O.setX(Q,_e),Q++}this.setIndex(O),this.addAttribute("position",H),this.addAttribute("normal",W),this.addAttribute("uv",X)},C.TorusKnotBufferGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.TorusKnotBufferGeometry.prototype.constructor=C.TorusKnotBufferGeometry,C.TorusKnotGeometry=function(A,P,R,D,I,U,F){C.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:A,tube:P,tubularSegments:R,radialSegments:D,p:I,q:U},F!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new C.TorusKnotBufferGeometry(A,P,R,D,I,U)),this.mergeVertices()},C.TorusKnotGeometry.prototype=Object.create(C.Geometry.prototype),C.TorusKnotGeometry.prototype.constructor=C.TorusKnotGeometry,C.TubeGeometry=function(A,P,R,D,I,U){function F(Ee,Le,we){return G.vertices.push(new C.Vector3(Ee,Le,we))-1}C.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:A,segments:P,radius:R,radialSegments:D,closed:I,taper:U},P=P||64,R=R||1,D=D||8,I=I||!1,U=U||C.TubeGeometry.NoTaper;var V=[],G=this,O,H,W,X=P+1,Y,Z,K,Q,J,ee,oe=new C.Vector3,ne,ie,se,le,pe,ue,ge,fe,he,ye,xe,ve,_e=new C.TubeGeometry.FrenetFrames(A,P,I),Se=_e.tangents,Me=_e.normals,Te=_e.binormals;for(this.tangents=Se,this.normals=Me,this.binormals=Te,ne=0;ne<X;ne++)for(V[ne]=[],Y=ne/(X-1),ee=A.getPointAt(Y),O=Se[ne],H=Me[ne],W=Te[ne],K=R*U(Y),ie=0;ie<D;ie++)Z=2*(ie/D)*_MathPI2,Q=-K*_Mathcos2(Z),J=K*_Mathsin2(Z),oe.copy(ee),oe.x+=Q*H.x+J*W.x,oe.y+=Q*H.y+J*W.y,oe.z+=Q*H.z+J*W.z,V[ne][ie]=F(oe.x,oe.y,oe.z);for(ne=0;ne<P;ne++)for(ie=0;ie<D;ie++)se=I?(ne+1)%P:ne+1,le=(ie+1)%D,pe=V[ne][ie],ue=V[se][ie],ge=V[se][le],fe=V[ne][le],he=new C.Vector2(ne/P,ie/D),ye=new C.Vector2((ne+1)/P,ie/D),xe=new C.Vector2((ne+1)/P,(ie+1)/D),ve=new C.Vector2(ne/P,(ie+1)/D),this.faces.push(new C.Face3(pe,ue,fe)),this.faceVertexUvs[0].push([he,ye,ve]),this.faces.push(new C.Face3(ue,ge,fe)),this.faceVertexUvs[0].push([ye.clone(),xe,ve.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},C.TubeGeometry.prototype=Object.create(C.Geometry.prototype),C.TubeGeometry.prototype.constructor=C.TubeGeometry,C.TubeGeometry.NoTaper=function(){return 1},C.TubeGeometry.SinusoidalTaper=function(A){return _Mathsin2(_MathPI2*A)},C.TubeGeometry.FrenetFrames=function(A,P,R){function D(){F[0]=new C.Vector3,V[0]=new C.Vector3,X=Number.MAX_VALUE,Y=_Mathabs(U[0].x),Z=_Mathabs(U[0].y),K=_Mathabs(U[0].z),Y<=X&&(X=Y,I.set(1,0,0)),Z<=X&&(X=Z,I.set(0,1,0)),K<=X&&I.set(0,0,1),G.crossVectors(U[0],I).normalize(),F[0].crossVectors(U[0],G),V[0].crossVectors(U[0],F[0])}var I=new C.Vector3,U=[],F=[],V=[],G=new C.Vector3,O=new C.Matrix4,H=P+1,W,X,Y,Z,K,Q,J;for(this.tangents=U,this.normals=F,this.binormals=V,Q=0;Q<H;Q++)J=Q/(H-1),U[Q]=A.getTangentAt(J),U[Q].normalize();for(D(),Q=1;Q<H;Q++)F[Q]=F[Q-1].clone(),V[Q]=V[Q-1].clone(),G.crossVectors(U[Q-1],U[Q]),G.length()>_NumberEPSILON&&(G.normalize(),W=_Mathacos(C.Math.clamp(U[Q-1].dot(U[Q]),-1,1)),F[Q].applyMatrix4(O.makeRotationAxis(G,W))),V[Q].crossVectors(U[Q],F[Q]);if(R)for(W=_Mathacos(C.Math.clamp(F[0].dot(F[H-1]),-1,1)),W/=H-1,0<U[0].dot(G.crossVectors(F[0],F[H-1]))&&(W=-W),Q=1;Q<H;Q++)F[Q].applyMatrix4(O.makeRotationAxis(U[Q],W*Q)),V[Q].crossVectors(U[Q],F[Q])},C.PolyhedronGeometry=function(A,P,R,D){function I(ge){var fe=ge.normalize().clone();fe.index=H.vertices.push(fe)-1;var he=V(ge)/2/_MathPI2+0.5,ye=G(ge)/_MathPI2+0.5;return fe.uv=new C.Vector2(he,1-ye),fe}function U(ge,fe,he,ye){var xe=new C.Face3(ge.index,fe.index,he.index,[ge.clone(),fe.clone(),he.clone()],void 0,ye);H.faces.push(xe),oe.copy(ge).add(fe).add(he).divideScalar(3);var ve=V(oe);H.faceVertexUvs[0].push([O(ge.uv,ge,ve),O(fe.uv,fe,ve),O(he.uv,he,ve)])}function F(ge,fe){for(var he=_Mathpow(2,fe),ye=I(H.vertices[ge.a]),xe=I(H.vertices[ge.b]),ve=I(H.vertices[ge.c]),_e=[],Se=ge.materialIndex,Me=0;Me<=he;Me++){_e[Me]=[];for(var Te=I(ye.clone().lerp(ve,Me/he)),Ee=I(xe.clone().lerp(ve,Me/he)),Le=he-Me,we=0;we<=Le;we++)_e[Me][we]=0===we&&Me===he?Te:I(Te.clone().lerp(Ee,we/Le))}for(var Me=0;Me<he;Me++)for(var we=0,Ce;we<2*(he-Me)-1;we++)Ce=_Mathfloor(we/2),0==we%2?U(_e[Me][Ce+1],_e[Me+1][Ce],_e[Me][Ce],Se):U(_e[Me][Ce+1],_e[Me+1][Ce+1],_e[Me+1][Ce],Se)}function V(ge){return _Mathatan(ge.z,-ge.x)}function G(ge){return _Mathatan(-ge.y,_Mathsqrt(ge.x*ge.x+ge.z*ge.z))}function O(ge,fe,he){return 0>he&&1===ge.x&&(ge=new C.Vector2(ge.x-1,ge.y)),0===fe.x&&0===fe.z&&(ge=new C.Vector2(he/2/_MathPI2+0.5,ge.y)),ge.clone()}C.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:A,indices:P,radius:R,detail:D},R=R||1,D=D||0;for(var H=this,W=0,X=A.length;W<X;W+=3)I(new C.Vector3(A[W],A[W+1],A[W+2]));for(var Y=this.vertices,Z=[],W=0,K=0,X=P.length;W<X;W+=3,K++){var Q=Y[P[W]],J=Y[P[W+1]],ee=Y[P[W+2]];Z[K]=new C.Face3(Q.index,J.index,ee.index,[Q.clone(),J.clone(),ee.clone()],void 0,K)}for(var oe=new C.Vector3,W=0,X=Z.length;W<X;W++)F(Z[W],D);for(var W=0,X=this.faceVertexUvs[0].length;W<X;W++){var ne=this.faceVertexUvs[0][W],ie=ne[0].x,se=ne[1].x,le=ne[2].x,pe=_Mathmax(ie,se,le),ue=_Mathmin(ie,se,le);0.9<pe&&0.1>ue&&(0.2>ie&&(ne[0].x+=1),0.2>se&&(ne[1].x+=1),0.2>le&&(ne[2].x+=1))}for(var W=0,X=this.vertices.length;W<X;W++)this.vertices[W].multiplyScalar(R);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new C.Sphere(new C.Vector3(),R)},C.PolyhedronGeometry.prototype=Object.create(C.Geometry.prototype),C.PolyhedronGeometry.prototype.constructor=C.PolyhedronGeometry,C.DodecahedronGeometry=function(A,P){var R=(1+2.23606797749979)/2,D=1/R;C.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-D,-R,0,-D,R,0,D,-R,0,D,R,-D,-R,0,-D,R,0,D,-R,0,D,R,0,-R,0,-D,R,0,-D,-R,0,D,R,0,D],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],A,P),this.type="DodecahedronGeometry",this.parameters={radius:A,detail:P}},C.DodecahedronGeometry.prototype=Object.create(C.PolyhedronGeometry.prototype),C.DodecahedronGeometry.prototype.constructor=C.DodecahedronGeometry,C.IcosahedronGeometry=function(A,P){var R=(1+2.23606797749979)/2;C.PolyhedronGeometry.call(this,[-1,R,0,1,R,0,-1,-R,0,1,-R,0,0,-1,R,0,1,R,0,-1,-R,0,1,-R,R,0,-1,R,0,1,-R,0,-1,-R,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],A,P),this.type="IcosahedronGeometry",this.parameters={radius:A,detail:P}},C.IcosahedronGeometry.prototype=Object.create(C.PolyhedronGeometry.prototype),C.IcosahedronGeometry.prototype.constructor=C.IcosahedronGeometry,C.OctahedronGeometry=function(A,P){C.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],A,P),this.type="OctahedronGeometry",this.parameters={radius:A,detail:P}},C.OctahedronGeometry.prototype=Object.create(C.PolyhedronGeometry.prototype),C.OctahedronGeometry.prototype.constructor=C.OctahedronGeometry,C.TetrahedronGeometry=function(A,P){C.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],A,P),this.type="TetrahedronGeometry",this.parameters={radius:A,detail:P}},C.TetrahedronGeometry.prototype=Object.create(C.PolyhedronGeometry.prototype),C.TetrahedronGeometry.prototype.constructor=C.TetrahedronGeometry,C.ParametricGeometry=function(A,P,R){C.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:A,slices:P,stacks:R};var D=this.vertices,I=this.faces,U=this.faceVertexUvs[0],F,V,G,O,H,W=P+1;for(F=0;F<=R;F++)for(H=F/R,V=0;V<=P;V++)O=V/P,G=A(O,H),D.push(G);var X,Y,Z,K,Q,J,ee,oe;for(F=0;F<R;F++)for(V=0;V<P;V++)X=F*W+V,Y=F*W+V+1,Z=(F+1)*W+V+1,K=(F+1)*W+V,Q=new C.Vector2(V/P,F/R),J=new C.Vector2((V+1)/P,F/R),ee=new C.Vector2((V+1)/P,(F+1)/R),oe=new C.Vector2(V/P,(F+1)/R),I.push(new C.Face3(X,Y,K)),U.push([Q,J,oe]),I.push(new C.Face3(Y,Z,K)),U.push([J.clone(),ee,oe.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},C.ParametricGeometry.prototype=Object.create(C.Geometry.prototype),C.ParametricGeometry.prototype.constructor=C.ParametricGeometry,C.WireframeGeometry=function(A){function P(he,ye){return he-ye}C.BufferGeometry.call(this);var R=[0,0],D={},I=["a","b","c"];if(A instanceof C.Geometry){for(var U=A.vertices,F=A.faces,V=0,G=new Uint32Array(6*F.length),O=0,H=F.length,W;O<H;O++){W=F[O];for(var X=0;3>X;X++){R[0]=W[I[X]],R[1]=W[I[(X+1)%3]],R.sort(P);var Y=R.toString();D[Y]===void 0&&(G[2*V]=R[0],G[2*V+1]=R[1],D[Y]=!0,V++)}}for(var Z=new Float32Array(3*(2*V)),O=0,H=V;O<H;O++)for(var X=0;2>X;X++){var K=U[G[2*O+X]],Q=6*O+3*X;Z[Q+0]=K.x,Z[Q+1]=K.y,Z[Q+2]=K.z}this.addAttribute("position",new C.BufferAttribute(Z,3))}else if(A instanceof C.BufferGeometry)if(null!==A.index){var J=A.index.array,U=A.attributes.position,ee=A.groups,V=0;0===ee.length&&A.addGroup(0,J.length);for(var G=new Uint32Array(2*J.length),oe=0,ne=ee.length;oe<ne;++oe)for(var ie=ee[oe],se=ie.start,le=ie.count,O=se;O<se+le;O+=3)for(var X=0;3>X;X++){R[0]=J[O+X],R[1]=J[O+(X+1)%3],R.sort(P);var Y=R.toString();void 0===D[Y]&&(G[2*V]=R[0],G[2*V+1]=R[1],D[Y]=!0,V++)}for(var Z=new Float32Array(3*(2*V)),O=0,H=V;O<H;O++)for(var X=0;2>X;X++){var Q=6*O+3*X,ue=G[2*O+X];Z[Q+0]=U.getX(ue),Z[Q+1]=U.getY(ue),Z[Q+2]=U.getZ(ue)}this.addAttribute("position",new C.BufferAttribute(Z,3))}else{for(var U=A.attributes.position.array,V=U.length/3,ge=V/3,Z=new Float32Array(3*(2*V)),O=0,H=ge;O<H;O++)for(var X=0;3>X;X++){var Q=18*O+6*X,fe=9*O+3*X;Z[Q+0]=U[fe],Z[Q+1]=U[fe+1],Z[Q+2]=U[fe+2];var ue=9*O+3*((X+1)%3);Z[Q+3]=U[ue],Z[Q+4]=U[ue+1],Z[Q+5]=U[ue+2]}this.addAttribute("position",new C.BufferAttribute(Z,3))}},C.WireframeGeometry.prototype=Object.create(C.BufferGeometry.prototype),C.WireframeGeometry.prototype.constructor=C.WireframeGeometry,C.AxisHelper=function(A){A=A||1;var P=new Float32Array([0,0,0,A,0,0,0,0,0,0,A,0,0,0,0,0,0,A]),R=new Float32Array([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]),D=new C.BufferGeometry;D.addAttribute("position",new C.BufferAttribute(P,3)),D.addAttribute("color",new C.BufferAttribute(R,3));var I=new C.LineBasicMaterial({vertexColors:C.VertexColors});C.LineSegments.call(this,D,I)},C.AxisHelper.prototype=Object.create(C.LineSegments.prototype),C.AxisHelper.prototype.constructor=C.AxisHelper,C.ArrowHelper=function(){var A=new C.Geometry;A.vertices.push(new C.Vector3(0,0,0),new C.Vector3(0,1,0));var P=new C.CylinderGeometry(0,0.5,1,5,1);return P.translate(0,-0.5,0),function(D,I,U,F,V,G){C.Object3D.call(this),void 0===F&&(F=16776960),void 0===U&&(U=1),void 0===V&&(V=0.2*U),void 0===G&&(G=0.2*V),this.position.copy(I),this.line=new C.Line(A,new C.LineBasicMaterial({color:F})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new C.Mesh(P,new C.MeshBasicMaterial({color:F})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(D),this.setLength(U,V,G)}}(),C.ArrowHelper.prototype=Object.create(C.Object3D.prototype),C.ArrowHelper.prototype.constructor=C.ArrowHelper,C.ArrowHelper.prototype.setDirection=function(){var A=new C.Vector3,P;return function(D){0.99999<D.y?this.quaternion.set(0,0,0,1):-0.99999>D.y?this.quaternion.set(1,0,0,0):(A.set(D.z,0,-D.x).normalize(),P=_Mathacos(D.y),this.quaternion.setFromAxisAngle(A,P))}}(),C.ArrowHelper.prototype.setLength=function(A,P,R){P===void 0&&(P=0.2*A),R===void 0&&(R=0.2*P),this.line.scale.set(1,_Mathmax(0,A-P),1),this.line.updateMatrix(),this.cone.scale.set(R,P,R),this.cone.position.y=A,this.cone.updateMatrix()},C.ArrowHelper.prototype.setColor=function(A){this.line.material.color.set(A),this.cone.material.color.set(A)},C.BoxHelper=function(A){var P=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),R=new Float32Array(24),D=new C.BufferGeometry;D.setIndex(new C.BufferAttribute(P,1)),D.addAttribute("position",new C.BufferAttribute(R,3)),C.LineSegments.call(this,D,new C.LineBasicMaterial({color:16776960})),A!==void 0&&this.update(A)},C.BoxHelper.prototype=Object.create(C.LineSegments.prototype),C.BoxHelper.prototype.constructor=C.BoxHelper,C.BoxHelper.prototype.update=function(){var A=new C.Box3;return function(P){if(P instanceof C.Box3?A.copy(P):A.setFromObject(P),!A.isEmpty()){var R=A.min,D=A.max,I=this.geometry.attributes.position,U=I.array;U[0]=D.x,U[1]=D.y,U[2]=D.z,U[3]=R.x,U[4]=D.y,U[5]=D.z,U[6]=R.x,U[7]=R.y,U[8]=D.z,U[9]=D.x,U[10]=R.y,U[11]=D.z,U[12]=D.x,U[13]=D.y,U[14]=R.z,U[15]=R.x,U[16]=D.y,U[17]=R.z,U[18]=R.x,U[19]=R.y,U[20]=R.z,U[21]=D.x,U[22]=R.y,U[23]=R.z,I.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),C.BoundingBoxHelper=function(A,P){var R=P===void 0?8947848:P;this.object=A,this.box=new C.Box3,C.Mesh.call(this,new C.BoxGeometry(1,1,1),new C.MeshBasicMaterial({color:R,wireframe:!0}))},C.BoundingBoxHelper.prototype=Object.create(C.Mesh.prototype),C.BoundingBoxHelper.prototype.constructor=C.BoundingBoxHelper,C.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},C.CameraHelper=function(A){function P(W,X,Y){R(W,Y),R(X,Y)}function R(W,X){D.vertices.push(new C.Vector3),D.colors.push(new C.Color(X)),U[W]===void 0&&(U[W]=[]),U[W].push(D.vertices.length-1)}var D=new C.Geometry,I=new C.LineBasicMaterial({color:16777215,vertexColors:C.FaceColors}),U={},F=16755200,V=16711680,G=43775,H=3355443;P("n1","n2",F),P("n2","n4",F),P("n4","n3",F),P("n3","n1",F),P("f1","f2",F),P("f2","f4",F),P("f4","f3",F),P("f3","f1",F),P("n1","f1",F),P("n2","f2",F),P("n3","f3",F),P("n4","f4",F),P("p","n1",V),P("p","n2",V),P("p","n3",V),P("p","n4",V),P("u1","u2",G),P("u2","u3",G),P("u3","u1",G),P("c","t",16777215),P("p","c",H),P("cn1","cn2",H),P("cn3","cn4",H),P("cf1","cf2",H),P("cf3","cf4",H),C.LineSegments.call(this,D,I),this.camera=A,this.camera.updateProjectionMatrix(),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=U,this.update()},C.CameraHelper.prototype=Object.create(C.LineSegments.prototype),C.CameraHelper.prototype.constructor=C.CameraHelper,C.CameraHelper.prototype.update=function(){function A(U,F,V,G){D.set(F,V,G).unproject(I);var O=R[U];if(O!==void 0)for(var H=0,W=O.length;H<W;H++)P.vertices[O[H]].copy(D)}var P,R,D=new C.Vector3,I=new C.Camera;return function(){P=this.geometry,R=this.pointMap;var U=1,F=1;I.projectionMatrix.copy(this.camera.projectionMatrix),A("c",0,0,-1),A("t",0,0,1),A("n1",-U,-F,-1),A("n2",U,-F,-1),A("n3",-U,F,-1),A("n4",U,F,-1),A("f1",-U,-F,1),A("f2",U,-F,1),A("f3",-U,F,1),A("f4",U,F,1),A("u1",0.7*U,1.1*F,-1),A("u2",0.7*-U,1.1*F,-1),A("u3",0,2*F,-1),A("cf1",-U,0,1),A("cf2",U,0,1),A("cf3",0,-F,1),A("cf4",0,F,1),A("cn1",-U,0,-1),A("cn2",U,0,-1),A("cn3",0,-F,-1),A("cn4",0,F,-1),P.verticesNeedUpdate=!0}}(),C.DirectionalLightHelper=function(A,P){C.Object3D.call(this),this.light=A,this.light.updateMatrixWorld(),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1,P=P||1;var R=new C.Geometry;R.vertices.push(new C.Vector3(-P,P,0),new C.Vector3(P,P,0),new C.Vector3(P,-P,0),new C.Vector3(-P,-P,0),new C.Vector3(-P,P,0));var D=new C.LineBasicMaterial({fog:!1});D.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new C.Line(R,D),this.add(this.lightPlane),R=new C.Geometry,R.vertices.push(new C.Vector3,new C.Vector3),D=new C.LineBasicMaterial({fog:!1}),D.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new C.Line(R,D),this.add(this.targetLine),this.update()},C.DirectionalLightHelper.prototype=Object.create(C.Object3D.prototype),C.DirectionalLightHelper.prototype.constructor=C.DirectionalLightHelper,C.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},C.DirectionalLightHelper.prototype.update=function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Vector3;return function(){A.setFromMatrixPosition(this.light.matrixWorld),P.setFromMatrixPosition(this.light.target.matrixWorld),R.subVectors(P,A),this.lightPlane.lookAt(R),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(R),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),C.EdgesHelper=function(A,P,R){var D=P===void 0?16777215:P;C.LineSegments.call(this,new C.EdgesGeometry(A.geometry,R),new C.LineBasicMaterial({color:D})),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1},C.EdgesHelper.prototype=Object.create(C.LineSegments.prototype),C.EdgesHelper.prototype.constructor=C.EdgesHelper,C.FaceNormalsHelper=function(A,P,R,D){this.object=A,this.size=P===void 0?1:P;var I=R===void 0?16776960:R,U=D===void 0?1:D,F=0,V=this.object.geometry;V instanceof C.Geometry?F=V.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var G=new C.BufferGeometry,O=new C.Float32Attribute(3*(2*F),3);G.addAttribute("position",O),C.LineSegments.call(this,G,new C.LineBasicMaterial({color:I,linewidth:U})),this.matrixAutoUpdate=!1,this.update()},C.FaceNormalsHelper.prototype=Object.create(C.LineSegments.prototype),C.FaceNormalsHelper.prototype.constructor=C.FaceNormalsHelper,C.FaceNormalsHelper.prototype.update=function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Matrix3;return function(){this.object.updateMatrixWorld(!0),R.getNormalMatrix(this.object.matrixWorld);for(var I=this.object.matrixWorld,U=this.geometry.attributes.position,F=this.object.geometry,V=F.vertices,G=F.faces,O=0,H=0,W=G.length;H<W;H++){var X=G[H],Y=X.normal;A.copy(V[X.a]).add(V[X.b]).add(V[X.c]).divideScalar(3).applyMatrix4(I),P.copy(Y).applyMatrix3(R).normalize().multiplyScalar(this.size).add(A),U.setXYZ(O,A.x,A.y,A.z),++O,U.setXYZ(O,P.x,P.y,P.z),++O}return U.needsUpdate=!0,this}}(),C.GridHelper=function(A,P){var R=new C.Geometry,D=new C.LineBasicMaterial({vertexColors:C.VertexColors});this.color1=new C.Color(4473924),this.color2=new C.Color(8947848);for(var I=-A;I<=A;I+=P){R.vertices.push(new C.Vector3(-A,0,I),new C.Vector3(A,0,I),new C.Vector3(I,0,-A),new C.Vector3(I,0,A));var U=0===I?this.color1:this.color2;R.colors.push(U,U,U,U)}C.LineSegments.call(this,R,D)},C.GridHelper.prototype=Object.create(C.LineSegments.prototype),C.GridHelper.prototype.constructor=C.GridHelper,C.GridHelper.prototype.setColors=function(A,P){this.color1.set(A),this.color2.set(P),this.geometry.colorsNeedUpdate=!0},C.HemisphereLightHelper=function(A,P){C.Object3D.call(this),this.light=A,this.light.updateMatrixWorld(),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new C.Color,new C.Color];var R=new C.SphereGeometry(P,4,2);R.rotateX(-_MathPI2/2);for(var D=0;D<8;D++)R.faces[D].color=this.colors[4>D?0:1];var U=new C.MeshBasicMaterial({vertexColors:C.FaceColors,wireframe:!0});this.lightSphere=new C.Mesh(R,U),this.add(this.lightSphere),this.update()},C.HemisphereLightHelper.prototype=Object.create(C.Object3D.prototype),C.HemisphereLightHelper.prototype.constructor=C.HemisphereLightHelper,C.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},C.HemisphereLightHelper.prototype.update=function(){var A=new C.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(A.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),C.PointLightHelper=function(A,P){this.light=A,this.light.updateMatrixWorld();var R=new C.SphereGeometry(P,4,2),D=new C.MeshBasicMaterial({wireframe:!0,fog:!1});D.color.copy(this.light.color).multiplyScalar(this.light.intensity),C.Mesh.call(this,R,D),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},C.PointLightHelper.prototype=Object.create(C.Mesh.prototype),C.PointLightHelper.prototype.constructor=C.PointLightHelper,C.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},C.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},C.SkeletonHelper=function(A){this.bones=this.getBoneList(A);for(var P=new C.Geometry,R=0,D;R<this.bones.length;R++)D=this.bones[R],D.parent instanceof C.Bone&&(P.vertices.push(new C.Vector3),P.vertices.push(new C.Vector3),P.colors.push(new C.Color(0,0,1)),P.colors.push(new C.Color(0,1,0)));P.dynamic=!0;var I=new C.LineBasicMaterial({vertexColors:C.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});C.LineSegments.call(this,P,I),this.root=A,this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1,this.update()},C.SkeletonHelper.prototype=Object.create(C.LineSegments.prototype),C.SkeletonHelper.prototype.constructor=C.SkeletonHelper,C.SkeletonHelper.prototype.getBoneList=function(A){var P=[];A instanceof C.Bone&&P.push(A);for(var R=0;R<A.children.length;R++)P.push.apply(P,this.getBoneList(A.children[R]));return P},C.SkeletonHelper.prototype.update=function(){for(var A=this.geometry,P=new C.Matrix4().getInverse(this.root.matrixWorld),R=new C.Matrix4,D=0,I=0,U;I<this.bones.length;I++)U=this.bones[I],U.parent instanceof C.Bone&&(R.multiplyMatrices(P,U.matrixWorld),A.vertices[D].setFromMatrixPosition(R),R.multiplyMatrices(P,U.parent.matrixWorld),A.vertices[D+1].setFromMatrixPosition(R),D+=2);A.verticesNeedUpdate=!0,A.computeBoundingSphere()},C.SpotLightHelper=function(A){C.Object3D.call(this),this.light=A,this.light.updateMatrixWorld(),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1;for(var P=new C.BufferGeometry,R=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],D=0,I=1,U=32;D<U;D++,I++){var F=2*(D/U*_MathPI2),V=2*(I/U*_MathPI2);R.push(_Mathcos2(F),_Mathsin2(F),1,_Mathcos2(V),_Mathsin2(V),1)}P.addAttribute("position",new C.Float32Attribute(R,3));var G=new C.LineBasicMaterial({fog:!1});this.cone=new C.LineSegments(P,G),this.add(this.cone),this.update()},C.SpotLightHelper.prototype=Object.create(C.Object3D.prototype),C.SpotLightHelper.prototype.constructor=C.SpotLightHelper,C.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},C.SpotLightHelper.prototype.update=function(){var A=new C.Vector3,P=new C.Vector3;return function(){var R=this.light.distance?this.light.distance:1e3,D=R*_Mathtan(this.light.angle);this.cone.scale.set(D,D,R),A.setFromMatrixPosition(this.light.matrixWorld),P.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(P.sub(A)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),C.VertexNormalsHelper=function(A,P,R,D){this.object=A,this.size=P===void 0?1:P;var I=R===void 0?16711680:R,U=D===void 0?1:D,F=0,V=this.object.geometry;V instanceof C.Geometry?F=3*V.faces.length:V instanceof C.BufferGeometry&&(F=V.attributes.normal.count);var G=new C.BufferGeometry,O=new C.Float32Attribute(3*(2*F),3);G.addAttribute("position",O),C.LineSegments.call(this,G,new C.LineBasicMaterial({color:I,linewidth:U})),this.matrixAutoUpdate=!1,this.update()},C.VertexNormalsHelper.prototype=Object.create(C.LineSegments.prototype),C.VertexNormalsHelper.prototype.constructor=C.VertexNormalsHelper,C.VertexNormalsHelper.prototype.update=function(){var A=new C.Vector3,P=new C.Vector3,R=new C.Matrix3;return function(){var I=["a","b","c"];this.object.updateMatrixWorld(!0),R.getNormalMatrix(this.object.matrixWorld);var U=this.object.matrixWorld,F=this.geometry.attributes.position,V=this.object.geometry;if(V instanceof C.Geometry)for(var G=V.vertices,O=V.faces,H=0,W=0,X=O.length,Y;W<X;W++){Y=O[W];for(var Z=0,K=Y.vertexNormals.length;Z<K;Z++){var Q=G[Y[I[Z]]],J=Y.vertexNormals[Z];A.copy(Q).applyMatrix4(U),P.copy(J).applyMatrix3(R).normalize().multiplyScalar(this.size).add(A),F.setXYZ(H,A.x,A.y,A.z),++H,F.setXYZ(H,P.x,P.y,P.z),++H}}else if(V instanceof C.BufferGeometry)for(var ee=V.attributes.position,oe=V.attributes.normal,H=0,Z=0,K=ee.count;Z<K;Z++)A.set(ee.getX(Z),ee.getY(Z),ee.getZ(Z)).applyMatrix4(U),P.set(oe.getX(Z),oe.getY(Z),oe.getZ(Z)),P.applyMatrix3(R).normalize().multiplyScalar(this.size).add(A),F.setXYZ(H,A.x,A.y,A.z),++H,F.setXYZ(H,P.x,P.y,P.z),++H;return F.needsUpdate=!0,this}}(),C.WireframeHelper=function(A,P){var R=P===void 0?16777215:P;C.LineSegments.call(this,new C.WireframeGeometry(A.geometry),new C.LineBasicMaterial({color:R})),this.matrix=A.matrixWorld,this.matrixAutoUpdate=!1},C.WireframeHelper.prototype=Object.create(C.LineSegments.prototype),C.WireframeHelper.prototype.constructor=C.WireframeHelper,C.ImmediateRenderObject=function(A){C.Object3D.call(this),this.material=A,this.render=function(){}},C.ImmediateRenderObject.prototype=Object.create(C.Object3D.prototype),C.ImmediateRenderObject.prototype.constructor=C.ImmediateRenderObject,C.MorphBlendMesh=function(A,P){C.Mesh.call(this,A,P),this.animationsMap={},this.animationsList=[];var R=this.geometry.morphTargets.length,D="__default";this.createAnimation(D,0,R-1,R/1),this.setAnimationWeight(D,1)},C.MorphBlendMesh.prototype=Object.create(C.Mesh.prototype),C.MorphBlendMesh.prototype.constructor=C.MorphBlendMesh,C.MorphBlendMesh.prototype.createAnimation=function(A,P,R,D){var I={start:P,end:R,length:R-P+1,fps:D,duration:(R-P)/D,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[A]=I,this.animationsList.push(I)},C.MorphBlendMesh.prototype.autoCreateAnimations=function(A){for(var P=/([a-z]+)_?(\d+)/i,D={},I=this.geometry,U=0,F=I.morphTargets.length,R;U<F;U++){var V=I.morphTargets[U],G=V.name.match(P);if(G&&1<G.length){var O=G[1];D[O]||(D[O]={start:Infinity,end:-Infinity});var H=D[O];U<H.start&&(H.start=U),U>H.end&&(H.end=U),R||(R=O)}}for(var O in D){var H=D[O];this.createAnimation(O,H.start,H.end,A)}this.firstAnimation=R},C.MorphBlendMesh.prototype.setAnimationDirectionForward=function(A){var P=this.animationsMap[A];P&&(P.direction=1,P.directionBackwards=!1)},C.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(A){var P=this.animationsMap[A];P&&(P.direction=-1,P.directionBackwards=!0)},C.MorphBlendMesh.prototype.setAnimationFPS=function(A,P){var R=this.animationsMap[A];R&&(R.fps=P,R.duration=(R.end-R.start)/R.fps)},C.MorphBlendMesh.prototype.setAnimationDuration=function(A,P){var R=this.animationsMap[A];R&&(R.duration=P,R.fps=(R.end-R.start)/R.duration)},C.MorphBlendMesh.prototype.setAnimationWeight=function(A,P){var R=this.animationsMap[A];R&&(R.weight=P)},C.MorphBlendMesh.prototype.setAnimationTime=function(A,P){var R=this.animationsMap[A];R&&(R.time=P)},C.MorphBlendMesh.prototype.getAnimationTime=function(A){var P=0,R=this.animationsMap[A];return R&&(P=R.time),P},C.MorphBlendMesh.prototype.getAnimationDuration=function(A){var P=-1,R=this.animationsMap[A];return R&&(P=R.duration),P},C.MorphBlendMesh.prototype.playAnimation=function(A){var P=this.animationsMap[A];P?(P.time=0,P.active=!0):console.warn("THREE.MorphBlendMesh: animation["+A+"] undefined in .playAnimation()")},C.MorphBlendMesh.prototype.stopAnimation=function(A){var P=this.animationsMap[A];P&&(P.active=!1)},C.MorphBlendMesh.prototype.update=function(A){for(var P=0,R=this.animationsList.length,D;P<R;P++)if(D=this.animationsList[P],D.active){var I=D.duration/D.length;D.time+=D.direction*A,D.mirroredLoop?(D.time>D.duration||0>D.time)&&(D.direction*=-1,D.time>D.duration&&(D.time=D.duration,D.directionBackwards=!0),0>D.time&&(D.time=0,D.directionBackwards=!1)):(D.time%=D.duration,0>D.time&&(D.time+=D.duration));var U=D.start+C.Math.clamp(_Mathfloor(D.time/I),0,D.length-1),F=D.weight;U!==D.currentFrame&&(this.morphTargetInfluences[D.lastFrame]=0,this.morphTargetInfluences[D.currentFrame]=1*F,this.morphTargetInfluences[U]=0,D.lastFrame=D.currentFrame,D.currentFrame=U);var V=D.time%I/I;D.directionBackwards&&(V=1-V),D.currentFrame===D.lastFrame?this.morphTargetInfluences[D.currentFrame]=F:(this.morphTargetInfluences[D.currentFrame]=V*F,this.morphTargetInfluences[D.lastFrame]=(1-V)*F)}},"undefined"==typeof E?this.THREE=C:("undefined"!=typeof M&&M.exports&&(E=M.exports=C),E.THREE=C)},{}],28:[function(S,M,E){arguments[4][11][0].apply(E,arguments)},{dup:11}],29:[function(S,M){M.exports=function(C){return C&&"object"==typeof C&&"function"==typeof C.copy&&"function"==typeof C.fill&&"function"==typeof C.readUInt8}},{}],30:[function(S,M,E){(function(L,C){function A(_e,Se){var Me={seen:[],stylize:R};return 3<=arguments.length&&(Me.depth=arguments[2]),4<=arguments.length&&(Me.colors=arguments[3]),W(Se)?Me.showHidden=Se:Se&&E._extend(Me,Se),J(Me.showHidden)&&(Me.showHidden=!1),J(Me.depth)&&(Me.depth=2),J(Me.colors)&&(Me.colors=!1),J(Me.customInspect)&&(Me.customInspect=!0),Me.colors&&(Me.stylize=P),I(Me,_e,Me.depth)}function P(_e,Se){var Me=A.styles[Se];return Me?"\x1B["+A.colors[Me][0]+"m"+_e+"\x1B["+A.colors[Me][1]+"m":_e}function R(_e){return _e}function D(_e){var Se={};return _e.forEach(function(Me){Se[Me]=!0}),Se}function I(_e,Se,Me){if(_e.customInspect&&Se&&se(Se.inspect)&&Se.inspect!==E.inspect&&!(Se.constructor&&Se.constructor.prototype===Se)){var Te=Se.inspect(Me,_e);return K(Te)||(Te=I(_e,Te,Me)),Te}var Ee=U(_e,Se);if(Ee)return Ee;var Le=Object.keys(Se),we=D(Le);if(_e.showHidden&&(Le=Object.getOwnPropertyNames(Se)),ie(Se)&&(0<=Le.indexOf("message")||0<=Le.indexOf("description")))return F(Se);if(0===Le.length){if(se(Se)){var Ce=Se.name?": "+Se.name:"";return _e.stylize("[Function"+Ce+"]","special")}if(ee(Se))return _e.stylize(RegExp.prototype.toString.call(Se),"regexp");if(ne(Se))return _e.stylize(Date.prototype.toString.call(Se),"date");if(ie(Se))return F(Se)}var Ae="",Pe=!1,Re=["{","}"];if(H(Se)&&(Pe=!0,Re=["[","]"]),se(Se)){var De=Se.name?": "+Se.name:"";Ae=" [Function"+De+"]"}if(ee(Se)&&(Ae=" "+RegExp.prototype.toString.call(Se)),ne(Se)&&(Ae=" "+Date.prototype.toUTCString.call(Se)),ie(Se)&&(Ae=" "+F(Se)),0===Le.length&&(!Pe||0==Se.length))return Re[0]+Ae+Re[1];if(0>Me)return ee(Se)?_e.stylize(RegExp.prototype.toString.call(Se),"regexp"):_e.stylize("[Object]","special");_e.seen.push(Se);var Ie;return Ie=Pe?V(_e,Se,Me,we,Le):Le.map(function(Be){return G(_e,Se,Me,we,Be,Pe)}),_e.seen.pop(),O(Ie,Ae,Re)}function U(_e,Se){if(J(Se))return _e.stylize("undefined","undefined");if(K(Se)){var Me="'"+JSON.stringify(Se).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return _e.stylize(Me,"string")}return Z(Se)?_e.stylize(""+Se,"number"):W(Se)?_e.stylize(""+Se,"boolean"):X(Se)?_e.stylize("null","null"):void 0}function F(_e){return"["+Error.prototype.toString.call(_e)+"]"}function V(_e,Se,Me,Te,Ee){for(var Le=[],we=0,Ce=Se.length;we<Ce;++we)fe(Se,we+"")?Le.push(G(_e,Se,Me,Te,we+"",!0)):Le.push("");return Ee.forEach(function(Ae){Ae.match(/^\d+$/)||Le.push(G(_e,Se,Me,Te,Ae,!0))}),Le}function G(_e,Se,Me,Te,Ee,Le){var we,Ce,Ae;if(Ae=Object.getOwnPropertyDescriptor(Se,Ee)||{value:Se[Ee]},Ae.get?Ae.set?Ce=_e.stylize("[Getter/Setter]","special"):Ce=_e.stylize("[Getter]","special"):Ae.set&&(Ce=_e.stylize("[Setter]","special")),fe(Te,Ee)||(we="["+Ee+"]"),Ce||(0>_e.seen.indexOf(Ae.value)?(Ce=X(Me)?I(_e,Ae.value,null):I(_e,Ae.value,Me-1),-1<Ce.indexOf("\n")&&(Le?Ce=Ce.split("\n").map(function(Pe){return"  "+Pe}).join("\n").substr(2):Ce="\n"+Ce.split("\n").map(function(Pe){return"   "+Pe}).join("\n"))):Ce=_e.stylize("[Circular]","special")),J(we)){if(Le&&Ee.match(/^\d+$/))return Ce;we=JSON.stringify(""+Ee),we.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(we=we.substr(1,we.length-2),we=_e.stylize(we,"name")):(we=we.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),we=_e.stylize(we,"string"))}return we+": "+Ce}function O(_e,Se,Me){var Te=0,Ee=_e.reduce(function(Le,we){return Te++,0<=we.indexOf("\n")&&Te++,Le+we.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<Ee?Me[0]+(""===Se?"":Se+"\n ")+" "+_e.join(",\n  ")+" "+Me[1]:Me[0]+Se+" "+_e.join(", ")+" "+Me[1]}function H(_e){return Array.isArray(_e)}function W(_e){return"boolean"==typeof _e}function X(_e){return null===_e}function Z(_e){return"number"==typeof _e}function K(_e){return"string"==typeof _e}function J(_e){return void 0===_e}function ee(_e){return oe(_e)&&"[object RegExp]"===pe(_e)}function oe(_e){return"object"==typeof _e&&null!==_e}function ne(_e){return oe(_e)&&"[object Date]"===pe(_e)}function ie(_e){return oe(_e)&&("[object Error]"===pe(_e)||_e instanceof Error)}function se(_e){return"function"==typeof _e}function pe(_e){return Object.prototype.toString.call(_e)}function ue(_e){return 10>_e?"0"+_e.toString(10):_e.toString(10)}function ge(){var _e=new Date,Se=[ue(_e.getHours()),ue(_e.getMinutes()),ue(_e.getSeconds())].join(":");return[_e.getDate(),ve[_e.getMonth()],Se].join(" ")}function fe(_e,Se){return Object.prototype.hasOwnProperty.call(_e,Se)}var he=/%[sdj%]/g;E.format=function(_e){if(!K(_e)){for(var Se=[],Me=0;Me<arguments.length;Me++)Se.push(A(arguments[Me]));return Se.join(" ")}for(var Me=1,Te=arguments,Ee=Te.length,Le=(_e+"").replace(he,function(Ce){if("%%"===Ce)return"%";if(Me>=Ee)return Ce;switch(Ce){case"%s":return Te[Me++]+"";case"%d":return+Te[Me++];case"%j":try{return JSON.stringify(Te[Me++])}catch(Ae){return"[Circular]"}default:return Ce;}}),we=Te[Me];Me<Ee;we=Te[++Me])Le+=X(we)||!oe(we)?" "+we:" "+A(we);return Le},E.deprecate=function(_e,Se){if(J(C.process))return function(){return E.deprecate(_e,Se).apply(this,arguments)};if(!0===L.noDeprecation)return _e;var Te=!1;return function(){if(!Te){if(L.throwDeprecation)throw new Error(Se);else L.traceDeprecation?console.trace(Se):console.error(Se);Te=!0}return _e.apply(this,arguments)}};var ye={},xe;E.debuglog=function(_e){if(J(xe)&&(xe=L.env.NODE_DEBUG||""),_e=_e.toUpperCase(),!ye[_e])if(new RegExp("\\b"+_e+"\\b","i").test(xe)){var Se=L.pid;ye[_e]=function(){var Me=E.format.apply(E,arguments);console.error("%s %d: %s",_e,Se,Me)}}else ye[_e]=function(){};return ye[_e]},E.inspect=A,A.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},A.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},E.isArray=H,E.isBoolean=W,E.isNull=X,E.isNullOrUndefined=function(_e){return null==_e},E.isNumber=Z,E.isString=K,E.isSymbol=function(_e){return"symbol"==typeof _e},E.isUndefined=J,E.isRegExp=ee,E.isObject=oe,E.isDate=ne,E.isError=ie,E.isFunction=se,E.isPrimitive=function(_e){return null===_e||"boolean"==typeof _e||"number"==typeof _e||"string"==typeof _e||"symbol"==typeof _e||"undefined"==typeof _e},E.isBuffer=S("./support/isBuffer");var ve=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];E.log=function(){console.log("%s - %s",ge(),E.format.apply(E,arguments))},E.inherits=S("inherits"),E._extend=function(_e,Se){if(!Se||!oe(Se))return _e;for(var Me=Object.keys(Se),Te=Me.length;Te--;)_e[Me[Te]]=Se[Me[Te]];return _e}}).call(this,S("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./support/isBuffer":29,_process:20,inherits:28}],31:[function(S,M){var L=S("log-scale"),C=S("lodash.range"),A=S("average"),P=S("get-closest");M.exports=function(D){var I=D.context.createAnalyser();D.fftSize&&(I.fftSize=D.fftSize);var U=new Uint8Array(I.frequencyBinCount),F=new L(0,U.length);I.equalTemperedFreqBinCount=D.equalTemperedFreqBinCount||8;for(var V=C(0,1,1/I.equalTemperedFreqBinCount).map(function(Q){return F.linearToLogarithmic(Q)}).concat(U.length),G=[],O=0;O<V.length-1;O++){var H=V[O],W=V[O+1]+1;G.push({start:H,end:W})}I.equalTemperedFrequencyData=function(){this.getByteFrequencyData(U);var Q=G.map(function(J){var ee=U.slice(J.start,J.end);return parseInt(A(ee))});return{frequencies:Q,overallAmplitude:A(Q)}};var X=[60,150,250,350,450,570,700,840,1000,1170,1370,1600,1850,2150,2500,2900,3400,4000,4800,5800,7000,8500,10500,13500];D.addSubBassToBarkScale&&X.unshift(20);var Y=D.context.sampleRate/I.fftSize,Z=C(0,U.length).map(function(Q){return parseInt(Q*Y)}),K=X.map(function(Q){return P.number(Q,Z)});return I.barkScaleFrequencyData=function(){this.getByteFrequencyData(U);var Q=K.map(function(J){return U[J]});return{frequencies:Q,overallAmplitude:A(Q)}},I}},{average:2,"get-closest":10,"lodash.range":14,"log-scale":17}],32:[function(S,M){var L=S("jquery"),C=S("web-audio-analyser-2"),A=S("lodash.range"),P=A(10).map(function(I){return"#track-"+I}),R=S("rotate-array");M.exports=class{constructor(){var I=this;this.currentAudioIdIndex=0,this.ctx=new(window.webkitAudioContext||window.AudioContext),this.sources=P.map(function(U){var F=I.ctx.createMediaElementSource(L(U)[0]);return F.mediaElement||(F.mediaElement=L(U)[0]),F}),this.analyser=C({context:this.ctx,fftSize:2048,equalTemperedFreqBinCount:7}),this.out=this.ctx.destination,this.currentSource().connect(this.analyser),this.analyser.connect(this.out),this.bindEventListeners()}bindEventListeners(){var I=this;L("#play").click(function(){I.play(),L("#play-sound")[0].play()}),L("#pause").click(function(){I.pause(),L("#pause-sound")[0].play()}),L("#step-forward").click(function(){I.stepForward(),L("#step-sound")[0].play()}),L("#step-backward").click(function(){I.stepBackward(),L("#step-sound")[0].play()}),this.sources.forEach(function(U){U.mediaElement.onended=I.stepForward.bind(I)})}measure(){var I=this.analyser.equalTemperedFrequencyData(7),U=I.frequencies,F=I.overallAmplitude;return{frequencies:U,overallAmplitude:F}}currentSource(){return this.sources[0]}currentAudio(){return this.currentSource().mediaElement}stepForward(){this.pause(),this.currentAudio().currentTime=0,this.sources=R(this.sources,1),this.currentSource().connect(this.analyser),this.play()}stepBackward(){this.currentAudio().paused?(this.sources=R(this.sources,-1),this.currentSource().connect(this.analyser)):(this.pause(),this.currentAudio().currentTime=0)}pause(){L("#pause").hide(),L("#play").show(),this.currentAudio().pause()}play(){var I=this;L("#play").hide(),L("#pause").show(),setTimeout(function(){I.currentAudio().play()},1e3)}}},{jquery:12,"lodash.range":14,"rotate-array":24,"web-audio-analyser-2":31}],33:[function(S,M){var C=4,A=100,P=20;M.exports={groundLevel:-1,railSpacing:C,numRails:P,powerLineSpacing:A,numberOfPowerLines:P*C/A}},{}],34:[function(S,M){var L=S("lodash.range"),C=S("lodash.round");M.exports=function(P){var R=P.Entity,D=P.spacing,I=P.scene,U=P.color,F=P.count,V=P.camera,G=L(F).map(function(){return new R({color:U,scene:I})}),O=function(W,X){G.shift().remove(),G.push(new R({color:X,scene:W}))},H=function(W){return 0==C(-W.position.z,1)%D};return{render:function(W,X,Y){H(X)&&O(W,Y)}}}},{"lodash.range":14,"lodash.round":15}],35:[function(S,M){var L=S("three"),C=L.Scene,A=L.PerspectiveCamera,P=L.WebGLRenderer,R=L.MeshBasicMaterial,D=L.Mesh,I=L.Vector3,U=L.Color,F=S("jquery"),V=S("three-window-resize"),G=S("../constants"),O=G.railSpacing,H=G.powerLineSpacing,W=G.numRails,X=G.numberOfPowerLines,Y=S("./collection"),Z=S("./rail-segment"),K=S("./power-line");M.exports=class{constructor(){this.materialColor=0,this.scene=new C,this.camera=new A(75,window.innerWidth/window.innerHeight,0.01,50),this.camera.position.z=0,this.camera.position.y=0,this.camera.lookAt(new I(0,0,0)),this.renderer=new P({alpha:!0,canvas:F("#three-canvas")[0]}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(this.materialColor,0),this.renderer.context.getShaderInfoLog=function(){return""},this.windowResize=new V(this.renderer,this.camera),this.railSegments=Y({Entity:Z,spacing:O,scene:this.scene,color:this.materialColor,count:W,camera:this.camera}),this.powerLines=Y({Entity:K,spacing:H,scene:this.scene,color:this.materialColor,count:X,camera:this.camera})}render(){this.camera.position.z-=0.1,this.railSegments.render(this.scene,this.camera,this.materialColor),this.powerLines.render(this.scene,this.camera,this.materialColor),this.renderer.render(this.scene,this.camera)}renderColors(J){var ee=this;this.materialColor=new U("#"+J),this.scene.traverse(function(oe){oe instanceof D&&(oe.material=new R({color:ee.materialColor}))})}}},{"../constants":33,"./collection":34,"./power-line":36,"./rail-segment":37,jquery:12,three:27,"three-window-resize":26}],36:[function(S,M){var L=S("three"),C=L.MeshBasicMaterial,A=L.Mesh,P=L.CylinderGeometry,R=S("lodash.sample"),D=S("../constants"),I=D.groundLevel,U=D.powerLineSpacing,F=0;M.exports=class{constructor(G){var O=G.scene,H=G.color;F++;var W=3,X=new C({color:H}),Y=R([-5,5]),Z=new P(0.02,0.02,W,32);this.pole=new A(Z,X),this.pole.position.set(Y,I+W/2,-F*U);var K=new P(0.02,0.02,0.4,32);this.cross=new A(K,X),this.cross.rotation.z=_MathPI2/2,this.cross.position.set(Y,I+2*W/3,-F*U),this.scene=O,this.scene.add(this.pole,this.cross)}remove(){this.scene.remove(this.pole,this.cross)}}},{"../constants":33,"lodash.sample":16,three:27}],37:[function(S,M){var L=S("three"),C=L.MeshBasicMaterial,A=L.Mesh,P=L.BoxGeometry,R=S("../constants"),D=R.groundLevel,I=R.railSpacing,U=0;M.exports=class{constructor(V){var G=V.scene,O=V.color;U++,this.left=this._mesh(O,-3),this.right=this._mesh(O,3),this.scene=G,this.scene.add(this.left,this.right)}remove(){this.scene.remove(this.left,this.right)}_mesh(V,G){var O=new P(0.2,0.02,1),H=new C({color:V}),W=new A(O,H);return W.position.set(G,D,-U*I),W}}},{"../constants":33,three:27}],38:[function(S,M){var L=S("jquery"),C=S("raf-loop"),A=S("./environment"),P=S("./view"),R=S("./space"),D=S("./audio-interface"),I=S("lodash.round"),U=S("./mountain-range"),F=S("color-convert");M.exports=class{constructor(){this.environment=new A,this.space=new R,this.audioInterface=new D,this.view=new P({audioInterface:this.audioInterface}),this.mountainRange=new U}bindEventListeners(){L(window).load(this.view.closeLoadingScreen)}start(){var G=this,O=0,H=!0,W=20;this.space.show(),C(function(){G.environment.render(),O+=0.1;var X=G.audioInterface.measure(),Y=X.overallAmplitude,Z=X.frequencies;G.mountainRange.render(Z),G.space.update(-1*O/180*_MathPI2,Y);var K=1*I(O,1)%180;if(0==K%180&&(H=!H),K>180-W){var Q=(180-K)/W,J=H?{primary:F.hsl.hex(0,0,100*(1-Q)),secondary:F.hsl.hex(0,0,100*Q)}:{primary:F.hsl.hex(0,0,100*Q),secondary:F.hsl.hex(0,0,100*(1-Q))};G.view.renderColors(J.primary,J.secondary),G.mountainRange.renderColors(J.primary,J.secondary),G.environment.renderColors(J.primary)}}).start()}}},{"./audio-interface":32,"./environment":35,"./mountain-range":39,"./space":40,"./view":42,"color-convert":4,jquery:12,"lodash.round":15,"raf-loop":21}],39:[function(S,M){var L=S("jquery"),C=S("scale-number-range");M.exports=class{constructor(){this.canvas=L("#mountain-range")[0],this.ctx=this.canvas.getContext("2d"),this.strokeStyle="black",this.fillStyle="white",this.setDimensions(),this.bindEventListeners()}bindEventListeners(){L(window).resize(this.setDimensions.bind(this))}setDimensions(){this.canvas.width=L(window).width(),this.canvas.height=L(window).height(),this.mountainRangeHeight=0.5111*L(window).height()}render(P){var R=this,D=[];P.forEach(function(G){D.push(2e-3*(G*R.mountainRangeHeight)),D.push(0)});var I=D.map(function(G,O,H){return{x:C(O+1,0,H.length,0,R.canvas.width),y:R.mountainRangeHeight-1*G}});this.ctx.strokeStyle=this.strokeStyle,this.ctx.fillStyle=this.fillStyle,this.ctx.beginPath(),this.ctx.moveTo(0,this.mountainRangeHeight);var U=void 0;for(U=0;U<I.length-2;U++){var F=(I[U].x+I[U+1].x)/2,V=(I[U].y+I[U+1].y)/2;this.ctx.quadraticCurveTo(I[U].x,I[U].y,F,V)}this.ctx.quadraticCurveTo(I[U].x,I[U].y,I[U+1].x,I[U+1].y),this.ctx.lineTo(0,this.mountainRangeHeight),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillRect(0,this.mountainRangeHeight,this.canvas.width,this.canvas.height),this.ctx.fill(),this.ctx.stroke()}renderColors(P,R){this.strokeStyle="#"+P,this.fillStyle="#"+R}}},{jquery:12,"scale-number-range":25}],40:[function(S,M){var L=_MathPI2,C=_Mathcos2,A=_Mathsin2,P=S("jquery"),R=S("lodash.min");M.exports=class{constructor(){this.$space=P("#space"),this.setSpaceContainerSize(),this.$sun=P("#sun"),this.$moon=P("#moon"),this.bindEventListeners()}bindEventListeners(){P(window).resize(this.setSpaceContainerSize.bind(this))}setSpaceContainerSize(){this.spaceSize=R([P(window).width(),P(window).height()]),this.$space.width(this.spaceSize),this.$space.height(this.spaceSize)}show(){this.$sun.show(),this.$moon.show()}update(I,U){var F=50+0.25*(U/255*this.spaceSize),V=P(window).width()/2-F/2,G=P(window).height()/2-F/2;this.$sun.css({width:F,height:F}),this.$moon.css({width:F,height:F}),this.$sun.offset({top:G+this.spaceSize/2*A(I),left:V+this.spaceSize/2*C(I)}),this.$moon.offset({top:G+this.spaceSize/2*A(I+L),left:V+this.spaceSize/2*C(I+L)})}}},{jquery:12,"lodash.min":13}],41:[function(S,M){M.exports=[{img:"a3247042134_2.jpg",album:"dead-beat-til-i-die",title:"dead//beat til i die"},{img:"a3287578958_2.jpg",album:"steeping",title:"steeping"},{img:"a2557375228_2.jpg",album:"motionless",title:"motionless"},{img:"a2361122322_2.jpg",album:"stress",title:"stress"},{img:"a3136442865_2.jpg",album:"low-vibes",title:"low vibes"},{img:"a0412213850_2.jpg",album:"untitled-ep-4",title:"untitled ep4"},{img:"a1343068421_2.jpg",album:"untitled-ep-3",title:"untitled ep3"},{img:"a1637662097_2.jpg",album:"takes-the-air",title:"takes the air"},{img:"a3163431488_2.jpg",album:"untitled-ep-2",title:"untitled ep 2"},{img:"a2362660752_2.jpg",album:"untitled-ep",title:"untitled ep"},{img:"a0499335438_2.jpg",album:"thought-loop",title:"thought loop"},{img:"a0500555093_2.jpg",album:"hfpn011-a-long-interval-marked-by-nothing-of-distinguished-note",title:"(HFPN011) a long interval, marked by nothing of distinguished note"},{img:"a2317249876_2.jpg",album:"cold-heart-warm",title:"cold/heart\\warm"},{img:"a3290534802_2.jpg",album:"music-to-watch-clouds-with",title:"music to watch clouds with"},{img:"a3201699299_2.jpg",album:"so-long-blue-skies",title:"(so long) blue skies"},{img:"a4109433261_2.jpg",album:"view",title:"view"},{img:"a4085011476_2.jpg",album:"ilo",title:"ilo"},{img:"a2870091575_2.jpg",album:"well",title:"well"},{img:"a0329685018_2.jpg",album:"-",title:"..."},{img:"a2153041237_2.jpg",album:"styrofoam-sleep",title:"Styrofoam Sleep"},{img:"a1789288278_2.jpg",album:"red-oak-intermodulation",title:"Red Oak Intermodulation"},{img:"a4058127069_2.jpg",album:"um-ah",title:"Um / Ah"},{img:"a1942401491_2.jpg",album:"oh-people",title:"Oh [people]"}]},{}],42:[function(S,M){var L=S("jquery"),C=S("./audio-list"),A=S("./video-list");M.exports=class{constructor(R){var D=R.audioInterface;this.audioInterface=D,this.bindEventListeners()}populateAudioPanel(){L("#audio-panel").html(C.map(function(R){var D=R.img,I=R.album,U=R.title;return"\n      <a href=\"https://lotsoflettershere.bandcamp.com/album/"+I+"\" class=\"album-link\" target=\"_blank\">\n        <img class=\"album-art\" src=\"https://f4.bcbits.com/img/"+D+"\" />\n      </a>\n    "}))}populateVideoPanel(){L("#video-panel").html(A.map(function(R){var D=R.gif,I=R.video;return"\n      <img class=\"video-art\" src="+D+" data-src=\"https://github.com/data-doge/hosted-videos/blob/master/"+I+"?raw=true\" />\n    "}))}closeLoadingScreen(){L("#loading-screen").hide()}bindEventListeners(){L(".nav-link").on("click",this.handleNavLinkClick.bind(this)),L("#home").on("click",this.hideAllPanels.bind(this)),L(document).on("click",".video-art",this.handleVideoLinkClick.bind(this)),L(document).on("click","#close-video",this.handleCloseVideoClick.bind(this))}handleNavLinkClick(R){R.preventDefault();var D=R.target.id,I=L("#"+D+"-panel");"true"===I.attr("data-selected")?I.hide().attr("data-selected",!1):("audio"===D&&this.populateAudioPanel(),"video"===D&&this.populateVideoPanel(),this.hideAllPanels(),I.show().attr("data-selected",!0))}hideAllPanels(){L(".panel").hide().attr("data-selected",!1)}handleVideoLinkClick(R){this.audioInterface.pause();var D=L(R.target).attr("data-src");L("body").append(L("\n      <div id=\"video-container\">\n        <div id=\"close-video\">&times;</div>\n        <video autoplay>\n          <source src=\""+D+"\"></source>\n        </video>\n      </div>\n    "))}handleCloseVideoClick(){L("#video-container").remove()}renderColors(R,D){L("body").css({background:"#"+D}),L(".color-transition-copy").css({background:"#"+R,color:"#"+D}),L(".audio-control").css({color:"#"+R})}}},{"./audio-list":41,"./video-list":43,jquery:12}],43:[function(S,M){M.exports=[{gif:"./media/1991.gif",video:"1991.mp4"},{gif:"./media/1992.gif",video:"1992.mp4"},{gif:"./media/1993.gif",video:"1993.mp4"},{gif:"./media/1994.gif",video:"1994.mp4"},{gif:"./media/untitled-again.gif",video:"untitled-again.mp4"},{gif:"./media/dash.gif",video:"dash.mp4"},{gif:"./media/addendum.gif",video:"addendum.mp4"},{gif:"./media/untitled.gif",video:"untitled.mp4"},{gif:"./media/fades-to-color.gif",video:"fades-to-color.mp4"},{gif:"./media/m-o-k-e.gif",video:"m-o-k-e.mp4"},{gif:"./media/niagara-falls.gif",video:"niagara-falls.mp4"},{gif:"./media/spring-comes-to-a-pond.gif",video:"spring-comes-to-a-pond.mp4"},{gif:"./media/untitled-1.gif",video:"untitled-1.mp4"}]},{}],44:[function(S){var L=S("./engine"),C=new L;C.bindEventListeners(),C.start()},{"./engine":38}]},{},[44]);
